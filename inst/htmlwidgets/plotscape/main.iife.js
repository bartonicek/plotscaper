var plotscape=function(S){"use strict";var _e=document.createElement("style");_e.textContent=`html,body{width:100%;height:100%}#app{width:100%;height:100%;padding:2%;box-sizing:border-box}.ps-scene-container{-webkit-user-select:none;user-select:none;display:grid!important;position:relative;overflow:hidden;background-color:#deded9;width:100%;height:100%;grid-template-columns:repeat(var(--ncols),1fr);grid-template-rows:repeat(var(--nrows),1fr);box-sizing:border-box;padding:min(5vmin,50px);grid-gap:20px}.ps-plot-container{z-index:0;position:relative;border:1px solid black;border:2px solid transparent}.ps-plot-container textarea{resize:none;width:100%;height:100%;padding:20px;box-sizing:border-box;background-color:#f5f5f5;color:#3d3d3d;border:none;outline:none}.ps-plot-container.active{border:2px solid #7a7a7a}.ps-plot-context{position:absolute;top:0;right:0;width:100%;height:100%}.ps-plot-context.inner{background-color:#fefffe;top:var(--tmargin);right:var(--rmargin);width:calc(100% - var(--lmargin) - var(--rmargin));height:calc(100% - var(--bmargin) - var(--tmargin));border-bottom:1px solid black;border-left:1px solid black}.ps-help-modal{font-size:min(2.5vmin,14pt);color:#3d3d3d;background-color:#fefffe;border:1px solid #3d3d3d;outline:none;overflow:hidden;padding:2vmin 5vmin}.ps-help-modal h1,h2,h3,hr{margin:0;font-weight:lighter}.ps-help-modal ul{list-style:none;font-family:sans-serif;padding:0}.ps-help-button{position:absolute;top:0;right:0;width:30px;height:30px;font-weight:700;float:right;border:none;font-weight:100;font-size:medium}.ps-query-display{display:none;white-space:nowrap;z-index:30;position:absolute;width:fit-content;background-color:#fff;border:1px solid #7a7a7a;padding:2%;pointer-events:none}.ps-widget-modal{margin:0;left:10vmin;top:10vmin;position:absolute;font-size:min(2.5vmin,14pt);color:#3d3d3d;background-color:#fefffe;border:1px solid #3d3d3d;outline:none;padding:0}.ps-widget-display{cursor:move;position:relative;min-width:40vmin;padding-top:2vmin;padding-bottom:2vmin}.ps-widget span{font-family:sans-serif;font-weight:700}.ps-widget button{border:none}.ps-widget-display button{position:absolute;top:10px;right:10px}.ps-widget{background-color:#f5f5f5;margin:2vmin 5vmin;padding:2vmin 3vmin}.ps-widget button{background-color:#deded9;position:relative;top:auto;right:auto;margin-left:1vmin}.ps-widget input{text-align:right}.ps-widget-draglist ul{background-color:#f5f5f5;list-style:none;padding-left:0}.ps-widget-draglist li{cursor:grab;background-color:#fefffe;padding:5px}.ps-widget-draglist li:hover{opacity:.75}.ps-widget-draglist li:nth-child(odd){background-color:#deded9}.ps-widget-draglist li.dragged{opacity:.3;cursor:move}.ps-widget-range input{text-overflow:ellipsis;margin-left:10px}
`,document.head.appendChild(_e);function k(t){return{node:document.createElement(t),get:On,append:Cn,appendTo:Tn,text:Nn,html:En,addClass:Ln,setAttribute:Hn,setStyles:Bn}}var On=function(){return this.node},Cn=function(t){return this.node.appendChild(t),this},Tn=function(t){return t.appendChild(this.node),this},Nn=function(t){return this.node.innerText=t,this},En=function(t){return this.node.innerHTML=t,this},Ln=function(t){return this.node.classList.add(t),this},Hn=function(t,e){return this.node[t]=e,this},Bn=function(t){for(const[e,n]of Object.entries(t))this.node.style[e]=n;return this};function Jt(t){throw new Error(t)}function te(t){return t}function Rt(t,e){return function(n){return e(t(n))}}function Fn(t,e){return function(...n){t(n),e(n)}}function Wn(){}function et(){return this}function Pe(t){return[1,0][t]}function Re(t){return t+1}function Gn(t){return t-1}function pt(t){return function(e){return t*e}}function Ot(t){return t**2}function Ct(t){return Math.sqrt(t)}function jn(t){return parseInt(t,10)}function Oe(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Kn(t){return t.toLocaleLowerCase()}function In(t){return t.toLocaleUpperCase()}function qn(t){return t.replace(/\s/g,"")}async function Qn(t){return await(await fetch(t)).json()}function N(t,e){return t-e}function Ce(t,e){return t+e}function Zn(t,e){return t*e}function ee(t,e){return t.localeCompare(e,"en",{numeric:!0})}function Yn(t,e,n){return Math.min(Math.max(t,e),n)}function ne(t){return Yn(t,0,1)}function se(t,e=0){return Math.round(t*10**e)/10**e}function gt(t){return t[t.length-1]}function at(t,e,n){const s=Math.abs(e-t);n=n??Math.ceil(s)+1;const r=s/(n-1),i=e>=t?1:-1;return Array.from(Array(n),(o,a)=>t+i*r*a)}function Tt(t){let[e,n]=[1/0,-1/0];for(let s=0;s<t.length;s++)e=Math.min(e,t[s]),n=Math.max(n,t[s]);return[e,n]}function Nt(t,e){return Array(e).fill(t)}function re(t,e,n=0,s=e.length){const r=Array(s-n);for(let i=0;i<s-n;i++)r[i]=t[e[n+i]];return r}function Xn(t,...e){const n=Array(t.length*e.length);for(let s=0;s<e.length;s++){const r=e[s];for(let i=0;i<t.length;i++)n[t.length*s+i]=r(t[i])}return n}function Te(t,e){return Math.floor(t+Math.random()*e)}function Ne(t,e,n=e-t){const s=e-t,r=[],i=new Set;for(;r.length<Math.min(n,s);){let o=Te(t,e);for(;i.has(o);)o=Te(t,e);r.push(o),i.add(o)}return r}function ie(t){const e=Array(t.length);e[0]=t[0];for(let n=1;n<t.length;n++)e[n]=t[n]+e[n-1];return e}function oe(t){return Object.keys(t)}function j(t){return Object.values(t)}function nt(t){return Object.entries(t)}function Ee(t){return Reflect.ownKeys(t)}function Vn(t){const e=[];for(const n of Ee(t))e.push(t[n]);return e}function B(t){const e=[];for(const n of Ee(t))e.push([n,t[n]]);return e}function Un(t){for(const[e,n]of nt(t))n===void 0&&delete t[e];return t}function Et(t,e){let n=0;return(...s)=>{const r=new Date().getTime();r-n<e||(n=r,t(...s))}}function yt(t,e){for(const n of e)t.add(n);return t}function bt(t,e){return 1/(e-t)}function Lt(t,e){const n=bt(t,e);return[-t*n,n-t*n]}function Jn(t,e,n=4){const s=(e-t)/n,r=Math.floor(Math.log10(s)),i=[1,2,4,5,10];let[o,a]=[1/0,0];for(let m=0;m<i.length;m++){const p=(i[m]*10**r-s)**2;p<o&&([o,a]=[p,i[m]])}const c=10**r*a,u=Math.ceil(t/c)*c,l=Math.floor(e/c)*c,d=Math.round((l-u)/c),h=[];for(let m=0;m<d+1;m++){const p=u+m*c;h.push(p)}return h}var ts=function(t){return function(e){return t[e]}};function es(t){return t.split("").map(ts(ss)).join("")}function ns(t){let[e,n]=t.split("e");return n=es(n),e+"×10"+n}function Ht(t){for(;t.lastChild;)t.removeChild(t.lastChild);return t}var ae=t=>()=>t,Le=ae(0),ss={"-":"⁻","+":"",0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹"};function E(t){return{...t,_name:void 0,name:rs,hasName:is,setName:os}}function rs(t="[name missing]"){return this._name??t}function is(){return this._name!=null}function os(t){return this._name=t,this}function st(t){return{...t,_isQueryable:!1,isQueryable:as,setQueryable:cs}}function as(){return this._isQueryable}function cs(t){return this._isQueryable=t,this}function Bt(t){"@babel/helpers - typeof";return Bt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bt(t)}var us=/^\s+/,ls=/\s+$/;function f(t,e){if(t=t||"",e=e||{},t instanceof f)return t;if(!(this instanceof f))return new f(t,e);var n=ds(t);this._originalInput=t,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}f.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),n,s,r,i,o,a;return n=e.r/255,s=e.g/255,r=e.b/255,n<=.03928?i=n/12.92:i=Math.pow((n+.055)/1.055,2.4),s<=.03928?o=s/12.92:o=Math.pow((s+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),.2126*i+.7152*o+.0722*a},setAlpha:function(e){return this._a=je(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=Be(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=Be(this._r,this._g,this._b),n=Math.round(e.h*360),s=Math.round(e.s*100),r=Math.round(e.v*100);return this._a==1?"hsv("+n+", "+s+"%, "+r+"%)":"hsva("+n+", "+s+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=He(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=He(this._r,this._g,this._b),n=Math.round(e.h*360),s=Math.round(e.s*100),r=Math.round(e.l*100);return this._a==1?"hsl("+n+", "+s+"%, "+r+"%)":"hsla("+n+", "+s+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return Fe(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return ps(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(A(this._r,255)*100)+"%",g:Math.round(A(this._g,255)*100)+"%",b:Math.round(A(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(A(this._r,255)*100)+"%, "+Math.round(A(this._g,255)*100)+"%, "+Math.round(A(this._b,255)*100)+"%)":"rgba("+Math.round(A(this._r,255)*100)+"%, "+Math.round(A(this._g,255)*100)+"%, "+Math.round(A(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:$s[Fe(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+We(this._r,this._g,this._b,this._a),s=n,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=f(e);s="#"+We(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+n+",endColorstr="+s+")"},toString:function(e){var n=!!e;e=e||this._format;var s=!1,r=this._a<1&&this._a>=0,i=!n&&r&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return i?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(s=this.toRgbString()),e==="prgb"&&(s=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(s=this.toHexString()),e==="hex3"&&(s=this.toHexString(!0)),e==="hex4"&&(s=this.toHex8String(!0)),e==="hex8"&&(s=this.toHex8String()),e==="name"&&(s=this.toName()),e==="hsl"&&(s=this.toHslString()),e==="hsv"&&(s=this.toHsvString()),s||this.toHexString())},clone:function(){return f(this.toString())},_applyModification:function(e,n){var s=e.apply(null,[this].concat([].slice.call(n)));return this._r=s._r,this._g=s._g,this._b=s._b,this.setAlpha(s._a),this},lighten:function(){return this._applyModification(xs,arguments)},brighten:function(){return this._applyModification(vs,arguments)},darken:function(){return this._applyModification(ws,arguments)},desaturate:function(){return this._applyModification(gs,arguments)},saturate:function(){return this._applyModification(ys,arguments)},greyscale:function(){return this._applyModification(bs,arguments)},spin:function(){return this._applyModification(As,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(ks,arguments)},complement:function(){return this._applyCombination(Ms,arguments)},monochromatic:function(){return this._applyCombination(zs,arguments)},splitcomplement:function(){return this._applyCombination(Ss,arguments)},triad:function(){return this._applyCombination(Ge,[3])},tetrad:function(){return this._applyCombination(Ge,[4])}},f.fromRatio=function(t,e){if(Bt(t)=="object"){var n={};for(var s in t)t.hasOwnProperty(s)&&(s==="a"?n[s]=t[s]:n[s]=xt(t[s]));t=n}return f(t,e)};function ds(t){var e={r:0,g:0,b:0},n=1,s=null,r=null,i=null,o=!1,a=!1;return typeof t=="string"&&(t=Rs(t)),Bt(t)=="object"&&(K(t.r)&&K(t.g)&&K(t.b)?(e=hs(t.r,t.g,t.b),o=!0,a=String(t.r).substr(-1)==="%"?"prgb":"rgb"):K(t.h)&&K(t.s)&&K(t.v)?(s=xt(t.s),r=xt(t.v),e=ms(t.h,s,r),o=!0,a="hsv"):K(t.h)&&K(t.s)&&K(t.l)&&(s=xt(t.s),i=xt(t.l),e=fs(t.h,s,i),o=!0,a="hsl"),t.hasOwnProperty("a")&&(n=t.a)),n=je(n),{ok:o,format:t.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}function hs(t,e,n){return{r:A(t,255)*255,g:A(e,255)*255,b:A(n,255)*255}}function He(t,e,n){t=A(t,255),e=A(e,255),n=A(n,255);var s=Math.max(t,e,n),r=Math.min(t,e,n),i,o,a=(s+r)/2;if(s==r)i=o=0;else{var c=s-r;switch(o=a>.5?c/(2-s-r):c/(s+r),s){case t:i=(e-n)/c+(e<n?6:0);break;case e:i=(n-t)/c+2;break;case n:i=(t-e)/c+4;break}i/=6}return{h:i,s:o,l:a}}function fs(t,e,n){var s,r,i;t=A(t,360),e=A(e,100),n=A(n,100);function o(u,l,d){return d<0&&(d+=1),d>1&&(d-=1),d<.16666666666666666?u+(l-u)*6*d:d<.5?l:d<.6666666666666666?u+(l-u)*(.6666666666666666-d)*6:u}if(e===0)s=r=i=n;else{var a=n<.5?n*(1+e):n+e-n*e,c=2*n-a;s=o(c,a,t+.3333333333333333),r=o(c,a,t),i=o(c,a,t-.3333333333333333)}return{r:s*255,g:r*255,b:i*255}}function Be(t,e,n){t=A(t,255),e=A(e,255),n=A(n,255);var s=Math.max(t,e,n),r=Math.min(t,e,n),i,o,a=s,c=s-r;if(o=s===0?0:c/s,s==r)i=0;else{switch(s){case t:i=(e-n)/c+(e<n?6:0);break;case e:i=(n-t)/c+2;break;case n:i=(t-e)/c+4;break}i/=6}return{h:i,s:o,v:a}}function ms(t,e,n){t=A(t,360)*6,e=A(e,100),n=A(n,100);var s=Math.floor(t),r=t-s,i=n*(1-e),o=n*(1-r*e),a=n*(1-(1-r)*e),c=s%6,u=[n,o,i,i,a,n][c],l=[a,n,n,o,i,i][c],d=[i,i,a,n,n,o][c];return{r:u*255,g:l*255,b:d*255}}function Fe(t,e,n,s){var r=[L(Math.round(t).toString(16)),L(Math.round(e).toString(16)),L(Math.round(n).toString(16))];return s&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function ps(t,e,n,s,r){var i=[L(Math.round(t).toString(16)),L(Math.round(e).toString(16)),L(Math.round(n).toString(16)),L(Ke(s))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)&&i[3].charAt(0)==i[3].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)+i[3].charAt(0):i.join("")}function We(t,e,n,s){var r=[L(Ke(s)),L(Math.round(t).toString(16)),L(Math.round(e).toString(16)),L(Math.round(n).toString(16))];return r.join("")}f.equals=function(t,e){return!t||!e?!1:f(t).toRgbString()==f(e).toRgbString()},f.random=function(){return f.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function gs(t,e){e=e===0?0:e||10;var n=f(t).toHsl();return n.s-=e/100,n.s=Ft(n.s),f(n)}function ys(t,e){e=e===0?0:e||10;var n=f(t).toHsl();return n.s+=e/100,n.s=Ft(n.s),f(n)}function bs(t){return f(t).desaturate(100)}function xs(t,e){e=e===0?0:e||10;var n=f(t).toHsl();return n.l+=e/100,n.l=Ft(n.l),f(n)}function vs(t,e){e=e===0?0:e||10;var n=f(t).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),f(n)}function ws(t,e){e=e===0?0:e||10;var n=f(t).toHsl();return n.l-=e/100,n.l=Ft(n.l),f(n)}function As(t,e){var n=f(t).toHsl(),s=(n.h+e)%360;return n.h=s<0?360+s:s,f(n)}function Ms(t){var e=f(t).toHsl();return e.h=(e.h+180)%360,f(e)}function Ge(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=f(t).toHsl(),s=[f(t)],r=360/e,i=1;i<e;i++)s.push(f({h:(n.h+i*r)%360,s:n.s,l:n.l}));return s}function Ss(t){var e=f(t).toHsl(),n=e.h;return[f(t),f({h:(n+72)%360,s:e.s,l:e.l}),f({h:(n+216)%360,s:e.s,l:e.l})]}function ks(t,e,n){e=e||6,n=n||30;var s=f(t).toHsl(),r=360/n,i=[f(t)];for(s.h=(s.h-(r*e>>1)+720)%360;--e;)s.h=(s.h+r)%360,i.push(f(s));return i}function zs(t,e){e=e||6;for(var n=f(t).toHsv(),s=n.h,r=n.s,i=n.v,o=[],a=1/e;e--;)o.push(f({h:s,s:r,v:i})),i=(i+a)%1;return o}f.mix=function(t,e,n){n=n===0?0:n||50;var s=f(t).toRgb(),r=f(e).toRgb(),i=n/100,o={r:(r.r-s.r)*i+s.r,g:(r.g-s.g)*i+s.g,b:(r.b-s.b)*i+s.b,a:(r.a-s.a)*i+s.a};return f(o)},f.readability=function(t,e){var n=f(t),s=f(e);return(Math.max(n.getLuminance(),s.getLuminance())+.05)/(Math.min(n.getLuminance(),s.getLuminance())+.05)},f.isReadable=function(t,e,n){var s=f.readability(t,e),r,i;switch(i=!1,r=Os(n),r.level+r.size){case"AAsmall":case"AAAlarge":i=s>=4.5;break;case"AAlarge":i=s>=3;break;case"AAAsmall":i=s>=7;break}return i},f.mostReadable=function(t,e,n){var s=null,r=0,i,o,a,c;n=n||{},o=n.includeFallbackColors,a=n.level,c=n.size;for(var u=0;u<e.length;u++)i=f.readability(t,e[u]),i>r&&(r=i,s=f(e[u]));return f.isReadable(t,s,{level:a,size:c})||!o?s:(n.includeFallbackColors=!1,f.mostReadable(t,["#fff","#000"],n))};var ce=f.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},$s=f.hexNames=Ds(ce);function Ds(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}function je(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function A(t,e){_s(t)&&(t="100%");var n=Ps(t);return t=Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function Ft(t){return Math.min(1,Math.max(0,t))}function R(t){return parseInt(t,16)}function _s(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function Ps(t){return typeof t=="string"&&t.indexOf("%")!=-1}function L(t){return t.length==1?"0"+t:""+t}function xt(t){return t<=1&&(t=t*100+"%"),t}function Ke(t){return Math.round(parseFloat(t)*255).toString(16)}function Ie(t){return R(t)/255}var H=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+t+")",s="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",r="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+s),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+s),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+s),hsva:new RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function K(t){return!!H.CSS_UNIT.exec(t)}function Rs(t){t=t.replace(us,"").replace(ls,"").toLowerCase();var e=!1;if(ce[t])t=ce[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=H.rgb.exec(t))?{r:n[1],g:n[2],b:n[3]}:(n=H.rgba.exec(t))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=H.hsl.exec(t))?{h:n[1],s:n[2],l:n[3]}:(n=H.hsla.exec(t))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=H.hsv.exec(t))?{h:n[1],s:n[2],v:n[3]}:(n=H.hsva.exec(t))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=H.hex8.exec(t))?{r:R(n[1]),g:R(n[2]),b:R(n[3]),a:Ie(n[4]),format:e?"name":"hex8"}:(n=H.hex6.exec(t))?{r:R(n[1]),g:R(n[2]),b:R(n[3]),format:e?"name":"hex"}:(n=H.hex4.exec(t))?{r:R(n[1]+""+n[1]),g:R(n[2]+""+n[2]),b:R(n[3]+""+n[3]),a:Ie(n[4]+""+n[4]),format:e?"name":"hex8"}:(n=H.hex3.exec(t))?{r:R(n[1]+""+n[1]),g:R(n[2]+""+n[2]),b:R(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function Os(t){var e,n;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),n=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:e,size:n}}const O={defaultGapPct:.8,defaultGapPx:1,defaultNormX:.05,defaultNormY:.05,defaultRadius:5,axisTitleFontsize:18,axisLabelFontsize:14,marginLines:[4,4,1,1],groupColors:["#984ea3","#e41a1c","#4daf4a","#377eb8"]};function ct(t){return{...t,with(e){return ct(e(this))}}}function Cs(t,e,n){const s=Array(t.length);for(let r=0;r<t.length;r++)s[r]=n(t[r],e[r]);return s}function Ts(t,e){return(t+e)/2}function ut(){const{marginLines:t,axisTitleFontsize:e}=O;return t.map(pt(e))}function ue(t,e){const[n,s]=[t[0],t[2]].sort(N),[r,i]=[t[1],t[3]].sort(N),[o,a]=[e[0],e[2]].sort(N),[c,u]=[e[1],e[3]].sort(N);return!(s<o||n>a||i<c||r>u)}function qe(t){const[e,n,s,r]=t;return[e,n,s-e,r-n]}function Qe(t,e,n){return!(t<e)&&!(t>n)}function Wt(t,e){let[n,s,r,i]=qe(t),[o,a,c,u]=qe(e);const l=c*i-r*u,d=((n-o)*i-(s-a)*r)/l,h=-(-(n-o)*u+(s-a)*c)/l;return Qe(d,0,1)&&Qe(h,0,1)}function Ze(t,e){const[n,s,r,i]=t;return Wt([n,s,r,s],e)||Wt([n,s,n,i],e)||Wt([r,s,r,i],e)||Wt([n,i,r,i],e)}function le(t,e){const[n,s]=t,[r,i,o,a]=e;return!(n<r||n>o||s<i||s>a)}function Ns(t){return typeof t[0]=="number"}function Gt(t){if(typeof t!="number")return t;if(t===0)return t.toString();const e=Math.floor(Math.log10(Math.abs(t)));return e>4?se(t).toString():e<=4&&e>0?se(t,4-e).toString():se(t,Math.abs(e)+2).toString()}function Es(t,e){if(!Ns(t))return t;const n=(e==null?void 0:e.decimalPlaces)??4,s=o=>o!=0&&Math.abs(Math.log10(o))>n,i=Tt(t).some(s)?Ls:Hs;return t.map(i)}function Ls(t){return t===0?"0":ns(t.toExponential())}function Hs(t){return t===0?"0":parseFloat(t.toPrecision(12)).toString()}function Bs(t){const e=[...t].sort(N),n=Array(t.length),s={};for(let r=0;r<t.length;r++){const i=t[r];s[i]===void 0?s[i]=0:s[i]++,n[r]=e.indexOf(i)+s[i]}return n}function I(t,e,n=0,s=e.length){const r=Array(s-n);for(let i=0;i<s-n;i++)r[e[n+i]]=t[i];return r}function Fs(t){return f(t).saturate(30).lighten(30).toHexString()}function jt(t,e){const n={};for(const s of e)s==null||s.injectQueryInfo(t,n);return n}function de(t){return{...t,...{n:Ws,values:Gs,valueAt:js,scaledAt:Ks,retrain:Is}}}function Ws(){return this.array.length}function Gs(){const t=this.n(),e=[];for(let n=0;n<t;n++)e.push(this.valueAt(n));return e}function js(t,e=0){return this.array[t+e]}function Ks(t,e){return e?e.pushforward(this.valueAt(t)):this.domain.normalize(this.valueAt(t))}function Is(t){return this.domain.retrain(t),this}function Kt(t){return{...t,proxy:Ye}}function Ye(t){return{...this,source:this,indexfn:t,n:qs,valueAt:Qs,proxy:Ye}}function qs(){return this.indexfn().length}function Qs(t,e=0){return this.source.valueAt(this.indexfn()[t],e)}function It(t){return{...t,...{setReducer:Zs,stack:Ys,normalizeByParent:Xs,shiftLeft:Vs,parent:Us}}}function Zs(t){return this.reducer=t,this}function Ys(){if(!this.reducer)return this;let e=this.reducer.stack().result;return this.indexfn&&(e=e.proxy(this.indexfn)),e}function Xs(){if(!this.reducer)return this;const t=this.reducer.normalizeByParent();let e=t.result;return this.indexfn&&(e=e.proxy(this.indexfn)),t.result}function Vs(){if(!this.reducer)return this;const t=this,e={...this};return e.valueAt=function(n){var s;return n===0?(s=e.reducer)==null?void 0:s.reducer.initialfn():t.valueAt(n,-1)},e}function Us(){const{reducer:t}=this;if(!t)return this;const{parent:e,factor:n}=t;if(!e||!n||!n.parent)return this;const r=e.clone().result.proxy(()=>n.parent.levels);return It(r)}function vt(t){return{...t,shallowClone:Js}}function Js(){return{...this}}function $(t){return{...t,observers:new Set,listen:er,emit:tr,remove:nr}}function tr(){for(const t of this.observers)t();return this}function er(t){return this.observers.add(t),this}function nr(t){return this.observers.delete(t),this}function wt(t,e){const n=t.emit;t.emit=et,e(),t.emit=n}var F=(t=>(t[t.Transient=255]="Transient",t[t.Group1=7]="Group1",t[t.Group2=6]="Group2",t[t.Group3=5]="Group3",t[t.Group4=4]="Group4",t))(F||{}),z=(t=>(t[t.Absolute=0]="Absolute",t[t.Proportion=1]="Proportion",t))(z||{}),lt=(t=>(t[t.Alphanumeric=0]="Alphanumeric",t[t.Custom=1]="Custom",t))(lt||{}),At=(t=>(t[t.Middle=.5]="Middle",t[t.Top=1]="Top",t[t.Bottom=0]="Bottom",t))(At||{}),qt=(t=>(t[t.Center=.5]="Center",t[t.Left=1]="Left",t[t.Right=0]="Right",t))(qt||{}),Qt=(t=>(t[t.Forward=0]="Forward",t[t.Backward=1]="Backward",t))(Qt||{});function sr(t){const e=k("div").addClass("ps-widget").addClass("ps-widget-range").get(),{min:n,max:s}=t,r=Qt.Forward,i=$(E({container:e,source:t,min:n,max:s,direction:r,render:rr}));return t.listen(i.render.bind(i)),i}function rr(){const{container:t,source:e}=this;Ht(t);const n=k("span").appendTo(t).get(),s=k("span").appendTo(n).get(),r=k("input").appendTo(n).get(),i=k("input").appendTo(n).get(),o=k("button").text("⇆").appendTo(n).get();s.innerText=`Range of ${this.name()}: `,r.size=6,i.size=6,r.onmousedown=c=>c.stopPropagation(),i.onmousedown=c=>c.stopPropagation(),r.value=Gt(e.min),i.value=Gt(e.max);const a=c=>{c.code==="Enter"&&(this.min=parseFloat(r.value),this.max=parseFloat(i.value),this.emit())};return r.addEventListener("keydown",a),i.addEventListener("keydown",a),o.addEventListener("mousedown",()=>{this.direction=Pe(this.direction),this.emit()}),this}var Zt=(t=>(t.Continuous="ExpanseContinuous",t.DiscreteAbsolute="ExpanseDiscreteAbsolute",t.DiscreteWeighted="ExpanseDiscreteWeighted",t))(Zt||{});function C(t){return t[Symbol.toStringTag]==="ExpanseContinuous"}function dt(t){return t[Symbol.toStringTag]==="ExpanseDiscreteAbsolute"||t[Symbol.toStringTag]==="ExpanseDiscreteWeighted"}function Xe(t){return t[Symbol.toStringTag]==="ExpanseDiscreteWeighted"}function he(t,e){return this.zero=t,e!=null&&e.default&&(this.defaultZero=t),this.emit(),this}function fe(t,e){return this.one=t,e!=null&&e.default&&(this.defaultOne=t),this.emit(),this}function me(t,e,n){return wt(this,()=>this.setZero(t,n).setOne(e,n)),this.emit(),this}function pe(){return this.setZero=et,this}function ge(){return this.setOne=et,this}function ye(){return this.freezeZero().freezeOne()}function ir(t){const e=this.expand.bind(this),n=this.move.bind(this),s=this.defaultize.bind(this);if(this.expand=(r,i)=>(e(r,i),t.expand(r,i),this),this.move=r=>(n(r),t.move(r),this),this.defaultize=r=>(s(r),t.defaultize(r),this),C(this)&&C(t)){const r=this.flip.bind(this);this.flip=()=>(r(),t.flip(),this)}return this}function Ve(t,e){const n=this.zero+t,s=this.one+t;return wt(this,()=>this.setZeroOne(n,s,e)),this.emit(),this}function be(t,e,n){const{zero:s,one:r}=this,i=r-s;let[o,a]=[t,e].map(c=>(c-s)/i);return[o,a]=Lt(o,a),wt(this,()=>this.setZeroOne(o,a,n)),this.emit(),this}function Z(t=0,e=1){const[n,s,r,i]=[t,e,1,1],[o,a,c,u]=[0,1,0,1],l=Qt.Forward,d={min:!1,max:!1,scale:!1},[h,m]=[te,te],y={...{min:t,max:e,zero:o,one:a,scale:r,defaultMin:n,defaultMax:s,defaultZero:c,defaultOne:u,defaultScale:i,direction:l,frozen:d,[Symbol.toStringTag]:Zt.Continuous},...{clone:Mr,range:or,transRange:ar,normalize:cr,unnormalize:ur,defaultize:wr,trans:h,inv:m,setMin:lr,setMax:dr,setScale:fr,setMinMax:hr,setZero:he,setOne:fe,setZeroOne:me,setTransform:mr,link:ir,freezeZero:pe,freezeOne:ge,freeze:ye,freezeMin:pr,freezeMax:gr,freezeScale:yr,flip:br,expand:be,move:xr,retrain:Ar,breaks:Sr,widget:kr}};return $(y)}function or(){return this.max-this.min}function ar(){return this.trans(this.max)-this.trans(this.min)}function cr(t){const{min:e,zero:n,one:s,scale:r,direction:i,trans:o}=this,a=this.transRange();let c=(o(t)-o(e))/a/r;return c=n+c*(s-n),i+(-2*i+1)*c}function ur(t){const{min:e,one:n,zero:s,scale:r,trans:i,inv:o}=this,a=(t-s)/(n-s);return o(i(e)+a*this.transRange())*r}function lr(t,e){return this.min=t,e!=null&&e.default&&(this.defaultMin=t),this.emit(),this}function dr(t,e){return this.max=t,e!=null&&e.default&&(this.defaultMax=t),this.emit(),this}function hr(t,e,n){return wt(this,()=>this.setMin(t,n).setMax(e,n)),this.emit(),this}function fr(t,e){return t=typeof t=="number"?t:t(this.scale),this.scale=t,e!=null&&e.default&&(this.defaultScale=t),this.emit(),this}function mr(t,e){return this.trans=t,this.inv=e,this}function pr(){return this.setMin=et,this}function gr(){return this.setMax=et,this}function yr(){return this.setScale=et,this}function br(){return this.direction=Pe(this.direction),this}function xr(t,e){const n=1-2*this.direction,s=this.zero+n*t,r=this.one+n*t;return wt(this,()=>this.setZeroOne(s,r,e)),this.emit(),this}const vr={min:!0,max:!0,scale:!0,zero:!0,one:!0};function wr(t){const e=Object.assign(vr,t);for(const[n,s]of nt(e))s&&(this[n]=this[`default${Oe(n)}`]);return this.direction=Qt.Forward,this.emit(),this}function Ar(t){const[e,n]=Tt(t),s={default:!0};return this.setMinMax(e,n,s),this}function Mr(){const{defaultMin:t,defaultMax:e,trans:n,inv:s}=this,r=Z(),i={default:!0};return r.setMin(t,i).setMax(e,i),r.setTransform(n,s),r}function Sr(){const[t,e]=[0,1].map(n=>this.unnormalize(n)).sort(N);return Jn(t,e)}function kr(){const[t,e]=[0,1].map(i=>this.unnormalize(i)),n=$({min:t,max:e}),s=sr(n),r=()=>{const[i,o]=[0,1].map(a=>this.unnormalize(a));n.min=i,n.max=o,n.emit()};return this.listen(r),s.listen(()=>{let{min:i,max:o,direction:a}=s;if(a!=this.direction){this.flip(),this.emit();return}n.min=i,n.max=o,this.zero=0,this.one=1,[i,o]=[i,o].sort(N).map(this.normalize.bind(this)),[i,o]=Lt(i,o),this.setZeroOne(i,o)}),s}function zr(t){return C(t.domain)}function Yt(t,e){!this.hasName()||!this.isQueryable()||(e[this.name()]=this.valueAt(t))}function Y(t,e){const n="Continuous";e=e??Z(...Tt(t));const i={...{array:t,domain:e,[Symbol.toStringTag]:n},...{range:Pr,min:Dr,max:_r,clone:$r,injectQueryInfo:Yt}};return ct(i).with(E).with(st).with(vt).with(de).with(Kt).with(It)}function $r(){const t=[...this.array];return Y(t)}function Dr(){return this.domain.min}function _r(){return this.domain.max}function Pr(){return this.domain.range()}function Rr(){return st(E({options:{center:!1,scale:!1},parse:Or,center:Cr,scale:Tr}))}function Or(t){const{center:e,scale:n}=this.options;if(!(e||n))return Y(t);const s=[],r={mean:0,sumSquares:0,sd:0};for(let i=0;i<t.length;i++){const{mean:o,sumSquares:a}=r,c=t[i],u=o,l=(i*o+c)/(i+1),d=a+(c-u)*(c-l);r.mean=l,r.sumSquares=d}r.sd=Math.sqrt(r.sumSquares/t.length);for(let i=0;i<t.length;i++){const o=e?r.mean:0,a=n?r.sd:1;s[i]=(t[i]-o)/a}return Y(s)}function Cr(){return this.options.center=!0,this}function Tr(){return this.options.scale=!0,this}function Nr(t){const e=k("div").addClass("ps-widget").addClass("ps-widget-draglist").get(),n=$(E({container:e,source:t,render:Er}));return n.render(),t.listen(n.render.bind(n)),n}function Er(){const{container:t,source:e}=this,n=e.values;Ht(t);const s=k("span").appendTo(t).get(),r=k("ul").appendTo(t).get();s.innerText=`Levels of ${this.name()}: `;for(const i of n){const o=k("li").setAttribute("draggable",!0).text(i).appendTo(r).get();o.addEventListener("dragstart",()=>o.classList.add("dragged")),o.addEventListener("dragend",()=>{const a=Array.from(r.childNodes);for(let c=0;c<a.length;c++)n[c]=a[c].innerText;this.emit(),o.classList.remove("dragged")})}return r.addEventListener("mousedown",i=>i.stopPropagation()),r.addEventListener("dragover",i=>Lr(r,i.clientY)),this}function Lr(t,e){const n=Array.from(t.childNodes),s=n.findIndex(o=>o.classList.contains("dragged")),r=n.splice(s,1);let i={element:n[0],distance:1/0};for(const o of n){const a=o.getBoundingClientRect(),c=e-a.top-a.height/2;Math.abs(c)<i.distance&&(i={element:o,distance:c})}i.distance>0?t.insertBefore(i.element,r[0]):t.insertBefore(r[0],i.element)}function Ue(t){const e=this.expand.bind(this),n=this.defaultize.bind(this);return this.expand=(s,r)=>(e(s,r),t.expand(s,r),this),this.defaultize=s=>(n(s),t.defaultize(s),this),this}function Je(t){for(let e=0;e<t.length;e++)this.values[e]=t[e];return this.emit(),this}function tn(){return I(this.values,this.order)}function en(){const{values:t}=this,e=$({values:[...t]}),n=Nr(e);return this.listen(()=>{e.values=I(t,this.order),e.emit()}),n.listen(()=>{const s=Array(t.length);for(let r=0;r<t.length;r++)s[r]=e.values.indexOf(t[r]);this.setOrder(s)}),n}function xe(t){const e=at(0,t.length-1),n=Nt(1,t.length),[s,r,i,o]=[0,1,0,1],a=ie(n),l={...{order:e,values:t,weights:n,zero:s,one:r,defaultZero:i,defaultOne:o,cumWeights:a,[Symbol.toStringTag]:Zt.DiscreteWeighted},...{clone:Zr,normalize:Hr,unnormalize:Br,defaultize:Fr,width:Wr,setZero:he,setOne:fe,setZeroOne:me,setValues:Je,setWeights:jr,setOrder:Kr,freezeZero:pe,freezeOne:ge,freeze:ye,link:Ue,expand:be,move:Ve,setDefaultWeights:Ir,setDefaultOrder:qr,getWidthExpanse:Gr,retrain:Qr,breaks:tn,widget:en}};return $(l)}function Hr(t){const{zero:e,one:n}=this,[s,r,i]=nn(this,t),a=(s+(r-s)/2)/i;return e+a*(n-e)}function Br(t){throw new Error("Not implemented yet")}function Fr(t){const e=Object.assign({zero:!0,one:!0,order:!0,weights:!0},t);if(e.zero&&(this.zero=this.defaultZero),e.one&&(this.one=this.defaultOne),e.weights&&this.weights.fill(1),e.order)for(let n=0;n<this.order.length;n++)this.order[n]=n;return(e.weights||e.order)&&Mt(this),this.emit(),this}function Wr(t){const{zero:e,one:n}=this,[s,r,i]=nn(this,t);return(r-s)/i*(n-e)}function Gr(){const t={...this};return t.normalize=this.width,t.clone=et.bind(t),t}function jr(t){for(let e=0;e<t.length;e++)this.weights[e]=t[e];return Mt(this),this.emit(),this}function Kr(t){for(let e=0;e<t.length;e++)this.order[e]=t[e];return Mt(this),this.emit(),this}function Ir(){return this.weights.fill(1),Mt(this),this.emit(),this}function qr(){for(let t=0;t<this.order.length;t++)this.order[t]=t;return Mt(this),this.emit(),this}function Qr(t){const e=Array.from(new Set(t)).sort(ee),n=Nt(1,e.length),s=ie(n);return this.values=e,this.weights=n,this.cumWeights=s,this.emit(),this}function Zr(){const t=xe(this.values);return t.order=this.order,t.weights=this.weights,t.cumWeights=this.cumWeights,t.normalize=this.normalize,t}function nn(t,e){const{order:n,values:s,cumWeights:r}=t,i=n[s.indexOf(e)];return[r[i-1]??0,r[i],gt(r)]}function Mt(t){const e=ie(I(t.weights,t.order));for(let n=0;n<e.length;n++)t.cumWeights[n]=e[n]}function St(t,e){const n=Array.from(new Set(t)).sort(ee),s="Discrete";e=e??xe(n);const o={...{array:t,domain:e,[Symbol.toStringTag]:s},...{width:Xr,clone:Yr,injectQueryInfo:Yt}};return ct(o).with(E).with(st).with(vt).with(de).with(Kt).with(It)}function Yr(){const t=[...this.array],e=St(t);return e.domain=this.domain.clone(),e}function Xr(){const t=this.clone();return t.domain=this.domain.getWidthExpanse(),t}function Vr(){return st(E({options:{case:0,capitalize:!1,stripWS:!1},parse:Ur,toLowerCase:Jr,toUpperCase:ti,capitalize:ei,stripWhitespace:ni}))}function Ur(t){const{case:e,capitalize:n,stripWS:s}=this.options;if(e===0&&!(n||s))return St(t.map(String));const r=Array(t.length);let i=te;e===1&&(i=Rt(i,Kn)),e===2&&(i=Rt(i,In)),s&&(i=Rt(i,qn)),n&&(i=Rt(i,Oe));for(let o=0;o<t.length;o++)r[o]=i(String(t[o]));return St(r)}function Jr(){return this.options.case=1,this}function ti(){return this.options.case=2,this}function ei(){return this.options.capitalize=!0,this}function ni(){return this.options.stripWS=!0,this}function si(t){return t==="continuous"?Rr():Vr()}function P(t){const e="Dataframe",r={...{[Symbol.toStringTag]:e,columns:t},...{n:ri,keys:ii,col:oi,cols:ai,colsArray:ci,row:ui,rows:li,select:hi,join:fi,proxy:mi}};return $(r)}function ri(){for(const t of j(this.columns))if(t.n()!=-1)return t.n();throw new Error("No fixed-length variables present in the data")}function ii(){return Object.keys(this.columns)}function oi(t){return this.columns[t]}function ai(){return this.columns}function ci(){return Vn(this.columns)}function ui(t,e){e=e??{};for(const[n,s]of B(this.columns))e[n]=s.valueAt(t);return e}function li(){const t=this.n(),e=Array(t);for(let n=0;n<t;n++)e[n]=this.row(n);return e}const di={keepSymbols:!0,keepQueryables:!0};function hi(t,e){const{columns:n}=this,s=Un(t(n)),r=Object.assign(di,e);for(const[o,a]of B(n))(r.keepSymbols&&typeof o=="symbol"||r.keepQueryables&&a.isQueryable())&&(s[o]=a);const i=P(s);return this.listen(()=>i.emit()),i}function fi(t){const e={...this.columns,...t.columns},n=P(e);return this.listen(()=>n.emit()),t.listen(()=>n.emit()),n}function mi(t){const e={...this.columns},n=P(e);n.cachedN=()=>t.length;for(const[s,r]of B(n.columns))n.columns[s]=r.proxy(()=>t);return n}function pi(t,e,n){const s={},r=P(s),{maxRows:i,sample:o}=n??{},a=Object.values(t)[0].length,c=Ne(0,a-1,o??1);let u=0;for(const[l,d]of Object.entries(e)){l in t||Jt(`Property ${l} missing from raw data`),Array.isArray(t[l])||Jt(`Property "${l}" is not an array.`);let h=t[l];u===0&&(u=h.length),h.length!=u&&Jt(`Array "${l}" has different length from previously seen columns`),o&&(h=re(h,c)),i&&h.length>i&&(h.length=i),d.hasName()||d.setName(l);const m=d.parse(h);m.setName(d.name()),m.setQueryable(d.isQueryable()),s[l]=m}return r}function gi(t,e,n){if(!t.length)throw new Error("Data should be an array of objects");const s={},r=t.length;let{maxRows:i,sample:o}=n??{};const a=o?Ne(0,r,Math.min(o,r)):at(0,r);i=i??r;for(const u of oe(e))s[u]=[];for(let u=0;u<a.length&&u<i;u++){const l=t[a[u]];for(const d of oe(e)){const h=l[d];if(h===void 0)throw new Error(`Cannot parse row with missing data: ${l}`);s[d].push(h)}}for(const u of oe(e))s[u]=e[u].parse(s[u]);return P(s)}const ht={name:"sum",initialfn:Le,reducefn:Ce},yi={...ht,name:"count"},bi={name:"max",initialfn:ae(-1/0),reducefn:Math.max},xi={name:"paste",initialfn:ae(""),reducefn:(t,e)=>t+e.toString()};function sn(t){return{scale:t,render:vi}}function vi(t){const{scale:e}=this,n=e.aes,s=t[`${n}Axis`],r=e.breaks(),i=Es(r),[o,a,c,u]=ut(),l=e.other.codomain.min-s.fontsize/2;if(s.clear(),n==="x"){let d=0,h=0;for(let m=0;m<i.length;m++){const p=i[m],v=e.pushforward(r[m]),y=s.textWidth(p)+1;v<a||v>s.width-u||wi(d,v,h,y)||([d,h]=[v,y],s.text(v,l,p))}}else if(n==="y"){let d=0;for(let h=0;h<i.length;h++){const m=i[h],p=e.pushforward(r[h]),v=s.textHeight(m)+5;p<o||p>s.height-c||p-v<d||(d=p,s.text(l,p,m))}}}function wi(t,e,n,s){const[r,i]=[t-n/2,t+n/2],[o,a]=[e-s/2,e+s/2];return r<a&&i>=o}function rn(t){return{scale:t,render:Ai}}function Ai(t){const e=this.scale.aes;if(!e)return;const n=t.base,s=this.scale.name(),r=ut(),i=e==="x"?r[0]:r[1],o=this.scale.codomain.unnormalize(.5),a=this.scale.other.codomain.unnormalize(0)-i*2/3;e==="x"&&n.text(o,a,s),e==="y"&&n.text(a,o,s,{vertical:!0})}function rt(t,e){const n="Scale";return t=t??Z(),e=e??Z(),$(E({...{[Symbol.toStringTag]:n,domain:t,codomain:e},...{clone:Mi,pushforward:zi,pullback:$i,setAes:Si,setDomain:Di,setCodomain:_i,setOther:ki,setMin:Pi,setMax:Ri,setMinMax:Oi,setZeroOne:Ci,setTransform:Ti,setOrder:Ei,setWeights:Hi,setDefaultOrder:Li,setDefaultWeights:Bi,getOrder:Ni,move:Fi,expand:Wi,freezeZero:Ki,freezeOne:Ii,flip:qi,link:Gi,breaks:ji,ratio:Qi,widget:Zi}}))}function Mi(){return rt(this.domain.clone(),this.codomain.clone())}function Si(t){return this.aes=t,this}function ki(t){return this.other=t,this}function zi(t){const{domain:e,codomain:n}=this;return n.unnormalize(e.normalize(t))}function $i(t){const{domain:e,codomain:n}=this;return e.unnormalize(n.normalize(t))}function Di(t){return this.domain=t,t.listen(()=>this.emit()),this}function _i(t){return this.codomain=t,this}function Pi(t,e){return C(this.domain)?(this.domain.setMin(t,e),this):this}function Ri(t,e){return C(this.domain)?(this.domain.setMax(t,e),this):this}function Oi(t,e,n){return C(this.domain)?(this.domain.setMinMax(t,e,n),this):this}function Ci(t,e,n){return this.domain.setZeroOne(t,e,n),this}function Ti(t,e){return C(this.domain)?(this.domain.setTransform(t,e),this):this}function Ni(){return dt(this.domain)?this.domain.order:[]}function Ei(t){return dt(this.domain)?(this.domain.setOrder(t),this):this}function Li(){return dt(this.domain)?(this.domain.setDefaultOrder(),this):this}function Hi(t){return Xe(this.domain)?(this.domain.setWeights(t),this):this}function Bi(){return Xe(this.domain)?(this.domain.setDefaultWeights(),this):this}function Fi(t){return this.domain.move(t),this}function Wi(t,e,n){return this.domain.expand(t,e,n),this}function Gi(t){return this.domain.link(t.domain),this}function ji(){return this.domain.breaks()}function Ki(){return C(this.domain)?(this.domain.freezeZero(),this):this}function Ii(){return C(this.domain)?(this.domain.freezeOne(),this):this}function qi(){return C(this.domain)?(this.domain.flip(),this):this}function Qi(){if(!ve(this))return-1;const{domain:t,codomain:e}=this;return t.range()/e.range()}function Zi(){const t=this.domain.widget();if(t)return t.setName(this.name()),t}function ve(t){return C(t.domain)}function ft(t){const e=k("canvas").appendTo(t),n=e.get(),s=n.getContext("2d"),r={node:n,container:t,canvas:n,canvasWrapper:e,context:s,contextProps:{}},i={clipped:!1,margins:[0,0,0,0],fontsize:O.axisLabelFontsize,width:0,height:0,scalingFactor:2},a=$({...r,...i,...{resize:Yi,clip:Xi,setMargins:Vi,addClass:eo,getProp:no,setAttribute:Ui,setStyles:Ji,setProps:so,setBackgroundColor:to,textWidth:lo,textHeight:ho,clear:ro,point:io,rectangleXY:oo,rectangleWH:ao,line:co,text:uo}});return a.resize(),window.addEventListener("resize",()=>a.resize()),a}function Yi(){const{context:t,canvas:e,contextProps:n,scalingFactor:s,clipped:r}=this,{clientWidth:i,clientHeight:o,clientLeft:a,clientTop:c}=e,u=i-a,l=o-c;this.width=u,this.height=l,this.canvas.width=u*s,this.canvas.height=l*s;for(const[d,h]of nt(n))t[d]=h;return t.scale(s,s),r&&this.clip(),this.emit(),this}function Xi(){let{context:t,width:e,height:n}=this;const[s,r,i,o]=this.margins;return e=e-r-o,n=n-i-s,t.beginPath(),t.rect(r,i,e,n),t.clip(),this}function Vi(t){return this.margins=t,this.clipped=!0,this}function Ui(t,e){return this.canvasWrapper.setAttribute(t,e),this}function Ji(t){return this.canvasWrapper.setStyles(t),this}function to(t){return this.setStyles({backgroundColor:t}),this}function eo(t){return this.canvasWrapper.addClass(t),this}function no(t){return this.context[t]}function so(t){for(const[e,n]of nt(t))this.contextProps[e]=n,this.context[e]=n;return this}function ro(){return this.context.clearRect(0,0,this.width,this.height),this}function io(t,e,n){const{height:s}=this,r=(n==null?void 0:n.radius)??O.defaultRadius,i=(n==null?void 0:n.hAnchor)??qt.Center,o=(n==null?void 0:n.vAnchor)??At.Middle;return t=t+2*(i-.5)*r,e=s-e+2*(.5-o)*r,this.context.beginPath(),this.context.arc(t,e,r,0,Math.PI*2),this.context.fill(),this}function oo(t,e,n,s){const{context:r,height:i}=this;return r.fillRect(t,i-e,n-t,e-s),this}function ao(t,e,n,s,r){const{height:i}=this,o=(r==null?void 0:r.hAnchor)??qt.Center,a=(r==null?void 0:r.vAnchor)??At.Middle;return t=t-o*n,e=i-e+a*s,this.context.fillRect(t,e,n,-s),this}function co(t,e){const{context:n,height:s}=this;n.beginPath(),n.moveTo(t[0],s-e[0]);for(let r=1;r<t.length;r++)n.lineTo(t[r],s-e[r]);return n.stroke(),this}function uo(t,e,n,s){const{context:r,height:i}=this;return r.save(),r.translate(t,i-e),s!=null&&s.vertical&&r.rotate(-Math.PI/2),r.fillText(n,0,0),r.translate(-t,-(i-e)),r.restore(),this}function lo(t){return this.context.measureText(t).width}function ho(t){const e=this.context.measureText(t);return e.actualBoundingBoxAscent+e.actualBoundingBoxDescent}function fo(t){const e=k("div").appendTo(t).addClass("ps-query-display").get();return{parentContainer:t,container:e,clear:mo,renderQuery:po}}function mo(){this.container.style.display="none"}function po(t,e){if(!e)return;let n="";for(const[d,h]of Object.entries(e))n+=`${d}: ${Gt(h)}<br>`;const{container:s,parentContainer:r}=this,{clientWidth:i,clientHeight:o}=r;s.innerHTML=n,s.style.display="inline-block";const a=getComputedStyle(s),c=parseFloat(a.width.slice(0,-2)),[u,l]=t;u+c>i?(s.style.left="auto",s.style.right=`${i-u+5}px`):(s.style.left=`${u+5}px`,s.style.right="auto"),s.style.top=`${o-l}px`}function go(){return $({coords:[0,0,0,0],setCoords:yo,clear:bo,render:xo})}function yo(t){this.coords=t,this.emit()}function bo(){this.setCoords([0,0,0,0])}function xo(t){const[e,n,s,r]=this.coords;t.user.clear(),t.user.rectangleXY(e,n,s,r)}function vo(t){const e=k("dialog").addClass("ps-widget-modal").appendTo(t).get(),n=k("div").addClass("ps-widget-display").appendTo(e).get(),s=0,r=!1,[i,o]=[0,0],u={...{mode:s,initialized:r,container:n,modal:e,lastX:i,lastY:o},...{show:Mo,addWidget:ko,clear:So,isInitialized:wo,setInitialized:Ao}};return n.addEventListener("mousedown",zo.bind(u)),n.addEventListener("mouseup",$o.bind(u)),n.addEventListener("mousemove",Do.bind(u)),e.addEventListener("mousedown",()=>{u.mode=0,e.close()}),u}function wo(){return this.initialized}function Ao(t){return this.initialized=t,this}function Mo(){return this.container.childNodes.length?(this.modal.showModal(),this):this}function So(){const{container:t}=this;return Ht(t),this}function ko(t){return t&&(t.render(),this.container.appendChild(t.container)),this}function zo(t){return t.stopPropagation(),t.button!=0?this:(this.lastX=t.clientX,this.lastY=t.clientY,this.mode=1,this)}function $o(t){return t.stopPropagation(),this.mode=0,this}function Do(t){if(this.mode!=1)return this;const{modal:e}=this,n=t.clientX-this.lastX,s=t.clientY-this.lastY,{left:r,top:i}=getComputedStyle(e);e.style.left=`${parseFloat(r.slice(0,-2))+n}px`,e.style.top=`${parseFloat(i.slice(0,-2))+s}px`,this.lastX=t.clientX,this.lastY=t.clientY}function _o(){const{defaultNormX:t,defaultNormY:e}=O;return{...{coords:[[t,e,1-t,1-e]]},...{push:Po,pop:Co,clear:Ro,isEmpty:Oo,current:To,currentStretch:No}}}function Po(t){return this.coords.push(t),this}function Ro(){return this.coords.length=1,this}function Oo(){return this.coords.length===1}function Co(){return this.coords.length>1&&this.coords.pop(),gt(this.coords)}function To(){return gt(this.coords)}function No(){if(this.coords.length===1)return[1,1,1];const[t,e,n,s]=gt(this.coords),r=n-t,i=s-e,o=Math.max(r,i);return[r,i,o]}const mt=[0,1,2,3,4,5,6,7],we=[4,5,6,7];function X(t){const e=k("div").addClass("ps-plot-container").get(),n={},{groupColors:s,axisTitleFontsize:r,axisLabelFontsize:i}=O,o=s.slice(),a=o.length;for(let T=0;T<a;T++)o.push(Fs(o[T]));const c=ut();for(const T of mt)n[T]=ft(e).setAttribute("id",`data-layer${T}`).addClass("ps-plot-context").setStyles({zIndex:`${7-T+1}`}).setProps({fillStyle:o[T],strokeStyle:o[T],font:`${i}px sans`}).setMargins(c);n.base=ft(e).addClass("ps-plot-context").addClass("base").setStyles({backgroundColor:"whitesmoke"}).setProps({textAlign:"center",textBaseline:"middle",font:`${r}px sans`}),n.under=ft(e).addClass("ps-plot-context").addClass("inner"),n.user=ft(e).addClass("ps-plot-context").addClass("user").setStyles({zIndex:"10"}).setProps({fillStyle:"#99999933",strokeStyle:"#00000000"}).setMargins(c),n.xAxis=ft(e).addClass("ps-plot-context").setProps({textBaseline:"top",textAlign:"center",font:`${i}px serif`,fillStyle:"#3B4854"}),n.yAxis=ft(e).addClass("ps-plot-context").setProps({textBaseline:"middle",textAlign:"right",font:`${i}px serif`,fillStyle:"#3B4854"});const u={x:rt(),y:rt(),size:rt(),width:rt(),height:rt(),area:rt()},{defaultNormX:l,defaultNormY:d}=O,h={default:!0};u.x.setOther(u.y).setAes("x"),u.y.setOther(u.x).setAes("y"),u.size.codomain.setMin(1,h).setMax(10,h).defaultize(),u.width.setMax(1-2*l,h),u.height.setMax(1-2*d,h),u.width.freezeZero(),u.height.freezeZero();const m=[],p=!1,v=!1,y=0,b=0,M=0,x=0,G="",D=void 0,U=go(),ot=_o(),w=fo(e),J=vo(t.container),g={pars:{active:p,mousedown:v,mousebutton:y,mode:b,lastX:M,lastY:x,lastKey:G,aspectRatio:D},...{scene:t,container:e,contexts:n,scales:u,graphicObjects:m,selectionRect:U,zoomStack:ot,queryDisplay:w,widgetDisplay:J,widgetSources:[],localKeyActions:{},globalKeyActions:{}},...{activate:Eo,deactivate:Lo,render:Bo,resize:Ae,reset:Fo,setAlpha:Ko,scaleAlpha:Io,setAspectRatio:qo,trainScales:Ho,addGraphicObject:Wo,addWidgetSource:Go,addKeyAction:jo}};window.addEventListener("resize",Et(Ae.bind(g),10)),window.addEventListener("keydown",ia.bind(g)),window.addEventListener("keyup",oa.bind(g)),e.addEventListener("mousedown",Vo.bind(g)),e.addEventListener("mouseup",Uo.bind(g)),e.addEventListener("mousemove",Et(Jo.bind(g),20)),e.addEventListener("dblclick",ra.bind(g)),e.addEventListener("contextmenu",sa.bind(g)),new ResizeObserver(Et(Ae.bind(g),10)).observe(e),g.addKeyAction("BracketRight",()=>g.scaleAlpha(1.1111111111111112)),g.addKeyAction("BracketLeft",()=>g.scaleAlpha(.9)),g.addKeyAction("KeyR",()=>(g.reset(),g.render())),g.addKeyAction("KeyP",Qo.bind(g)),g.addKeyAction("KeyZ",Yo.bind(g)),g.addKeyAction("KeyX",Xo.bind(g)),g.addKeyAction("KeyS",()=>{e.style.resize="both",e.style.overflow="hidden"}),g.addKeyAction("KeyQ",()=>{for(const T of t.plots)T.pars.mode=2}),U.listen(Et(Zo.bind(g),20)),g.addGraphicObject(sn(u.x)),g.addGraphicObject(sn(u.y)),g.addGraphicObject(rn(u.x)),g.addGraphicObject(rn(u.y)),g.addGraphicObject(U),t.addPlot(g),g.addWidgetSource(g.scales.x),g.addWidgetSource(g.scales.y);for(const T of j(g.scales))T.listen(()=>g.render());return g}function Ae(){const{contexts:t,scales:e,container:n}=this;for(const d of Object.values(t))d.resize();const{clientWidth:s,clientHeight:r}=n,[i,o,a,c]=ut(),u=s-o-c,l=r-a-i;return e.x.codomain.setMin(o).setMax(Math.max(o,s-c)),e.y.codomain.setMin(i).setMax(Math.max(i,r-a)),e.width.codomain.setMax(u),e.height.codomain.setMax(l),e.area.codomain.setMax(Math.min(u,l)),this.scene.marker.clearTransient(),this.selectionRect.clear(),this.render(),this}function Eo(){return this.pars.active=!0,this.container.classList.add("active"),this}function Lo(){return this.pars.active=!1,this.container.classList.remove("active"),this.selectionRect.clear(),this}function Ho(t,e){const n=e(t.columns),{scales:s,widgetDisplay:r}=this,{defaultNormX:i,defaultNormY:o}=O;r.setInitialized(!1);const a={default:!0};for(const[c,u]of nt(n)){const l=s[c];l&&(u.domain&&l.setDomain(u.domain.clone()),u.hasName()&&l.setName(u.name()))}for(const c of["height","width","area"])s[c].setMin(0);return s.x.setZeroOne(i,1-i,a),s.y.setZeroOne(o,1-o,a),s.width.setZeroOne(0,1-2*i).freezeZero(),s.height.setZeroOne(0,1-2*o).freezeZero(),this}function Bo(){for(const t of Object.values(this.contexts))t.clear();for(const t of this.graphicObjects)t.render&&t.render(this.contexts);return this}function Fo(){const{container:t,scales:e,contexts:n,selectionRect:s,zoomStack:r}=this,{clientWidth:i,clientHeight:o}=t,[a,c,u,l]=ut(),d=i-c-l,h=o-u-a;for(const p of j(e))p.domain.defaultize();const m={default:!0};e.width.codomain.setMax(d,m).defaultize(),e.height.codomain.setMax(h,m).defaultize(),e.area.codomain.setMax(Math.min(d,h),m).defaultize(),s.clear(),r.clear();for(const p of j(n))p.setProps({globalAlpha:1});return this.render(),this}function Wo(t){if(this.graphicObjects.push(t),t.keyActions)for(const[e,n]of nt(t.keyActions))this.addKeyAction(e,n);return this.render(),this}function Go(t){return this.widgetSources.push(t),this}function jo(t,e){const{localKeyActions:n}=this;return n[t]?n[t]=Fn(n[t],e):n[t]=e,this}function Ko(t){const{contexts:e}=this;for(const n of we)e[n].setProps({globalAlpha:t});return this.render(),this}function Io(t){const{contexts:e}=this;for(const n of we){const s=e[n],r=s.getProp("globalAlpha");s.setProps({globalAlpha:ne(r*t)})}return this.render(),this}function qo(t){const{x:e,y:n}=this.scales;return!ve(e)||!ve(n)?this:(this.pars.aspectRatio=t,this.resize(),this)}function Qo(t){t.preventDefault();const{widgetDisplay:e,widgetSources:n}=this;if(e.isInitialized())e.show();else{e.clear();for(const s of n){const r=s.widget();r&&e.addWidget(r.render())}e.setInitialized(!0).show()}return this}function Zo(){const{scene:t,graphicObjects:e,selectionRect:n}=this,{coords:s}=n,r=new Set;if(s.every(i=>i===0)){t.marker.update(r);return}for(const i of e)i.check&&yt(r,i.check(s));return this.scene.marker.update(r),this}function Yo(){const{scales:t,selectionRect:e,zoomStack:n}=this;let[s,r,i,o]=e.coords;if(Math.abs(i-s)<10||Math.abs(o-r)<10)return;const{x:a,y:c}=t;[s,i]=[s,i].map(d=>ne(a.codomain.normalize(d))).sort(N),[r,o]=[r,o].map(d=>ne(c.codomain.normalize(d))).sort(N);const u=bt(s,i),l=bt(r,o);return t.x.expand(s,i),t.y.expand(r,o),t.width!=t.area&&t.width.codomain.setScale(d=>d*u),t.height!=t.area&&t.height.codomain.setScale(d=>d*l),t.area.codomain.setScale(d=>{const h=Math.sqrt(Math.max(u,l));return d*h}),n.push([s,r,i,o]),e.clear(),this.render(),this}function Xo(){const{zoomStack:t,scales:e,selectionRect:n}=this;if(t.isEmpty())return;const[s,r,i,o]=t.current(),[a,c]=Lt(s,i),[u,l]=Lt(r,o),d=bt(a,c),h=bt(u,l);return e.x.expand(a,c),e.y.expand(u,l),e.width!=e.area&&e.width.codomain.setScale(m=>m*d),e.height!=e.area&&e.height.codomain.setScale(m=>m*h),e.area.codomain.setScale(m=>{const p=Math.sqrt(Math.max(1/d,1/h));return m/p}),t.pop(),n.clear(),this.render(),this}function Vo(t){const{scene:e,container:n,selectionRect:s}=this;if(e.deactivateAllExcept(this),this.activate(),this.pars.mousedown=!0,this.pars.mousebutton=t.button,t.button===0&&(this.pars.mode=0),t.button===2&&(this.pars.mode=1),this.pars.mode===0){const{clientHeight:r}=n,i=t.offsetX,o=r-t.offsetY;s.setCoords([i,o,i,o])}}function Uo(){this.pars.mousedown=!1}function Jo(t){switch(this.pars.mode){case 0:ta(this,t);break;case 1:ea(this,t);break;case 2:na(this,t)}}function ta(t,e){if(!t.pars.active||!t.pars.mousedown)return t;const{container:n,selectionRect:s}=t,{clientHeight:r}=n,i=e.offsetX,o=r-e.offsetY,{coords:a}=s;return s.setCoords([a[0],a[1],i,o]),t}function ea(t,e){if(!t.pars.active||!t.pars.mousedown)return t;const{scales:n}=t,{lastX:s,lastY:r}=t.pars,{clientWidth:i,clientHeight:o}=t.container,a=e.offsetX,c=o-e.offsetY,u=(a-s)/i,l=(c-r)/o;return n.x.move(u),n.y.move(l),t.pars.lastX=a,t.pars.lastY=c,t}function na(t,e){var c;const{offsetX:n,offsetY:s}=e,{clientHeight:r}=t.container,i=n,o=r-s;let a;for(const u of t.graphicObjects)if(a=(c=u.query)==null?void 0:c.call(u,[i,o]),a)break;return a?t.queryDisplay.renderQuery([i,o],a):t.queryDisplay.clear(),t}function sa(t){t.preventDefault(),this.selectionRect.clear(),this.pars.mousebutton=2,this.pars.lastX=t.offsetX,this.pars.lastY=this.container.clientHeight-t.offsetY}function ra(){this.deactivate(),this.scene.marker.clearAll()}function ia(t){var e,n,s,r;t.code==="KeyQ"&&t.code===this.pars.lastKey||(this.queryDisplay.clear(),(n=(e=this.globalKeyActions)[t.code])==null||n.call(e,t),this.pars.active&&((r=(s=this.localKeyActions)[t.code])==null||r.call(s,t)),this.pars.lastKey=t.code)}function oa(){this.container.style.resize="none",this.container.style.overflow="visible",this.pars.mode=0,this.pars.lastKey="",this.queryDisplay.clear()}var kt=(t=>(t[t.Pct=0]="Pct",t[t.Px=1]="Px",t))(kt||{}),on=(t=>(t[t.Width=0]="Width",t[t.Both=1]="Both",t[t.Height=2]="Height",t))(on||{});function aa(){const[s,r]=[.8,1];return $({...{type:0,dimension:1,amount:.8,defaultGapPct:s,defaultGapPx:r},...{setGapType:ca,setGapDimension:ua,setDefaultGap:la,defaultize:da,decreaseGap:fa,increaseGap:ha,applyGap:ma}})}function ca(t){const{defaultGapPct:e,defaultGapPx:n}=this;return this.amount=t===0?e:n,this.type=t,this.emit(),this}function ua(t){return this.dimension=t,this.emit(),this}function la(t,e){const{type:n}=this;return this.amount=n===0?t:e,this.defaultGapPct=t,this.defaultGapPx=e,this}function da(){const{type:t,defaultGapPct:e,defaultGapPx:n}=this;return this.amount=t===0?e:n,this.emit(),this}function ha(){return this.type===0?this.amount=this.amount*9/10:this.amount++,this.emit(),this}function fa(){return this.type===0?this.amount=this.amount*10/9:this.amount=Math.max(this.amount-1,0),this.emit(),this}function ma(t,e){const{type:n,dimension:s,amount:r}=this,i=n===0?Zn:N;return s<=1&&(t=Math.max(i(t,r),1)),s>=1&&(e=Math.max(i(e,r),1)),[t,e]}const W=Symbol("positions"),pa=Symbol("parent"),zt=Symbol("layer");function $t(t,e){const n="Derived",s=Z(),o={...{[Symbol.toStringTag]:n,variable:e,domain:s},...{clone:ga,n:ya,derivefn:t,valueAt:xa,scaledAt:va,setDomain:ba,injectQueryInfo:Yt}};return ct(o).with(E).with(st).with(vt).with(Kt)}function ga(){return this}function ya(){return-1}function ba(t){return this.domain=t,this}function xa(t){return this.derivefn(t,this.variable)}function va(t,e){return e.pushforward(this.valueAt(t))}const V=$t(()=>0),q=$t(()=>1);$t(t=>t);const wa=$t(t=>new Set([t])),an=P({[W]:wa});function Q(t){const e="Reference",n=Z(),i={...{array:t,domain:n,[Symbol.toStringTag]:e},...{clone:Aa,injectQueryInfo:Yt}};return ct(i).with(E).with(st).with(vt).with(de).with(Kt)}function Aa(){const t=[...this.array];return Q(t)}function Ma(){const e=[0],n=Le,s=P({});return $({cardinality:1,levels:e,data:s,levelAt:n})}function Dt(t,e,n,s){return s=s??Ma(),$({parent:s,cardinality:t,levels:e,data:n,levelAt:Sa})}function Sa(t){return this.levels[t]}function Me(t,e){const n=t.values();e=e??t.domain.values;const s=[],r={};for(let u=0;u<n.length;u++){const l=e.indexOf(n[u].toString());r[l]||(r[l]=new Set),r[l].add(u),s.push(l)}const i=xe(e),o={label:St(e,i),[W]:Q(Object.values(r))};o.label.setName(t.name());const a=P(o);return Dt(e.length,s,a)}function Se(t,e){const n=cn(t,e),s=()=>{const r=cn(t,e);n.parent=r.parent,n.cardinality=r.cardinality,n.levels=r.levels;const i=n.data.cols(),o=r.data.cols();for(const[a,c]of B(o))i[a].domain=c.domain,i[a].array=c.array,i[a].source=c.source,i[a].indexfn=c.indexfn;n.emit()};return t.listen(s),e.listen(s),n}function cn(t,e){const n=Math.max(t.cardinality,e.cardinality)+1,s=[],r=new Set,i={},o={},a={};for(let b=0;b<t.levels.length;b++){const M=n*t.levelAt(b)+e.levelAt(b);M in i||(i[M]=t.levelAt(b),o[M]=e.levelAt(b),a[M]=new Set),s.push(M),r.add(M),a[M].add(b)}const c=Array.from(r).sort(N),u=s;for(let b=0;b<u.length;b++)u[b]=c.indexOf(u[b]);const l=Object.values(i),d=Object.values(o),h={};for(const[b,M]of B(t.data.cols()))h[b]=M.proxy(()=>l),h[b].setName(M.name());for(let[b,M]of B(e.data.cols())){if(typeof b=="string")for(;b in h;)b+="$";h[b]=M.proxy(()=>d),h[b].setName(M.name())}h[W]=Q(Object.values(a)),h[pa]=Q(Object.values(i));const m=Dt(t.cardinality,l,P({})),p=r.size,v=P(h);return Dt(p,u,v,m)}function ka(t,e){const n={};for(const[a,c]of B(e))n[a]=c.clone().setFactor(t);const s={};for(const[a,c]of B(t.data.cols()))s[a]=c;for(const[a,c]of B(n))c.setFactor(t),s[a]=c.result;const r=P(s),o=$({...r,...{factor:t,reducers:n,recompute:za}});return o.recompute(),t.listen(o.recompute.bind(o)),o}function za(){const{reducers:t}=this;for(const e of j(t))e.recompute();this.cachedN=void 0,this.emit()}function _t(t,e){return{reducers:t,factor:e,refine:$a,data:Da}}function $a(t){const{factor:e,reducers:n}=this,s=e?Se(e,t):t,r=_t(n,s);if(r._data=ka(s,n),this._data)for(const[i,o]of nt(this._data.reducers))r._data.reducers[i].setParent(o);return r}function Da(){const{_data:t}=this;if(!t)throw new Error("No factor to reduce data by");return t}function Pt(t,e){var l;const n=La(e.initialfn());let s;(l=t.hasName)!=null&&l.call(t)?s=`${e.name} of ${t.name()}`:s="count";const r=It(n([]));r.setName(s);const[i,o]=[!1,!1],u=$({...{name:s,reducer:e,source:t,result:r,stacked:i,normalized:o},...{clone:Ra,setParent:Pa,setFactor:_a,recompute:Oa,stack:Ca,normalizeByParent:Ta}});return u.result.setReducer(u),u}function _a(t){return this.factor=t,this}function Pa(t){return this.parent=t,this}function Ra(){const{source:t,reducer:e,factor:n,parent:s}=this,r=Pt(t,e);return r.result.array=[...this.result.array],r.stacked=this.stacked,r.normalized=this.normalized,s&&r.setParent(s),n&&r.setFactor(n),this.listen(()=>r.recompute()),r}function Oa(){const{factor:t,source:e,result:n,reducer:s,stacked:r,normalized:i}=this;if(t===void 0)throw new Error("Factor has not been registered");const{cardinality:o}=t,a=n.array;a.length=o;for(let c=0;c<o;c++)a[c]=s.initialfn();for(let c=0;c<t.levels.length;c++){const u=t.levelAt(c);a[u]=s.reducefn(a[u],e.valueAt(c))}return r&&Na(this),i&&Ea(this),n.domain.retrain(a),this.emit(),this}function Ca(){const{factor:t}=this;if(!t||!t.parent)return this;const e=this.clone();return e.stacked=!0,e.recompute(),e}function Ta(){const{parent:t,factor:e}=this;if(!t||!e||!e.parent)return this;const n=this.clone();return n.normalized=!0,n.recompute(),n}function Na(t){const{factor:e,reducer:n}=t;if(!e||!e.parent)return t;const s=e.parent,r=Array(s.cardinality);for(let o=0;o<s.cardinality;o++)r[o]=n.initialfn();const i=t.result.array;for(let o=0;o<i.length;o++){const a=s.levelAt(o);r[a]=n.reducefn(r[a],i[o]),i[o]=r[a]}}function Ea(t){const{parent:e,factor:n}=t;if(!e||!n||!n.parent)return t;const s=n.parent,r=t.result.array,i=e.result.array;for(let o=0;o<s.levels.length;o++){const a=r[o],c=i[s.levelAt(o)];r[o]=a/c}}function La(t){const e=typeof t;return e==="number"?Y:e==="string"?St:Q}function Xt(t){this.boundaryData=t}function Vt(t){this.renderData=t}function Ut(t,e){this.scales[t]=this.scales[e]}function un(t){const{scales:e,contexts:n}=t,[s,r]=[qt.Center,At.Middle],i=aa(),o={};o.Equal=()=>i.decreaseGap(),o.Minus=()=>i.increaseGap(),o.KeyR=()=>i.defaultize();const u={...{scales:e,contexts:n,keyActions:o,hAnchor:s,vAnchor:r,gapHandler:i},...{setBoundaryData:Xt,setRenderData:Vt,render:Ha,check:Ba,query:Fa,setHAnchor:Wa,setVAnchor:Ga,setGapType:ja,setGapDimension:Ka,setDefaultGap:Ia,noGap:qa,remap:Ut}};return i.listen(u.render.bind(u)),u}function Ha(){if(!this.renderData)return;const{renderData:t,scales:e,contexts:n}=this,{hAnchor:s,vAnchor:r,gapHandler:i}=this,o=t.n();for(const a of mt)n[a].clear();for(let a=0;a<o;a++){const c=t.col(zt).valueAt(a),u=t.col("x").scaledAt(a,e.x),l=t.col("y").scaledAt(a,e.y);let d=t.col("width").scaledAt(a,e.width),h=t.col("height").scaledAt(a,e.height);[d,h]=i.applyGap(d,h),n[c].rectangleWH(u,l,d,h,{vAnchor:r,hAnchor:s})}}function Ba(t){if(!this.boundaryData)return new Set;const{boundaryData:e,scales:n,vAnchor:s,hAnchor:r}=this,i=e.n(),o=new Set;for(let a=0;a<i;a++){const c=e.col("x").scaledAt(a,n.x),u=e.col("y").scaledAt(a,n.y);let l=e.col("width").scaledAt(a,n.width),d=e.col("height").scaledAt(a,n.height);const h=[c-l*r,u-s*d,c+l*r,u+(1-s)*d];ue(t,h)&&yt(o,e.col(W).valueAt(a))}return o}function Fa(t){if(!this.boundaryData)return;const{boundaryData:e,scales:n,vAnchor:s,hAnchor:r}=this,i=e.n();for(let o=0;o<i;o++){const a=e.col("x").scaledAt(o,n.x),c=e.col("y").scaledAt(o,n.y);let u=e.col("width").scaledAt(o,n.width),l=e.col("height").scaledAt(o,n.height);const d=[a-u*r,c-s*l,a+u*r,c+(1-s)*l];if(le(t,d))return jt(o,j(e.cols()))}}function Wa(t){return this.hAnchor=t,this}function Ga(t){return this.vAnchor=t,this}function ja(t){return this.gapHandler.setGapType(t),this}function Ka(t){return this.gapHandler.setGapDimension(t),this}function Ia(t,e){return this.gapHandler.setDefaultGap(t,e),this}function qa(){return this.gapHandler.applyGap=(t,e)=>[t,e],this}function ln(t,e,n){const s=X(t),r=t.data.select(e),i=r.col("v2")??q,o=(n==null?void 0:n.reducer)??ht,a={stat1:Pt(i,o)},c=Me(r.col("v1")),u=_t(a).refine(c),l=u.refine(t.marker.factor),d=u.data(),h=l.data(),[m,p]=[z.Absolute,lt.Alphanumeric],v=un(s);v.setVAnchor(At.Bottom).setGapDimension(on.Width);const y={...s,bars:v,type:m,order:p,partition1Data:d,partition2Data:h};return ke(y),y.addGraphicObject(y.bars),y.addKeyAction("KeyR",Qa.bind(y)),y.addKeyAction("KeyO",Ya.bind(y)),y.addKeyAction("KeyN",Za.bind(y)),h.listen(y.render.bind(y)),y}function Qa(){this.scales.x.setDefaultOrder(),this.order=lt.Alphanumeric,ke(this)}function Za(){this.type===z.Absolute?Xa(this):ke(this)}function Ya(){if(this.order===lt.Alphanumeric){const t=Bs(this.partition1Data.col("stat1").values());this.scales.x.setOrder(t),this.order=lt.Custom}else this.scales.x.setDefaultOrder(),this.order=lt.Alphanumeric;this.render()}function ke(t){const{partition1Data:e,partition2Data:n,bars:s}=t,r=e.select(Va),i=n.select(Ua);s.setBoundaryData(r),s.setRenderData(i),s.setGapType(kt.Pct),t.type=z.Absolute,t.trainScales(r,c=>({...c,y:c.height,width:c.x.width()}));const{scales:o}=t,a=o.x.getOrder();o.x.setDefaultWeights(),a&&o.x.setOrder(a),o.y.setMin(0).link(o.height).freezeZero(),o.height.codomain.freezeScale(),t.render()}function Xa(t){const{partition1Data:e,partition2Data:n,bars:s}=t,r=e.select(Ja),i=n.select(tc);s.setBoundaryData(r),s.setRenderData(i),s.setGapType(kt.Px),t.type=z.Proportion,t.trainScales(r,u=>({...u,y:u.height,width:u.x.width()}));const{scales:o}=t,a=o.x.getOrder(),c=e.col("stat1").values();o.x.setWeights(c),a&&o.x.setOrder(a),o.y.setMin(0).link(o.height).freezeZero(),o.height.codomain.freezeScale(),o.width.setMax(c.reduce(Ce)),t.render()}const Va=t=>({x:t.label.setQueryable(!0),y:V,width:t.label,height:t.stat1.setQueryable(!0)}),Ua=t=>({x:t.label,y:V,width:t.label,height:t.stat1.stack()}),Ja=t=>({x:t.label.setQueryable(!0),y:V,width:t.label,height:q,aux1:t.stat1.setQueryable(!0)}),tc=t=>({x:t.label,y:V,width:t.label,height:t.stat1.stack().normalizeByParent()});function dn(t,e){const n=X(t),s=t.data.select(e),r={stat1:Pt(q,ht)},i=Me(s.col("v1")),o=Me(s.col("v2")),a=Se(i,o),c=_t(r).refine(a),u=c.refine(t.marker.factor),l=c.data(),d=u.data(),h=z.Absolute,m=un(n).setDefaultGap(1,0);m.remap("width","area"),m.remap("height","area");const p={...n,squares:m,type:h,partition1Data:l,partition2Data:d};hn(p),n.addGraphicObject(m);const v=Math.max(i.cardinality,o.cardinality)+1;p.scales.area.codomain.setScale(1/v,{default:!0}),p.scales.area.codomain.setTransform(Ot,Ct),p.partition1Data.listen(p.render.bind(p)),p.partition2Data.listen(p.render.bind(p)),p.addKeyAction("KeyR",()=>{p.scales.x.setDefaultOrder(),p.scales.y.setDefaultOrder()}),p.addKeyAction("KeyN",()=>p.type===z.Absolute?ec(p):hn(p)),p.render()}function hn(t){const{partition1Data:e,partition2Data:n,squares:s}=t,r=e.select(nc),i=n.select(sc);s.setBoundaryData(r),s.setRenderData(i),s.setGapType(kt.Pct),t.type=z.Absolute,t.trainScales(r,o=>({x:o.x,y:o.y,area:o.width})),t.render()}function ec(t){const{partition1Data:e,partition2Data:n,squares:s}=t,r=e.select(rc),i=n.select(ic);s.setBoundaryData(r),s.setRenderData(i),s.setGapType(kt.Px),t.type=z.Proportion,t.trainScales(r,o=>({x:o.x,y:o.y,area:o.width})),t.render()}const nc=t=>({x:t.label.setQueryable(!0),y:t.label$.setQueryable(!0),width:t.stat1.setQueryable(!0),height:t.stat1}),sc=t=>({x:t.label,y:t.label$,width:t.stat1.stack(),height:t.stat1.stack()}),rc=t=>({x:t.label.setQueryable(!0),y:t.label$.setQueryable(!0),width:q,height:q,query1:t.stat1.setQueryable(!0)}),ic=t=>({x:t.label,y:t.label$,width:t.stat1.stack().normalizeByParent(),height:t.stat1.stack().normalizeByParent()});function oc(t){const e=k("div").addClass("ps-widget").get(),n=t.value,s=$(E({source:t,value:n,container:e,render:ac}));return t.listen(s.render.bind(s)),s}function ac(){const{container:t,source:e}=this;Ht(t);const n=k("span").appendTo(t).get(),s=k("input").appendTo(t).get();return n.innerText=`${this.name()}`,s.value=`${Gt(e.value)}`,s.size=6,s.addEventListener("keydown",r=>{r.code=="Enter"&&(this.value=parseFloat(s.value),this.emit())}),s.onmousedown=r=>r.stopPropagation(),this}function it(t){const s={...{value:t,defaultValue:t},...{defaultize:cc,set:uc,widget:lc}};return $(E(s))}function cc(){return this.value=this.defaultValue,this.emit(),this}function uc(t){return this.value=typeof t!="function"?t:t(this.value),this.emit(),this}function lc(){const t=$({value:this.value}),e=oc(t).setName(this.name());return this.listen(()=>{t.value=this.value,t.emit()}),e.listen(()=>{this.value=e.value,this.emit()}),e}function ze(t){return t===void 0?!1:t&&typeof t=="object"&&"listen"in t}function fn(t){return t&&ze(t)?()=>t.value:()=>t}function $e(t,e,n){const s=fn(e),r=fn(n),i=mn(t,s(),r()),o=()=>{const a=mn(t,s(),r());i.parent=a.parent,i.cardinality=a.cardinality,i.levels=a.levels;for(const[c,u]of B(a.data.columns))i.data.columns[c].domain=u.domain,i.data.columns[c].array=u.array,i.data.columns[c].source=u.source,i.data.columns[c].indexfn=u.indexfn;i.emit()};return ze(e)&&e.listen(o),ze(n)&&n.listen(o),i}function mn(t,e,n){const s=t.array,{min:r,max:i}=t.domain,o=t.domain.range(),a=e?Math.ceil(o/e)+1:10;e=e??o/(a-1),n=n??r;const c=r-e+(n-r)%e,u=i+e-(i-n)%e,l=Array(a+2);l[0]=c,l[l.length-1]=u;for(let _=1;_<l.length-1;_++)l[_]=c+_*e;const d=new Set,h=[],m={};for(let _=0;_<s.length;_++){const tt=l.findIndex(Rn=>Rn>=s[_])-1;m[tt]||(m[tt]=new Set),m[tt].add(_),d.add(tt),h.push(tt)}const p=Array.from(d).sort(N),v={};for(const[_,tt]of Object.entries(p))v[tt]=jn(_);const y=h;for(let _=0;_<y.length;_++)y[_]=v[y[_]];const[b,M]=[l[p[0]],l[gt(p)+1]],x=Z(b,M);Y(l,x).setName(t.name());const D=re(l,p),U=re(l,p.map(Re)),ot=Cs(D,U,Ts),w=Y(D,x),J=Y(U,x),De=Y(ot,x);t.hasName()&&(w.setName(`lower ${t.name()}`),J.setName(`upper ${t.name()}`),De.setName(t.name()));const _n={binStart:w,binMid:De,binEnd:J,[W]:Q(Object.values(m))},Pn=P(_n);return Dt(p.length,y,Pn)}function pn(t){const{scales:e,contexts:n}=t;return{...{scales:e,contexts:n},...{setBoundaryData:Xt,setRenderData:Vt,render:dc,check:hc,query:fc,remap:Ut}}}function dc(t){if(!this.renderData)return;const{renderData:e,scales:n}=this,s=e.n();for(const r of mt)t[r].clear();for(let r=0;r<s;r++){const i=e.col(zt).valueAt(r);let o=e.col("x0").scaledAt(r,n.x),a=e.col("y0").scaledAt(r,n.y),c=e.col("x1").scaledAt(r,n.x),u=e.col("y1").scaledAt(r,n.y);if(e.col("area")){const l=e.col("area").scaledAt(r,n.area);o=o+(1-l)/2*(c-o),c=c-(1-l)/2*(c-o),a=a+(1-l)/2*(u-a),u=u-(1-l)/2*(u-a)}t[i].rectangleXY(o,a,c,u)}}function hc(t){if(!this.boundaryData)return new Set;const{boundaryData:e,scales:n}=this,s=e.n(),r=new Set;for(let i=0;i<s;i++){let o=e.col("x0").scaledAt(i,n.x),a=e.col("y0").scaledAt(i,n.y),c=e.col("x1").scaledAt(i,n.x),u=e.col("y1").scaledAt(i,n.y);if(e.col("area")){const d=e.col("area").scaledAt(i,n.area);o=o+(1-d)/2*(c-o),c=c-(1-d)/2*(c-o),a=a+(1-d)/2*(u-a),u=u-(1-d)/2*(u-a)}ue(t,[o,a,c,u])&&yt(r,e.col(W).valueAt(i))}return r}function fc(t){if(!this.boundaryData)return;const{boundaryData:e,scales:n}=this,s=e.n();for(let r=0;r<s;r++){let i=e.col("x0").scaledAt(r,n.x),o=e.col("y0").scaledAt(r,n.y),a=e.col("x1").scaledAt(r,n.x),c=e.col("y1").scaledAt(r,n.y);if(e.col("area")){const l=e.col("area").scaledAt(r,n.area);i=i+(1-l)/2*(a-i),a=a-(1-l)/2*(a-i),o=o+(1-l)/2*(c-o),c=c-(1-l)/2*(c-o)}if(le(t,[i,o,a,c]))return jt(r,j(e.cols()))}}function gn(t,e,n){const s=X(t),r=t.data.select(e),[i,o]=[r.col("v1").min(),r.col("v1").range()],a=it(i).setName("Anchor: "),c=it(o/15).setName("Binwidth: "),u=r.col("v2")??q,l=(n==null?void 0:n.reducer)??ht,d={stat1:Pt(u,l)},h=$e(r.col("v1"),c,a),m=_t(d).refine(h),p=m.refine(t.marker.factor),v=m.data(),y=p.data(),b=z.Absolute,M=pn(s),x={...s,type:b,bars:M,partition1Data:v,partition2Data:y};yn(x),x.addGraphicObject(M),x.addKeyAction("KeyN",()=>x.type===z.Absolute?mc(x):yn(x)),x.addKeyAction("Minus",()=>c.set(D=>D*.9)),x.addKeyAction("Equal",()=>c.set(D=>D*1.1111111111111112));const G=r.col("v1").range()/20;x.addKeyAction("Quote",()=>a.set(D=>D-G)),x.addKeyAction("Semicolon",()=>a.set(D=>D+G)),x.addKeyAction("KeyR",()=>(c.defaultize(),a.defaultize())),x.addWidgetSource(c),x.addWidgetSource(a),v.listen(()=>{x.trainScales(M.boundaryData,D=>({x:D.x0,y:D.y1})),x.scales.x.setName(v.col("binMid").name()),x.scales.y.freezeZero()}),y.listen(x.render.bind(x))}function yn(t){const{partition1Data:e,partition2Data:n,bars:s}=t,r=e.select(pc),i=n.select(gc);s.setBoundaryData(r),s.setRenderData(i),t.type=z.Absolute,t.trainScales(r,o=>({x:o.x0,y:o.y1})),t.scales.x.setName(e.col("binMid").name()),t.scales.y.freezeZero().setName("count"),t.render()}function mc(t){const{partition1Data:e,partition2Data:n,bars:s}=t,r=e.select(yc),i=n.select(bc);r.col("x0").setName(void 0),r.col("x1").setName(void 0),s.setBoundaryData(r),s.setRenderData(i),t.type=z.Proportion,t.trainScales(r,o=>({x:o.x0,y:o.y1})),t.scales.x.setName("cumulative count"),t.scales.y.freezeZero().setName("proportion"),t.render()}const pc=t=>({x0:t.binStart.setQueryable(!0),y0:V,x1:t.binEnd.setQueryable(!0),y1:t.stat1.setQueryable(!0)}),gc=t=>({x0:t.binStart,y0:V,x1:t.binEnd,y1:t.stat1.stack()}),yc=t=>({x0:t.stat1.stack().shiftLeft(),x1:t.stat1.stack(),y0:V,y1:q,query1:t.binStart.setQueryable(!0),query2:t.binEnd.setQueryable(!0),query3:t.stat1.setQueryable(!0)}),bc=t=>({x0:t.stat1.parent().stack().shiftLeft(),x1:t.stat1.parent().stack(),y0:V,y1:t.stat1.stack().normalizeByParent()});function bn(t,e){const n=X(t),s=t.data.select(e),[r,i]=[s.col("v1"),s.col("v2")],[o,a]=[r.range(),i.range()],[c,u]=[r.min(),i.min()],l=it(o/30).setName(vn(r.name())),d=it(a/30).setName(vn(r.name())),h=it(c).setName(wn(r.name())),m=it(u).setName(wn(i.name())),p={stat1:Pt(q,ht)},v=$e(r,l,h),y=$e(i,d,m),b=Se(v,y),M=_t(p).refine(b),x=M.refine(t.marker.factor),G=M.data(),D=x.data(),U=z.Absolute,ot=pn(n),w={...n,type:U,squares:ot,partition1Data:G,partition2Data:D};xn(w),w.addGraphicObject(ot),w.addKeyAction("KeyN",()=>w.type===z.Absolute?xc(w):xn(w)),w.addKeyAction("Minus",()=>{l.set(pt(.9)),d.set(pt(.9))}),w.addKeyAction("Equal",()=>{l.set(pt(1.1111111111111112)),d.set(pt(1.1111111111111112))}),w.addKeyAction("KeyR",()=>{l.defaultize(),d.defaultize()}),w.addWidgetSource(l),w.addWidgetSource(d),w.addWidgetSource(h),w.addWidgetSource(m),G.listen(()=>{w.trainScales(ot.boundaryData,J=>({x:J.x0,y:J.y0,area:J.area})),w.scales.x.setName(G.col("binMid").name()),w.scales.y.setName(G.col("binMid$").name()),w.scales.area.codomain.setMinMax(0,1,{default:!0}).setTransform(Ot,Ct).freezeMax().freezeScale(),w.render()}),D.listen(w.render.bind(w)),w.render()}function xn(t){const{partition1Data:e,partition2Data:n,squares:s}=t,r=e.select(vc),i=n.select(wc);s.setBoundaryData(r),s.setRenderData(i),t.trainScales(r,a=>({x:a.x0,y:a.y1,area:a.area}));const{scales:o}=t;o.x.setName(e.col("binMid").name()),o.y.setName(e.col("binMid$").name()),o.area.codomain.setMinMax(0,1,{default:!0}).setTransform(Ot,Ct).freezeMax().freezeScale(),t.type=z.Absolute,t.render()}function xc(t){const{partition1Data:e,partition2Data:n,squares:s}=t,r=e.select(Ac),i=n.select(Mc);s.setBoundaryData(r),s.setRenderData(i),t.trainScales(r,a=>({x:a.x0,y:a.y1,area:a.area}));const{scales:o}=t;o.x.setName(e.col("binMid").name()),o.y.setName(e.col("binMid$").name()),o.area.codomain.setMinMax(0,1,{default:!0}).setTransform(Ot,Ct).freezeMax().freezeScale(),t.type=z.Proportion,t.render()}const vc=t=>({x0:t.binStart.setQueryable(!0),x1:t.binEnd.setQueryable(!0),y0:t.binStart$.setQueryable(!0),y1:t.binEnd$.setQueryable(!0),area:t.stat1.setQueryable(!0)}),wc=t=>({x0:t.binStart,x1:t.binEnd,y0:t.binStart$,y1:t.binEnd$,area:t.stat1.stack()}),Ac=t=>({x0:t.binStart.setQueryable(!0),x1:t.binEnd.setQueryable(!0),y0:t.binStart$.setQueryable(!0),y1:t.binEnd$.setQueryable(!0),area:q}),Mc=t=>({x0:t.binStart,x1:t.binEnd,y0:t.binStart$,y1:t.binEnd$,area:t.stat1.stack().normalizeByParent()});function vn(t){return`Binwidth of ${t}: `}function wn(t){return`Anchor of ${t}: `}function An(t){const e=X(t);for(const s of j(e.contexts))s.canvas.remove();const n=k("textarea").appendTo(e.container).get();return n.value=`
Write notes here....`,e.localKeyActions.KeyP=Wn,{...e,textarea:n}}function Sc(t,e,n){const{scales:s,contexts:r}=t;return{...{boundaryData:e,renderData:n,scales:s,contexts:r},...{render:kc,check:zc,query:$c,setBoundaryData:Xt,setRenderData:Vt,remap:Ut}}}function kc(){const{renderData:t,scales:e,contexts:n}=this;if(!dt(e.x.domain))return;const s=t.n(),r=e.x.domain.order;for(const i of mt)n[i].clear();for(let i=0;i<s;i++){const o=t.col(zt).valueAt(i);let a=t.col("x").scaledAt(i,e.x),c=t.col("y").scaledAt(i,e.y);a=I(a,r),c=I(c,r),n[o].line(a,c)}}function zc(t){const{boundaryData:e,scales:n}=this,s=new Set;if(!dt(n.x.domain))return s;const r=e.n(),i=n.x.domain.order;for(let o=0;o<r;o++){let a=e.col("x").scaledAt(o,n.x),c=e.col("y").scaledAt(o,n.y);a=I(a,i),c=I(c,i);for(let u=1;u<a.length;u++)Ze(t,[a[u-1],c[u-1],a[u],c[u]])&&yt(s,e.col(W).valueAt(o))}return s}function $c(t){const{boundaryData:e,scales:n}=this;if(!dt(n.x.domain))return{};const s=e.n(),r=Xn(t,Gn,Re),i=n.x.domain.order;for(let o=0;o<s;o++){let a=e.col("x").scaledAt(o,n.x),c=e.col("y").scaledAt(o,n.y);a=I(a,i),c=I(c,i);for(let u=1;u<a.length;u++)if(Ze(r,[a[u-1],c[u-1],a[u],c[u]]))return jt(o,[e.col("y")])}}function Mn(t){const e=at(0,t.length-1),[n,s,r,i]=[0,1,0,1],o={order:e,values:t,zero:n,one:s,defaultZero:r,defaultOne:i,[Symbol.toStringTag]:Zt.DiscreteAbsolute};return $({...o,...{clone:Dc,normalize:_c,unnormalize:Pc,defaultize:Rc,setZero:he,setOne:fe,setZeroOne:me,setValues:Je,setOrder:Oc,setDefaultOrder:Cc,link:Ue,freezeZero:pe,freezeOne:ge,freeze:ye,expand:be,move:Ve,retrain:Tc,breaks:tn,widget:en}})}function Dc(){const t=Mn(this.values);return t.order=this.order,t.normalize=this.normalize,t}function _c(t){const{order:e,values:n,zero:s,one:r}=this,i=e[n.indexOf(t)]/(n.length-1);return s+i*(r-s)}function Pc(t){throw new Error("Not implemented yet")}function Rc(t){const e=Object.assign({zero:!0,one:!0,order:!0},t);if(e.zero&&(this.zero=this.defaultZero),e.one&&(this.one=this.defaultOne),e.order)for(let n=0;n<this.order.length;n++)this.order[n]=n;return this.emit(),this}function Oc(t){for(let e=0;e<t.length;e++)this.order[e]=t[e];return this.emit(),this}function Cc(){for(let t=0;t<this.order.length;t++)this.order[t]=t;return this.emit(),this}function Tc(t){const e=Array.from(new Set(t)).sort(ee);return this.values=e,this.emit(),this}function Sn(t){const e="Tuple",s=at(0,t.length-1),r=Z(),a={...{tag:e,variables:t,order:s,domain:r,commonDomain:!1},...{clone:Nc,n:Ec,valueAt:Lc,scaledAt:Hc,setOrder:Bc,setCommonDomain:Fc,unsetCommonDomain:Wc,injectQueryInfo:Gc}};return ct(a).with(E).with(st).with(vt)}function Nc(){return{...this}}function Ec(){for(const t of this.variables)if(t.n()!=-1)return t.n();throw new Error("No fixed length variables present")}function Lc(t,e=0){const{variables:n,order:s}=this,r=Array(n.length);for(let i=0;i<n.length;i++){const o=n[i];r[s[i]]=o.valueAt(t,e)}return r}function Hc(t,e){const{variables:n,order:s,domain:r,commonDomain:i}=this,o=Array(n.length),a=e.domain;for(let c=0;c<n.length;c++){const u=n[c];e.domain=i?r:u.domain,o[s[c]]=u.scaledAt(t,e)}return e.domain=a,o}function Bc(t){for(let e=0;e<t.length;e++)this.order[e]=t[e];return this}function Fc(){if(!C(this.domain))throw new Error("Only continuous domain can be shared.");let[t,e]=[1/0,-1/0];for(const n of this.variables){if(!zr(n))throw new Error("All variables must be continuous for common domain.");const[s,r]=Tt(n.array);t=Math.min(t,s),e=Math.max(e,r)}return this.domain.setMinMax(t,e),this.commonDomain=!0,this.domain}function Wc(){if(!C(this.domain))throw new Error("Only continuous domain can be shared.");return this.domain.setMinMax(0,1),this.commonDomain=!1,this.domain}function Gc(t,e){for(const n of this.variables)n.hasName()&&n.injectQueryInfo(t,e)}function kn(t,e){const n=t.data.select(e),s=X(t),r=n.select(jc).join(t.marker.data()),i=r,o=r.select(zn).join(an),a=i.select(zn).join(t.marker.data()),c=z.Proportion,u=Sc(s,o,a);s.addGraphicObject(u),s.trainScales(o,d=>({x:d.x,y:d.y})),s.scales.x.domain.link(o.col("x").domain),s.scales.y.domain.link(o.col("y").domain);for(const d of o.col("y").variables)s.scales.y.domain.link(d.domain);const l={...s,type:c,lines:u,partition1Data:r,partition2Data:i};return l.addKeyAction("KeyN",Kc.bind(l)),l.addKeyAction("KeyR",()=>l.scales.x.setDefaultOrder()),a.listen(s.render.bind(s)),l}const jc=t=>{const{defaultNormX:e,defaultNormY:n}=O,s=[];for(const[a,c]of Object.entries(t))/^v\d+$/g.test(a)&&(s.push(c.setQueryable(!0)),c.domain.expand(-e,1+e,{default:!0}));const r=Sn(s),i=Sn(s.map(a=>$t((c,u)=>u.name(),a).setName(a.name()))),o=Mn(i.valueAt(0));o.expand(-n,1+n,{default:!0});for(const a of i.variables)a.setDomain(o);return i.domain=o,i.n=()=>r.n(),i.setName("variable"),r.setName("scaled value"),{names:i,values:r}},zn=t=>({x:t.names,y:t.values});function Kc(){if(this.type===z.Proportion){const{defaultNormY:t}=O,e=this.partition1Data.col("values").setCommonDomain(),{min:n,max:s}=e.expand(-t,1+t);this.scales.y.setMinMax(n,s),this.scales.y.setName("value"),this.type=z.Absolute,this.render()}else{const{defaultNormY:t}=O;this.partition1Data.col("values").unsetCommonDomain(),this.scales.y.setMinMax(-t,1+t).setName("scaled value"),this.type=z.Proportion,this.render()}}function Ic(t,e,n){const{scales:s,contexts:r}=t,i=it(1),o={};o.Equal=()=>i.set(l=>l*10/9),o.Minus=()=>i.set(l=>l*9/10),o.KeyR=()=>i.defaultize();const u={...{boundaryData:e,renderData:n,scales:s,contexts:r,keyActions:o,sizePct:i},...{render:qc,check:Qc,query:Zc,setBoundaryData:Xt,setRenderData:Vt,remap:Ut}};return i.listen(u.render.bind(u)),u}function qc(){var i;const{renderData:t,scales:e,contexts:n,sizePct:s}=this,r=t.n();for(const o of mt)n[o].clear();for(let o=0;o<r;o++){const a=t.col(zt).valueAt(o),c=t.col("x").scaledAt(o,e.x),u=t.col("y").scaledAt(o,e.y);let l=(i=t.col("size"))==null?void 0:i.scaledAt(o,e.size);l=l?Math.sqrt(l):O.defaultRadius,l=l*s.value,n[a].point(c,u,{radius:l})}}function Qc(t){var i;const{boundaryData:e,scales:n}=this,s=e.n(),r=new Set;for(let o=0;o<s;o++){const a=e.col("x").scaledAt(o,n.x),c=e.col("y").scaledAt(o,n.y);let u=(i=e.col("size"))==null?void 0:i.scaledAt(o,n.size);u=u?Math.sqrt(u):O.defaultRadius;const l=u/Math.sqrt(2);ue(t,[a-l,c-l,a+l,c+l])&&yt(r,e.col(W).valueAt(o))}return r}function Zc(t){var r;const{boundaryData:e,scales:n}=this,s=e.n();for(let i=0;i<s;i++){const o=e.col("x").scaledAt(i,n.x),a=e.col("y").scaledAt(i,n.y);let c=(r=e.col("size"))==null?void 0:r.scaledAt(i,n.size);c=c?Math.sqrt(c):O.defaultRadius;const u=c/Math.sqrt(2);if(le(t,[o-u,a-u,o+u,a+u]))return jt(i,j(e.cols()))}}function $n(t,e){const n=X(t),s=t.data.select(e),r=s.select(Dn).join(an),i=s.select(Dn).join(t.marker.data()),o=Ic(n,r,i);return n.addGraphicObject(o),n.trainScales(r,a=>({x:a.x,y:a.y})),i.listen(n.render.bind(n)),{...n,data:s,points:o,renderData:i,boundaryData:r}}const Dn=t=>{var e;return{x:t.v1.setQueryable(!0),y:t.v2.setQueryable(!0),size:(e=t.v3)==null?void 0:e.setQueryable(!0)}},Yc=`<div>
    <br>
    <h1>Available Interactions</h1>
    <hr>
    <ul>
        <li> <b>Click/click and drag</b> to select objects transiently </li>
        <li>Hold <b>1/2/3</b> while dragging for permanent selection</li>
        <li><b>Right click and drag</b> to pan</li>
        <li>Hold <b>Q</b> and mouse-over objects to query them</li>
        <br>
        <li>Press <b>Z</b> to zoom into current selection</li>
        <li>Press <b>X</b> to pop one level of zoom</li>
        <li>Press <b>O</b> to order by statistic (barplot)</li> 
        <li>Press <b>N</b> to normalize representation</li>
        <li>Press <b>P</b> to bring up parameter menu</li>
        <li>Press and hold <b>S</b> for plot resize mode
           <br>(you can then click and drag bottom right to resize plot)</li>
        <br>
        <li><b>Double-click</b> to reset any selection</li>
        <li>Press <b>R</b> to reset any graphical changes</li>
        <br>
        <li>Press <b>+/-</b> to change object size/width</li>
        <li>Press <b>[/]</b> to change opacity (unselected only)</li>
        <li>Press <b>;/'</b> to change histogram anchor</li>
    </ul>
</div>
`,Xc={scatter:$n,bar:ln,histo:gn,fluct:dn,histo2d:bn,pcoords:kn,note:An};function Vc(t){return t&-5}function Uc(t){return t|4}const Jc=[0,1,2,3];function tu(t){const e=F.Transient,n=Array(t).fill(F.Group1),s=Array.from(Array(8),()=>new Set);s[7]=new Set(at(0,t-1));const r=Q(at(0,7)),i=Q(s),o=P({[zt]:r,[W]:i}),a=Dt(8,n,o);return $({...{n:t,group:e,indices:n,positions:s,transientPositions:new Set,factor:a},...{setGroup:eu,update:nu,clearAll:su,clearTransient:ru,data:iu}})}function eu(t){return this.group=t,this}function nu(t){const{group:e,indices:n,positions:s,transientPositions:r}=this;if(this.clearTransient(),!t.size)return this;for(const i of s)for(const o of t)i.delete(o);if(e===F.Transient)for(const i of t){const o=Vc(n[i]);n[i]=o,s[o].add(i),r.add(i)}else for(const i of t){const o=e;n[i]=o,s[o].add(i)}return this.factor.emit(),this.emit(),this}function su(){const{indices:t,positions:e}=this;for(const n of e)n.clear();for(let n=0;n<this.n;n++)e[F.Group1].add(n);return t.fill(F.Group1),this.factor.emit(),this}function ru(){const{indices:t,positions:e,transientPositions:n}=this;for(const s of Jc)e[s].clear();for(const s of n){const r=Uc(t[s]);t[s]=r,e[r].add(s)}return n.clear(),this.factor.emit(),this}function iu(){const{n:t,factor:e,indices:n}=this,s=e.data.proxy(n),r=Array.from(Array(t),(i,o)=>new Set([o]));return s.columns[W]=Q(r),this.factor.listen(()=>s.emit()),s}const ou=new DOMParser().parseFromString(Yc.replace(/(\r\n|\n|\r)/gm,""),"text/html").body;function au(t,e){const n=k("div").addClass("ps-scene-container").appendTo(t).get(),s=[],r=ut(),i=document.documentElement;i.style.setProperty("--bmargin",`${r[0]}px`),i.style.setProperty("--lmargin",`${r[1]}px`),i.style.setProperty("--tmargin",`${r[2]}px`),i.style.setProperty("--rmargin",`${r[3]}px`);const o=tu(e.n()),a={},d={...{container:n,data:e,marker:o,hasLayout:!1,plots:s,keyActions:a},...{addPlot:lu,addPlotByKey:du,setGroup:mu,setLayout:uu,setDimensions:cu,deactivateAll:hu,deactivateAllExcept:fu}};a.Digit1=()=>d.setGroup(F.Group2),a.Digit2=()=>d.setGroup(F.Group3),a.Digit3=()=>d.setGroup(F.Group4),n.addEventListener("mousedown",pu.bind(d)),window.addEventListener("keydown",gu.bind(d)),window.addEventListener("keyup",yu.bind(d));const h=k("dialog").appendTo(n).append(ou).addClass("ps-help-modal").get(),m=k("button").appendTo(n).addClass("ps-help-button").text("?").get();return m.onclick=()=>h.showModal(),h.onclick=()=>h.close(),d}function cu(t,e){document.documentElement.style.setProperty("--ncols",e.toString()),document.documentElement.style.setProperty("--nrows",t.toString());for(const n of this.plots)n.resize();return this}function uu(t){const{container:e,plots:n}=this;let s="";for(const r of t){const i=`"${r.map(o=>`p${o}`).join(" ")}"`;s+=i}for(let r=0;r<n.length;r++)n[r].container.style.gridArea=`p${r+1}`;e.style.gridTemplateRows=Nt("1fr",t.length).join(" "),e.style.gridTemplateColumns=Nt("1fr",t[0].length).join(" "),e.style.gridTemplateAreas=s;for(const r of this.plots)r.resize();return this.hasLayout=!0,this}function lu(t){this.container.append(t.container),this.plots.push(t),this.hasLayout&&(t.container.style.gridArea=`p${this.plots.length}`);const e=Math.ceil(Math.sqrt(this.plots.length)),n=Math.ceil(this.plots.length/e);return this.setDimensions(n,e),this}function du(t,e){const n=Xc[t];return n(this,e),this}function hu(){for(const t of this.plots)t.deactivate();return this}function fu(t){for(const e of this.plots)e!==t&&e.deactivate();return this}function mu(t){return this.marker.setGroup(t),this}function pu(t){t.target===this.container&&this.deactivateAll()}function gu(t){var e,n;return(n=(e=this.keyActions)[t.code])==null||n.call(e,t),this}function yu(){this.setGroup(F.Transient)}return S.baseLayers=we,S.col=si,S.countReducer=yi,S.fetchJSON=Qn,S.layers=mt,S.maxReducer=bi,S.newBarplot=ln,S.newDataframe=P,S.newFluctplot=dn,S.newHistogram=gn,S.newHistogram2D=bn,S.newNoteplot=An,S.newPCoordsplot=kn,S.newPlot=X,S.newScatter=$n,S.newScene=au,S.parseColumns=pi,S.parseRows=gi,S.pasteReducer=xi,S.sumReducer=ht,Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}),S}({});
