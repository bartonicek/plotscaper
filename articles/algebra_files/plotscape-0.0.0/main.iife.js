var plotscape=function(exports){"use strict";var __vite_style__=document.createElement("style");__vite_style__.textContent=`*:where(.tailwind,.tailwind *),:before:where(.tailwind,.tailwind *),:after:where(.tailwind,.tailwind *){box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before:where(.tailwind,.tailwind *),:after:where(.tailwind,.tailwind *){--tw-content: ""}.tailwind{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}.tailwind{margin:0;line-height:inherit}hr:where(.tailwind,.tailwind *){height:0;color:inherit;border-top-width:1px}abbr:where([title]):where(.tailwind,.tailwind *){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1:where(.tailwind,.tailwind *),h2:where(.tailwind,.tailwind *),h3:where(.tailwind,.tailwind *),h4:where(.tailwind,.tailwind *),h5:where(.tailwind,.tailwind *),h6:where(.tailwind,.tailwind *){font-size:inherit;font-weight:inherit}a:where(.tailwind,.tailwind *){color:inherit;text-decoration:inherit}b:where(.tailwind,.tailwind *),strong:where(.tailwind,.tailwind *){font-weight:bolder}code:where(.tailwind,.tailwind *),kbd:where(.tailwind,.tailwind *),samp:where(.tailwind,.tailwind *),pre:where(.tailwind,.tailwind *){font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small:where(.tailwind,.tailwind *){font-size:80%}sub:where(.tailwind,.tailwind *),sup:where(.tailwind,.tailwind *){font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub:where(.tailwind,.tailwind *){bottom:-.25em}sup:where(.tailwind,.tailwind *){top:-.5em}table:where(.tailwind,.tailwind *){text-indent:0;border-color:inherit;border-collapse:collapse}button:where(.tailwind,.tailwind *),input:where(.tailwind,.tailwind *),optgroup:where(.tailwind,.tailwind *),select:where(.tailwind,.tailwind *),textarea:where(.tailwind,.tailwind *){font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button:where(.tailwind,.tailwind *),select:where(.tailwind,.tailwind *){text-transform:none}button:where(.tailwind,.tailwind *),input:where([type=button]):where(.tailwind,.tailwind *),input:where([type=reset]):where(.tailwind,.tailwind *),input:where([type=submit]):where(.tailwind,.tailwind *){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring:where(.tailwind,.tailwind *){outline:auto}:-moz-ui-invalid:where(.tailwind,.tailwind *){box-shadow:none}progress:where(.tailwind,.tailwind *){vertical-align:baseline}::-webkit-inner-spin-button:where(.tailwind,.tailwind *),::-webkit-outer-spin-button:where(.tailwind,.tailwind *){height:auto}[type=search]:where(.tailwind,.tailwind *){-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration:where(.tailwind,.tailwind *){-webkit-appearance:none}::-webkit-file-upload-button:where(.tailwind,.tailwind *){-webkit-appearance:button;font:inherit}summary:where(.tailwind,.tailwind *){display:list-item}blockquote:where(.tailwind,.tailwind *),dl:where(.tailwind,.tailwind *),dd:where(.tailwind,.tailwind *),h1:where(.tailwind,.tailwind *),h2:where(.tailwind,.tailwind *),h3:where(.tailwind,.tailwind *),h4:where(.tailwind,.tailwind *),h5:where(.tailwind,.tailwind *),h6:where(.tailwind,.tailwind *),hr:where(.tailwind,.tailwind *),figure:where(.tailwind,.tailwind *),p:where(.tailwind,.tailwind *),pre:where(.tailwind,.tailwind *){margin:0}fieldset:where(.tailwind,.tailwind *){margin:0;padding:0}legend:where(.tailwind,.tailwind *){padding:0}ol:where(.tailwind,.tailwind *),ul:where(.tailwind,.tailwind *),menu:where(.tailwind,.tailwind *){list-style:none;margin:0;padding:0}dialog:where(.tailwind,.tailwind *){padding:0}textarea:where(.tailwind,.tailwind *){resize:vertical}input::-moz-placeholder:where(.tailwind,.tailwind *),textarea::-moz-placeholder:where(.tailwind,.tailwind *){opacity:1;color:#9ca3af}input::placeholder:where(.tailwind,.tailwind *),textarea::placeholder:where(.tailwind,.tailwind *){opacity:1;color:#9ca3af}button:where(.tailwind,.tailwind *),[role=button]:where(.tailwind,.tailwind *){cursor:pointer}:disabled:where(.tailwind,.tailwind *){cursor:default}img:where(.tailwind,.tailwind *),svg:where(.tailwind,.tailwind *),video:where(.tailwind,.tailwind *),canvas:where(.tailwind,.tailwind *),audio:where(.tailwind,.tailwind *),iframe:where(.tailwind,.tailwind *),embed:where(.tailwind,.tailwind *),object:where(.tailwind,.tailwind *){display:block;vertical-align:middle}img:where(.tailwind,.tailwind *),video:where(.tailwind,.tailwind *){max-width:100%;height:auto}[hidden]:where(.tailwind,.tailwind *){display:none}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.tw-absolute{position:absolute}.tw-relative{position:relative}.tw-left-0{left:0}.tw-right-0{right:0}.tw-top-0{top:0}.tw-z-10{z-index:10}.tw-z-30{z-index:30}.tw-z-50{z-index:50}.tw-m-1{margin:.25rem}.tw-flex{display:flex}.tw-grid{display:grid}.tw-size-full{width:100%;height:100%}.tw-h-5\\/6{height:83.333333%}.tw-h-full{height:100%}.tw-h-screen{height:100vh}.tw-w-5\\/6{width:83.333333%}.tw-w-8{width:2rem}.tw-w-fit{width:-moz-fit-content;width:fit-content}.tw-w-full{width:100%}.tw-select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.tw-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.tw-grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.tw-flex-row{flex-direction:row}.tw-flex-col{flex-direction:column}.tw-flex-wrap{flex-wrap:wrap}.tw-content-center{align-content:center}.tw-items-center{align-items:center}.tw-justify-start{justify-content:flex-start}.tw-justify-center{justify-content:center}.tw-gap-5{gap:1.25rem}.tw-rounded-md{border-radius:.375rem}.tw-rounded-bl-md{border-bottom-left-radius:.375rem}.tw-border{border-width:1px}.tw-border-gray-400{--tw-border-opacity: 1;border-color:rgb(156 163 175 / var(--tw-border-opacity))}.tw-border-b-black{--tw-border-opacity: 1;border-bottom-color:rgb(0 0 0 / var(--tw-border-opacity))}.tw-border-l-black{--tw-border-opacity: 1;border-left-color:rgb(0 0 0 / var(--tw-border-opacity))}.tw-bg-\\[\\#deded9\\]{--tw-bg-opacity: 1;background-color:rgb(222 222 217 / var(--tw-bg-opacity))}.tw-bg-gray-100{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity))}.tw-bg-gray-300{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity))}.tw-bg-gray-400{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity))}.tw-bg-gray-50{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity))}.tw-bg-slate-200{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity))}.tw-bg-slate-800{--tw-bg-opacity: 1;background-color:rgb(30 41 59 / var(--tw-bg-opacity))}.tw-bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.tw-bg-opacity-80{--tw-bg-opacity: .8}.tw-p-1{padding:.25rem}.tw-p-10{padding:2.5rem}.tw-px-2{padding-left:.5rem;padding-right:.5rem}.tw-px-3{padding-left:.75rem;padding-right:.75rem}.tw-py-1{padding-top:.25rem;padding-bottom:.25rem}.tw-py-10{padding-top:2.5rem;padding-bottom:2.5rem}.tw-text-center{text-align:center}.tw-font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.tw-text-\\[max\\(min\\(2vmin\\,16px\\)\\,8px\\)\\]{font-size:max(min(2vmin,16px),8px)}.tw-text-sm{font-size:.875rem;line-height:1.25rem}.tw-text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity))}.tw-text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.tw-shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.tw-outline-none{outline:2px solid transparent;outline-offset:2px}.tw-outline{outline-style:solid}.tw-outline-2{outline-width:2px}.tw-outline-slate-600{outline-color:#475569}.tw-drop-shadow-md{--tw-drop-shadow: drop-shadow(0 4px 3px rgb(0 0 0 / .07)) drop-shadow(0 2px 2px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.hover\\:tw-bg-gray-400:hover{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity))}.hover\\:tw-bg-gray-500:hover{--tw-bg-opacity: 1;background-color:rgb(107 114 128 / var(--tw-bg-opacity))}.hover\\:tw-bg-slate-200:hover{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity))}
`,document.head.appendChild(__vite_style__);const NAME=Symbol("name"),LENGTH=Symbol("length"),MIN=Symbol("min"),MAX=Symbol("max"),QUERYABLE=Symbol("queryable"),PARENTVALUES=Symbol("parentValues"),keyToSymbolMap={name:NAME,length:LENGTH,min:MIN,max:MAX,queryable:QUERYABLE,parent:PARENTVALUES};var Meta;(e=>{function n(a,c){return!!a[keyToSymbolMap[c]]}e.has=n;function r(a,c){return c==="length"&&Array.isArray(a)?a.length:a[keyToSymbolMap[c]]}e.get=r;function l(a,c){const x=[];for(let o=0;o<c.length;o++)x.push(r(a,c[o]));return x}e.getN=l;function h(a,c,x){a[keyToSymbolMap[c]]=x}e.set=h;function t(a,c,x){for(let o=0;o<c.length;o++)h(a,c[o],x[o])}e.setN=t;function p(a,c,x){const o=x??Object.keys(keyToSymbolMap);for(const i of o)a[keyToSymbolMap[i]]=r(c,i)}e.copy=p})(Meta||(Meta={}));var Getter;(e=>{function n(a){if(typeof a=="function")return a;if(Array.isArray(a)){const c=x=>a[x];return Meta.set(c,"length",a.length),c}if(isTypedArray(a)){const c=x=>a[x];return Meta.set(c,"length",a.length),c}return()=>a}e.of=n;function r(a){return()=>a}e.constant=r;function l(a,c){const x=e.of(a),o=i=>x(c[i]);return isObject(a)&&Meta.copy(o,a),Meta.set(o,"length",c.length),o}e.proxy=l;function h(a){const c=a.map(e.of),x=o=>c.map(i=>i(o));return Meta.copy(x,a[0],["length"]),x}e.multi=h;function t(a){const c={};for(const x of Reflect.ownKeys(a))c[x]=e.of(a[x]);return c}e.mapObject=t;function p(a,c){const x=e.of(c),o=Array(a);for(let i=0;i<a;i++)o[i]=x(i);return o}e.array=p})(Getter||(Getter={}));function identity(e){return e}const just=e=>()=>e,zero=just(0),one=just(1);function inc(e){return e+1}function dec(e){return e-1}function call(e){return e()}function bimap(e,n,r){if(e.length!==n.length)throw new Error("Arrays must be of the same length");const l=Array(e.length);for(let h=0;h<e.length;h++)l[h]=r(e[h],n[h]);return l}function square(e){return e**2}const sqrt=Math.sqrt,log10=Math.log10;function exp10(e){return 10**e}const max=Math.max;function diff(e,n){return e-n}function sum(e,n){return e+n}function prod(e,n){return e*n}function trunc(e,n=0,r=1){return Math.min(Math.max(e,n),r)}function rangeInverse(e,n){return 1/(n-e)}function invertRange(e,n){const r=rangeInverse(e,n);return[-e*r,r-e*r]}function round(e,n=0){return Math.round(e*10**n)/10**n}function compareAlphaNumeric(e,n){return e.localeCompare(n,"en",{numeric:!0})}function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}function toLowerCase(e){return e.toLocaleLowerCase()}function toUpperCase(e){return e.toLocaleUpperCase()}function stripWS(e){return e.replace(/\s/g,"")}function last(e){return e[e.length-1]}function rep(e,n){return Array(n).fill(e)}function seq(e,n,r){const l=Math.abs(n-e);r=r??Math.ceil(l)+1;const h=l/(r-1),t=n>=e?1:-1;return Array.from(Array(r),(p,a)=>e+t*h*a)}function seqLength(e,n){return Array.from(Array(n),(r,l)=>e+l)}function subset(e,n){const r=Array(n.length);for(let l=0;l<n.length;l++)r[l]=e[n[l]];return r}function remove(e,n){const r=e.indexOf(n);r!==-1&&e.splice(r,1)}function ordered(e,n){const r=Array(n.length);for(let l=0;l<n.length;l++)r[n[l]]=e[l];return r}function orderIndices(e){const n=e.toSorted(diff),r={},l={};for(let h=0;h<n.length;h++){const t=e[h];l[t]=l[t]+1||0,r[h]=n.indexOf(t)+l[t]}return Object.values(r)}function orderBy(e,n){const r=Array(e.length);for(let l=0;l<e.length;l++)r[l]=e[n[l]];for(let l=0;l<e.length;l++)e[l]=r[l]}function orderIndicesByTable(e,n){const r=Array(e.length);for(let l=0;l<e.length;l++)r[l]=n.indexOf(e[l]);return r}function minmax(e){let[n,r]=[1/0,-1/0];for(let l=0;l<e.length;l++)n=Math.min(n,e[l]),r=Math.max(r,e[l]);return[n,r]}function cumsum(e){const n=Array(e.length);n[0]=e[0];for(let r=1;r<e.length;r++)n[r]=e[r]+n[r-1];return n}function randomInteger(e,n){return Math.floor(e+Math.random()*n)}function uniqueIntegers(e,n,r=n-e){const l=n-e,h=[],t=new Set;for(;h.length<Math.min(r,l);){let p=randomInteger(e,n);for(;t.has(p);)p=randomInteger(e,n);h.push(p),t.add(p)}return h}async function fetchJSON(e){return await(await fetch(e)).json()}function merge(e,n){return{...e,...n}}function copyValues(e,n){if(e!==n){if(isTypedArray(e)&&isTypedArray(n))n.set(e);else if(Array.isArray(e)&&Array.isArray(n)){n.length=e.length;for(let r=0;r<e.length;r++)n[r]=e[r]}}}function copyProps(e,n){for(const[r,l]of Object.entries(e))Array.isArray(l)&&Array.isArray(e[r])?copyValues(l,e[r]):n[r]=l}function applyDirection(e,n){return .5*(1-n)+n*e}function prettyBreaks(e,n,r=4){const l=(n-e)/r,h=Math.floor(Math.log10(l)),t=[1,2,4,5,10];let[p,a]=[1/0,0];for(let d=0;d<t.length;d++){const w=(t[d]*10**h-l)**2;w<p&&([p,a]=[w,t[d]])}const c=10**h*a,x=Math.ceil(e/c)*c,o=Math.floor(n/c)*c,i=Math.round((o-x)/c),s=[];for(let d=0;d<i+1;d++){const w=x+d*c;s.push(w)}return s}function binBreaks(e,n){let{width:r,anchor:l,nBins:h}=n||{};const[t,p]=minmax(e),a=p-t;h=h??(r?Math.ceil(a/r)+1:10),r=r??a/(h-1),l=l??t;const c=t-r+(l-t)%r,x=p+r-(p-l)%r,o=Array(h+2);o[0]=c,o[o.length-1]=x;for(let i=1;i<o.length-1;i++)o[i]=c+i*r;return o}function tw(e){return e.trim().split(/\s+/)}function addTailwind(e,n){for(const r of n.trim().split(/\s+/))e.classList.add(r)}function removeTailwind(e,n){for(const r of n.trim().split(/\s+/))e.classList.remove(r)}function throttle(e,n){let r=0;return function(...l){const h=new Date().getTime();h-r<n||(r=h,e(...l))}}function timeExecution(e){const n=performance.now();return e(),performance.now()-n}function segmentToPointVec(e){const[n,r,l,h]=e;return[n,r,l-n,h-r]}function inRange(e,n,r){return!(e<n)&&!(e>r)}function segmentsIntersect(e,n){let[r,l,h,t]=segmentToPointVec(e),[p,a,c,x]=segmentToPointVec(n);const o=c*t-h*x,i=((r-p)*t-(l-a)*h)/o,s=-(-(r-p)*x+(l-a)*c)/o;return inRange(i,0,1)&&inRange(s,0,1)}function rectSegmentIntersect(e,n){const[r,l,h,t]=e;return segmentsIntersect([r,l,h,l],n)||segmentsIntersect([r,l,r,t],n)||segmentsIntersect([h,l,h,t],n)||segmentsIntersect([r,t,h,t],n)}function pointInRect(e,n){const[r,l]=e,[h,t,p,a]=n;return!(r<h||r>p||l<t||l>a)}function rectsIntersect(e,n){const[r,l]=[e[0],e[2]].sort(diff),[h,t]=[e[1],e[3]].sort(diff),[p,a]=[n[0],n[2]].sort(diff),[c,x]=[n[1],n[3]].sort(diff);return!(l<p||r>a||t<c||h>x)}function addIndexed(e,n,r){const h=Object.keys(e).filter(a=>a.replace(/[0-9]*$/,"")===n);if(h.length===0){e[`${n}1`]=r;return}const t=h.map(a=>parseInt(a.match(/[0-9]*$/)[0],10)),p=Math.max(...t);e[`${n}${p+1}`]=r}function minDecimal(e){let n=1/0;for(let r=0;r<e.length;r++)e[r]!==0&&(n=Math.min(n,Math.log10(Math.abs(e[r]))));return n>3?0:Math.floor(Math.abs(n))+2}function formatText(e,n={lowercase:!0,capitalize:!0,split:!0}){return n!=null&&n.split&&(e=e.replace(/_/g," ")),n!=null&&n.lowercase&&(e=e.toLocaleLowerCase()),n!=null&&n.capitalize&&(e=capitalize(e)),e}function formatLabel(e){if(typeof e=="string")return e;if(e===0)return e.toString();const n=Math.floor(Math.log10(Math.abs(e)));return n>=3?round(e).toString():n<=-3?round(e,-n+1).toString():round(e,2).toString()}function formatAxisLabels(e,n){if(!isNumberArray(e))return e;const r=(n==null?void 0:n.tens)??4,l=a=>a!=0&&Math.abs(Math.log10(a))>r,h=(n==null?void 0:n.decimals)??minDecimal(e);e=e.map(a=>round(a,h));const p=minmax(e).some(l)?superscriptFn:noSuperscriptFn;return e.map(p)}function superscriptFn(e){return e===0?"0":exponentialToSuperscript(e.toExponential())}function noSuperscriptFn(e){return e===0?"0":parseFloat(e.toPrecision(12)).toString()}function exponentialToSuperscript(e){let[n,r]=e.split("e");return r=convertToSuperscript(r),n+"×10"+r}const sups={"-":"⁻","+":"",0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹"};function convertToSuperscript(e){return e.split("").map(n=>sups[n]).join("")}function isDefined(e){return e!=null}const primitives=["string","number","boolean","undefined"];function isPrimitive(e){return e===null||primitives.includes(typeof e)}function isObject(e){return typeof e=="object"&&e!==null}function isTypedArray(e){return ArrayBuffer.isView(e)}function isNumber(e){return typeof e=="number"}function isIntegerString(e){return/^[0-9]+/.test(e)}function isNumberArray(e){return typeof e[0]=="number"&&typeof last(e)=="number"}function isStringArray(e){return typeof e[0]=="string"&&typeof last(e)=="string"}function isEventTarget(e){return"addEventListener"in e}function findLength(e){for(const r of e){if(!r)continue;const l=Meta.get(r,"length");if(l)return l}const n="At least one variable needs to be of fixed length";throw new Error(n)}function applyWith(...e){return function(n){return n(...e)}}function row(e,n){const r={};for(const[l,h]of Object.entries(e))r[l]=Getter.of(h)(n);return r}function selector(e){return function(n){return n[e]}}function keysToSelectors(e){return function(n){return e.map(r=>n[r])}}function splitNumericSuffix(e){let n=e.length-1;for(;n>0&&/[0-9]/.test(e[n]);)n--;return n+=1,[e.substring(0,n),e.substring(n,e.length)]}function filterIndices(e,n){const r=[];for(let l=0;l<e.length;l++)n(e[l])&&r.push(l);return r}function stringArraysMatch(e,n){if(e.length!==n.length)return!1;const r=e.toSorted(compareAlphaNumeric).join(""),l=n.toSorted(compareAlphaNumeric).join("");return r===l}function clearNodeChildren(e){e.innerHTML=""}const LISTENERS=Symbol("listeners"),DEFERRED=Symbol("deferred");var Reactive;(e=>{function n(){return function(o){return{...o,[LISTENERS]:{},[DEFERRED]:{}}}}e.of=n;function r(o){return o[LISTENERS]!==void 0}e.is=r;function l(o,i,s,d){d!=null&&d.throttle&&(s=throttle(s,d.throttle));const w=d!=null&&d.defer?o[DEFERRED]:o[LISTENERS];w[i]||(w[i]=[]),w[i].includes(s)||w[i].push(s)}e.listen=l;function h(o,i,s){const[d,w]=[o[LISTENERS][i],o[DEFERRED][i]];if(d)for(const u of d)u(s);if(w)for(const u of w)u(s)}e.dispatch=h;function t(o,i,s){const d=()=>e.dispatch(i,s);e.listen(o,s,d,{defer:!0})}e.propagate=t;function p(o,i){i(o),e.dispatch(o,"changed")}e.set=p;function a(o,i,s){const[d,w]=[o[LISTENERS][i],o[DEFERRED][i]];d&&remove(d,s),w&&remove(w,s)}e.remove=a;function c(o,i){const[s,d]=[o[LISTENERS][i],o[DEFERRED][i]];if(s)for(const w of s)remove(s,w);if(d)for(const w of d)remove(d,w)}e.removeAll=c;function x(o){const[i,s]=[o[LISTENERS],o[DEFERRED]];if(i)for(const d of Object.values(i))d.length=0;if(s)for(const d of Object.values(s))d.length=0}e.removeAllListeners=x})(Reactive||(Reactive={}));const METHODS=Symbol("methods");exports.Poly=void 0,(e=>{function n(h){const t=function(...p){return r(t,h,p[0].type)(...p)};return t[METHODS]={},t}e.of=n;function r(h,t,p){return h[METHODS][p]??t}e.dispatch=r;function l(h,t,p){h[METHODS][t]=p}e.set=l})(exports.Poly||(exports.Poly={})),exports.Expanse=void 0,(e=>{e.normalize=exports.Poly.of(n),e.unnormalize=exports.Poly.of(r),e.train=exports.Poly.of(l),e.breaks=exports.Poly.of(h),e.reorder=exports.Poly.of(t);function n(m,S){throw new Error(`Method 'normalize' not implemented for expanse of type '${m.type}'`)}function r(m,S){throw new Error(`Method 'unnormalize' not implemented for expanse of type '${m.type}'`)}function l(m,S,k){throw new Error(`Method 'train' not implemented for expanse of type '${m.type}'`)}e.trainDefault=l;function h(m){throw new Error(`Method 'breaks' not implemented for expanse of type '${m.type}'`)}function t(m,S){throw new Error(`Method 'reorder' not implemented for expanse of type '${m.type}'`)}function p(m){const S=(m==null?void 0:m.zero)??0,k=(m==null?void 0:m.one)??1,b=(m==null?void 0:m.direction)??1,g=[],M=[],T={zero:S,one:k,direction:b};return Reactive.of()({zero:S,one:k,direction:b,frozen:g,linked:M,defaults:T})}e.base=p;function a(m,S,k){const{linked:b,frozen:g}=m,M={...m};if(S(M),!(k!=null&&k.unfreeze))for(const T of g)delete M[T];for(const T of Object.keys(M))M[T]===m[T]&&delete M[T];copyProps(M,m);for(const T of b)e.set(T,S);k!=null&&k.default&&copyProps(M,m.defaults),k!=null&&k.silent||Reactive.dispatch(m,"changed")}e.set=a;function c(m,S){for(const k of S)m.frozen.includes(k)||m.frozen.push(k)}e.freeze=c;function x(m,S){m.linked.includes(S)||m.linked.push(S)}e.linkTo=x;function o(m){const{defaults:S}=m;for(const[k,b]of Object.entries(S))Array.isArray(b)&&Array.isArray(m[k])?copyValues(b,m[k]):m[k]=b;Reactive.dispatch(m,"changed")}e.reset=o;function i(m,S){const{direction:k}=m,b=S;e.set(m,g=>(g.zero+=k*b,g.one+=k*b))}e.move=i;function s(m,S,k,b){const{zero:g,one:M,direction:T}=m,A=M-g;T===-1&&([S,k]=[1-S,1-k]);let[O,L]=[S,k].map(j=>(j-g)/A);[O,L]=invertRange(O,L),T===-1&&([O,L]=[1-O,1-L]),e.set(m,j=>(j.zero=O,j.one=L),b)}e.expand=s;function d(m){e.set(m,S=>S.direction*=-1)}e.flip=d;function w(m){return m.one-m.zero}e.unitRange=w;function u(m){return m.type==="continuous"||m.type==="split"}e.isContinuous=u;function f(m){return m.type==="point"}e.isPoint=f;function y(m){return m.type==="point"||m.type==="band"}e.isDiscrete=y;function R(m){return m.type==="band"}e.isBand=R;function z(m){return m.type==="compound"}e.isCompound=z;function v(m){return m.type==="split"}e.isSplit=v})(exports.Expanse||(exports.Expanse={}));var ExpanseBand;(e=>{const n="band";function r(s=[],d){const w="",u=exports.Expanse.base(d),[f,y]=[!1,seqLength(0,s.length)],R=(d==null?void 0:d.weights)??Array(s.length).fill(1),z=cumsum(R),v={labels:s,ordered:f,order:y,weights:R,cumulativeWeights:z},m={ordered:f,labels:[...s],order:[...y],weights:[...R],cumulativeWeights:[...z],...u.defaults};return{value:w,type:n,...v,...u,defaults:m}}e.of=r,exports.Poly.set(exports.Expanse.normalize,n,t),exports.Poly.set(exports.Expanse.unnormalize,n,p),exports.Poly.set(exports.Expanse.train,n,a),exports.Poly.set(exports.Expanse.breaks,n,x),exports.Poly.set(exports.Expanse.reorder,n,c);function l(s,d){const{order:w,cumulativeWeights:u}=s;d=w[d];const f=u[d-1]??0,y=u[d],R=last(u);return(f+y)/2/R}function h(s,d){if(d=d??Array(s.labels.length).fill(1),d.length!=s.labels.length){const f="The length of the weights must match the length of labels";throw new Error(f)}const{order:w}=s,u=cumsum(ordered(d,w));copyValues(d,s.weights),copyValues(d,s.defaults.weights),copyValues(u,s.cumulativeWeights),copyValues(u,s.defaults.cumulativeWeights),Reactive.dispatch(s,"changed")}e.setWeights=h;function t(s,d){const{labels:w,zero:u,one:f,direction:y}=s,R=w.indexOf(d);if(R===-1)throw new Error(`Label ${d} not found in: ${w}`);const z=l(s,R),v=u+z*(f-u);return applyDirection(v,y)}e.normalize=t;function p(s,d){const{labels:w,zero:u,one:f,direction:y}=s;d=applyDirection(d,y);const R=(d-u)/(f-u),z=Math.round((2*R*w.length-1)/2);return w[z]}e.unnormalize=p;function a(s,d,w){const{order:u}=s,f=Array.from(new Set(d)).sort(compareAlphaNumeric);if(!u.length){for(let v=0;v<f.length;v++)u[v]=v;s.defaults.order=[...u],s.ordered=!1}const y=Array(f.length).fill(1),R=cumsum(ordered(y,u)),z={labels:f,weights:y,cumulativeWeights:R};for(const[v,m]of Object.entries(z))Array.isArray(s[v])&&copyValues(m,s[v]),w!=null&&w.default&&copyValues(m,s.defaults[v]);exports.Expanse.set(s,()=>{},w)}e.train=a;function c(s,d){const{order:w,weights:u,cumulativeWeights:f,defaults:y}=s;if(!d){copyValues(y.order,w),copyValues(cumsum(ordered(u,w)),f),s.ordered=!1,Reactive.dispatch(s,"changed");return}copyValues(d,w),copyValues(cumsum(ordered(u,d)),f),s.ordered=!0,Reactive.dispatch(s,"changed")}e.reorder=c;function x(s){return ordered(s.labels,s.order)}e.breaks=x;function o(){return!1}e.isContinuous=o;function i(){return!0}e.isDiscrete=i})(ExpanseBand||(ExpanseBand={}));var ExpanseContinuous;(e=>{const n="continuous";function r(c=0,x=1,o){const s=exports.Expanse.base(o),[d,w]=[identity,identity],{scale:u=1,mult:f=1,offset:y=0,ratio:R=!1}=o??{},z={min:c,max:x,scale:u,mult:f,offset:y},v={...z,...s.defaults,offset:y,trans:d,inv:w};return{value:0,type:n,ratio:R,...z,...s,trans:d,inv:w,defaults:v}}e.of=r,exports.Poly.set(exports.Expanse.normalize,n,l),exports.Poly.set(exports.Expanse.unnormalize,n,h),exports.Poly.set(exports.Expanse.train,n,t),exports.Poly.set(exports.Expanse.breaks,n,p);function l(c,x){const{min:o,max:i,zero:s,one:d}=c,{direction:w,scale:u,mult:f,offset:y,trans:R}=c,z=R(i)-R(o);let v=x/(u*f)-y;return v=(R(v-y)-R(o))/z,v=s+v*(d-s),v=applyDirection(v,w),v}e.normalize=l;function h(c,x){const{min:o,max:i,zero:s,one:d}=c,{scale:w,mult:u,offset:f,trans:y,inv:R}=c,z=y(i)-y(o);let v=(x-s)/(d-s);return v=R(y(o)+v*z),v=v*(w*u)+f,v}e.unnormalize=h;function t(c,x,o){let[i,s]=Meta.getN(x,["min","max"]);(!i||!s)&&([i,s]=minmax(x)),i=c.ratio||o!=null&&o.ratio?0:i,exports.Expanse.set(c,d=>(d.min=i,d.max=s),o)}e.train=t;function p(c,x=4){const[o,i]=[0,1].map(d=>h(c,d)).sort(diff);return prettyBreaks(o,i,x)}e.breaks=p;function a(c){const{min:x,max:o}=c;return o-x}e.range=a})(ExpanseContinuous||(ExpanseContinuous={})),exports.Scale=void 0,(e=>{function n(u,f){const y=Reactive.of()({domain:u,codomain:f});return Reactive.propagate(u,y,"changed"),Reactive.propagate(f,y,"changed"),y}e.of=n;function r(u,f){u.domain=f,Reactive.propagate(u.domain,u,"changed")}e.setDomain=r;function l(u,f){u.codomain=f,Reactive.propagate(u.codomain,u,"changed")}e.setCoomain=l;function h(u,f){const{domain:y,codomain:R}=u;return exports.Expanse.unnormalize(R,exports.Expanse.normalize(y,f))}e.pushforward=h;function t(u,f){const{domain:y,codomain:R}=u;return exports.Expanse.unnormalize(y,exports.Expanse.normalize(R,f))}e.pullback=t;function p(u,f,y,R){exports.Expanse.expand(u.domain,f,y,R)}e.expand=p;function a(u,f,y){if(((y==null?void 0:y.name)??!0)&&Meta.has(f,"name")&&Meta.copy(u,f,["name"]),typeof f[0]=="string"&&exports.Expanse.isContinuous(u.domain)){const z=Array.from(new Set(f));u.domain=ExpanseBand.of(z)}exports.Expanse.train(u.domain,f,y)}e.train=a;function c(u){exports.Expanse.reset(u.domain),exports.Expanse.reset(u.codomain)}e.restoreDefaults=c;function x(u){const f=exports.Expanse.breaks(u.domain);let y=formatAxisLabels(f);if(exports.Expanse.isCompound(u.domain)){y=formatAxisLabels(f,{decimals:1});const z=f.map(v=>exports.Expanse.unnormalize(u.codomain,ExpanseContinuous.normalize(u.domain,v)));return{labels:y,positions:z}}else if(exports.Expanse.isSplit(u.codomain)){const z=e.pushforward(u,f);return{labels:y,positions:z}}const R=f.map(z=>e.pushforward(u,z));return{labels:y,positions:R}}e.breaks=x;function o(u,f){exports.Expanse.move(u.domain,f)}e.move=o;function i(u,f){f.codomain=u.codomain}e.shareCodomain=i;function s(u){const{domain:f}=u;if(exports.Expanse.isContinuous(f))return ExpanseContinuous.range(f)/exports.Expanse.unitRange(f)}e.domainRange=s;function d(u){const{codomain:f}=u;if(exports.Expanse.isContinuous(f))return ExpanseContinuous.range(f)*exports.Expanse.unitRange(f)}e.codomainRange=d;function w(u){const{domain:f,codomain:y}=u;if(!exports.Expanse.isContinuous(f)||!exports.Expanse.isContinuous(y))throw new Error("Both domain and codomain need to be continuous");const R=ExpanseContinuous.range(f);return ExpanseContinuous.range(y)*exports.Expanse.unitRange(y)/R}e.unitRatio=w})(exports.Scale||(exports.Scale={}));var DOM;(e=>{function n(a,c){const x=document.createElement(a);return c!=null&&c.id&&(x.id=c.id),c!=null&&c.classes&&t(x,c.classes),c!=null&&c.textContent&&(x.textContent=c.textContent),x}e.element=n;function r(a,c){a.appendChild(c)}e.append=r;function l(a,c){return a.querySelector(c)}e.select=l;function h(a,c){for(const[x,o]of Object.entries(c))a.style[x]=o}e.setStyles=h;function t(a,c){for(const x of c)a.classList.add(x)}e.addClasses=t;function p(a,c){for(const x of c)a.classList.remove(x)}e.removeClasses=p})(DOM||(DOM={}));var VAnchor=(e=>(e[e.Middle=.5]="Middle",e[e.Top=1]="Top",e[e.Bottom=0]="Bottom",e))(VAnchor||{}),HAnchor=(e=>(e[e.Center=.5]="Center",e[e.Left=1]="Left",e[e.Right=0]="Right",e))(HAnchor||{}),MouseButton=(e=>(e[e.Left=0]="Left",e[e.Right=2]="Right",e))(MouseButton||{});const dataLayers=[0,1,2,3,4,5,6,7],baseLayers=[4,5,6,7];var Frame;(e=>{function n(v){const m=DOM.element("canvas"),S=m.getContext("2d");DOM.addClasses(m,tw(v.classes??""));for(const[Y,W]of Object.entries(v.canvasStyles??{}))m.style[Y]=W;const{clientWidth:k,clientHeight:b,clientLeft:g,clientTop:M}=m,T=k-g,A=b-M,O=2,{margins:L=[0,0,0,0],contextProps:j={}}=v;return{canvas:m,context:S,width:T,height:A,margins:L,scalingFactor:O,contextProps:j}}e.of=n;function r(v,m){m.appendChild(v.canvas),v.parent=m,e.resize(v)}e.append=r;function l(v,m){for(const[S,k]of Object.entries(m))v.contextProps[S]=k,v.context[S]=k}e.setContext=l;function h(v){const{context:m,canvas:S,scalingFactor:k}=v,{clientWidth:b,clientHeight:g,clientLeft:M,clientTop:T}=S,A=b-M,O=g-T;v.width=A,v.height=O,v.canvas.width=A*k,v.canvas.height=O*k;for(const[L,j]of Object.entries(v.contextProps))v.context[L]=j;m.scale(k,k),e.clip(v)}e.resize=h;function t(v){const{context:m}=v;let{width:S,height:k}=v;const[b,g,M,T]=v.margins;S=Math.max(S-g-T,0),k=Math.max(k-M-b,0),m.beginPath(),m.rect(g,M,S,k),m.clip()}e.clip=t;function p(v){v.context.clearRect(0,0,v.width,v.height)}e.clear=p;function a(v,m){v.context.globalAlpha=m(v.context.globalAlpha)}e.setAlpha=a;function c(v){v.context.globalAlpha=1}e.resetAlpha=c;function x(v,m){return v.context.measureText(m).width}e.textWidth=x;function o(v,m){const S=v.context.measureText(m);return S.actualBoundingBoxAscent+S.actualBoundingBoxDescent}e.textHeight=o;function i(v,m,S,k,b){const{context:g}=v,M=v.canvas.clientHeight,T=(b==null?void 0:b.hAnchor)??HAnchor.Center,A=(b==null?void 0:b.vAnchor)??VAnchor.Middle;m=m+2*(T-.5)*k,S=M-S+2*(.5-A)*k,g.beginPath(),g.arc(m,S,k,0,Math.PI*2),g.fill()}e.point=i;function s(v,m,S,k,b){for(let g=0;g<m.length;g++)i(v[g],m[g],S[g],k[g],b)}e.points=s;function d(v,m,S,k,b,g){const{context:M,height:T}=v,A=k-m,O=b-S;m=m+(1-g)/2*A,k=k-(1-g)/2*A,S=S+(1-g)/2*O,b=b-(1-g)/2*O,M.fillRect(m,T-S,k-m,S-b)}e.rectangleXY=d;function w(v,m,S,k,b,g){for(let M=0;M<m.length;M++)d(v[M],m[M],S[M],k[M],b[M],g[M])}e.rectanglesXY=w;function u(v,m,S,k,b,g){const{context:M,height:T}=v,A=(g==null?void 0:g.hAnchor)??HAnchor.Center,O=(g==null?void 0:g.vAnchor)??VAnchor.Middle;m=m-A*k,S=T-S+O*b,M.fillRect(m,S,k,-b)}e.rectangleWH=u;function f(v,m,S,k,b,g){for(let M=0;M<m.length;M++)u(v[M],m[M],S[M],k[M],b[M],g)}e.rectanglesWH=f;function y(v,m,S){const{context:k,height:b}=v;k.beginPath(),k.moveTo(m[0],b-S[0]);for(let g=0;g<m.length;g++)k.lineTo(m[g],b-S[g]);k.stroke()}e.line=y;function R(v,m,S){for(let k=0;k<m.length;k++)y(v[k],m[k],S[k])}e.lines=R;function z(v,m,S,k,b){const{context:g,height:M}=v;g.save(),g.translate(m,M-S),b!=null&&b.vertical&&g.rotate(-Math.PI/2),g.fillText(k,0,0),g.translate(-m,-(M-S)),g.restore()}e.text=z})(Frame||(Frame={}));const POSITIONS=Symbol("positions");exports.Factor=void 0,(e=>{(o=>{o[o.Constant=0]="Constant",o[o.Bijection=1]="Bijection",o[o.Surjection=2]="Surjection"})(e.Type||(e.Type={}));function n(o,i,s,d){return Reactive.of()({type:o,cardinality:i,indices:s,data:d})}e.of=n;function r(o,i){i.cardinality=o.cardinality,copyValues(o.indices,i.indices);for(const s of Reflect.ownKeys(o.data))Array.isArray(o.data[s])&&Array.isArray(i.data[s])?(copyValues(o.data[s],i.data[s]),Meta.copy(i.data[s],o.data[s])):i.data[s]=o.data[s]}e.copyFrom=r;function l(o,i){if([o,i].some(s=>s.type===1))return!0;if(o.indices.length!==i.indices.length)throw new Error("Factors do not have matching length")}function h(o){const s=new Uint32Array,d=f=>[f],w=1,u={...o,[POSITIONS]:d};return n(w,1/0,s,u)}e.bijection=h;function t(o){const s=new Uint32Array(o).fill(0),d=()=>Array.from(s),w=0,u={[POSITIONS]:d};return n(w,1,s,u)}e.mono=t;function p(o,i){const s=o.map(y=>y.toString());i=i??Array.from(new Set(s)).sort(compareAlphaNumeric),Meta.has(o,"name")&&Meta.copy(i,o,["name"]);const d=new Uint32Array(o.length),w={};for(let y=0;y<s.length;y++){const R=i.indexOf(s[y]);w[R]||(w[R]=[]),d[y]=R,w[R].push(y)}const u=2,f={label:i,[POSITIONS]:Object.values(w)};return n(u,i.length,d,f)}e.from=p;function a(o,i){function s(){const w=(i==null?void 0:i.breaks)??binBreaks(o,i),u=new Set,f=new Uint32Array(o.length),y={};for(let g=0;g<o.length;g++){const M=w.findIndex(T=>T>=o[g])-1;y[M]||(y[M]=[]),f[g]=M,y[M].push(g),u.add(M)}const R=Array.from(u).sort(diff);for(let g=0;g<f.length;g++)f[g]=R.indexOf(f[g]);const[z,v]=[[],[]];for(let g=0;g<R.length;g++)z.push(w[R[g]]),v.push(w[R[g]+1]);const[m,S]=[w[R[0]],w[last(R)+1]];Meta.setN(z,["min","max"],[m,S]),Meta.setN(v,["min","max"],[m,S]),Meta.set(z,"name",`min of ${Meta.get(o,"name")}`),Meta.set(v,"name",`max of ${Meta.get(o,"name")}`),Meta.copy(w,o,["name"]);const k=2,b={binMin:z,binMax:v,breaks:w,[POSITIONS]:Object.values(y)};return n(k,R.length,f,b)}const d=s();return i&&Reactive.is(i)&&Reactive.listen(i,"changed",()=>{const w=s();e.copyFrom(w,d),Reactive.dispatch(d,"changed")}),d}e.bin=a;function c(o,i){l(o,i);function s(){if(o.type===1){const A={};for(const W of Reflect.ownKeys(o.data))A[W]=Getter.of(o.data[W]);for(const W of Reflect.ownKeys(i.data))A[W]=Getter.proxy(i.data[W],i.indices);const O=1,L=i.indices.length,j=new Uint32Array(o.indices.length),Y=n(O,L,j,A);return Y.parent=o,Y}if(o.type===0){const{type:A,data:O,cardinality:L,indices:j}=i,Y=n(A,L,j,O);return Y.parent=o,Y}const w=Math.max(o.cardinality,i.cardinality)+1,u=new Set,f=new Uint32Array(o.indices.length),y={},R={},z={},v=Getter.of(o.indices),m=Getter.of(i.indices);for(let A=0;A<o.indices.length;A++){const[O,L]=[v(A),m(A)],j=w*O+L;j in R||(R[j]=O,z[j]=L,y[j]=[]),f[A]=j,y[j].push(A),u.add(j)}const S=Array.from(u).sort(diff);for(let A=0;A<f.length;A++)f[A]=S.indexOf(f[A]);const k=Object.values(R),b=Object.values(z),g={};for(let A of Reflect.ownKeys(o.data)){let O=A;if(typeof A=="string")for(;O in g;)A+="$";const[L,j]=[o.data[A],k],Y=Array.isArray(L)?subset(L,j):Getter.proxy(L,j);Meta.copy(Y,L),g[O]=Y}for(let A of Reflect.ownKeys(i.data)){let O=A;if(typeof A=="string")for(;O in g;)O+="$";const[L,j]=[i.data[A],b],Y=Array.isArray(L)?subset(L,j):Getter.proxy(L,j);Meta.copy(Y,L),g[O]=Y}const M=2;g[POSITIONS]=Object.values(y);const T=n(M,S.length,f,g);return T.parent=o,T}const d=s();return Reactive.listen(o,"changed",()=>{const w=s();e.copyFrom(w,d)}),Reactive.listen(i,"changed",()=>{const w=s();e.copyFrom(w,d)}),Reactive.propagate(o,d,"changed"),Reactive.propagate(i,d,"changed"),d}e.product=c;function x(o,i){const s={};for(let d=0;d<i.indices.length&&(s[i.indices[d]]=o.indices[d],!(Object.keys(s).length>=i.cardinality));d++);return Object.values(s)}e.parentIndices=x})(exports.Factor||(exports.Factor={}));const Transient=255;var Group=(e=>(e[e.Base=7]="Base",e[e.First=6]="First",e[e.Second=5]="Second",e[e.Third=4]="Third",e[e.BaseTransient=3]="BaseTransient",e[e.FirstTransient=2]="FirstTransient",e[e.SecondTransient=1]="SecondTransient",e[e.ThirdTransient=0]="ThirdTransient",e))(Group||{}),Marker;(e=>{function n(o){const i=Transient,s=new Uint32Array(o).fill(7),d=[],w=exports.Factor.Type.Surjection,u=exports.Factor.of(w,8,s,{[LAYER]:[0,1,2,3,4,5,6,7]}),f=Reactive.of()({group:i,indices:s,transientIndices:d,factor:u});return Reactive.listen(f,"updated",()=>Reactive.dispatch(u,"changed")),Reactive.listen(f,"cleared",()=>Reactive.dispatch(u,"changed")),f}e.of=n;function r(o,i){o.group=i}e.setGroup=r;function l(o,i,s){const d=(s==null?void 0:s.group)??o.group;if(t(o,{silent:!0}),d===Transient){for(let w=0;w<i.length;w++){const u=i[w];o.indices[u]=c(o.indices[u])}o.transientIndices=i}else for(let w=0;w<i.length;w++){const u=i[w];o.indices[u]=d}s!=null&&s.silent||Reactive.dispatch(o,"updated")}e.update=l;function h(o,i){for(let s=0;s<o.indices.length;s++)o.indices[s]=7;i!=null&&i.silent||Reactive.dispatch(o,"cleared")}e.clearAll=h;function t(o,i){for(let s=0;s<o.transientIndices.length;s++){const d=o.transientIndices[s];o.indices[d]=x(o.indices[d])}i!=null&&i.silent||Reactive.dispatch(o,"cleared")}e.clearTransient=t;function p(o){const{factor:i,indices:s}=o;return d=>i.data[LAYER][s[d]]}e.getLayer=p;function a(o){return!(o&4)}e.isTransient=a;function c(o){return o&-5}function x(o){return o|4}})(Marker||(Marker={}));const LAYER=Symbol("layer");var Bars;(e=>{function n(t){const p={},a=[],c=Geom.Type.Bars,x=(t==null?void 0:t.vAnchor)??VAnchor.Bottom,o=(t==null?void 0:t.hAnchor)??HAnchor.Center;return{type:c,data:a,scales:p,vAnchor:x,hAnchor:o}}e.of=n;function r(t,p){const{scales:a,hAnchor:c,vAnchor:x}=t,o=Geom.groupedData(t),i=findLength(Object.values(o)),[s,d,w,u]=Geom.scaledArrays(i,[[o.x,a.x],[o.y,a.y],[o.width,a.width],[o.height,a.height]]),f=Geom.frames(i,o[LAYER],p);Frame.rectanglesWH(f,s,d,w,u,{hAnchor:c,vAnchor:x})}e.render=r;function l(t,p){const{scales:a,hAnchor:c,vAnchor:x}=t,o=Geom.flatData(t),i=findLength(Object.values(o)),{x:s,y:d,width:w,height:u}=Getter.mapObject(o),f=Getter.of(o[POSITIONS]),y=[];for(let R=0;R<i;R++){let z=exports.Scale.pushforward(a.x,s(R)),v=exports.Scale.pushforward(a.y,d(R)),m=exports.Scale.pushforward(a.width,w(R)),S=exports.Scale.pushforward(a.height,u(R));[z,v,m,S]=[z,v,m,S];const b=[z-m*c,v-S*x,z+m*c,v+S*(1-x)];if(rectsIntersect(p,b)){const g=f(R);for(let M=0;M<g.length;M++)y.push(g[M])}}return y}e.check=l;function h(t,p){const{scales:a,hAnchor:c,vAnchor:x}=t,o=Geom.flatData(t),i=findLength(Object.values(o)),{x:s,y:d,width:w,height:u}=Getter.mapObject(o);for(let f=0;f<i;f++){let y=exports.Scale.pushforward(a.x,s(f)),R=exports.Scale.pushforward(a.y,d(f)),z=exports.Scale.pushforward(a.width,w(f)),v=exports.Scale.pushforward(a.height,u(f));[y,R,z,v]=[y,R,z,v];const S=[y-z*c,R-v*x,y+z*c,R+v*(1-x)];if(pointInRect(p,S)){const k={};Meta.has(o.x,"name")&&(k[Meta.get(o.x,"name")]=s(f)),Meta.has(o.y,"name")&&(k[Meta.get(o.y,"name")]=d(f)),Meta.has(o.height,"name")&&(k[Meta.get(o.height,"name")]=u(f));for(const[b,g]of Object.entries(o))["x","y","width","height"].includes(b)||g&&Meta.has(g,"name")&&(k[Meta.get(g,"name")]=Geom.getter(g)(f));return k}}}e.query=h})(Bars||(Bars={}));var Lines;(e=>{function n(){const t={},p=[];return{type:Geom.Type.Lines,data:p,scales:t}}e.of=n;function r(t,p){const{scales:a}=t,c=Geom.groupedData(t),x=findLength(Object.values(c)),[o,i]=Geom.scaledArrays(x,[[c.x,a.x],[c.y,a.y]]),s=Geom.frames(x,c[LAYER],p);Frame.lines(s,o,i)}e.render=r;function l(t,p){const{scales:a}=t,c=Geom.flatData(t),x=findLength(Object.values(c)),{x:o,y:i}=Getter.mapObject(c),s=Getter.of(c[POSITIONS]),d=[];for(let w=0;w<x;w++){const u=exports.Scale.pushforward(a.x,o(w)),f=exports.Scale.pushforward(a.y,i(w));for(let y=1;y<u.length;y++){const R=[u[y-1],f[y-1],u[y],f[y]];if(rectSegmentIntersect(p,R)){const z=s(w);for(let v=0;v<z.length;v++)d.push(z[v])}}}return d}e.check=l;function h(t,p){let{scales:a}=t;const c=Geom.flatData(t),x=findLength(Object.values(c)),{x:o,y:i}=Getter.mapObject(c),s=bimap([...p,...p],[-1,-1,1,1],sum);for(let d=0;d<x;d++){const w=exports.Scale.pushforward(a.x,o(d)),u=exports.Scale.pushforward(a.y,i(d));for(let f=1;f<w.length;f++){const y=[w[f-1],u[f-1],w[f],u[f]];if(rectSegmentIntersect(s,y)){const R={},[z,v]=[o(d),i(d)];for(let m=0;m<z.length;m++)R[z[m]]=v[m];for(const[m,S]of Object.entries(c))m==="x"||m==="y"||S&&Meta.has(S,"name")&&(R[Meta.get(S,"name")]=Geom.getter(S)(d));return R}}}}e.query=h})(Lines||(Lines={}));var Points;(e=>{function n(){const t={},p=[];return{type:Geom.Type.Points,data:p,scales:t}}e.of=n;function r(t,p){const{scales:a}=t,c=Geom.groupedData(t),x=findLength(Object.values(c)),[o,i,s]=Geom.scaledArrays(x,[[c.x,a.x],[c.y,a.y],[c.size,a.size]]),d=Geom.frames(x,c[LAYER],p);Frame.points(d,o,i,s)}e.render=r;function l(t,p){const{scales:a}=t,c=Geom.flatData(t),x=findLength(Object.values(c)),{x:o,y:i,size:s}=Getter.mapObject(c),d=Getter.of(c[POSITIONS]),w=[];for(let u=0;u<x;u++){const f=exports.Scale.pushforward(a.x,o(u)),y=exports.Scale.pushforward(a.y,i(u));let R=exports.Scale.pushforward(a.size,s(u));R=R/Math.sqrt(2);const z=[f-R,y-R,f+R,y+R];if(rectsIntersect(p,z)){const v=d(u);for(let m=0;m<v.length;m++)w.push(v[m])}}return w}e.check=l;function h(t,p){const{scales:a}=t,c=Geom.flatData(t),x=findLength(Object.values(c)),{x:o,y:i,size:s}=Getter.mapObject(c);for(let d=0;d<x;d++){const w=exports.Scale.pushforward(a.x,o(d)),u=exports.Scale.pushforward(a.y,i(d));let f=exports.Scale.pushforward(a.size,s(d));f=f/Math.sqrt(2);const y=[w-f,u-f,w+f,u+f];if(pointInRect(p,y)){const R={};R[Meta.get(c.x,"name")]=o(d),R[Meta.get(c.y,"name")]=i(d);for(const[z,v]of Object.entries(c))z==="x"||z==="y"||v&&Meta.has(v,"name")&&(R[Meta.get(v,"name")]=Geom.getter(v)(d));return R}}}e.query=h})(Points||(Points={}));var Rectangles;(e=>{function n(){const t={},p=[];return{type:Geom.Type.Rectangles,data:p,scales:t}}e.of=n;function r(t,p){const{scales:a}=t,c=Geom.groupedData(t),x=findLength(Object.values(c)),[o,i,s,d,w]=Geom.scaledArrays(x,[[c.x0,a.x],[c.y0,a.y],[c.x1,a.x],[c.y1,a.y],[c.area,a.areaPct]]),u=Geom.frames(x,c[LAYER],p);Frame.rectanglesXY(u,o,i,s,d,w)}e.render=r;function l(t,p){const{scales:a}=t,c=Geom.flatData(t),x=findLength(Object.values(c)),{x0:o,y0:i,x1:s,y1:d,area:w}=Getter.mapObject(c),u=Getter.of(c[POSITIONS]),f=[];for(let y=0;y<x;y++){let R=exports.Scale.pushforward(a.x,o(y)),z=exports.Scale.pushforward(a.y,i(y)),v=exports.Scale.pushforward(a.x,s(y)),m=exports.Scale.pushforward(a.y,d(y));if(c.area){const S=exports.Scale.pushforward(a.areaPct,w(y)),k=v-R,b=m-z;R=R+(1-S)/2*k,v=v-(1-S)/2*k,z=z+(1-S)/2*b,m=m-(1-S)/2*b}if(rectsIntersect(p,[R,z,v,m])){const S=u(y);for(let k=0;k<S.length;k++)f.push(S[k])}}return f}e.check=l;function h(t,p){const{scales:a}=t,c=Geom.flatData(t),x=findLength(Object.values(c)),{x0:o,y0:i,x1:s,y1:d,area:w}=Getter.mapObject(c);for(let u=0;u<x;u++){let f=exports.Scale.pushforward(a.x,o(u)),y=exports.Scale.pushforward(a.y,i(u)),R=exports.Scale.pushforward(a.x,s(u)),z=exports.Scale.pushforward(a.y,d(u));if(c.area){const v=exports.Scale.pushforward(a.areaPct,w(u)),m=R-f,S=z-y;f=f+(1-v)/2*m,R=R-(1-v)/2*m,y=y+(1-v)/2*S,z=z-(1-v)/2*S}if(pointInRect(p,[f,y,R,z])){const v={};for(const m of Object.values(c))m&&Meta.has(m,"name")&&(v[Meta.get(m,"name")]=Geom.getter(m)(u));return v}}}e.query=h})(Rectangles||(Rectangles={}));var Geom;(e=>{(i=>{i[i.Points=0]="Points",i[i.Bars=1]="Bars",i[i.Rectangles=2]="Rectangles",i[i.Lines=3]="Lines"})(e.Type||(e.Type={}));const n={0:Points,1:Bars,2:Rectangles,3:Lines};function r(i){return i.data[i.data.length-2]}e.flatData=r;function l(i){return i.data[i.data.length-1]}e.groupedData=l;function h(i,s=()=>.5){return Getter.of(i??s)}e.getter=h;function t(i,s,d=()=>.5){return s.map(w=>e.getter(i[w],d))}e.getters=t;function p(i,s,d){const[w,u]=[Array(i),Getter.of(s)];for(let f=0;f<i;f++)w[f]=d[u(f)];return w}e.frames=p;function a(i,s){const d=[];for(const[w,u]of s){const f=Array(i),y=Getter.of(w??1);for(let R=0;R<i;R++)f[R]=exports.Scale.pushforward(u,y(R));d.push(f)}return d}e.scaledArrays=a;function c(i,s){n[i.type].render(i,s)}e.render=c;function x(i,s){return n[i.type].check(i,s)}e.check=x;function o(i,s){return n[i.type].query(i,s)}e.query=o})(Geom||(Geom={}));const PARENT=Symbol("parent"),VALUES=Symbol("values"),INDICES=Symbol("indices"),FACTOR=Symbol("factor"),REDUCER=Symbol("reducer");var Reduced;(e=>{function n(s,d,w,u){const f=s;return f[VALUES]=s,f[FACTOR]=d,f[REDUCER]=w,u&&r(f,u),f}e.of=n;function r(s,d){s[PARENT]=d}e.setParent=r;function l(s){const[,d,w,u]=i(s);if(!u)throw new Error("Parent missing");const f=exports.Factor.parentIndices(a(u),d),y=subset(u,f),R=n(y,a(u),w,c(u));return x(R,u),o(R,f),Meta.copy(R,s,["name"]),R}e.parent=l;function h(s){const[d,w,u,f,y]=i(s);if(!f)throw new Error("Cannot stack a without a parent");const R=exports.Factor.parentIndices(a(f),w),{reducefn:z,initialfn:v}=u,[m,S]=[d.length,[]],k=Array.from(Array(m),()=>v()),b=Getter.of(R);for(let T=0;T<d.length;T++){const A=b(T);S[A]===void 0&&(S[A]=v()),S[A]=z(S[A],d[T]),k[T]=S[A]}const g=y?subset(k,y):k,M=e.of(g,w,u,f);return x(M,k),y&&o(M,y),Meta.copy(M,s,["name"]),M}e.stack=h;function t(s,d){const[w,u,f,y,R]=i(s);if(!y)throw new Error("Cannot normalize a without a parent");const z=exports.Factor.parentIndices(a(y),u),v=subset(y,z),m=[...w];for(let b=0;b<s.length;b++)m[b]=d(m[b],v[b]);const S=R?subset(m,R):m,k=e.of(S,u,f,y);return x(k,m),R&&o(k,R),Meta.copy(k,s,["name"]),k}e.normalize=t;function p(s){const[d,w,u,f,y]=i(s),R=[];R.push(u.initialfn());for(let m=0;m<d.length-1;m++)R.push(d[m]);const z=y?subset(R,y):R,v=e.of(z,w,u,f);return x(v,R),y&&o(v,y),Meta.copy(v,s,["name"]),v}e.shiftLeft=p;function a(s){return s[FACTOR]}function c(s){return s[PARENT]}e.getParent=c;function x(s,d){s[VALUES]=d}function o(s,d){s[INDICES]=d}function i(s){return[s[VALUES],s[FACTOR],s[REDUCER],s[PARENT],s[INDICES]]}})(Reduced||(Reduced={})),exports.Reducer=void 0,(Reducer=>{Reducer.sum={name:"sum",fallback:"count",initialfn:()=>0,reducefn:(e,n)=>e+n},Reducer.max={name:"max",initialfn:()=>-1/0,reducefn:(e,n)=>Math.max(e,n)},Reducer.product={name:"product",initialfn:()=>1,reducefn:(e,n)=>e*n},Reducer.table={name:"table",initialfn:()=>({}),reducefn:(e,n)=>(e[n]=e[n]+1||0,e)};function parse(value){if(typeof value=="string")return Reducer[value];if(typeof value.initialfn=="string"&&typeof value.reducefn=="string"){const parsed={name:value.name};return parsed.initialfn=eval(value.initialfn),parsed.reducefn=eval(value.reducefn),parsed}return value}Reducer.parse=parse;function reduce(e,n,r){const{indices:l,cardinality:h}=n,{initialfn:t,reducefn:p}=r,a=Array.from(Array(h),()=>t()),c=Getter.of(l),x=Getter.of(e);for(let i=0;i<l.length;i++){const s=c(i);a[s]=p(a[s],x(i))}const o=Reduced.of(a,n,r);return Meta.copy(o,e),Meta.set(o,"name",getName(a,r)??"[unknown summary]"),o}Reducer.reduce=reduce;function getName(e,n){return Meta.has(e,"name")?`${n.name} of ${Meta.get(e,"name")}`:n.fallback}Reducer.getName=getName})(exports.Reducer||(exports.Reducer={}));var Summaries;(e=>{function n(t,p){const a=[];for(let c=0;c<p.length;c++){const x=p[c],o=r(t,x),i=Reactive.of()(merge(o,x.data));if(a.push(i),c>0)for(const s of Object.keys(o)){const d=a[c-1][s];Reduced.setParent(o[s],d)}Reactive.listen(x,"changed",()=>{const s=r(t,x);for(const d of Object.keys(s))copyValues(s[d],o[d])}),Reactive.propagate(x,i,"changed")}return a}e.of=n;function r(t,p){const a={};for(const[c,x]of Object.entries(t)){const[o,i]=x;a[c]=exports.Reducer.reduce(o,p,i)}return a}function l(t,p){const a=[];for(let c=0;c<t.length;c++){let x=function(i){const s=p[c](i),d=Reflect.ownKeys(i);for(const w of d)(typeof w=="symbol"||isIntegerString(w))&&(s[w]=i[w]);return s};const o=Reactive.of()(x(t[c]));a.push(o),Reactive.listen(t[c],"changed",()=>{const i=x(t[c]);for(const s of Reflect.ownKeys(i))Array.isArray(i[s])&&Array.isArray(o[s])&&copyValues(i[s],o[s]);Reactive.dispatch(o,"changed")})}return a}e.translate=l;function h(t,p){const a={};let c=0;for(const[x,o]of t)a[`q${c++}`]=[x(p),o];return a}e.formatQueries=h})(Summaries||(Summaries={}));function Barplot(e,n,r){const{data:l,marker:h}=e;let[t,p]=n(l);const a=p&&(r!=null&&r.reducer)?r.reducer:exports.Reducer.sum,c=p||(()=>1),x=exports.Factor.from(t),o=exports.Factor.product(x,h.factor),i=[x,o],s=r!=null&&r.queries?r.queries(l):{},d=Summaries.of({stat:[c,a],...s},i),w=[],u=0,f={type:"bar",scales:{x:"band"}},y={representation:u,...exports.Plot.of(f),summaries:d,coordinates:w};return Reactive.listen(y,"normalize",()=>switchRepresentation$3(y)),barplot(y),exports.Plot.addGeom(y,Bars.of()),y}function sortAxis(e,n){if(e.ordered)ExpanseBand.reorder(e);else{const r=orderIndices(n);ExpanseBand.reorder(e,r)}}function switchRepresentation$3(e){e.representation===0?spineplot(e):barplot(e)}function barplot(e){const{summaries:n,scales:r}=e,l=Summaries.translate(n,[a=>({x:a.label,y:zero,height:a.stat,width:one}),a=>({x:a.label,y:zero,height:Reduced.stack(a.stat),width:one})]),[h]=l,t={default:!0,ratio:!0};exports.Scale.train(r.x,h.x,t),exports.Scale.train(r.y,h.height,t),exports.Scale.train(r.width,[0,1],t),exports.Scale.train(r.height,h.height,t),exports.Expanse.freeze(r.y.domain,["zero"]),exports.Expanse.freeze(r.height.domain,["zero"]),ExpanseBand.setWeights(r.x.domain);const p=1/new Set(h.x).size;exports.Expanse.linkTo(r.y.domain,r.height.domain),exports.Expanse.set(r.width.codomain,a=>{a.scale=p,a.mult=.9,a.offset=0},{default:!0}),Meta.copy(r.y,h.height,["name"]),Reactive.removeAll(e,"reorder"),Reactive.listen(e,"reorder",()=>sortAxis(r.x.domain,h.height)),e.representation=0,exports.Plot.setData(e,l),exports.Plot.render(e),exports.Plot.renderAxes(e)}function spineplot(e){const{summaries:n,scales:r}=e,l=Summaries.translate(n,[p=>({x:p.label,y:zero,height:one,width:p.stat}),p=>({x:p.label,y:zero,height:Reduced.normalize(Reduced.stack(p.stat),(a,c)=>a/c),width:Reduced.parent(p.stat)})]),[h]=l,t={default:!0,ratio:!0};exports.Scale.train(r.x,h.x,t),exports.Scale.train(r.y,[0,1],t),exports.Scale.train(r.width,cumsum(h.width),t),exports.Scale.train(r.height,[0,1],t),exports.Expanse.freeze(r.y.domain,["zero"]),exports.Expanse.freeze(r.height.domain,["zero"]),ExpanseBand.setWeights(r.x.domain,h.width),exports.Expanse.linkTo(r.y.domain,r.height.domain),exports.Expanse.set(r.width.codomain,p=>{p.scale=1,p.mult=1,p.offset=-1},{default:!0}),Meta.set(r.y,"name","proportion"),Reactive.removeAll(e,"reorder"),Reactive.listen(e,"reorder",()=>sortAxis(r.x.domain,h.width)),e.representation=1,exports.Plot.setData(e,l),exports.Plot.render(e),exports.Plot.renderAxes(e)}function Fluctuationplot(e,n,r){const{data:l,marker:h}=e;let[t,p,a]=n(l);const c=a&&(r!=null&&r.reducer)?r.reducer:exports.Reducer.sum,x=a?[...a]:()=>1,o=exports.Factor.product(exports.Factor.from(t),exports.Factor.from(p)),i=exports.Factor.product(o,h.factor),s=[o,i],d=Summaries.formatQueries((r==null?void 0:r.queries)??[],l),w=Summaries.of({stat:[x,c],...d},s),u=[],f=0,y={type:"fluct",scales:{x:"band",y:"band"}},R={representation:f,...exports.Plot.of(y),summaries:w,coordinates:u};return exports.Scale.shareCodomain(R.scales.area,R.scales.width),exports.Scale.shareCodomain(R.scales.area,R.scales.height),Reactive.listen(R,"normalize",()=>switchRepresentation$2(R)),fluctplot(R),exports.Plot.addGeom(R,Bars.of({vAnchor:VAnchor.Middle})),R}function switchRepresentation$2(e){e.representation===0?pctfluctplot(e):fluctplot(e)}function fluctplot(e){const{summaries:n,scales:r}=e,l=Summaries.translate(n,[a=>({x:a.label,y:a.label$,height:a.stat,width:a.stat}),a=>({x:a.label,y:a.label$,height:Reduced.stack(a.stat),width:Reduced.stack(a.stat)})]),[h]=l,t={default:!0,ratio:!0};exports.Scale.train(r.x,h.x,t),exports.Scale.train(r.y,h.y,t),exports.Scale.train(r.width,h.width,t),exports.Scale.train(r.height,h.height,t);const p=max(new Set(h.x).size,new Set(h.y).size);exports.Expanse.set(r.area.codomain,a=>{a.scale=1/p,a.mult=.9,a.offset=0},{default:!0}),exports.Plot.setData(e,l),e.representation=0,exports.Plot.render(e)}function pctfluctplot(e){const{summaries:n,scales:r}=e,l=Summaries.translate(n,[a=>({x:a.label,y:a.label$,height:one,width:one}),a=>({x:a.label,y:a.label$,height:Reduced.normalize(Reduced.stack(a.stat),(c,x)=>c/x),width:Reduced.normalize(Reduced.stack(a.stat),(c,x)=>c/x)})]),[h]=l,t={default:!0,ratio:!0};exports.Scale.train(r.x,h.x,t),exports.Scale.train(r.y,h.y,t),exports.Scale.train(r.width,[0,1],t),exports.Scale.train(r.height,[0,1],t);const p=max(new Set(h.x).size,new Set(h.y).size);exports.Expanse.set(r.area.codomain,a=>{a.scale=1/p,a.mult=.9,a.offset=-1},{default:!0}),exports.Plot.setData(e,l),e.representation=1,exports.Plot.render(e)}function Histogram(e,n,r){const{data:l,marker:h}=e;let[t,p]=n(l);const a=p&&(r!=null&&r.reducer)?r.reducer:exports.Reducer.sum,c=p||(()=>1),[x,o]=minmax(t),i=o-x,s=Reactive.of()({anchor:x,width:i/15}),d=exports.Factor.mono(t.length),w=exports.Factor.product(d,exports.Factor.bin(t,s)),u=exports.Factor.product(w,h.factor),f=[d,w,u],y=r!=null&&r.queries?r.queries(l):{},R=Summaries.of({stat:[c,a],...y},f),z=0,v=[],m={type:"histo"},S={representation:z,...exports.Plot.of(m),summaries:R,coordinates:v};Reactive.listen(S,"normalize",()=>switchRepresentation$1(S));const k=i/10;return Reactive.listen(S,"set-parameters",b=>{b&&(b.width&&Reactive.set(s,g=>g.width=b.width),b.anchor&&Reactive.set(s,g=>g.anchor=b.anchor))}),Reactive.listen(S,"grow",()=>Reactive.set(s,b=>b.width*=1.1111111111111112)),Reactive.listen(S,"shrink",()=>Reactive.set(s,b=>b.width*=.9)),Reactive.listen(S,"increment-anchor",()=>Reactive.set(s,b=>b.anchor+=k)),Reactive.listen(S,"decrement-anchor",()=>Reactive.set(s,b=>b.anchor-=k)),Reactive.listen(S,"reset",()=>{Reactive.set(s,b=>(b.anchor=x,b.width=i/15))}),histogram(S),exports.Plot.addGeom(S,Rectangles.of()),S}function switchRepresentation$1(e){e.representation===0?spinogram(e):histogram(e)}function histogram(e){const{summaries:n}=e,r=Summaries.translate(n,[t=>t,t=>({x0:t.binMin,y0:zero,x1:t.binMax,y1:t.stat}),t=>({x0:t.binMin,y0:zero,x1:t.binMax,y1:Reduced.stack(t.stat)})]),{scales:l}=e,[,h]=r;exports.Scale.train(l.x,h.x1,{default:!0,name:!1}),exports.Scale.train(l.y,h.y1,{default:!0,ratio:!0});for(const t of e.data)Reactive.removeAll(t,"changed");Reactive.listen(h,"changed",()=>{exports.Scale.train(l.x,h.x1,{default:!0,name:!1}),exports.Scale.train(l.y,h.y1,{default:!0,ratio:!0})}),exports.Expanse.freeze(l.y.domain,["zero"]),Meta.copy(l.x,n[1].breaks,["name"]),Meta.copy(l.y,h.y1,["name"]),e.representation=0,exports.Plot.setData(e,r),exports.Plot.render(e),exports.Plot.renderAxes(e)}function spinogram(e){const{summaries:n}=e,r=Summaries.translate(n,[t=>t,t=>({x0:Reduced.shiftLeft(Reduced.stack(t.stat)),y0:zero,x1:Reduced.stack(t.stat),y1:one,query1:t.binMin,query2:t.binMax}),t=>({x0:Reduced.shiftLeft(Reduced.stack(Reduced.parent(t.stat))),y0:zero,x1:Reduced.stack(Reduced.parent(t.stat)),y1:Reduced.normalize(Reduced.stack(t.stat),(p,a)=>p/a)})]),{scales:l}=e,[,h]=r;exports.Scale.train(l.x,[0,...h.x1],{default:!0,name:!1}),exports.Scale.train(l.y,[0,1],{default:!0,ratio:!0}),Reactive.listen(h,"changed",()=>{exports.Scale.train(l.x,[0,...h.x1],{default:!0,name:!1})}),exports.Expanse.freeze(l.y.domain,["zero"]),Meta.set(l.x,"name","cumulative count"),Meta.set(l.y,"name","proportion"),exports.Plot.setData(e,r),e.representation=1,exports.Plot.render(e),exports.Plot.renderAxes(e)}function Histogram2d(e,n,r){const{data:l,marker:h}=e;let[t,p,a]=n(l);const c=a&&(r!=null&&r.reducer)?r.reducer:exports.Reducer.sum,x=a||(()=>1),[o,i]=minmax(t),[s,d]=minmax(p),[w,u]=[i-o,d-s],f=Reactive.of()({anchor:o,width:w/15}),y=Reactive.of()({anchor:s,width:u/15}),R=exports.Factor.bin(t,f),z=exports.Factor.bin(p,y),v=exports.Factor.product(R,z),m=exports.Factor.product(v,h.factor),S=[v,m],k=r!=null&&r.queries?r.queries(l):{},b=Summaries.of({stat:[x,c],...k},S),g=0,M=[],T={type:"histo2d",ratio:r==null?void 0:r.ratio},A={representation:g,...exports.Plot.of(T),summaries:b,coordinates:M};return Reactive.listen(A,"normalize",()=>switchRepresentation(A)),Reactive.listen(A,"set-parameters",O=>{O&&(O.width1&&Reactive.set(f,L=>L.width=O.width1),O.anchor1&&Reactive.set(f,L=>L.anchor=O.anchor1),O.width2&&Reactive.set(y,L=>L.width=O.width2),O.anchor2&&Reactive.set(y,L=>L.anchor=O.anchor2))}),Reactive.listen(A,"grow",()=>{Reactive.set(f,O=>O.width*=1.1111111111111112),Reactive.set(y,O=>O.width*=1.1111111111111112)}),Reactive.listen(A,"shrink",()=>{Reactive.set(f,O=>O.width*=.9),Reactive.set(y,O=>O.width*=.9)}),Reactive.listen(A,"reset",()=>{Reactive.set(f,O=>(O.anchor=o,O.width=w/15)),Reactive.set(y,O=>(O.anchor=s,O.width=u/15))}),histogram2d(A),exports.Plot.addGeom(A,Rectangles.of()),A}function switchRepresentation(e){e.representation===0?spinogram2d(e):histogram2d(e)}function histogram2d(e){const{summaries:n}=e,r=Summaries.translate(n,[t=>({x0:t.binMin,y0:t.binMin$,x1:t.binMax,y1:t.binMax$,area:t.stat}),t=>({x0:t.binMin,y0:t.binMin$,x1:t.binMax,y1:t.binMax$,area:Reduced.stack(t.stat)})]),{scales:l}=e,[,h]=r;exports.Scale.train(l.x,h.x1,{default:!0}),exports.Scale.train(l.y,h.y1,{default:!0}),exports.Scale.train(l.areaPct,h.area,{default:!0}),exports.Expanse.set(l.area.codomain,t=>(t.min=0,t.max=1),{default:!0}),exports.Expanse.freeze(l.area.codomain,["min","max"]);for(const t of e.data)Reactive.removeAll(t,"changed");Reactive.listen(h,"changed",()=>{exports.Scale.train(l.x,h.x1,{default:!0,name:!1}),exports.Scale.train(l.y,h.y1,{default:!0,name:!1}),exports.Scale.train(l.areaPct,h.area,{default:!0})}),e.representation=0,exports.Plot.setData(e,r),Meta.copy(l.x,n[1].breaks,["name"]),Meta.copy(l.y,n[1].breaks$,["name"]),exports.Plot.render(e),exports.Plot.renderAxes(e)}function spinogram2d(e){const{summaries:n}=e,r=Summaries.translate(n,[t=>({x0:t.binMin,y0:t.binMin$,x1:t.binMax,y1:t.binMax$,area:one}),t=>({x0:t.binMin,y0:t.binMin$,x1:t.binMax,y1:t.binMax$,area:Reduced.normalize(Reduced.stack(t.stat),(p,a)=>p/a)})]),{scales:l}=e,[,h]=r;exports.Scale.train(l.x,h.x1,{default:!0}),exports.Scale.train(l.y,h.y1,{default:!0}),exports.Scale.train(l.areaPct,[0,1],{default:!0}),exports.Expanse.set(l.area.codomain,t=>(t.min=0,t.max=1),{default:!0}),exports.Expanse.freeze(l.area.codomain,["min","max"]);for(const t of e.data)Reactive.removeAll(t,"changed");Reactive.listen(h,"changed",()=>{exports.Scale.train(l.x,h.x1,{default:!0,name:!1}),exports.Scale.train(l.y,h.y1,{default:!0,name:!1})}),e.representation=1,exports.Plot.setData(e,r),Meta.copy(l.x,n[1].breaks,["name"]),Meta.copy(l.y,n[1].breaks$,["name"]),exports.Plot.render(e),exports.Plot.renderAxes(e)}var ExpanseCompound;(e=>{const n="compound";function r(c=[],x){const o=[],i=ExpanseContinuous.of(0,1,x),{zero:s,one:d,direction:w}=i,u={zero:s,one:d,direction:w};for(const y of c)Object.assign(y,{zero:s,one:d,direction:w}),Object.assign(y.defaults,{zero:s,one:d,direction:w});const f={expanses:c,...i,value:o,type:n,defaults:u};return Reactive.listen(f,"changed",()=>{const{zero:y,one:R,direction:z}=f;for(const v of c)Object.assign(v,{zero:y,one:R,direction:z}),Object.assign(v.defaults,{zero:y,one:R,direction:z})}),f}e.of=r,exports.Poly.set(exports.Expanse.normalize,n,l),exports.Poly.set(exports.Expanse.unnormalize,n,h),exports.Poly.set(exports.Expanse.train,n,t),exports.Poly.set(exports.Expanse.breaks,n,p);function l(c,x){const{expanses:o}=c;return x.map((i,s)=>exports.Expanse.normalize(o[s],i))}e.normalize=l;function h(c,x){const{expanses:o}=c;return x.map((i,s)=>exports.Expanse.unnormalize(o[s],i))}e.unnormalize=h;function t(c,x){const{expanses:o}=c;if(x.length!=o.length){const i="The number of arrays does not match the number of expanses.";throw new Error(i)}for(let i=0;i<x.length;i++)exports.Expanse.train(o[i],x[i])}e.train=t;function p(c){return ExpanseContinuous.breaks(c)}e.breaks=p;function a(c){for(const x of c.expanses)exports.Expanse.reset(x)}e.reset=a})(ExpanseCompound||(ExpanseCompound={}));var ExpansePoint;(e=>{const n="point";function r(c=[],x){const o="",i=exports.Expanse.base(x),[s,d]=[!1,seqLength(0,c.length)],w={labels:c,ordered:s,order:d},u={ordered:s,labels:[...c],order:[...d],...i.defaults};return{type:n,value:o,...i,...w,defaults:u}}e.of=r,exports.Poly.set(exports.Expanse.normalize,n,l),exports.Poly.set(exports.Expanse.unnormalize,n,h),exports.Poly.set(exports.Expanse.train,n,t),exports.Poly.set(exports.Expanse.breaks,n,a),exports.Poly.set(exports.Expanse.reorder,n,p);function l(c,x){const{labels:o,order:i,zero:s,one:d,direction:w}=c,u=i[o.indexOf(x)];if(u===-1)return u;let f=u/(o.length-1);return f=s+f*(d-s),f=applyDirection(f,w),f}e.normalize=l;function h(c,x){const{labels:o,order:i,zero:s,one:d,direction:w}=c;let u=applyDirection(x,w);return u=(u-s)/(d-s),u=Math.round(u*(o.length-1)),o[i[u]]}e.unnormalize=h;function t(c,x,o){const{order:i}=c,s=Array.from(new Set(x)).sort(compareAlphaNumeric);if(!i.length){for(let d=0;d<s.length;d++)i[d]=d;c.defaults.order=[...i],c.ordered=!1}copyValues(s,c.labels),o!=null&&o.default&&copyValues(s,c.defaults.labels),exports.Expanse.set(c,()=>{},o)}e.train=t;function p(c,x){const{order:o,defaults:i}=c;if(!x){copyValues(i.order,o),c.ordered=!1,Reactive.dispatch(c,"changed");return}copyValues(x,o),c.ordered=!0,Reactive.dispatch(c,"changed")}e.reorder=p;function a(c){return ordered(c.labels,c.order)}e.breaks=a})(ExpansePoint||(ExpansePoint={}));var ExpanseSplit;(e=>{const n="split";function r(a){const c=[],x=a.type;return{...a,value:c,type:n,innerType:x}}e.of=r,exports.Poly.set(exports.Expanse.normalize,n,l),exports.Poly.set(exports.Expanse.unnormalize,n,h),exports.Poly.set(exports.Expanse.train,n,t),exports.Poly.set(exports.Expanse.breaks,n,p);function l(a,c){const{innerType:x}=a,o=exports.Poly.dispatch(exports.Expanse.normalize,identity,x);return Array.isArray(c)?c.map(i=>o(a,i)):o(a,c)}e.normalize=l;function h(a,c){const{innerType:x}=a,o=exports.Poly.dispatch(exports.Expanse.unnormalize,identity,x);return Array.isArray(c)?c.map(i=>o(a,i)):o(a,c)}e.unnormalize=h;function t(a,c){const{innerType:x}=a;exports.Poly.dispatch(exports.Expanse.train,identity,x)(a,c)}e.train=t;function p(a){const{innerType:c}=a;return exports.Poly.dispatch(exports.Expanse.breaks,identity,c)(a)}e.breaks=p})(ExpanseSplit||(ExpanseSplit={}));function inferExpanse(e,n={train:!0}){const l=isNumberArray(e)?ExpanseContinuous.of():ExpansePoint.of();return n.train&&exports.Expanse.train(l,e),l}function Pcoordsplot(e,n,r){const{data:l,marker:h}=e,t=n(l),p=t.map(m=>Meta.get(m,"name")),a=Getter.constant(p),c=Getter.multi(t),x=r!=null&&r.queries?r.queries(l):{},o=exports.Factor.bijection({x:a,y:c,...x}),i=exports.Factor.product(o,h.factor),s=Summaries.of({},[o,i]),d=Summaries.translate(s,[m=>m,m=>m]),w=exports.Plot.of({type:"pcoords"}),{scales:u}=w,{expandX:f,expandY:y}=e.options,R={zero:f,one:1-f},z={zero:y,one:1-y};exports.Scale.setDomain(u.x,ExpanseSplit.of(ExpansePoint.of(p,R))),exports.Scale.setCoomain(u.x,ExpanseSplit.of(u.x.codomain));const v=t.map(m=>inferExpanse(m));return exports.Scale.setDomain(u.y,ExpanseCompound.of(v,z)),exports.Scale.setCoomain(u.y,ExpanseSplit.of(u.y.codomain)),Meta.set(u.x,"name","variable"),Meta.set(u.y,"name","value"),exports.Plot.setData(w,d),exports.Plot.addGeom(w,Lines.of()),w}function Scatterplot(e,n,r){const{data:l,marker:h}=e,[t,p,a]=n(l),c=r!=null&&r.queries?r==null?void 0:r.queries(l):{},x={x:t,y:p,size:a??(()=>.5),...c},o=exports.Factor.bijection(x),i=exports.Factor.product(o,h.factor),s=Summaries.of({},[o,i]),d=Summaries.translate(s,[f=>f,f=>f]),w=exports.Plot.of({type:"scatter",ratio:r==null?void 0:r.ratio}),{scales:u}=w;return exports.Scale.train(u.x,t,{default:!0}),exports.Scale.train(u.y,p,{default:!0}),a&&exports.Scale.train(u.size,a,{default:!0}),exports.Plot.setData(w,d),exports.Plot.addGeom(w,Points.of()),{...w,summaries:s}}const defaultOptions={size:10,expandX:.1,expandY:.1,gapPct:.8,gapPx:1,axisLabelSize:1,axisTitleSize:1.25,margins:[0,0,0,0],marginLines:[3.5,3.5,1,1],colors:["#FF7F00","#E31A1C","#33A02C","#1F78B4","#FDBF6F","#FB9A99","#B2DF8A","#A6CEE3"],plotBackground:"#fefffe"};function renderAxisLabels(e){renderSingleAxisLabels(e,"x"),renderSingleAxisLabels(e,"y")}function renderSingleAxisLabels(e,n){const{frames:r,scales:l,options:h}=e,{margins:t,marginLines:p}=h,a=l[n],c=n==="x"?l.y:l.x,x=r[`${n}Axis`],{context:o}=x,{labels:i,positions:s}=exports.Scale.breaks(a),[d,w,u,f]=t,y=parseInt(o.font.match(/^[0-9]*/)[0],10),R=c.codomain.min-y/2,{width:z,height:v}=x;if(Frame.clear(x),n==="x"){let[m,S]=[0,0];for(let k=0;k<i.length;k++){const b=i[k],g=s[k],M=Frame.textWidth(x,b)+1;outside(g,w,z-f)||overlap(m,g,S,M)||([m,S]=[g,M],Frame.text(x,g,R,b))}}else if(n==="y"){let[m,S]=[0,0];for(let k=0;k<i.length;k++){const b=i[k],g=s[k],M=Frame.textWidth(x,b)+1,T=Frame.textHeight(x,b)+1;if(!outside(g,d,v-u)&&!overlap(m,g,S,T)){for(;t[1]/2<M+T;)p[1]*=1.05,exports.Plot.resize(e);[m,S]=[g,T],Frame.text(x,R,g,b)}}}}function renderAxisTitles(e){renderSingleAxisTitle(e,"x"),renderSingleAxisTitle(e,"y")}function renderSingleAxisTitle(e,n){const{scales:r,frames:l,options:h}=e,{margins:t}=h,p=r[n],a=n==="x"?e.scales.y:e.scales.x,c=l.base,x=Meta.get(p,"name"),o=n==="x"?t[0]:t[1],i=exports.Expanse.unnormalize(p.codomain,.5),s=exports.Expanse.unnormalize(a.codomain,0)-o*2/3;n==="x"&&Frame.text(c,i,s,x),n==="y"&&Frame.text(c,s,i,x,{vertical:!0})}function outside(e,n,r){return e<n||e>r}function overlap(e,n,r,l){const[h,t]=[e-r/2,e+r/2],[p,a]=[n-l/2,n+l/2];return h<a&&t>=p}exports.Plot=void 0,(e=>{(E=>{E.Select="select",E.Pan="pan",E.Query="query"})(e.Mode||(e.Mode={}));function n(E){const P=(E==null?void 0:E.type)??"unknown",C=DOM.element("div",{id:"plot"}),I=DOM.element("table");DOM.addClasses(C,tw("tw-relative tw-h-full tw-w-full tw-drop-shadow-md")),DOM.addClasses(I,tw("tw-relative tw-z-30 tw-bg-gray-50 tw-shadow-md")),DOM.append(C,I);const D=[],F={},V={},G=[],$=[],B=[],q=structuredClone({...defaultOptions,...E}),{expandX:U,expandY:H}=q,N=[[U,H,1-U,1-H]],_={active:!1,locked:!1,mousedown:!1,mousebutton:MouseButton.Left,mode:"select",mousecoords:[0,0,0,0],lastkey:"",ratio:(E==null?void 0:E.ratio)??void 0},J=Reactive.of()({type:P,data:D,container:C,queryTable:I,frames:F,scales:V,renderables:G,selectables:$,queryables:B,zoomStack:N,parameters:_,options:q});return setupFrames(J,q),setupScales(J,q),setupEvents$1(J),J}e.of=n,e.scatter=Scatterplot,e.bar=Barplot,e.fluct=Fluctuationplot,e.histo=Histogram,e.histo2d=Histogram2d,e.pcoords=Pcoordsplot;function r(E,P){E.appendChild(P.container),e.resize(P)}e.append=r;function l(E,P){for(const C of E.data)Reactive.is(C)&&Reactive.removeAll(C,"changed");E.data.length=0;for(let C=0;C<P.length;C++)E.data.push(P[C]);Reactive.listen(last(P),"changed",()=>e.render(E))}e.setData=l;function h(E,P){P.scales=E.scales,P.data=E.data;const{renderables:C,selectables:I,queryables:D}=E;for(const F of[C,I,D])F.push(P)}e.addGeom=h;function t(E,P){const{renderables:C,selectables:I,queryables:D}=E;for(const F of[C,I,D])remove(F,P)}e.deleteGeom=t;const p=tw("tw-outline tw-outline-2 tw-outline-slate-600");function a(E){DOM.addClasses(E.container,p),E.parameters.active=!0,Reactive.dispatch(E,"activated")}e.activate=a;function c(E){DOM.removeClasses(E.container,p),E.parameters.active=!1,Reactive.dispatch(E,"deactivated")}e.deactivate=c;function x(E){E.parameters.locked=!0}e.lock=x;function o(E){E.parameters.locked=!1}e.unlock=o;function i(E){for(const P of dataLayers)Frame.clear(E.frames[P]);for(const P of E.renderables)Geom.render(P,E.frames)}e.render=i;function s(E){for(const P of["base","xAxis","yAxis"])Frame.clear(E.frames[P]);renderAxisLabels(E),renderAxisTitles(E)}e.renderAxes=s;function d(E){Frame.clear(E.frames.user)}e.clearUserFrame=d;function w(E){const{container:P,scales:C,frames:I,parameters:D,options:F}=E,{clientWidth:V,clientHeight:G}=P,{x:$,y:B,width:q,height:U,area:H}=C,{margins:N,marginLines:_}=F,J=getComputedStyle(E.container),K=parseFloat(J.fontSize);for(let X=0;X<N.length;X++)N[X]=_[X]*K;for(const X of Object.values(E.frames))Frame.resize(X);const[Q,ee]=[N[0],N[1]],[ne,re]=[G-N[2],V-N[3]];DOM.setStyles(I.under.canvas,{width:`calc(100% - ${ee}px - ${N[3]}px)`,height:`calc(100% - ${Q}px - ${N[2]}px)`,top:`${N[2]}px`,right:`${N[3]}px`}),DOM.setStyles(I.over.canvas,{width:`calc(100% - ${ee}px - ${N[3]}px)`,height:`calc(100% - ${Q}px - ${N[2]}px)`,top:`${N[2]}px`,right:`${N[3]}px`});const Z={default:!0,silent:!0};exports.Expanse.set($.codomain,X=>(X.min=ee,X.max=re),Z),exports.Expanse.set(B.codomain,X=>(X.min=Q,X.max=ne),Z);const[oe,se]=[re-ee,ne-Q];if(exports.Expanse.set(q.codomain,X=>X.max=oe,Z),exports.Expanse.set(U.codomain,X=>X.max=se,Z),exports.Expanse.set(H.codomain,X=>X.max=Math.min(oe,se),Z),D.ratio){const{expandX:X,expandY:ae}=defaultOptions;exports.Expanse.set($.domain,te=>(te.zero=X,te.one=1-X),Z),exports.Expanse.set(B.domain,te=>(te.zero=ae,te.one=1-ae),Z),e.applyRatio(E,D.ratio)}e.render(E),e.renderAxes(E)}e.resize=w;function u(E){const{selectables:P,parameters:C}=E,I=new Set;for(const D of P){const F=Geom.check(D,C.mousecoords);for(let V=0;V<F.length;V++)I.add(F[V])}Reactive.dispatch(E,"set-selected",{cases:Array.from(I)})}e.checkSelection=u;function f(E,P){E.parameters.mode=P}e.setMode=f;function y(E,P){E.parameters.mousedown=P}e.setMousedown=y;function R(E,P){E.parameters.mousebutton=P}e.setMouseButton=R,e.mousemoveHandlers={select:z,pan:v,query:m};function z(E,P){const{container:C,parameters:I,frames:D}=E;if(!I.active||!I.mousedown)return;Reactive.dispatch(E,"clear-transient");const{mousecoords:F}=I,{clientHeight:V}=C,G=P.offsetX,$=V-P.offsetY;F[2]=G,F[3]=$,e.checkSelection(E),Reactive.dispatch(E,"lock-others"),Frame.clear(D.user),Frame.rectangleXY(D.user,...I.mousecoords,1)}function v(E,P){const{container:C,scales:I,parameters:D}=E;if(!D.active||!D.mousedown)return;const{mousecoords:F}=D,{clientWidth:V,clientHeight:G}=C,[$,B]=F,q=P.offsetX,U=G-P.offsetY,H=(q-$)/V,N=(U-B)/G;exports.Scale.move(I.x,H),exports.Scale.move(I.y,N),F[0]=q,F[1]=U,e.clearUserFrame(E)}function m(E,P){const{offsetX:C,offsetY:I}=P,{container:D,queryTable:F,queryables:V}=E,{clientWidth:G,clientHeight:$}=D;F.style.display="none";const B=C,q=$-I;let U;for(const J of V)if(U=Geom.query(J,[B,q]),U)break;if(!U)return;clearNodeChildren(F);for(const[J,K]of Object.entries(U)){const Q=DOM.element("tr"),ee=DOM.element("td",{classes:tw("tw-border tw-border-gray-400 tw-px-3 py-1"),textContent:J}),ne=DOM.element("td",{classes:tw("tw-border tw-border-gray-400 tw-px-3 tw-py-1 tw-font-mono"),textContent:formatLabel(K)});DOM.append(Q,ee),DOM.append(Q,ne),DOM.append(F,Q)}F.style.display="inline-block";const H=getComputedStyle(F),N=parseFloat(H.width.slice(0,-2)),{clientWidth:_}=F;B+N>G?(F.style.left="auto",F.style.right=`${_-C+5}px`):(F.style.left=`${B+5}px`,F.style.right="auto"),F.style.top=I+"px"}e.keybindings={"=":"grow","-":"shrink","]":"unfade","[":"fade",z:"zoom",x:"pop-zoom",o:"reorder",";":"decrement-anchor","'":"increment-anchor",n:"normalize"};function S(E){const{area:P,size:C,width:I}=E.scales;exports.Expanse.set(P.codomain,D=>(D.min*=1.1111111111111112,D.max*=1.1111111111111112)),exports.Expanse.set(C.codomain,D=>(D.min*=1.1111111111111112,D.max*=1.1111111111111112)),exports.Expanse.set(I.codomain,D=>D.mult<1?D.mult*=1.1111111111111112:null)}e.grow=S;function k(E){const{area:P,width:C,size:I}=E.scales;exports.Expanse.set(P.codomain,D=>(D.min*=.9,D.max*=.9)),exports.Expanse.set(I.codomain,D=>(D.min*=.9,D.max*=.9)),exports.Expanse.set(C.codomain,D=>D.mult*=.9)}e.shrink=k;function b(E){const{frames:P}=E;for(const C of baseLayers)Frame.setAlpha(P[C],I=>I*9/10);e.render(E)}e.fade=b;function g(E){const{frames:P}=E;for(const C of baseLayers)Frame.setAlpha(P[C],I=>I*10/9);e.render(E)}e.unfade=g;function M(E){const{frames:P,scales:C}=E;for(const I of baseLayers)Frame.resetAlpha(P[I]);for(const I of Object.values(C))exports.Scale.restoreDefaults(I);E.zoomStack.length=1,e.clearUserFrame(E)}e.reset=M;function T(E){e.setMode(E,"query")}e.setQueryMode=T;function A(E,P){const{scales:C,parameters:I,zoomStack:D}=E;let{coords:F,units:V}=P??{};V=V??"screen";let[G,$,B,q]=F??I.mousecoords;const{x:U,y:H}=C;if(V==="data"){const K={silent:!0};exports.Expanse.set(U.domain,Q=>(Q.zero=0,Q.one=1),K),exports.Expanse.set(H.domain,Q=>(Q.zero=0,Q.one=1),K),G=exports.Expanse.normalize(U.domain,G),B=exports.Expanse.normalize(U.domain,B),$=exports.Expanse.normalize(H.domain,$),q=exports.Expanse.normalize(H.domain,q)}if(V==="screen"){if(Math.abs(B-G)<10||Math.abs(q-$)<10)return;G=trunc(exports.Expanse.normalize(U.codomain,G)),B=trunc(exports.Expanse.normalize(U.codomain,B)),$=trunc(exports.Expanse.normalize(H.codomain,$)),q=trunc(exports.Expanse.normalize(H.codomain,q))}[G,B]=[G,B].sort(diff),[$,q]=[$,q].sort(diff),exports.Scale.expand(C.x,G,B),exports.Scale.expand(C.y,$,q);const N=rangeInverse(G,B),_=rangeInverse($,q),J=sqrt(max(N,_));exports.Expanse.set(C.width.codomain,K=>K.max*=N),exports.Expanse.set(C.height.codomain,K=>K.max*=_),exports.Expanse.set(C.area.codomain,K=>K.max*=J),exports.Expanse.set(C.size.codomain,K=>K.max*=J),D.push([G,$,B,q]),Reactive.dispatch(E,"clear-transient"),e.render(E)}e.zoom=A;function O(E){const{scales:P,zoomStack:C}=E;if(C.length===1)return;const[I,D,F,V]=C[C.length-1],[G,$]=invertRange(I,F),[B,q]=invertRange(D,V);exports.Scale.expand(P.x,G,$),exports.Scale.expand(P.y,B,q);const U=rangeInverse(G,$),H=rangeInverse(B,q),N=1/sqrt(max(1/U,1/H));exports.Expanse.set(P.width.codomain,_=>_.max*=U),exports.Expanse.set(P.height.codomain,_=>_.max*=H),exports.Expanse.set(P.area.codomain,_=>_.max*=N),exports.Expanse.set(P.size.codomain,_=>_.max*=N),C.pop(),e.clearUserFrame(E),e.render(E)}e.popZoom=O;function L(E,P){const{x:C,y:I}=E.scales;if(!exports.Expanse.isContinuous(C.domain)||!exports.Expanse.isContinuous(I.domain))throw new Error("Both axes need to be continuous to set a ratio");E.parameters.ratio=P,e.resize(E)}e.setRatio=L;function j(E,P){const{scales:C}=E,{x:I,y:D}=C,F=exports.Scale.unitRatio(I),V=exports.Scale.unitRatio(D)*P,G={default:!0,silent:!0};if(F>V){const $=V/F*exports.Expanse.unitRange(D.domain);exports.Expanse.set(I.domain,B=>(B.zero=(1-$)/2,B.one=(1+$)/2),G)}else{const $=F/V*exports.Expanse.unitRange(I.domain);exports.Expanse.set(D.domain,B=>(B.zero=(1-$)/2,B.one=(1+$)/2),G)}}e.applyRatio=j;function Y(E,P){return E.scales[P].domain}e.getScale=Y;function W(E,P,C){let{min:I,max:D,zero:F,one:V,mult:G,labels:$,direction:B}=C;const q=E.scales[P].domain,U=E.scales[P].codomain;if(!Object.keys(E.scales).includes(P))throw new Error(`Unrecognized scale '${P}'`);const H={default:C.default??!1,unfreeze:C.unfreeze??!1};if([F,V].some(isDefined)&&(F=F??q.zero,D=D??q.max,exports.Expanse.set(q,N=>(N.zero=F,N.one=V),H),E.parameters.ratio=void 0),[I,D].some(isDefined)){if(!exports.Expanse.isContinuous(q))throw new Error("Limits can only be set with a continuous scale");I=I??q.min,D=D??q.max,exports.Expanse.set(q,N=>(N.min=I,N.max=D),H),E.parameters.ratio=void 0}if($){if(!exports.Expanse.isDiscrete(q))throw new Error("Labels can be ordered with a discrete scale only");if(!stringArraysMatch(q.labels,$))throw new Error("Labels must match the scale's labels");const N=orderIndicesByTable(q.labels,$);exports.Expanse.reorder(q,N)}B&&exports.Expanse.set(q,N=>N.direction=B,H),G&&exports.Expanse.set(U,N=>N.mult=G,H)}e.setScale=W})(exports.Plot||(exports.Plot={}));function setupFrames(e,n){const{container:r,frames:l}=e,{margins:h,colors:t,axisLabelSize:p,axisTitleSize:a}=n,[c,x,o,i]=h,s=[7,6,5,4,3,2,1,0],d="tw-absolute tw-top-0 tw-right-0 tw-w-full tw-h-full ";for(const g of s){const M={zIndex:`${7-g+2}`},T=t[g],A={fillStyle:T,strokeStyle:T},O=Frame.of({classes:d,contextProps:A,canvasStyles:M,margins:h});l[g]=O}const w=Frame.of({classes:d+"tw-bg-gray-100"});Frame.setContext(w,{font:`${a}em sans-serif`,textBaseline:"middle",textAlign:"center"});const u=`calc(100% - ${x}px - ${i}px)`,f=`calc(100% - ${c}px - ${o}px)`,y={width:u,height:f,top:o+"px",right:i+"px"},R=Frame.of({classes:d+"tw-z-1 tw-bg-white",canvasStyles:y}),v=Frame.of({classes:d+"tw-z-10 tw-border tw-border-b-black tw-border-l-black",canvasStyles:y}),m=Frame.of({classes:d+"tw-z-10",margins:h});Frame.setContext(m,{globalAlpha:.06666666666666667});const S="#3B4854",k=Frame.of({classes:d});Frame.setContext(k,{fillStyle:S,textBaseline:"top",textAlign:"center",font:`${p}em serif`});const b=Frame.of({classes:d});Frame.setContext(b,{fillStyle:"#3B4854",textBaseline:"middle",textAlign:"right",font:`${p}em serif`}),Object.assign(l,{base:w,under:R,over:v,user:m,xAxis:k,yAxis:b});for(let[g,M]of Object.entries(l))isNaN(parseFloat(g))||(g="data-"+g),M.canvas.id=`frame-${g}`,Frame.append(M,r)}function setupEvents$1(e){const{container:n,parameters:r,frames:l}=e,{mousecoords:h}=r;for(const[t,p]of Object.entries(exports.Plot.keybindings))Reactive.listen(e,t,()=>Reactive.dispatch(e,p));n.addEventListener("mousedown",t=>{t.stopPropagation();const{locked:p}=r;exports.Plot.activate(e),exports.Plot.setMousedown(e,!0),exports.Plot.setMouseButton(e,t.button),t.button===MouseButton.Left?exports.Plot.setMode(e,"select"):t.button===MouseButton.Right&&exports.Plot.setMode(e,"pan");const a=t.offsetX,c=n.clientHeight-t.offsetY;copyValues([a,c,a,c],h),!p&&r.mode==="select"&&(Reactive.dispatch(e,"clear-transient"),exports.Plot.checkSelection(e)),exports.Plot.unlock(e)}),n.addEventListener("contextmenu",t=>{t.preventDefault(),exports.Plot.setMousedown(e,!0),exports.Plot.setMouseButton(e,MouseButton.Right),exports.Plot.setMode(e,"pan"),h[0]=t.offsetX,h[1]=n.clientHeight-t.offsetY,Frame.clear(l.user)}),n.addEventListener("mouseup",()=>exports.Plot.setMousedown(e,!1)),n.addEventListener("mousemove",throttle(t=>{exports.Plot.mousemoveHandlers[r.mode](e,t)},20)),Reactive.listen(e,"reset",()=>exports.Plot.reset(e)),Reactive.listen(e,"resize",()=>exports.Plot.resize(e)),Reactive.listen(e,"activate",()=>exports.Plot.activate(e)),Reactive.listen(e,"deactivate",()=>exports.Plot.deactivate(e)),Reactive.listen(e,"render",()=>exports.Plot.render(e)),Reactive.listen(e,"lock",()=>exports.Plot.lock(e)),Reactive.listen(e,"unlock",()=>exports.Plot.unlock(e)),Reactive.listen(e,"query-mode",()=>exports.Plot.setMode(e,"query")),Reactive.listen(e,"render-axes",()=>exports.Plot.renderAxes(e)),Reactive.listen(e,"clear-transient",()=>exports.Plot.clearUserFrame(e)),Reactive.listen(e,"get-scale",t=>{if(!(!t||!t.scale))return exports.Plot.getScale(e,t.scale)}),Reactive.listen(e,"set-scale",t=>{!t||!t.scale||exports.Plot.setScale(e,t.scale,t)}),Reactive.listen(e,"grow",()=>exports.Plot.grow(e)),Reactive.listen(e,"shrink",()=>exports.Plot.shrink(e)),Reactive.listen(e,"fade",()=>exports.Plot.fade(e)),Reactive.listen(e,"unfade",()=>exports.Plot.unfade(e)),Reactive.listen(e,"zoom",t=>exports.Plot.zoom(e,t)),Reactive.listen(e,"pop-zoom",()=>exports.Plot.popZoom(e));for(const t of Object.values(e.scales))Reactive.listen(t,"changed",()=>{exports.Plot.render(e),exports.Plot.renderAxes(e)})}function setupScales(e,n){var v,m;const{scales:r,container:l}=e,{clientWidth:h,clientHeight:t}=l,p={continuous:ExpanseContinuous,point:ExpansePoint,band:ExpanseBand},a=p[((v=n==null?void 0:n.scales)==null?void 0:v.x)??"continuous"].of(),c=p[((m=n==null?void 0:n.scales)==null?void 0:m.y)??"continuous"].of();r.x=exports.Scale.of(a,ExpanseContinuous.of(0,h)),r.y=exports.Scale.of(c,ExpanseContinuous.of(0,t)),r.height=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of(0,t)),r.width=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of(0,h)),r.area=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of()),r.size=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of(0,n.size)),r.areaPct=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of());const{x,y:o,width:i,height:s,size:d,area:w,areaPct:u}=r,f={default:!0,silent:!0},{expandX:y,expandY:R}=defaultOptions;exports.Expanse.set(w.domain,S=>S.ratio=!0,f),exports.Expanse.set(u.domain,S=>S.ratio=!0,f),exports.Expanse.set(d.domain,S=>S.ratio=!0,f),exports.Expanse.set(d.codomain,S=>(S.trans=square,S.inv=sqrt),f),exports.Expanse.set(w.codomain,S=>(S.trans=square,S.inv=sqrt),f),exports.Expanse.set(u.codomain,S=>(S.trans=square,S.inv=sqrt),f),exports.Expanse.set(x.domain,S=>(S.zero=y,S.one=1-y),f),exports.Expanse.set(o.domain,S=>(S.zero=R,S.one=1-R),f),exports.Expanse.set(i.domain,S=>S.one=1-2*y,f),exports.Expanse.set(s.domain,S=>S.one=1-2*R,f),exports.Expanse.set(w.domain,S=>S.one=1-2*Math.max(y,R),f);const z=S=>Math.max(S,0);exports.Expanse.set(i.codomain,S=>S.inv=z,f),exports.Expanse.set(s.codomain,S=>S.inv=z,f)}var KeybindingsMenu;(e=>{function n(l){const h=DOM.element("div"),t=DOM.element("div",{id:"modal"}),p=DOM.element("div",{id:"bindings"}),a=DOM.element("button",{textContent:"key bindings"});DOM.addClasses(t,tw("tw-absolute tw-left-0 tw-top-0 tw-z-50 tw-flex tw-size-full tw-flex-col tw-items-center tw-bg-slate-800 tw-bg-opacity-80 tw-p-10")),DOM.addClasses(p,tw("tw-relative tw-flex tw-h-full tw-w-fit tw-flex-col tw-flex-wrap tw-justify-start tw-py-10")),DOM.addClasses(a,tw("tw-absolute tw-right-0 tw-top-0 tw-z-30 tw-select-none tw-rounded-bl-md tw-bg-gray-300 tw-p-1 tw-px-2 tw-text-sm tw-text-white hover:tw-bg-gray-400")),DOM.append(h,t),DOM.append(h,a),DOM.append(t,p),p.style.columnFill="auto",t.style.display="none";let c=!1;function x(){t.style.display="flex"}function o(){c||(t.style.display="none")}a.addEventListener("click",x),t.addEventListener("click",o);for(const[i,s]of Object.entries(l)){const d=DOM.element("span",{classes:tw("tw-m-1 tw-flex tw-flex-row")}),w=DOM.element("button",{textContent:i}),u=DOM.element("div",{classes:tw("tw-m-1 tw-p-1 tw-px-2 tw-text-white"),textContent:capitalize(s.replaceAll("-"," "))});DOM.addClasses(w,tw("tw-m-1 tw-w-8 tw-rounded-md tw-bg-gray-400 tw-p-1 tw-px-2 tw-text-center tw-text-white tw-outline-none hover:tw-bg-gray-500")),DOM.append(d,w),DOM.append(d,u),u.addEventListener("click",y=>y.stopPropagation()),w.addEventListener("click",y=>{c||(y.stopPropagation(),DOM.addClasses(w,tw("text-black bg-slate-200 hover:bg-slate-200")),window.addEventListener("keydown",f),c=!0)});const f=y=>{const{key:R}=y,z=w.innerText;R in l&&R!==z||(r(l,R,s),w.innerText=y.key,DOM.removeClasses(w,tw("tw-text-black tw-bg-slate-200 hover:tw-bg-slate-200")),window.removeEventListener("keydown",f),c=!1)};p.appendChild(d)}return h}e.of=n;function r(l,h,t){let p;for(const[a,c]of Object.entries(l))if(c===t){p=a;break}p&&delete l[p],l[h]=t}})(KeybindingsMenu||(KeybindingsMenu={})),exports.Scene=void 0,(e=>{function n(b,g){const M=DOM.element("div",{id:"scene-container"}),T=DOM.element("div",{id:"plots-container"});DOM.addClasses(M,tw("tailwind tw-pr-15 tw-relative tw-flex tw-h-full tw-w-full tw-content-center tw-items-center tw-justify-center tw-bg-[#deded9] tw-p-10 tw-text-[max(min(2vmin,16px),8px)]")),DOM.addClasses(T,tw("tw-grid tw-h-full tw-w-full tw-grid-cols-1 tw-grid-rows-1 tw-gap-5 "));const A={...e.keybindings,...exports.Plot.keybindings},O=KeybindingsMenu.of(A);DOM.append(M,T),DOM.append(M,O);const[L,j]=[1,1],Y=Marker.of(Object.values(b)[0].length),W=[],E={},P=Object.assign(defaultOptions,g);for(const[D,F]of Object.entries(b))Meta.has(F,"name")||Meta.set(F,"name",D);const C={send:console.log},I=Reactive.of()({data:b,container:M,plotsContainer:T,rows:L,cols:j,marker:Y,client:C,plots:W,plotsByType:E,options:P,keybindings:A});if(g!=null&&g.websocketURL){const D=new WebSocket(g.websocketURL),F={sender:"scene",target:"server",type:"connected"};D.addEventListener("open",()=>D.send(JSON.stringify(F))),D.addEventListener("message",V=>{f(I,JSON.parse(V.data))}),window.addEventListener("beforeunload",()=>D.close()),I.client=D}return setupEvents(I),I}e.of=n;async function r(b,g){const M=await fetchJSON(b);return e.of(M,g)}e.ofAsync=r;function l(b,g){b.appendChild(g.container),e.resize(g)}e.append=l;function h(b,g){const{plotsContainer:M,marker:T,plots:A,plotsByType:O}=b;Reactive.listen(g,"activated",()=>{for(const j of A)j!=g&&Reactive.dispatch(j,"deactivate");b.activePlot=g}),Reactive.listen(g,"lock-others",()=>{for(const j of A)j!==g&&Reactive.dispatch(j,"lock")}),Reactive.listen(g,"set-selected",j=>{Marker.update(T,j.cases)}),Reactive.listen(g,"clear-transient",()=>{for(const j of A)exports.Plot.clearUserFrame(j);Marker.clearTransient(T)});const{type:L}=g;O[L]||(O[L]=[]),O[L].push(A.length),A.push(g),exports.Plot.append(M,g),p(b),s(b),e.resize(b)}e.addPlot=h;function t(b,g){const{type:M,variables:T,reducer:A,queries:O}=g??{};if(!M||M==="unknown"||!T)return;for(const W of T)if(!Object.keys(b.data).includes(W))throw new Error(`Variable '${W}' is not present in the data`);const L=keysToSelectors(T),j={};if(A&&(j.reducer=exports.Reducer.parse(A)),O)if(isStringArray(O))j.queries=keysToSelectors(O);else{const W=E=>O.map(([P,C])=>[E[P],exports.Reducer.parse(C)]);j.queries=W}const Y=exports.Plot[M](b,L,j);e.addPlot(b,Y)}e.addPlotBySpec=t;function p(b){for(let g=0;g<b.plots.length;g++)b.plots[g].container.id=`plot${g+1}`}function a(b){const g=last(b.plots);g&&x(b,g)}e.popPlot=a;function c(b,g){const M=i(b,g);M&&x(b,M)}e.removePlot=c;function x(b,g){const{plots:M,plotsByType:T,plotsContainer:A}=b,O=M.indexOf(g);for(const L of Object.values(T))if(L.indexOf(O)!==-1){remove(L,O);break}remove(M,g),A.removeChild(g.container),Reactive.removeAllListeners(g),p(b),s(b),e.resize(b)}function o(b,g){return g==="scene"?b:i(b,g)}e.getTarget=o;function i(b,g){const{plots:M,plotsByType:T}=b;let[A,O]=splitNumericSuffix(g);const L=parseInt(O,10)-1;if(A==="plot"||A==="p")return M[L];if(A=A.replace("plot","").replace("gram",""),A in Object.keys(plotIdShort)&&(A=plotIdShort[A]),A in T)return M[T[A][L]]}e.getPlot=i;function s(b){const{plots:g}=b;if(g.length===0)return;const M=Math.ceil(Math.sqrt(g.length)),T=Math.ceil(g.length/M);e.setDimensions(b,T,M)}function d(b,g,M){const{plotsContainer:T}=b;b.rows=g,b.cols=M,T.style.gridTemplateRows=Array(g).fill("1fr").join(" "),T.style.gridTemplateColumns=Array(M).fill("1fr").join(" "),e.resize(b)}e.setDimensions=d;function w(b,g){const{plotsContainer:M,plots:T}=b,A=new Set(g.flat()),O=new Set(seq(0,T.length-1));for(const W of A)O.delete(W);O.size>0&&alert("Warning: Some plots are not included in the layout and will be hidden.");for(let W=0;W<T.length;W++)T[W].container.style.gridArea=`plot${W}`;let L="";for(const W of g)L+=`"${W.map(E=>`plot${E}`).join(" ")}" `;const[j,Y]=[g.length,g[0].length];M.style.gridTemplateAreas=L,M.style.gridTemplateRows=Array(j).fill("1fr").join(" "),M.style.gridTemplateColumns=Array(Y).fill("1fr").join(" "),e.resize(b)}e.setLayout=w;function u(b){b.plotsContainer.style.gridTemplateAreas="";for(const g of b.plots)g.container.style.gridArea="auto";s(b)}e.clearLayout=u;function f(b,g){if(!b.client)return;const{type:M,target:T,data:A}=g,O=o(b,T);O&&Reactive.dispatch(O,M,A)}e.handleMessage=f;function y(b,g,M){const[T,A]=["scene","server"],O=JSON.stringify({sender:T,target:A,type:g,data:M});b.client.send(O)}e.sendMessage=y;function R(b){for(const g of b.plots)Reactive.dispatch(g,"resize")}e.resize=R;function z(b){for(const g of b.plots)Reactive.dispatch(g,"reset");Marker.clearTransient(b.marker)}e.reset=z;function v(b){for(const g of b.plots)Reactive.dispatch(g,"query-mode")}e.setQueryMode=v;function m(b){Marker.setGroup(b.marker,Group.First)}e.setGroupFirst=m;function S(b){Marker.setGroup(b.marker,Group.Second)}e.setGroupSecond=S;function k(b){Marker.setGroup(b.marker,Group.Third)}e.setGroupThird=k,e.keybindings={r:"reset",q:"query-mode",1:"group-1",2:"group-2",3:"group-3"}})(exports.Scene||(exports.Scene={}));function setupEvents(e){const{marker:n,plots:r,container:l,keybindings:h}=e;l.addEventListener("mousedown",()=>{for(const t of r)Reactive.dispatch(t,"deactivate")}),l.addEventListener("dblclick",()=>{for(const t of r)Reactive.dispatch(t,"deactivate"),Frame.clear(t.frames.user);Marker.clearAll(e.marker),e.activePlot=void 0}),window.addEventListener("keydown",t=>{const p=h[t.key];p&&(e.activePlot&&Reactive.dispatch(e.activePlot,p),Reactive.dispatch(e,p))}),window.addEventListener("keyup",()=>{Marker.setGroup(n,Transient);for(const t of e.plots)t.parameters.mode=exports.Plot.Mode.Select,t.queryTable.style.display="none"}),window.addEventListener("resize",throttle(()=>exports.Scene.resize(e),10)),Reactive.listen(n,"cleared",()=>{for(const t of r)Reactive.dispatch(t,"unlock")}),Reactive.listen(e,"resize",()=>exports.Scene.resize(e)),Reactive.listen(e,"reset",()=>exports.Scene.reset(e)),Reactive.listen(e,"query-mode",()=>exports.Scene.setQueryMode(e)),Reactive.listen(e,"group-1",()=>exports.Scene.setGroupFirst(e)),Reactive.listen(e,"group-2",()=>exports.Scene.setGroupSecond(e)),Reactive.listen(e,"group-3",()=>exports.Scene.setGroupThird(e)),Reactive.listen(e,"connected",()=>{var t;return console.log(`Connected to Websocket server on: ${(t=e.client)==null?void 0:t.url}`)}),Reactive.listen(e,"set-dims",t=>{!t||!t.rows||!t.columns||exports.Scene.setDimensions(e,t.rows,t.cols)}),Reactive.listen(e,"add-plot",t=>{t&&exports.Scene.addPlotBySpec(e,t)}),Reactive.listen(e,"pop-plot",()=>exports.Scene.popPlot(e)),Reactive.listen(e,"remove-plot",t=>{!t||!t.id||exports.Scene.removePlot(e,t.id)}),Reactive.listen(e,"set-selected",t=>{!t||!t.cases||Marker.update(n,t.cases)}),Reactive.listen(e,"set-assigned",t=>{if(!t||!t.group)return;const p=7-Math.min(t.group,3);Marker.update(n,t.cases,{group:p})}),Reactive.listen(e,"get-selected",()=>{const t=filterIndices(Array.from(n.indices),Marker.isTransient);exports.Scene.sendMessage(e,"get-selected",{cases:t})}),Reactive.listen(e,"get-assigned",t=>{if(!t||!t.group)return;const p=c=>(c|4)===7-Math.min(t.group,3),a=filterIndices(Array.from(n.indices),p);exports.Scene.sendMessage(e,"get-assigned",{cases:a,group:t.group})}),Reactive.listen(e,"clear-selection",()=>Marker.clearAll(n)),Reactive.listen(e,"get-scale",t=>{if(!t||!t.id)return;const p=exports.Scene.getPlot(e,t.id);p&&Reactive.dispatch(p,"get-scale",t)}),Reactive.listen(e,"set-scale",t=>{if(!t||!t.id)return;const p=exports.Scene.getPlot(e,t.id);p&&Reactive.dispatch(p,"set-scale",t)}),Reactive.listen(e,"normalize",t=>{if(!t||!t.id)return;const p=exports.Scene.getPlot(e,t.id);p&&Reactive.dispatch(p,"normalize")}),Reactive.listen(e,"zoom",t=>{if(!t||!t.id)return;const p=exports.Scene.getPlot(e,t.id);p&&Reactive.dispatch(p,"zoom",t)}),Reactive.listen(e,"set-layout",t=>{!t||!t.layout||exports.Scene.setLayout(e,t.layout)}),Reactive.listen(e,"set-parameters",t=>{if(!t||!t.id)return;const p=exports.Scene.getPlot(e,t.id);p&&Reactive.dispatch(p,"set-parameters",t)}),Reactive.listen(e,"clear-layout",()=>exports.Scene.clearLayout(e))}const plotIdShort={s:"scatter",b:"bar",h:"histo",f:"fluct",hh:"histo2d",pc:"pcoords"};return exports.METHODS=METHODS,exports.POSITIONS=POSITIONS,exports.addIndexed=addIndexed,exports.addTailwind=addTailwind,exports.applyDirection=applyDirection,exports.applyWith=applyWith,exports.bimap=bimap,exports.binBreaks=binBreaks,exports.call=call,exports.capitalize=capitalize,exports.clearNodeChildren=clearNodeChildren,exports.compareAlphaNumeric=compareAlphaNumeric,exports.convertToSuperscript=convertToSuperscript,exports.copyProps=copyProps,exports.copyValues=copyValues,exports.cumsum=cumsum,exports.dec=dec,exports.diff=diff,exports.exp10=exp10,exports.exponentialToSuperscript=exponentialToSuperscript,exports.fetchJSON=fetchJSON,exports.filterIndices=filterIndices,exports.findLength=findLength,exports.formatAxisLabels=formatAxisLabels,exports.formatLabel=formatLabel,exports.formatText=formatText,exports.identity=identity,exports.inc=inc,exports.invertRange=invertRange,exports.isDefined=isDefined,exports.isEventTarget=isEventTarget,exports.isIntegerString=isIntegerString,exports.isNumber=isNumber,exports.isNumberArray=isNumberArray,exports.isObject=isObject,exports.isPrimitive=isPrimitive,exports.isStringArray=isStringArray,exports.isTypedArray=isTypedArray,exports.just=just,exports.keysToSelectors=keysToSelectors,exports.last=last,exports.log10=log10,exports.max=max,exports.merge=merge,exports.minDecimal=minDecimal,exports.minmax=minmax,exports.one=one,exports.orderBy=orderBy,exports.orderIndices=orderIndices,exports.orderIndicesByTable=orderIndicesByTable,exports.ordered=ordered,exports.pointInRect=pointInRect,exports.prettyBreaks=prettyBreaks,exports.prod=prod,exports.randomInteger=randomInteger,exports.rangeInverse=rangeInverse,exports.rectSegmentIntersect=rectSegmentIntersect,exports.rectsIntersect=rectsIntersect,exports.remove=remove,exports.removeTailwind=removeTailwind,exports.rep=rep,exports.round=round,exports.row=row,exports.segmentsIntersect=segmentsIntersect,exports.selector=selector,exports.seq=seq,exports.seqLength=seqLength,exports.splitNumericSuffix=splitNumericSuffix,exports.sqrt=sqrt,exports.square=square,exports.stringArraysMatch=stringArraysMatch,exports.stripWS=stripWS,exports.subset=subset,exports.sum=sum,exports.throttle=throttle,exports.timeExecution=timeExecution,exports.toLowerCase=toLowerCase,exports.toUpperCase=toUpperCase,exports.trunc=trunc,exports.tw=tw,exports.uniqueIntegers=uniqueIntegers,exports.zero=zero,Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),exports}({});
