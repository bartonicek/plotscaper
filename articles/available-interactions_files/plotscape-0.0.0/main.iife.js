var plotscape=function(exports){"use strict";var __vite_style__=document.createElement("style");__vite_style__.textContent=`*:where(.tailwind,.tailwind *),:before:where(.tailwind,.tailwind *),:after:where(.tailwind,.tailwind *){box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before:where(.tailwind,.tailwind *),:after:where(.tailwind,.tailwind *){--tw-content: ""}.tailwind{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}.tailwind{margin:0;line-height:inherit}hr:where(.tailwind,.tailwind *){height:0;color:inherit;border-top-width:1px}abbr:where([title]):where(.tailwind,.tailwind *){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1:where(.tailwind,.tailwind *),h2:where(.tailwind,.tailwind *),h3:where(.tailwind,.tailwind *),h4:where(.tailwind,.tailwind *),h5:where(.tailwind,.tailwind *),h6:where(.tailwind,.tailwind *){font-size:inherit;font-weight:inherit}a:where(.tailwind,.tailwind *){color:inherit;text-decoration:inherit}b:where(.tailwind,.tailwind *),strong:where(.tailwind,.tailwind *){font-weight:bolder}code:where(.tailwind,.tailwind *),kbd:where(.tailwind,.tailwind *),samp:where(.tailwind,.tailwind *),pre:where(.tailwind,.tailwind *){font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small:where(.tailwind,.tailwind *){font-size:80%}sub:where(.tailwind,.tailwind *),sup:where(.tailwind,.tailwind *){font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub:where(.tailwind,.tailwind *){bottom:-.25em}sup:where(.tailwind,.tailwind *){top:-.5em}table:where(.tailwind,.tailwind *){text-indent:0;border-color:inherit;border-collapse:collapse}button:where(.tailwind,.tailwind *),input:where(.tailwind,.tailwind *),optgroup:where(.tailwind,.tailwind *),select:where(.tailwind,.tailwind *),textarea:where(.tailwind,.tailwind *){font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button:where(.tailwind,.tailwind *),select:where(.tailwind,.tailwind *){text-transform:none}button:where(.tailwind,.tailwind *),input:where([type=button]):where(.tailwind,.tailwind *),input:where([type=reset]):where(.tailwind,.tailwind *),input:where([type=submit]):where(.tailwind,.tailwind *){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring:where(.tailwind,.tailwind *){outline:auto}:-moz-ui-invalid:where(.tailwind,.tailwind *){box-shadow:none}progress:where(.tailwind,.tailwind *){vertical-align:baseline}::-webkit-inner-spin-button:where(.tailwind,.tailwind *),::-webkit-outer-spin-button:where(.tailwind,.tailwind *){height:auto}[type=search]:where(.tailwind,.tailwind *){-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration:where(.tailwind,.tailwind *){-webkit-appearance:none}::-webkit-file-upload-button:where(.tailwind,.tailwind *){-webkit-appearance:button;font:inherit}summary:where(.tailwind,.tailwind *){display:list-item}blockquote:where(.tailwind,.tailwind *),dl:where(.tailwind,.tailwind *),dd:where(.tailwind,.tailwind *),h1:where(.tailwind,.tailwind *),h2:where(.tailwind,.tailwind *),h3:where(.tailwind,.tailwind *),h4:where(.tailwind,.tailwind *),h5:where(.tailwind,.tailwind *),h6:where(.tailwind,.tailwind *),hr:where(.tailwind,.tailwind *),figure:where(.tailwind,.tailwind *),p:where(.tailwind,.tailwind *),pre:where(.tailwind,.tailwind *){margin:0}fieldset:where(.tailwind,.tailwind *){margin:0;padding:0}legend:where(.tailwind,.tailwind *){padding:0}ol:where(.tailwind,.tailwind *),ul:where(.tailwind,.tailwind *),menu:where(.tailwind,.tailwind *){list-style:none;margin:0;padding:0}dialog:where(.tailwind,.tailwind *){padding:0}textarea:where(.tailwind,.tailwind *){resize:vertical}input::-moz-placeholder:where(.tailwind,.tailwind *),textarea::-moz-placeholder:where(.tailwind,.tailwind *){opacity:1;color:#9ca3af}input::placeholder:where(.tailwind,.tailwind *),textarea::placeholder:where(.tailwind,.tailwind *){opacity:1;color:#9ca3af}button:where(.tailwind,.tailwind *),[role=button]:where(.tailwind,.tailwind *){cursor:pointer}:disabled:where(.tailwind,.tailwind *){cursor:default}img:where(.tailwind,.tailwind *),svg:where(.tailwind,.tailwind *),video:where(.tailwind,.tailwind *),canvas:where(.tailwind,.tailwind *),audio:where(.tailwind,.tailwind *),iframe:where(.tailwind,.tailwind *),embed:where(.tailwind,.tailwind *),object:where(.tailwind,.tailwind *){display:block;vertical-align:middle}img:where(.tailwind,.tailwind *),video:where(.tailwind,.tailwind *){max-width:100%;height:auto}[hidden]:where(.tailwind,.tailwind *){display:none}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.tw-fixed{position:fixed}.tw-absolute{position:absolute}.tw-relative{position:relative}.tw-left-0{left:0}.tw-right-0{right:0}.tw-top-0{top:0}.tw-z-10{z-index:10}.tw-z-30{z-index:30}.tw-z-50{z-index:50}.tw-m-1{margin:.25rem}.tw-flex{display:flex}.tw-grid{display:grid}.tw-size-full{width:100%;height:100%}.tw-h-5\\/6{height:83.333333%}.tw-h-full{height:100%}.tw-h-screen{height:100vh}.tw-w-5\\/6{width:83.333333%}.tw-w-8{width:2rem}.tw-w-fit{width:-moz-fit-content;width:fit-content}.tw-w-full{width:100%}.tw-select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.tw-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.tw-grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.tw-flex-row{flex-direction:row}.tw-flex-col{flex-direction:column}.tw-flex-wrap{flex-wrap:wrap}.tw-content-center{align-content:center}.tw-items-center{align-items:center}.tw-justify-start{justify-content:flex-start}.tw-justify-center{justify-content:center}.tw-gap-\\[1em\\]{gap:1em}.tw-rounded-md{border-radius:.375rem}.tw-rounded-bl-md{border-bottom-left-radius:.375rem}.tw-border{border-width:1px}.tw-border-black{--tw-border-opacity: 1;border-color:rgb(0 0 0 / var(--tw-border-opacity))}.tw-border-b-black{--tw-border-opacity: 1;border-bottom-color:rgb(0 0 0 / var(--tw-border-opacity))}.tw-border-l-black{--tw-border-opacity: 1;border-left-color:rgb(0 0 0 / var(--tw-border-opacity))}.tw-bg-\\[\\#deded9\\]{--tw-bg-opacity: 1;background-color:rgb(222 222 217 / var(--tw-bg-opacity))}.tw-bg-gray-100{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity))}.tw-bg-gray-300{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity))}.tw-bg-gray-400{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity))}.tw-bg-slate-200{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity))}.tw-bg-slate-800{--tw-bg-opacity: 1;background-color:rgb(30 41 59 / var(--tw-bg-opacity))}.tw-bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.tw-bg-opacity-80{--tw-bg-opacity: .8}.tw-p-1{padding:.25rem}.tw-p-10{padding:2.5rem}.tw-px-2{padding-left:.5rem;padding-right:.5rem}.tw-px-3{padding-left:.75rem;padding-right:.75rem}.tw-py-1{padding-top:.25rem;padding-bottom:.25rem}.tw-py-10{padding-top:2.5rem;padding-bottom:2.5rem}.tw-text-center{text-align:center}.tw-font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.tw-text-\\[max\\(min\\(2vmin\\,16px\\)\\,8px\\)\\]{font-size:max(min(2vmin,16px),8px)}.tw-text-sm{font-size:.875rem;line-height:1.25rem}.tw-text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity))}.tw-text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.tw-shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.tw-outline-none{outline:2px solid transparent;outline-offset:2px}.tw-outline{outline-style:solid}.tw-outline-2{outline-width:2px}.tw-outline-slate-600{outline-color:#475569}.tw-drop-shadow-md{--tw-drop-shadow: drop-shadow(0 4px 3px rgb(0 0 0 / .07)) drop-shadow(0 2px 2px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.hover\\:tw-bg-gray-400:hover{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity))}.hover\\:tw-bg-gray-500:hover{--tw-bg-opacity: 1;background-color:rgb(107 114 128 / var(--tw-bg-opacity))}.hover\\:tw-bg-slate-200:hover{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity))}
`,document.head.appendChild(__vite_style__);const NAME=Symbol("name"),LENGTH=Symbol("length"),MIN=Symbol("min"),MAX=Symbol("max"),QUERYABLE=Symbol("queryable"),REDUCED=Symbol("reduced"),PARENT_VALUES=Symbol("parent-values"),IS_DIMENSION=Symbol("is-dimension"),keyToSymbolMap={name:NAME,length:LENGTH,min:MIN,max:MAX,queryable:QUERYABLE,reduced:REDUCED,parent:PARENT_VALUES,isDimension:IS_DIMENSION};var Meta;(e=>{function t(a,c){return!!a[keyToSymbolMap[c]]}e.has=t;function n(a,c){return Array.isArray(c)?c.map(f=>r(a,f)):r(a,c)}e.get=n;function r(a,c){return c==="length"&&Array.isArray(a)?a.length:a[keyToSymbolMap[c]]}function u(a,c){for(const[f,d]of Object.entries(c))a[keyToSymbolMap[f]]=d}e.set=u;function s(a,c,f){const d=f??Object.keys(keyToSymbolMap);for(const o of d)a[keyToSymbolMap[o]]=n(c,o)}e.copy=s})(Meta||(Meta={}));var Getter;(e=>{function t(c){if(typeof c=="function")return c;if(Array.isArray(c)){const f=d=>c[d];return Meta.set(f,{length:c.length}),f}if(isTypedArray(c)){const f=d=>c[d];return Meta.set(f,{length:c.length}),f}return()=>c}e.of=t;function n(c){return()=>c}e.constant=n;function r(c,f){const d=e.of(c),o=i=>d(f[i]);return isObject(c)&&Meta.copy(o,c),Meta.set(o,{length:f.length}),o}e.proxy=r;function u(c){const f=c.map(e.of),d=o=>f.map(i=>i(o));return Meta.copy(d,c[0],["length"]),d}e.multi=u;function s(c){const f={};for(const d of Reflect.ownKeys(c))f[d]=e.of(c[d]);return f}e.mapObject=s;function a(c,f){const d=e.of(f),o=Array(c);for(let i=0;i<c;i++)o[i]=d(i);return o}e.array=a})(Getter||(Getter={}));function identity(e){return e}const just=e=>()=>e,zero=just(0),one=just(1);function inc(e){return e+1}function dec(e){return e-1}function call(e){return e()}function bimap(e,t,n){if(e.length!==t.length)throw new Error("Arrays must be of the same length");const r=Array(e.length);for(let u=0;u<e.length;u++)r[u]=n(e[u],t[u]);return r}function square(e){return e**2}const sqrt=Math.sqrt,log10=Math.log10;function exp10(e){return 10**e}const max=Math.max;function diff(e,t){return e-t}function sum(e,t){return e+t}function prod(e,t){return e*t}function trunc(e,t=0,n=1){return Math.min(Math.max(e,t),n)}function rangeInverse(e,t){return 1/(t-e)}function invertRange(e,t){const n=rangeInverse(e,t);return[-e*n,n-e*n]}function round(e,t=0){return Math.round(e*10**t)/10**t}function compareAlphaNumeric(e,t){return e.localeCompare(t,"en",{numeric:!0})}function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}function toLowerCase(e){return e.toLocaleLowerCase()}function toUpperCase(e){return e.toLocaleUpperCase()}function stripWS(e){return e.replace(/\s/g,"")}function last(e){return e[e.length-1]}function rep(e,t){return Array(t).fill(e)}function seq(e,t,n){const r=Math.abs(t-e);n=n??Math.ceil(r)+1;const u=r/(n-1),s=t>=e?1:-1;return Array.from(Array(n),(a,c)=>e+s*u*c)}function seqLength(e,t){return Array.from(Array(t),(n,r)=>e+r)}function subset(e,t){const n=Array(t.length);for(let r=0;r<t.length;r++)n[r]=e[t[r]];return n}function remove(e,t){const n=e.indexOf(t);n!==-1&&e.splice(n,1)}function ordered(e,t){const n=Array(t.length);for(let r=0;r<t.length;r++)n[t[r]]=e[r];return n}function orderIndices(e){const t=e.toSorted(diff),n={},r={};for(let u=0;u<t.length;u++){const s=e[u];r[s]=r[s]+1||0,n[u]=t.indexOf(s)+r[s]}return Object.values(n)}function orderBy(e,t){const n=Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[t[r]];for(let r=0;r<e.length;r++)e[r]=n[r]}function orderIndicesByTable(e,t){const n=Array(e.length);for(let r=0;r<e.length;r++)n[r]=t.indexOf(e[r]);return n}function minmax(e){let[t,n]=[1/0,-1/0];for(let r=0;r<e.length;r++)t=Math.min(t,e[r]),n=Math.max(n,e[r]);return[t,n]}function cumsum(e){const t=Array(e.length);t[0]=e[0];for(let n=1;n<e.length;n++)t[n]=e[n]+t[n-1];return t}function randomInteger(e,t){return Math.floor(e+Math.random()*t)}function uniqueIntegers(e,t,n=t-e){const r=t-e,u=[],s=new Set;for(;u.length<Math.min(n,r);){let a=randomInteger(e,t);for(;s.has(a);)a=randomInteger(e,t);u.push(a),s.add(a)}return u}async function fetchJSON(e){return await(await fetch(e)).json()}function merge(e,t){return{...e,...t}}function copyValues(e,t){if(e!==t){if(isTypedArray(e)&&isTypedArray(t))t.set(e);else if(Array.isArray(e)&&Array.isArray(t)){t.length=e.length;for(let n=0;n<e.length;n++)t[n]=e[n]}}}function copyProps(e,t){for(const[n,r]of Object.entries(e))Array.isArray(r)&&Array.isArray(e[n])?copyValues(r,e[n]):t[n]=r}function applyDirection(e,t){return .5*(1-t)+t*e}function prettyBreaks(e,t,n=4){const r=(t-e)/n,u=Math.floor(Math.log10(r)),s=[1,2,4,5,10];let[a,c]=[1/0,0];for(let p=0;p<s.length;p++){const x=(s[p]*10**u-r)**2;x<a&&([a,c]=[x,s[p]])}const f=10**u*c,d=Math.ceil(e/f)*f,o=Math.floor(t/f)*f,i=Math.round((o-d)/f),l=[];for(let p=0;p<i+1;p++){const x=d+p*f;l.push(x)}return l}function binBreaks(e,t){let{width:n,anchor:r,nBins:u}=t||{};const[s,a]=minmax(e),c=a-s;u=u??(n?Math.ceil(c/n)+1:10),n=n??c/(u-1),r=r??s;const f=s-n+(r-s)%n,d=a+n-(a-r)%n,o=Array(u+2);o[0]=f,o[o.length-1]=d;for(let i=1;i<o.length-1;i++)o[i]=f+i*n;return o}function tw(e){return e.trim().split(/\s+/)}function addTailwind(e,t){for(const n of t.trim().split(/\s+/))e.classList.add(n)}function removeTailwind(e,t){for(const n of t.trim().split(/\s+/))e.classList.remove(n)}function throttle(e,t){let n=0;return function(...r){const u=new Date().getTime();u-n<t||(n=u,e(...r))}}function timeExecution(e){const t=performance.now();return e(),performance.now()-t}function segmentToPointVec(e){const[t,n,r,u]=e;return[t,n,r-t,u-n]}function inRange(e,t,n){return!(e<t)&&!(e>n)}function segmentsIntersect(e,t){let[n,r,u,s]=segmentToPointVec(e),[a,c,f,d]=segmentToPointVec(t);const o=f*s-u*d,i=((n-a)*s-(r-c)*u)/o,l=-(-(n-a)*d+(r-c)*f)/o;return inRange(i,0,1)&&inRange(l,0,1)}function rectSegmentIntersect(e,t){const[n,r,u,s]=e;return segmentsIntersect([n,r,u,r],t)||segmentsIntersect([n,r,n,s],t)||segmentsIntersect([u,r,u,s],t)||segmentsIntersect([n,s,u,s],t)}function pointInRect(e,t){const[n,r]=e,[u,s,a,c]=t;return!(n<u||n>a||r<s||r>c)}function rectsIntersect(e,t){const[n,r]=[e[0],e[2]].sort(diff),[u,s]=[e[1],e[3]].sort(diff),[a,c]=[t[0],t[2]].sort(diff),[f,d]=[t[1],t[3]].sort(diff);return!(r<a||n>c||s<f||u>d)}function addIndexed(e,t,n){const u=Object.keys(e).filter(c=>c.replace(/[0-9]*$/,"")===t);if(u.length===0){e[`${t}1`]=n;return}const s=u.map(c=>parseInt(c.match(/[0-9]*$/)[0],10)),a=Math.max(...s);e[`${t}${a+1}`]=n}function minDecimal(e){let t=1/0;for(let n=0;n<e.length;n++)e[n]!==0&&(t=Math.min(t,Math.log10(Math.abs(e[n]))));return t>3?0:Math.floor(Math.abs(t))+2}function formatText(e,t={lowercase:!0,capitalize:!0,split:!0}){return t!=null&&t.split&&(e=e.replace(/_/g," ")),t!=null&&t.lowercase&&(e=e.toLocaleLowerCase()),t!=null&&t.capitalize&&(e=capitalize(e)),e}function formatLabel(e){if(typeof e=="string")return e;if(e===0)return e.toString();const t=Math.floor(Math.log10(Math.abs(e)));return t>=3?round(e).toString():t<=-3?round(e,-t+1).toString():round(e,2).toString()}function formatAxisLabels(e,t){if(!isNumberArray(e))return e;const n=(t==null?void 0:t.tens)??4,r=c=>c!=0&&Math.abs(Math.log10(c))>n,u=(t==null?void 0:t.decimals)??minDecimal(e);e=e.map(c=>round(c,u));const a=minmax(e).some(r)?superscriptFn:noSuperscriptFn;return e.map(a)}function superscriptFn(e){return e===0?"0":exponentialToSuperscript(e.toExponential())}function noSuperscriptFn(e){return e===0?"0":parseFloat(e.toPrecision(12)).toString()}function exponentialToSuperscript(e){let[t,n]=e.split("e");return n=convertToSuperscript(n),t+"×10"+n}const sups={"-":"⁻","+":"",0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹"};function convertToSuperscript(e){return e.split("").map(t=>sups[t]).join("")}function isDefined(e){return e!=null}const primitives=["string","number","boolean","undefined"];function isPrimitive(e){return e===null||primitives.includes(typeof e)}function isObject(e){return typeof e=="object"&&e!==null}function isTypedArray(e){return ArrayBuffer.isView(e)}function isNumber(e){return typeof e=="number"}function isIntegerString(e){return/^[0-9]+/.test(e)}function isNumberArray(e){return typeof e[0]=="number"&&typeof last(e)=="number"}function isStringArray(e){return typeof e[0]=="string"&&typeof last(e)=="string"}function isEventTarget(e){return"addEventListener"in e}function findLength(e){for(const n of e){if(!n)continue;const r=Meta.get(n,"length");if(r)return r}const t="At least one variable needs to be of fixed length";throw new Error(t)}function applyWith(...e){return function(t){return t(...e)}}function row(e,t){const n={};for(const[r,u]of Object.entries(e))n[r]=Getter.of(u)(t);return n}function selector(e){return function(t){return t[e]}}function keysToSelectors(e){return function(t){return e.map(n=>t[n])}}function splitNumericSuffix(e){let t=e.length-1;for(;t>0&&/[0-9]/.test(e[t]);)t--;return t+=1,[e.substring(0,t),e.substring(t,e.length)]}function filterIndices(e,t){const n=[];for(let r=0;r<e.length;r++)t(e[r])&&n.push(r);return n}function stringArraysMatch(e,t){if(e.length!==t.length)return!1;const n=e.toSorted(compareAlphaNumeric).join(""),r=t.toSorted(compareAlphaNumeric).join("");return n===r}const LISTENERS=Symbol("listeners"),DEFERRED=Symbol("deferred");var Reactive;(e=>{function t(){return function(o){return{...o,[LISTENERS]:{},[DEFERRED]:{}}}}e.of=t;function n(o){return o[LISTENERS]!==void 0}e.is=n;function r(o,i,l,p){p!=null&&p.throttle&&(l=throttle(l,p.throttle));const x=p!=null&&p.defer?o[DEFERRED]:o[LISTENERS];x[i]||(x[i]=[]),x[i].includes(l)||x[i].push(l)}e.listen=r;function u(o,i,l){const[p,x]=[o[LISTENERS][i],o[DEFERRED][i]];if(p)for(const b of p)b(l);if(x)for(const b of x)b(l)}e.dispatch=u;function s(o,i,l){const p=()=>e.dispatch(i,l);e.listen(o,l,p,{defer:!0})}e.propagate=s;function a(o,i){i(o),e.dispatch(o,"changed")}e.set=a;function c(o,i,l){const[p,x]=[o[LISTENERS][i],o[DEFERRED][i]];p&&remove(p,l),x&&remove(x,l)}e.remove=c;function f(o,i){const[l,p]=[o[LISTENERS][i],o[DEFERRED][i]];if(l)for(const x of l)remove(l,x);if(p)for(const x of p)remove(p,x)}e.removeAll=f;function d(o){const[i,l]=[o[LISTENERS],o[DEFERRED]];if(i)for(const p of Object.values(i))p.length=0;if(l)for(const p of Object.values(l))p.length=0}e.removeAllListeners=d})(Reactive||(Reactive={}));const METHODS=Symbol("methods");exports.Poly=void 0,(e=>{function t(u){const s=function(...a){return n(s,u,a[0].type)(...a)};return s[METHODS]={},s}e.of=t;function n(u,s,a){return u[METHODS][a]??s}e.dispatch=n;function r(u,s,a){u[METHODS][s]=a}e.set=r})(exports.Poly||(exports.Poly={})),exports.Expanse=void 0,(e=>{e.normalize=exports.Poly.of(t),e.unnormalize=exports.Poly.of(n),e.train=exports.Poly.of(r),e.breaks=exports.Poly.of(u),e.reorder=exports.Poly.of(s);function t(m,S){throw new Error(`Method 'normalize' not implemented for expanse of type '${m.type}'`)}function n(m,S){throw new Error(`Method 'unnormalize' not implemented for expanse of type '${m.type}'`)}function r(m,S,M){throw new Error(`Method 'train' not implemented for expanse of type '${m.type}'`)}e.trainDefault=r;function u(m,S,M){throw new Error(`Method 'breaks' not implemented for expanse of type '${m.type}'`)}function s(m,S){throw new Error(`Method 'reorder' not implemented for expanse of type '${m.type}'`)}function a(){return Reactive.of()({})}e.base=a;function c(m,S,M){const{frozen:E,props:A}=m,h=S({...A});if(!(M!=null&&M.unfreeze))for(const y of E)delete h[y];for(const y of Object.keys(h))h[y]===m.props[y]&&delete h[y];copyProps(h,m.props),M!=null&&M.default&&copyProps(h,m.defaults),M!=null&&M.silent||Reactive.dispatch(m,"changed")}e.set=c;function f(m,S){for(const M of S)m.frozen.includes(M)||m.frozen.push(M)}e.freeze=f;function d(m,S){const{defaults:M}=m;for(const[E,A]of Object.entries(M))Array.isArray(A)&&Array.isArray(m.props[E])?copyValues(A,m.props[E]):m.props[E]=A;S!=null&&S.silent||Reactive.dispatch(m,"changed")}e.reset=d;function o(m){return m.type==="continuous"||m.type==="split"}e.isContinuous=o;function i(m){return m.type==="point"}e.isPoint=i;function l(m){return m.type==="point"||m.type==="band"}e.isDiscrete=l;function p(m){return m.type==="band"}e.isBand=p;function x(m){return m.type==="compound"}e.isCompound=x;function b(m){return m.type==="split"}e.isSplit=b})(exports.Expanse||(exports.Expanse={}));var ExpanseBand;(e=>{const t="band";function n(o=[]){const i="",l=exports.Expanse.base(),[p,x]=[!1,seqLength(0,o.length)],b=Array(o.length).fill(1),m=cumsum(b),S={labels:o,ordered:p,order:x,weights:b,cumulativeWeights:m},M=structuredClone(S);return{...l,type:t,value:i,props:S,defaults:M,frozen:[]}}e.of=n,exports.Poly.set(exports.Expanse.normalize,t,r),exports.Poly.set(exports.Expanse.unnormalize,t,u),exports.Poly.set(exports.Expanse.train,t,s),exports.Poly.set(exports.Expanse.breaks,t,c),exports.Poly.set(exports.Expanse.reorder,t,a);function r(o,i){const{labels:l}=o.props,p=l.indexOf(i);if(p===-1)throw new Error(`Label ${i} not found in: ${l}`);return d(o,p)}e.normalize=r;function u(o,i){const{labels:l}=o.props,p=Math.round((2*i*l.length-1)/2);return l[p]}e.unnormalize=u;function s(o,i,l){const{props:p}=o,{order:x}=p,b=Array.from(new Set(i)).sort(compareAlphaNumeric);if(!x.length){for(let E=0;E<b.length;E++)x[E]=E;o.defaults.order=[...x],p.ordered=!1}const m=Array(b.length).fill(1),S=cumsum(ordered(m,x)),M={labels:b,weights:m,cumulativeWeights:S};for(const[E,A]of Object.entries(M))copyValues(A,o.props[E]),l!=null&&l.default&&copyValues(A,o.defaults[E]);exports.Expanse.set(o,()=>({}),l)}e.train=s;function a(o,i){const{props:l,defaults:p}=o,{order:x,weights:b,cumulativeWeights:m}=o.props;if(!i){copyValues(p.order,x),copyValues(cumsum(ordered(b,x)),m),l.ordered=!1,Reactive.dispatch(o,"changed");return}copyValues(i,x),copyValues(cumsum(ordered(b,i)),m),l.ordered=!0,Reactive.dispatch(o,"changed")}e.reorder=a;function c(o){const{labels:i,order:l}=o.props;return ordered(i,l)}e.breaks=c;function f(o,i){const{props:l,defaults:p}=o;if(i=i??Array(l.labels.length).fill(1),i.length!=l.labels.length){const m="The length of the weights must match the length of labels";throw new Error(m)}const{order:x}=l,b=cumsum(ordered(i,x));copyValues(i,l.weights),copyValues(i,p.weights),copyValues(b,l.cumulativeWeights),copyValues(b,p.cumulativeWeights),Reactive.dispatch(o,"changed")}e.setWeights=f;function d(o,i){const{order:l,cumulativeWeights:p}=o.props;i=l[i];const x=p[i-1]??0,b=p[i],m=last(p);return(x+b)/2/m}})(ExpanseBand||(ExpanseBand={}));var ExpanseContinuous;(e=>{const t="continuous";function n(f=0,d=1){const i=exports.Expanse.base(),[l,p]=[identity,identity],[x,b,m,S]=[1,1,0,!1],M={min:f,max:d,scale:x,mult:b,offset:m,ratio:S,trans:l,inv:p},E={...M,trans:l,inv:p};return{...i,value:0,type:t,props:M,defaults:E,frozen:[]}}e.of=n,exports.Poly.set(exports.Expanse.normalize,t,r),exports.Poly.set(exports.Expanse.unnormalize,t,u),exports.Poly.set(exports.Expanse.train,t,s),exports.Poly.set(exports.Expanse.breaks,t,a);function r(f,d){const{min:o,max:i,scale:l,mult:p,offset:x,trans:b}=f.props,m=b(i)-b(o);let S=d/(l*p)-x;return S=(b(S-x)-b(o))/m,S}e.normalize=r;function u(f,d){const{min:o,max:i,scale:l,mult:p,offset:x,trans:b,inv:m}=f.props,S=b(i)-b(o);let M=m(b(o)+d*S);return M=M*(l*p)+x,M}e.unnormalize=u;function s(f,d,o){const{ratio:i}=f.props;let[l,p]=Meta.get(d,["min","max"]);(!l||!p)&&([l,p]=minmax(d)),l=i||o!=null&&o.ratio?0:l,exports.Expanse.set(f,()=>({min:l,max:p}),o)}e.train=s;function a(f,d=0,o=1){let[i,l]=[d,o].map(x=>u(f,x));return[i,l]=[i,l].sort(diff),prettyBreaks(i,l,4)}e.breaks=a;function c(f){const{min:d,max:o}=f.props;return o-d}e.range=c})(ExpanseContinuous||(ExpanseContinuous={})),exports.Scale=void 0,(e=>{function t(h,y){const v={zero:0,one:1,direction:1},g={...v},[w,R]=[[],[]],I=Reactive.of()({domain:h,codomain:y,props:v,defaults:g,frozen:R,linked:w});return Reactive.propagate(h,I,"changed"),Reactive.propagate(y,I,"changed"),I}e.of=t;function n(h,y){const{domain:v,codomain:g,props:w}=h,{zero:R,one:I,direction:T}=w;let z=exports.Expanse.normalize(v,y);return Array.isArray(z)?z=z.map(F=>u(R+F*(I-R),T)):(z=R+z*(I-R),z=u(z,T)),exports.Expanse.unnormalize(g,z)}e.pushforward=n;function r(h,y){const{domain:v,codomain:g,props:w}=h,{zero:R,one:I}=w;let T=exports.Expanse.normalize(g,y);return Array.isArray(T)?T=T.map(z=>(z-R)/(I-R)):T=(T-R)/(I-R),exports.Expanse.unnormalize(v,T)}e.pullback=r;function u(h,y){return .5*(1-y)+y*h}function s(h,y,v){const{linked:g,frozen:w,props:R}=h,I=y({...R});if(!(v!=null&&v.unfreeze))for(const T of w)delete I[T];Object.assign(R,I),v!=null&&v.default&&Object.assign(h.defaults,I),v!=null&&v.silent||Reactive.dispatch(h,"changed");for(const T of g)e.set(T,y,v)}e.set=s;function a(h,y){for(const v of y)h.frozen.includes(v)||h.frozen.push(v)}e.freeze=a;function c(h){e.set(h,y=>({direction:-1*y.direction}))}e.flip=c;function f(h,y){let{direction:v,zero:g,one:w}=h.props;g+=v*y,w+=v*y,e.set(h,()=>({zero:g,one:w}))}e.move=f;function d(h,y,v,g){const{zero:w,one:R,direction:I}=h.props,T=R-w;I===-1&&([y,v]=[1-y,1-v]),[y,v]=[y,v].map(z=>(z-w)/T),[y,v]=invertRange(y,v),I===-1&&([y,v]=[1-y,1-v]),e.set(h,()=>({zero:y,one:v}),g)}e.expand=d;function o(h,y,v){if(((v==null?void 0:v.name)??!0)&&Meta.has(y,"name")&&Meta.copy(h,y,["name"]),typeof y[0]=="string"&&exports.Expanse.isContinuous(h.domain)){const w=Array.from(new Set(y));h.domain=ExpanseBand.of(w)}exports.Expanse.train(h.domain,y,v)}e.train=o;function i(h,y){Object.assign(h.props,h.defaults),y!=null&&y.silent||Reactive.dispatch(h,"changed")}e.reset=i;function l(h){exports.Expanse.reset(h.domain,{silent:!0}),exports.Expanse.reset(h.codomain,{silent:!0}),e.reset(h)}e.restore=l;function p(h){const{domain:y,props:v}=h;let{zero:g,one:w}=v;[g,w]=invertRange(g,w);const R=exports.Expanse.breaks(y,g,w);let I=formatAxisLabels(R);if(exports.Expanse.isCompound(h.domain)){I=formatAxisLabels(R,{decimals:1});const z=R.map(F=>exports.Expanse.unnormalize(h.codomain,ExpanseContinuous.normalize(h.domain,F)));return{labels:I,positions:z}}else if(exports.Expanse.isSplit(h.codomain)){const z=e.pushforward(h,R);return{labels:I,positions:z}}const T=R.map(z=>e.pushforward(h,z));return{labels:I,positions:T}}e.breaks=p;function x(h,y){h.linked.includes(y)||h.linked.push(y)}e.link=x;function b(h,y){y.codomain=h.codomain}e.shareCodomain=b;function m(h){return h.props.one-h.props.zero}e.unitRange=m;function S(h){const{domain:y}=h;if(exports.Expanse.isContinuous(y))return ExpanseContinuous.range(y)/m(h)}e.domainRange=S;function M(h){const{codomain:y}=h;if(exports.Expanse.isContinuous(y))return ExpanseContinuous.range(y)*m(h)}e.codomainRange=M;function E(h){if(!A(h))throw new Error("Both domain and codomain need to be continuous");const{domain:y,codomain:v}=h,g=ExpanseContinuous.range(y);return ExpanseContinuous.range(v)*m(h)/g}e.unitRatio=E;function A(h){const{domain:y,codomain:v}=h;return exports.Expanse.isContinuous(y)&&exports.Expanse.isContinuous(v)}e.isContinuous=A})(exports.Scale||(exports.Scale={})),exports.Factor=void 0,(e=>{e.POSITIONS=Symbol("positions"),e.DIMENSION=Symbol("dimension"),e.CHILD_INDICES=Symbol("child-indices");function t(o,i,l,p){return Reactive.of()({type:o,cardinality:i,indices:l,data:p})}e.of=t;function n(o,i){i.cardinality=o.cardinality,copyValues(o.indices,i.indices);for(const l of Reflect.ownKeys(o.data))Array.isArray(o.data[l])&&Array.isArray(i.data[l])?(copyValues(o.data[l],i.data[l]),Meta.copy(i.data[l],o.data[l])):i.data[l]=o.data[l]}e.copyFrom=n;function r(o,i){if([o,i].some(l=>l.type==="bijection"))return!0;if(o.indices.length!==i.indices.length)throw new Error("Factors do not have matching length")}function u(o,i){const p=new Uint32Array(seq(0,o)),x=S=>[S];i=i??{};for(const S of Object.values(i))Meta.set(S,{queryable:!0});const b="bijection",m={...i,[e.POSITIONS]:x};return t(b,1/0,p,m)}e.bijection=u;function s(o){const l=new Uint32Array(o).fill(0),p=()=>Array.from(l),x="constant",b={[e.POSITIONS]:p};return t(x,1,l,b)}e.mono=s;function a(o,i){const l=o.map(M=>M.toString());i=i??Array.from(new Set(l)).sort(compareAlphaNumeric),Meta.has(o,"name")&&Meta.copy(i,o,["name"]);const p=new Uint32Array(o.length),x={};for(let M=0;M<l.length;M++){const E=i.indexOf(l[M]);x[E]||(x[E]=[]),p[M]=E,x[E].push(M)}Meta.set(i,{queryable:!0,isDimension:!0});const b=Object.values(x),m="surjection",S={label:i,[e.POSITIONS]:b};return t(m,i.length,p,S)}e.from=a;function c(o,i){function l(){const x=(i==null?void 0:i.breaks)??binBreaks(o,i),b=new Set,m=new Uint32Array(o.length),S={};for(let z=0;z<o.length;z++){const F=x.findIndex(_=>_>=o[z])-1;S[F]||(S[F]=[]),m[z]=F,S[F].push(z),b.add(F)}const M=Array.from(b).sort(diff);for(let z=0;z<m.length;z++)m[z]=M.indexOf(m[z]);const[E,A]=[[],[]];for(let z=0;z<M.length;z++)E.push(x[M[z]]),A.push(x[M[z]+1]);const[h,y]=[x[M[0]],x[last(M)+1]],v=`min of ${Meta.get(o,"name")}`,g=`max of ${Meta.get(o,"name")}`,w={queryable:!0,isDimension:!0};Meta.set(E,{min:h,max:y,name:v,...w}),Meta.set(A,{min:h,max:y,name:g,...w}),Meta.copy(x,o,["name"]);const R=Object.values(S),I="surjection",T={binMin:E,binMax:A,breaks:x,[e.POSITIONS]:R};return t(I,M.length,m,T)}const p=l();return i&&Reactive.is(i)&&Reactive.listen(i,"changed",()=>{const x=l();e.copyFrom(x,p),Reactive.dispatch(p,"changed")}),p}e.bin=c;function f(o,i){r(o,i),o.data[e.CHILD_INDICES]=[];function l(){if(o.type==="bijection"){const _={};for(const C of Reflect.ownKeys(o.data))_[C]=Getter.of(o.data[C]),Meta.copy(_[C],o.data[C]);for(const C of Reflect.ownKeys(i.data))_[C]=Getter.proxy(i.data[C],i.indices),Meta.copy(_[C],i.data[C]);const U="bijection",j=i.indices.length,k=new Uint32Array(i.indices.length),O=t(U,j,k,_);O.parent=o;const D=Array.from(Array(k.length),(C,L)=>[L]);return copyValues(D,o.data[e.CHILD_INDICES]),O}if(o.type==="constant"){const{type:_,data:U,cardinality:j,indices:k}=i,O=t(_,j,k,U);return O.parent=o,O}const x=Math.max(o.cardinality,i.cardinality)+1,b=new Set,m=new Uint32Array(o.indices.length),S={},M={},E={},A=Getter.of(o.indices),h=Getter.of(i.indices);for(let _=0;_<o.indices.length;_++){const[U,j]=[A(_),h(_)],k=x*U+j;k in M||(M[k]=U,E[k]=j,S[k]=[]),m[_]=k,S[k].push(_),b.add(k)}const y=Array.from(b).sort(diff),v={};for(const _ of Object.keys(M))v[parseInt(_)]=y.indexOf(parseInt(_));for(let _=0;_<m.length;_++)m[_]=v[m[_]];const g={};for(const[_,U]of Object.entries(M))U in g||(g[U]=[]),g[U].push(v[parseInt(_)]);const w=Object.values(M),R=Object.values(E),I={};for(let _ of Reflect.ownKeys(o.data)){let U=_;if(typeof _=="string")for(;U in I;)_+="$";const[j,k]=[o.data[_],w],O=Array.isArray(j)?subset(j,k):Getter.proxy(j,k);Meta.copy(O,j),I[U]=O}for(let _ of Reflect.ownKeys(i.data)){let U=_;if(typeof _=="string")for(;U in I;)U+="$";const[j,k]=[i.data[_],R],O=Array.isArray(j)?subset(j,k):Getter.proxy(j,k);Meta.copy(O,j),I[U]=O}const T="surjection";I[e.POSITIONS]=Object.values(S);const z=t(T,y.length,m,I);z.parent=o;const F=Object.values(g);return copyValues(F,o.data[e.CHILD_INDICES]),z}const p=l();return Reactive.listen(o,"changed",()=>{const x=l();e.copyFrom(x,p),Reactive.dispatch(p,"changed")}),Reactive.listen(i,"changed",()=>{const x=l();e.copyFrom(x,p),Reactive.dispatch(p,"changed")}),p}e.product=f;function d(o,i){const l={};for(let p=0;p<i.indices.length&&(l[i.indices[p]]=o.indices[p],!(Object.keys(l).length>=i.cardinality));p++);return Object.values(l)}e.parentIndices=d})(exports.Factor||(exports.Factor={}));const Transient=255;var Group=(e=>(e[e.Base=7]="Base",e[e.First=6]="First",e[e.Second=5]="Second",e[e.Third=4]="Third",e[e.BaseTransient=3]="BaseTransient",e[e.FirstTransient=2]="FirstTransient",e[e.SecondTransient=1]="SecondTransient",e[e.ThirdTransient=0]="ThirdTransient",e))(Group||{});const LAYER=Symbol("layer");var Marker;(e=>{function t(o){const i=Transient,l=new Uint32Array(o).fill(7),p=[],x="surjection",b=[0,1,2,3,4,5,6,7],m=exports.Factor.of(x,8,l,{[LAYER]:b});Meta.set(b,{queryable:!0});const S=Reactive.of()({group:i,indices:l,transientIndices:p,factor:m});return Reactive.listen(S,"updated",()=>Reactive.dispatch(m,"changed")),Reactive.listen(S,"cleared",()=>Reactive.dispatch(m,"changed")),S}e.of=t;function n(o,i){o.group=i}e.setGroup=n;function r(o,i,l){const p=(l==null?void 0:l.group)??o.group;if(s(o,{silent:!0}),p===Transient){for(let x=0;x<i.length;x++){const b=i[x];o.indices[b]=f(o.indices[b])}o.transientIndices=i}else for(let x=0;x<i.length;x++){const b=i[x];o.indices[b]=p}l!=null&&l.silent||Reactive.dispatch(o,"updated")}e.update=r;function u(o,i){for(let l=0;l<o.indices.length;l++)o.indices[l]=7;i!=null&&i.silent||Reactive.dispatch(o,"cleared")}e.clearAll=u;function s(o,i){for(let l=0;l<o.transientIndices.length;l++){const p=o.transientIndices[l];o.indices[p]=d(o.indices[p])}i!=null&&i.silent||Reactive.dispatch(o,"cleared")}e.clearTransient=s;function a(o){const{factor:i,indices:l}=o;return p=>i.data[LAYER][l[p]]}e.getLayer=a;function c(o){return!(o&4)}e.isTransient=c;function f(o){return o&-5}function d(o){return o|4}})(Marker||(Marker={}));var Reduced;(e=>{e.PARENT=Symbol("parent"),e.VALUES=Symbol("values"),e.INDICES=Symbol("indices"),e.FACTOR=Symbol("factor"),e.REDUCER=Symbol("reducer"),e.ORIGINAL_VALUES=Symbol("original-values");function t(l,p,x,b){const m=l;return m[e.VALUES]=l,m[e.FACTOR]=p,m[e.REDUCER]=x,m[e.ORIGINAL_VALUES]=l,b&&n(m,b),m}e.of=t;function n(l,p){l[e.PARENT]=p}e.setParent=n;function r(l){const[,p,x,b]=i(l);if(!b)throw new Error("Parent missing");const m=exports.Factor.parentIndices(c(b),p),S=subset(b,m),M=t(S,c(b),x,f(b));return d(M,b),o(M,m),M[e.ORIGINAL_VALUES]=l[e.ORIGINAL_VALUES],Meta.copy(M,l,["name","queryable","reduced"]),M}e.parent=r;function u(l){const[p,x,b,m,S]=i(l);if(!m)throw new Error("Cannot stack a without a parent");const M=exports.Factor.parentIndices(c(m),x),{reducefn:E,initialfn:A}=b,[h,y]=[p.length,[]],v=Array.from(Array(h),()=>A()),g=Getter.of(M);for(let I=0;I<p.length;I++){const T=g(I);y[T]===void 0&&(y[T]=A()),y[T]=E(y[T],p[I]),v[I]=y[T]}const w=S?subset(v,S):v,R=e.of(w,x,b,m);return d(R,v),S&&o(R,S),R[e.ORIGINAL_VALUES]=l[e.ORIGINAL_VALUES],Meta.copy(R,l,["name","queryable","reduced"]),R}e.stack=u;function s(l,p){const[x,b,m,S,M]=i(l);if(!S)throw new Error("Cannot normalize a without a parent");const E=exports.Factor.parentIndices(c(S),b),A=subset(S,E),h=[...x];for(let g=0;g<l.length;g++)h[g]=p(h[g],A[g]);const y=M?subset(h,M):h,v=e.of(y,b,m,S);return d(v,h),M&&o(v,M),v[e.ORIGINAL_VALUES]=l[e.ORIGINAL_VALUES],Meta.copy(v,l,["name","queryable","reduced"]),v}e.normalize=s;function a(l){const[p,x,b,m,S]=i(l),M=[];M.push(b.initialfn());for(let h=0;h<p.length-1;h++)M.push(p[h]);const E=S?subset(M,S):M,A=e.of(E,x,b,m);return d(A,M),S&&o(A,S),A[e.ORIGINAL_VALUES]=l[e.ORIGINAL_VALUES],Meta.copy(A,l,["name","queryable"]),A}e.shiftLeft=a;function c(l){return l[e.FACTOR]}function f(l){return l[e.PARENT]}e.getParent=f;function d(l,p){l[e.VALUES]=p}function o(l,p){l[e.INDICES]=p}function i(l){return[l[e.VALUES],l[e.FACTOR],l[e.REDUCER],l[e.PARENT],l[e.INDICES]]}})(Reduced||(Reduced={}));var Geom;(e=>{e.render=exports.Poly.of(t),e.check=exports.Poly.of(n),e.query=exports.Poly.of(r);function t(o,i){throw new Error(`Method 'render' not implemented for geom of type '${o.type}'`)}function n(o,i){throw new Error(`Method 'check' not implemented for geom of type '${o.type}'`)}function r(o,i){throw new Error(`Method 'render' not implemented for geom of type '${o.type}'`)}function u(o){return o.data[o.data.length-2]}e.flatData=u;function s(o){return o.data[o.data.length-1]}e.groupedData=s;function a(o,i,l){const[p,x]=[Array(o),Getter.of(i)];for(let b=0;b<o;b++)p[b]=l[x(b)];return p}e.frames=a;function c(o,i){const l=[];for(const[p,x]of i){const b=Array(o),m=Getter.of(p??1);for(let S=0;S<o;S++)b[S]=exports.Scale.pushforward(x,m(S));l.push(b)}return l}e.scaledArrays=c;function f(o,i){const l=i[0],x=[d(o,l,{dimension:"only"})];for(let b=0;b<i.length;b++){const m=i[b],S=d(o,m,{dimension:"exclude"});S[LAYER]=Getter.of(o[LAYER])(m),x.push(S)}return x}e.getQueryInfo=f;function d(o,i,l){const p={},x=l==null?void 0:l.dimension;for(const b of Object.values(o)){if(x==="exclude"&&Meta.get(b,"isDimension")||x==="only"&&!Meta.get(b,"isDimension"))continue;const[m,S,M]=Meta.get(b,["name","queryable","reduced"]);if(!m||!S)continue;const E=M?b[Reduced.ORIGINAL_VALUES]:b,A=Getter.of(E);p[m]=A(i)}return p}})(Geom||(Geom={}));var DOM;(e=>{function t(f,d){const o=document.createElement(f);return d!=null&&d.id&&(o.id=d.id),d!=null&&d.classes&&s(o,d.classes),d!=null&&d.textContent&&(o.textContent=d.textContent),o}e.element=t;function n(f,d){f.appendChild(d)}e.append=n;function r(f,d){return f.querySelector(d)}e.select=r;function u(f,d){for(const[o,i]of Object.entries(d))f.style[o]=i}e.setStyles=u;function s(f,d){for(const o of d)f.classList.add(o)}e.addClasses=s;function a(f,d){for(const o of d)f.classList.remove(o)}e.removeClasses=a;function c(f){f.innerHTML=""}e.clearChildren=c})(DOM||(DOM={}));var VAnchor=(e=>(e[e.Middle=.5]="Middle",e[e.Top=1]="Top",e[e.Bottom=0]="Bottom",e))(VAnchor||{}),HAnchor=(e=>(e[e.Center=.5]="Center",e[e.Left=1]="Left",e[e.Right=0]="Right",e))(HAnchor||{}),MouseButton=(e=>(e[e.Left=0]="Left",e[e.Right=2]="Right",e))(MouseButton||{});const dataLayers=[0,1,2,3,4,5,6,7],baseLayers=[4,5,6,7];var Frame;(e=>{function t(A){const h=DOM.element("canvas"),y=h.getContext("2d");DOM.addClasses(h,tw(A.classes??""));for(const[U,j]of Object.entries(A.canvasStyles??{}))h.style[U]=j;const{clientWidth:v,clientHeight:g,clientLeft:w,clientTop:R}=h,I=v-w,T=g-R,z=2,{margins:F=[0,0,0,0],contextProps:_={}}=A;return{canvas:h,context:y,width:I,height:T,margins:F,scalingFactor:z,contextProps:_}}e.of=t;function n(A,h){h.appendChild(A.canvas),A.parent=h,e.resize(A)}e.append=n;function r(A,h){for(const[y,v]of Object.entries(h))A.contextProps[y]=v,A.context[y]=v}e.setContext=r;function u(A){const{context:h,canvas:y,scalingFactor:v}=A,{clientWidth:g,clientHeight:w,clientLeft:R,clientTop:I}=y,T=g-R,z=w-I;A.width=T,A.height=z,A.canvas.width=T*v,A.canvas.height=z*v;for(const[F,_]of Object.entries(A.contextProps))A.context[F]=_;h.scale(v,v),e.clip(A)}e.resize=u;function s(A){const{context:h}=A;let{width:y,height:v}=A;const[g,w,R,I]=A.margins;y=Math.max(y-w-I,0),v=Math.max(v-R-g,0),h.beginPath(),h.rect(w,R,y,v),h.clip()}e.clip=s;function a(A){A.context.clearRect(0,0,A.width,A.height)}e.clear=a;function c(A,h){A.context.globalAlpha=h(A.context.globalAlpha)}e.setAlpha=c;function f(A){A.context.globalAlpha=1}e.resetAlpha=f;function d(A,h){return A.context.measureText(h).width}e.textWidth=d;function o(A,h){const y=A.context.measureText(h);return y.actualBoundingBoxAscent+y.actualBoundingBoxDescent}e.textHeight=o;function i(A,h,y,v,g){const{context:w}=A,R=A.canvas.clientHeight,I=(g==null?void 0:g.hAnchor)??HAnchor.Center,T=(g==null?void 0:g.vAnchor)??VAnchor.Middle;h=h+2*(I-.5)*v,y=R-y+2*(.5-T)*v,w.beginPath(),w.arc(h,y,v,0,Math.PI*2),w.fill()}e.point=i;function l(A,h,y,v,g){for(let w=0;w<h.length;w++)i(A[w],h[w],y[w],v[w],g)}e.points=l;function p(A,h,y,v,g,w){const{context:R,height:I}=A,T=v-h,z=g-y;h=h+(1-w)/2*T,v=v-(1-w)/2*T,y=y+(1-w)/2*z,g=g-(1-w)/2*z,R.fillRect(h,I-y,v-h,y-g)}e.rectangleXY=p;function x(A,h,y,v,g,w){for(let R=0;R<h.length;R++)p(A[R],h[R],y[R],v[R],g[R],w[R])}e.rectanglesXY=x;function b(A,h,y,v,g,w){const{context:R,height:I}=A,T=(w==null?void 0:w.hAnchor)??HAnchor.Center,z=(w==null?void 0:w.vAnchor)??VAnchor.Middle;h=h-T*v,y=I-y+z*g,R.fillRect(h,y,v,-g)}e.rectangleWH=b;function m(A,h,y,v,g,w){for(let R=0;R<h.length;R++)b(A[R],h[R],y[R],v[R],g[R],w)}e.rectanglesWH=m;function S(A,h,y){const{context:v,height:g}=A;v.beginPath(),v.moveTo(h[0],g-y[0]);for(let w=0;w<h.length;w++)v.lineTo(h[w],g-y[w]);v.stroke()}e.line=S;function M(A,h,y){for(let v=0;v<h.length;v++)S(A[v],h[v],y[v])}e.lines=M;function E(A,h,y,v,g){const{context:w,height:R}=A;w.save(),w.translate(h,R-y),g!=null&&g.vertical&&w.rotate(-Math.PI/2),w.fillText(v,0,0),w.translate(-h,-(R-y)),w.restore()}e.text=E})(Frame||(Frame={}));var Bars;(e=>{const t="bars";function n(a){const c={},f=[],d=(a==null?void 0:a.vAnchor)??VAnchor.Bottom,o=(a==null?void 0:a.hAnchor)??HAnchor.Center;return{type:t,data:f,scales:c,vAnchor:d,hAnchor:o}}e.of=n,exports.Poly.set(Geom.render,t,r),exports.Poly.set(Geom.check,t,u),exports.Poly.set(Geom.query,t,s);function r(a,c){const{scales:f,hAnchor:d,vAnchor:o}=a,i=Geom.groupedData(a),l=findLength(Object.values(i)),[p,x,b,m]=Geom.scaledArrays(l,[[i.x,f.x],[i.y,f.y],[i.width,f.width],[i.height,f.height]]),S=Geom.frames(l,i[LAYER],c);Frame.rectanglesWH(S,p,x,b,m,{hAnchor:d,vAnchor:o})}e.render=r;function u(a,c){const{scales:f,hAnchor:d,vAnchor:o}=a,i=Geom.flatData(a),l=findLength(Object.values(i)),{x:p,y:x,width:b,height:m}=Getter.mapObject(i),S=Getter.of(i[exports.Factor.POSITIONS]),M=[];for(let E=0;E<l;E++){let A=exports.Scale.pushforward(f.x,p(E)),h=exports.Scale.pushforward(f.y,x(E)),y=exports.Scale.pushforward(f.width,b(E)),v=exports.Scale.pushforward(f.height,m(E));[A,h,y,v]=[A,h,y,v];const w=[A-y*d,h-v*o,A+y*d,h+v*(1-o)];if(rectsIntersect(c,w)){const R=S(E);for(let I=0;I<R.length;I++)M.push(R[I])}}return M}e.check=u;function s(a,c){var M;const{scales:f,hAnchor:d,vAnchor:o}=a,i=Geom.flatData(a),l=Geom.groupedData(a),p=findLength(Object.values(i)),{x,y:b,width:m,height:S}=Getter.mapObject(i);for(let E=0;E<p;E++){let A=exports.Scale.pushforward(f.x,x(E)),h=exports.Scale.pushforward(f.y,b(E)),y=exports.Scale.pushforward(f.width,m(E)),v=exports.Scale.pushforward(f.height,S(E));[A,h,y,v]=[A,h,y,v];const w=[A-y*d,h-v*o,A+y*d,h+v*(1-o)];if(pointInRect(c,w)){const R=(M=i[exports.Factor.CHILD_INDICES])==null?void 0:M[E];return Geom.getQueryInfo(l,R??[])}}}e.query=s})(Bars||(Bars={})),exports.Reducer=void 0,(Reducer=>{Reducer.sum={name:"sum",fallback:"count",initialfn:()=>0,reducefn:(e,t)=>e+t},Reducer.max={name:"max",initialfn:()=>-1/0,reducefn:(e,t)=>Math.max(e,t)},Reducer.product={name:"product",initialfn:()=>1,reducefn:(e,t)=>e*t},Reducer.table={name:"table",initialfn:()=>({}),reducefn:(e,t)=>(e[t]=e[t]+1||0,e)};function parse(value){if(typeof value=="string")return Reducer[value];if(typeof value.initialfn=="string"&&typeof value.reducefn=="string"){const parsed={name:value.name};return parsed.initialfn=eval(value.initialfn),parsed.reducefn=eval(value.reducefn),parsed}return value}Reducer.parse=parse;function reduce(e,t,n){const{indices:r,cardinality:u}=t,{initialfn:s,reducefn:a}=n,c=Array.from(Array(u),()=>s()),f=Getter.of(r),d=Getter.of(e);for(let l=0;l<r.length;l++){const p=f(l);c[p]=a(c[p],d(l))}const o=Reduced.of(c,t,n);Meta.copy(o,e);const i=getName(c,n)??"[unknown summary]";return Meta.set(o,{name:i,queryable:!0,reduced:!0}),o}Reducer.reduce=reduce;function getName(e,t){return Meta.has(e,"name")?`${t.name} of ${Meta.get(e,"name")}`:t.fallback}Reducer.getName=getName})(exports.Reducer||(exports.Reducer={}));var Summaries;(e=>{function t(s,a){const c=[];for(let f=0;f<a.length;f++){const d=a[f],o=n(s,d),i=Reactive.of()(merge(o,d.data));if(c.push(i),f>0)for(const l of Object.keys(o)){const p=c[f-1][l];Reduced.setParent(o[l],p)}Reactive.listen(d,"changed",()=>{const l=n(s,d);for(const p of Object.keys(l))copyValues(l[p],o[p]);for(const p of Reflect.ownKeys(d.data))copyValues(d.data[p],i[p])}),Reactive.propagate(d,i,"changed")}return c}e.of=t;function n(s,a){const c={};for(const[f,d]of Object.entries(s)){const[o,i]=d;c[f]=exports.Reducer.reduce(o,a,i)}return c}function r(s,a){const c=[];for(let f=0;f<s.length;f++){let d=function(i){const l=a[f](i),p=Reflect.ownKeys(i);for(const x of p)(typeof x=="symbol"||isIntegerString(x))&&(l[x]=i[x]);return l};const o=Reactive.of()(d(s[f]));c.push(o),Reactive.listen(s[f],"changed",()=>{const i=d(s[f]);for(const l of Reflect.ownKeys(i))Array.isArray(i[l])&&Array.isArray(o[l])&&copyValues(i[l],o[l]);Reactive.dispatch(o,"changed")})}return c}e.translate=r;function u(s,a){const c={};let f=0;for(const[d,o]of s)c[`q${f++}`]=[d(a),o];return c}e.formatQueries=u})(Summaries||(Summaries={}));function Barplot(e,t,n){const{data:r,marker:u}=e;let[s,a]=t(r);const c=a&&(n!=null&&n.reducer)?n.reducer:exports.Reducer.sum,f=a||(()=>1),d=exports.Factor.from(s),o=exports.Factor.product(d,u.factor),i=[d,o],l=n!=null&&n.queries?n.queries(r):{},p=Summaries.of({stat:[f,c],...l},i),x=[],b=0,m={type:"bar",scales:{x:"band"}},S=Object.assign(exports.Plot.of(m),{representation:b,summaries:p,coordinates:x});return Reactive.listen(S,"normalize",()=>switchRepresentation$3(S)),barplot(S),exports.Plot.addGeom(S,Bars.of()),S}function sortAxis(e,t){if(e.props.ordered)ExpanseBand.reorder(e);else{const n=orderIndices(t);ExpanseBand.reorder(e,n)}}function switchRepresentation$3(e){e.representation===0?spineplot(e):barplot(e)}function barplot(e){const{summaries:t,scales:n}=e,r=Summaries.translate(t,[c=>({x:c.label,y:zero,height:c.stat,width:one}),c=>({x:c.label,y:zero,height:Reduced.stack(c.stat),width:one})]),[u]=r,s={default:!0,ratio:!0};exports.Scale.train(n.x,u.x,s),exports.Scale.train(n.y,u.height,s),exports.Scale.train(n.width,[0,1],s),exports.Scale.train(n.height,u.height,s),exports.Scale.freeze(n.y,["zero"]),exports.Scale.freeze(n.height,["zero"]),ExpanseBand.setWeights(n.x.domain);const a=1/new Set(u.x).size;exports.Scale.link(n.y,n.height),exports.Expanse.set(n.width.codomain,()=>({scale:a,mult:.9,offset:0}),{default:!0}),Meta.copy(n.y,u.height,["name"]),Reactive.removeAll(e,"reorder"),Reactive.listen(e,"reorder",()=>sortAxis(n.x.domain,u.height)),e.representation=0,exports.Plot.setData(e,r),exports.Plot.render(e),exports.Plot.renderAxes(e)}function spineplot(e){const{summaries:t,scales:n}=e,r=Summaries.translate(t,[a=>({x:a.label,y:zero,height:one,width:a.stat}),a=>({x:a.label,y:zero,height:Reduced.normalize(Reduced.stack(a.stat),(c,f)=>c/f),width:Reduced.parent(a.stat)})]),[u]=r,s={default:!0,ratio:!0};exports.Scale.train(n.x,u.x,s),exports.Scale.train(n.y,[0,1],s),exports.Scale.train(n.width,cumsum(u.width),s),exports.Scale.train(n.height,[0,1],s),exports.Scale.freeze(n.y,["zero"]),exports.Scale.freeze(n.height,["zero"]),ExpanseBand.setWeights(n.x.domain,u.width),exports.Scale.link(n.y,n.height),exports.Expanse.set(n.width.codomain,()=>({scale:1,mult:1,offset:-1}),{default:!0}),Meta.set(n.y,{name:"proportion"}),Reactive.removeAll(e,"reorder"),Reactive.listen(e,"reorder",()=>sortAxis(n.x.domain,u.width)),e.representation=1,exports.Plot.setData(e,r),exports.Plot.render(e),exports.Plot.renderAxes(e)}function Fluctuationplot(e,t,n){const{data:r,marker:u}=e;let[s,a,c]=t(r);const f=c&&(n!=null&&n.reducer)?n.reducer:exports.Reducer.sum,d=c?[...c]:()=>1,o=exports.Factor.product(exports.Factor.from(s),exports.Factor.from(a)),i=exports.Factor.product(o,u.factor),l=[o,i],p=Summaries.formatQueries((n==null?void 0:n.queries)??[],r),x=Summaries.of({stat:[d,f],...p},l),b=[],m=0,S={type:"fluct",scales:{x:"band",y:"band"}},M=Object.assign(exports.Plot.of(S),{representation:m,summaries:x,coordinates:b});return exports.Scale.shareCodomain(M.scales.area,M.scales.width),exports.Scale.shareCodomain(M.scales.area,M.scales.height),Reactive.listen(M,"normalize",()=>switchRepresentation$2(M)),fluctplot(M),exports.Plot.addGeom(M,Bars.of({vAnchor:VAnchor.Middle})),M}function switchRepresentation$2(e){e.representation===0?pctfluctplot(e):fluctplot(e)}function fluctplot(e){const{summaries:t,scales:n}=e,r=Summaries.translate(t,[c=>({x:c.label,y:c.label$,height:c.stat,width:c.stat}),c=>({x:c.label,y:c.label$,height:Reduced.stack(c.stat),width:Reduced.stack(c.stat)})]),[u]=r,s={default:!0,ratio:!0};exports.Scale.train(n.x,u.x,s),exports.Scale.train(n.y,u.y,s),exports.Scale.train(n.width,u.width,s),exports.Scale.train(n.height,u.height,s);const a=max(new Set(u.x).size,new Set(u.y).size);exports.Expanse.set(n.area.codomain,()=>({scale:1/a,mult:.9,offset:0}),{default:!0}),exports.Plot.setData(e,r),e.representation=0,exports.Plot.render(e)}function pctfluctplot(e){const{summaries:t,scales:n}=e,r=Summaries.translate(t,[c=>({x:c.label,y:c.label$,height:one,width:one}),c=>({x:c.label,y:c.label$,height:Reduced.normalize(Reduced.stack(c.stat),(f,d)=>f/d),width:Reduced.normalize(Reduced.stack(c.stat),(f,d)=>f/d)})]),[u]=r,s={default:!0,ratio:!0};exports.Scale.train(n.x,u.x,s),exports.Scale.train(n.y,u.y,s),exports.Scale.train(n.width,[0,1],s),exports.Scale.train(n.height,[0,1],s);const a=max(new Set(u.x).size,new Set(u.y).size);exports.Expanse.set(n.area.codomain,()=>({scale:1/a,mult:.9,offset:-1}),{default:!0}),exports.Plot.setData(e,r),e.representation=1,exports.Plot.render(e)}var Rectangles;(e=>{const t="rectangles";function n(){return{type:t,data:[],scales:{}}}e.of=n,exports.Poly.set(Geom.render,t,r),exports.Poly.set(Geom.check,t,u),exports.Poly.set(Geom.query,t,s);function r(a,c){const{scales:f}=a,d=Geom.groupedData(a),o=findLength(Object.values(d)),[i,l,p,x,b]=Geom.scaledArrays(o,[[d.x0,f.x],[d.y0,f.y],[d.x1,f.x],[d.y1,f.y],[d.area,f.areaPct]]),m=Geom.frames(o,d[LAYER],c);Frame.rectanglesXY(m,i,l,p,x,b)}e.render=r;function u(a,c){const{scales:f}=a,d=Geom.flatData(a),o=findLength(Object.values(d)),{x0:i,y0:l,x1:p,y1:x,area:b}=Getter.mapObject(d),m=Getter.of(d[exports.Factor.POSITIONS]),S=[];for(let M=0;M<o;M++){let E=exports.Scale.pushforward(f.x,i(M)),A=exports.Scale.pushforward(f.y,l(M)),h=exports.Scale.pushforward(f.x,p(M)),y=exports.Scale.pushforward(f.y,x(M));if(d.area){const v=exports.Scale.pushforward(f.areaPct,b(M)),g=h-E,w=y-A;E=E+(1-v)/2*g,h=h-(1-v)/2*g,A=A+(1-v)/2*w,y=y-(1-v)/2*w}if(rectsIntersect(c,[E,A,h,y])){const v=m(M);for(let g=0;g<v.length;g++)S.push(v[g])}}return S}e.check=u;function s(a,c){var S;const{scales:f}=a,d=Geom.flatData(a),o=Geom.groupedData(a),i=findLength(Object.values(d)),{x0:l,y0:p,x1:x,y1:b,area:m}=Getter.mapObject(d);for(let M=0;M<i;M++){let E=exports.Scale.pushforward(f.x,l(M)),A=exports.Scale.pushforward(f.y,p(M)),h=exports.Scale.pushforward(f.x,x(M)),y=exports.Scale.pushforward(f.y,b(M));if(d.area){const v=exports.Scale.pushforward(f.areaPct,m(M)),g=h-E,w=y-A;E=E+(1-v)/2*g,h=h-(1-v)/2*g,A=A+(1-v)/2*w,y=y-(1-v)/2*w}if(pointInRect(c,[E,A,h,y])){const v=(S=d[exports.Factor.CHILD_INDICES])==null?void 0:S[M];return Geom.getQueryInfo(o,v)}}}e.query=s})(Rectangles||(Rectangles={}));function Histogram(e,t,n){const{data:r,marker:u}=e;let[s,a]=t(r);const c=a&&(n!=null&&n.reducer)?n.reducer:exports.Reducer.sum,f=a||(()=>1),[d,o]=minmax(s),i=o-d,l=Reactive.of()({anchor:d,width:i/15}),p=exports.Factor.mono(s.length),x=exports.Factor.product(p,exports.Factor.bin(s,l)),b=exports.Factor.product(x,u.factor),m=[p,x,b],S=n!=null&&n.queries?n.queries(r):{},M=Summaries.of({stat:[f,c],...S},m),E=0,A=[],h={type:"histo"},y=Object.assign(exports.Plot.of(h),{representation:E,summaries:M,coordinates:A});Reactive.listen(y,"normalize",()=>switchRepresentation$1(y));const v=i/10;return Reactive.listen(y,"set-parameters",g=>{g&&(g.width&&Reactive.set(l,w=>w.width=g.width),g.anchor&&Reactive.set(l,w=>w.anchor=g.anchor))}),Reactive.listen(y,"grow",()=>Reactive.set(l,g=>g.width*=1.1111111111111112)),Reactive.listen(y,"shrink",()=>Reactive.set(l,g=>g.width*=.9)),Reactive.listen(y,"increment-anchor",()=>Reactive.set(l,g=>g.anchor+=v)),Reactive.listen(y,"decrement-anchor",()=>Reactive.set(l,g=>g.anchor-=v)),Reactive.listen(y,"reset",()=>{Reactive.set(l,g=>(g.anchor=d,g.width=i/15))}),histogram(y),exports.Plot.addGeom(y,Rectangles.of()),y}function switchRepresentation$1(e){e.representation===0?spinogram(e):histogram(e)}function histogram(e){const{summaries:t}=e,n=Summaries.translate(t,[s=>s,s=>({x0:s.binMin,y0:zero,x1:s.binMax,y1:s.stat}),s=>({x0:s.binMin,y0:zero,x1:s.binMax,y1:Reduced.stack(s.stat)})]),{scales:r}=e,[,u]=n;exports.Scale.train(r.x,u.x1,{default:!0,name:!1}),exports.Scale.train(r.y,u.y1,{default:!0,ratio:!0}),exports.Scale.freeze(r.y,["zero"]);for(const s of e.data)Reactive.removeAll(s,"changed");Reactive.listen(u,"changed",()=>{exports.Scale.train(r.x,u.x1,{default:!0,name:!1}),exports.Scale.train(r.y,u.y1,{default:!0,ratio:!0})}),Meta.copy(r.x,t[1].breaks,["name"]),Meta.copy(r.y,u.y1,["name"]),e.representation=0,exports.Plot.setData(e,n),exports.Plot.render(e),exports.Plot.renderAxes(e)}function spinogram(e){const{summaries:t}=e,n=Summaries.translate(t,[s=>s,s=>({x0:Reduced.shiftLeft(Reduced.stack(s.stat)),y0:zero,x1:Reduced.stack(s.stat),y1:one,query1:s.binMin,query2:s.binMax}),s=>({x0:Reduced.shiftLeft(Reduced.stack(Reduced.parent(s.stat))),y0:zero,x1:Reduced.stack(Reduced.parent(s.stat)),y1:Reduced.normalize(Reduced.stack(s.stat),(a,c)=>a/c)})]),{scales:r}=e,[,u]=n;exports.Scale.train(r.x,[0,...u.x1],{default:!0,name:!1}),exports.Scale.train(r.y,[0,1],{default:!0,ratio:!0}),exports.Scale.freeze(r.y,["zero"]),Reactive.listen(u,"changed",()=>{exports.Scale.train(r.x,[0,...u.x1],{default:!0,name:!1})}),Meta.set(r.x,{name:"cumulative count"}),Meta.set(r.y,{name:"proportion"}),exports.Plot.setData(e,n),e.representation=1,exports.Plot.render(e),exports.Plot.renderAxes(e)}function Histogram2d(e,t,n){const{data:r,marker:u}=e;let[s,a,c]=t(r);const f=c&&(n!=null&&n.reducer)?n.reducer:exports.Reducer.sum,d=c||(()=>1),[o,i]=minmax(s),[l,p]=minmax(a),[x,b]=[i-o,p-l],m=Reactive.of()({anchor:o,width:x/15}),S=Reactive.of()({anchor:l,width:b/15}),M=exports.Factor.bin(s,m),E=exports.Factor.bin(a,S),A=exports.Factor.product(M,E),h=exports.Factor.product(A,u.factor),y=[A,h],v=n!=null&&n.queries?n.queries(r):{},g=Summaries.of({stat:[d,f],...v},y),w=0,R=[],I={type:"histo2d",ratio:n==null?void 0:n.ratio},T=Object.assign(exports.Plot.of(I),{representation:w,summaries:g,coordinates:R});return Reactive.listen(T,"normalize",()=>switchRepresentation(T)),Reactive.listen(T,"set-parameters",z=>{z&&(z.width1&&Reactive.set(m,F=>F.width=z.width1),z.anchor1&&Reactive.set(m,F=>F.anchor=z.anchor1),z.width2&&Reactive.set(S,F=>F.width=z.width2),z.anchor2&&Reactive.set(S,F=>F.anchor=z.anchor2))}),Reactive.listen(T,"grow",()=>{Reactive.set(m,z=>z.width*=1.1111111111111112),Reactive.set(S,z=>z.width*=1.1111111111111112)}),Reactive.listen(T,"shrink",()=>{Reactive.set(m,z=>z.width*=.9),Reactive.set(S,z=>z.width*=.9)}),Reactive.listen(T,"reset",()=>{Reactive.set(m,z=>(z.anchor=o,z.width=x/15)),Reactive.set(S,z=>(z.anchor=l,z.width=b/15))}),histogram2d(T),exports.Plot.addGeom(T,Rectangles.of()),T}function switchRepresentation(e){e.representation===0?spinogram2d(e):histogram2d(e)}function histogram2d(e){const{summaries:t}=e,n=Summaries.translate(t,[s=>({x0:s.binMin,y0:s.binMin$,x1:s.binMax,y1:s.binMax$,area:s.stat}),s=>({x0:s.binMin,y0:s.binMin$,x1:s.binMax,y1:s.binMax$,area:Reduced.stack(s.stat)})]),{scales:r}=e,[,u]=n;exports.Scale.train(r.x,u.x1,{default:!0}),exports.Scale.train(r.y,u.y1,{default:!0}),exports.Scale.train(r.areaPct,u.area,{default:!0}),exports.Expanse.set(r.area.codomain,()=>({min:0,max:1}),{default:!0}),exports.Expanse.freeze(r.area.codomain,["min","max"]);for(const s of e.data)Reactive.removeAll(s,"changed");Reactive.listen(u,"changed",()=>{exports.Scale.train(r.x,u.x1,{default:!0,name:!1}),exports.Scale.train(r.y,u.y1,{default:!0,name:!1}),exports.Scale.train(r.areaPct,u.area,{default:!0})}),e.representation=0,exports.Plot.setData(e,n),Meta.copy(r.x,t[1].breaks,["name"]),Meta.copy(r.y,t[1].breaks$,["name"]),exports.Plot.render(e),exports.Plot.renderAxes(e)}function spinogram2d(e){const{summaries:t}=e,n=Summaries.translate(t,[s=>({x0:s.binMin,y0:s.binMin$,x1:s.binMax,y1:s.binMax$,area:one}),s=>({x0:s.binMin,y0:s.binMin$,x1:s.binMax,y1:s.binMax$,area:Reduced.normalize(Reduced.stack(s.stat),(a,c)=>a/c)})]),{scales:r}=e,[,u]=n;exports.Scale.train(r.x,u.x1,{default:!0}),exports.Scale.train(r.y,u.y1,{default:!0}),exports.Scale.train(r.areaPct,[0,1],{default:!0}),exports.Expanse.set(r.area.codomain,()=>({min:0,max:1}),{default:!0}),exports.Expanse.freeze(r.area.codomain,["min","max"]);for(const s of e.data)Reactive.removeAll(s,"changed");Reactive.listen(u,"changed",()=>{exports.Scale.train(r.x,u.x1,{default:!0,name:!1}),exports.Scale.train(r.y,u.y1,{default:!0,name:!1})}),e.representation=1,exports.Plot.setData(e,n),Meta.copy(r.x,t[1].breaks,["name"]),Meta.copy(r.y,t[1].breaks$,["name"]),exports.Plot.render(e),exports.Plot.renderAxes(e)}var Lines;(e=>{const t="lines";function n(){return{type:t,data:[],scales:{}}}e.of=n,exports.Poly.set(Geom.render,t,r),exports.Poly.set(Geom.check,t,u),exports.Poly.set(Geom.query,t,s);function r(a,c){const{scales:f}=a,d=Geom.groupedData(a),o=findLength(Object.values(d)),[i,l]=Geom.scaledArrays(o,[[d.x,f.x],[d.y,f.y]]),p=Geom.frames(o,d[LAYER],c);Frame.lines(p,i,l)}e.render=r;function u(a,c){const{scales:f}=a,d=Geom.flatData(a),o=findLength(Object.values(d)),{x:i,y:l}=Getter.mapObject(d),p=Getter.of(d[exports.Factor.POSITIONS]),x=[];for(let b=0;b<o;b++){const m=exports.Scale.pushforward(f.x,i(b)),S=exports.Scale.pushforward(f.y,l(b));for(let M=1;M<m.length;M++){const E=[m[M-1],S[M-1],m[M],S[M]];if(rectSegmentIntersect(c,E)){const A=p(b);for(let h=0;h<A.length;h++)x.push(A[h])}}}return x}e.check=u;function s(a,c){var b;let{scales:f}=a;const d=Geom.flatData(a),o=Geom.groupedData(a),i=findLength(Object.values(d)),{x:l,y:p}=Getter.mapObject(d),x=bimap([...c,...c],[-1,-1,1,1],sum);for(let m=0;m<i;m++){const S=exports.Scale.pushforward(f.x,l(m)),M=exports.Scale.pushforward(f.y,p(m));for(let E=1;E<S.length;E++){const A=[S[E-1],M[E-1],S[E],M[E]];if(rectSegmentIntersect(x,A)){const h=(b=d[exports.Factor.CHILD_INDICES])==null?void 0:b[m],y=l(m),v=p(m),g={};for(let R=0;R<y.length;R++)g[y[R]]=v[R];const w=h[0];return g[LAYER]=Getter.of(o[LAYER])(w),[g]}}}}e.query=s})(Lines||(Lines={}));var ExpanseCompound;(e=>{const t="compound";function n(f=[]){const d=[];return{...ExpanseContinuous.of(),type:t,value:d,expanses:f}}e.of=n,exports.Poly.set(exports.Expanse.normalize,t,r),exports.Poly.set(exports.Expanse.unnormalize,t,u),exports.Poly.set(exports.Expanse.train,t,s),exports.Poly.set(exports.Expanse.breaks,t,a);function r(f,d){const{expanses:o}=f;return d.map((i,l)=>exports.Expanse.normalize(o[l],i))}e.normalize=r;function u(f,d){const{expanses:o}=f;return d.map((i,l)=>exports.Expanse.unnormalize(o[l],i))}e.unnormalize=u;function s(f,d){const{expanses:o}=f;if(d.length!=o.length){const i="The number of arrays does not match the number of expanses.";throw new Error(i)}for(let i=0;i<d.length;i++)exports.Expanse.train(o[i],d[i])}e.train=s;function a(f){return ExpanseContinuous.breaks(f)}e.breaks=a;function c(f){for(const d of f.expanses)exports.Expanse.reset(d)}e.reset=c})(ExpanseCompound||(ExpanseCompound={}));var ExpansePoint;(e=>{const t="point";function n(f=[]){const d="",o=exports.Expanse.base(),[i,l]=[!1,seqLength(0,f.length)],p={labels:f,ordered:i,order:l},x=structuredClone(p);return{...o,type:t,value:d,props:p,defaults:x,frozen:[]}}e.of=n,exports.Poly.set(exports.Expanse.normalize,t,r),exports.Poly.set(exports.Expanse.unnormalize,t,u),exports.Poly.set(exports.Expanse.train,t,s),exports.Poly.set(exports.Expanse.breaks,t,c),exports.Poly.set(exports.Expanse.reorder,t,a);function r(f,d){const{labels:o,order:i}=f.props,l=i[o.indexOf(d)];return l===-1?l:l/(o.length-1)}e.normalize=r;function u(f,d){const{labels:o,order:i}=f.props;return d=Math.round(d*(o.length-1)),o[i[d]]}e.unnormalize=u;function s(f,d,o){const{props:i,defaults:l}=f,{order:p}=i,x=Array.from(new Set(d)).sort(compareAlphaNumeric);if(!p.length){for(let b=0;b<x.length;b++)p[b]=b;l.order=[...p],i.ordered=!1}copyValues(x,i.labels),o!=null&&o.default&&copyValues(x,f.defaults.labels),exports.Expanse.set(f,()=>({}),o)}e.train=s;function a(f,d){const{props:o,defaults:i}=f,{order:l}=o;if(!d){copyValues(i.order,l),o.ordered=!1,Reactive.dispatch(f,"changed");return}copyValues(d,l),o.ordered=!0,Reactive.dispatch(f,"changed")}e.reorder=a;function c(f){const{labels:d,order:o}=f.props;return ordered(d,o)}e.breaks=c})(ExpansePoint||(ExpansePoint={}));var ExpanseSplit;(e=>{const t="split";function n(c){const f=[],d=c.type;return{...c,value:f,type:t,innerType:d}}e.of=n,exports.Poly.set(exports.Expanse.normalize,t,r),exports.Poly.set(exports.Expanse.unnormalize,t,u),exports.Poly.set(exports.Expanse.train,t,s),exports.Poly.set(exports.Expanse.breaks,t,a);function r(c,f){const{innerType:d}=c,o=exports.Poly.dispatch(exports.Expanse.normalize,identity,d);return Array.isArray(f)?f.map(i=>o(c,i)):o(c,f)}e.normalize=r;function u(c,f){const{innerType:d}=c,o=exports.Poly.dispatch(exports.Expanse.unnormalize,identity,d);return Array.isArray(f)?f.map(i=>o(c,i)):o(c,f)}e.unnormalize=u;function s(c,f){const{innerType:d}=c;exports.Poly.dispatch(exports.Expanse.train,identity,d)(c,f)}e.train=s;function a(c){const{innerType:f}=c;return exports.Poly.dispatch(exports.Expanse.breaks,identity,f)(c)}e.breaks=a})(ExpanseSplit||(ExpanseSplit={}));function inferExpanse(e,t={train:!0}){const r=isNumberArray(e)?ExpanseContinuous.of():ExpansePoint.of();return t.train&&exports.Expanse.train(r,e),r}function Pcoordsplot(e,t,n){const{data:r,marker:u}=e,s=t(r),a=s.map(S=>Meta.get(S,"name")),c=Getter.constant(a),f=Getter.multi(s),d=n!=null&&n.queries?n.queries(r):{},o=exports.Factor.bijection(s[0].length,{x:c,y:f,...d}),i=exports.Factor.product(o,u.factor),l=Summaries.of({},[o,i]),p=Summaries.translate(l,[S=>S,S=>S]),x=exports.Plot.of({type:"pcoords"}),{scales:b}=x,m=s.map(S=>inferExpanse(S));return b.x.domain=ExpanseSplit.of(ExpansePoint.of(a)),b.y.domain=ExpanseCompound.of(m),b.x.codomain=ExpanseSplit.of(b.x.codomain),b.y.codomain=ExpanseSplit.of(b.y.codomain),Meta.set(b.x,{name:"variable"}),Meta.set(b.y,{name:"value"}),exports.Plot.setData(x,p),exports.Plot.addGeom(x,Lines.of()),x}var Points;(e=>{const t="points";function n(){return{type:t,data:[],scales:{}}}e.of=n,exports.Poly.set(Geom.render,t,r),exports.Poly.set(Geom.check,t,u),exports.Poly.set(Geom.query,t,s);function r(a,c){const{scales:f}=a,d=Geom.groupedData(a),o=findLength(Object.values(d)),[i,l,p]=Geom.scaledArrays(o,[[d.x,f.x],[d.y,f.y],[d.size,f.size]]),x=Geom.frames(o,d[LAYER],c);Frame.points(x,i,l,p)}e.render=r;function u(a,c){const{scales:f}=a,d=Geom.flatData(a),o=findLength(Object.values(d)),{x:i,y:l,size:p}=Getter.mapObject(d),x=Getter.of(d[exports.Factor.POSITIONS]),b=[];for(let m=0;m<o;m++){const S=exports.Scale.pushforward(f.x,i(m)),M=exports.Scale.pushforward(f.y,l(m));let E=exports.Scale.pushforward(f.size,p(m));E=E/Math.sqrt(2);const A=[S-E,M-E,S+E,M+E];if(rectsIntersect(c,A)){const h=x(m);for(let y=0;y<h.length;y++)b.push(h[y])}}return b}e.check=u;function s(a,c){var b;const{scales:f}=a,d=Geom.flatData(a),o=Geom.groupedData(a),i=findLength(Object.values(d)),{x:l,y:p,size:x}=Getter.mapObject(d);for(let m=0;m<i;m++){const S=exports.Scale.pushforward(f.x,l(m)),M=exports.Scale.pushforward(f.y,p(m));let E=exports.Scale.pushforward(f.size,x(m));E=E/Math.sqrt(2);const A=[S-E,M-E,S+E,M+E];if(pointInRect(c,A)){const h=(b=d[exports.Factor.CHILD_INDICES])==null?void 0:b[m];return Geom.getQueryInfo(o,h)}}}e.query=s})(Points||(Points={}));function Scatterplot(e,t,n){const{data:r,marker:u}=e,[s,a,c]=t(r),f=n!=null&&n.queries?n==null?void 0:n.queries(r):{},d={x:s,y:a,size:c??(()=>.5),...f},o=exports.Factor.bijection(s.length,d),i=exports.Factor.product(o,u.factor),l=Summaries.of({},[o,i]),p=Summaries.translate(l,[S=>S,S=>S]),x=exports.Plot.of({type:"scatter",ratio:n==null?void 0:n.ratio}),{scales:b}=x;exports.Scale.train(b.x,s,{default:!0}),exports.Scale.train(b.y,a,{default:!0}),c&&exports.Scale.train(b.size,c,{default:!0});const m=30/Math.log(s.length+2);return exports.Expanse.set(b.size.codomain,()=>({max:m}),{default:!0}),exports.Plot.setData(x,p),exports.Plot.addGeom(x,Points.of()),Object.assign(x,{summaries:l})}const defaultOptions={size:10,expandX:.1,expandY:.1,gapPct:.8,gapPx:1,axisLabelSize:1,axisTitleSize:1.25,margins:[0,0,0,0],marginLines:[3.5,3.5,1,1],colors:["#FF7F00","#E31A1C","#33A02C","#1F78B4","#FDBF6F","#FB9A99","#B2DF8A","#A6CEE3"],plotBackground:"#fefffe"};function renderAxisLabels(e){renderSingleAxisLabels(e,"x"),renderSingleAxisLabels(e,"y")}function renderSingleAxisLabels(e,t){const{frames:n,scales:r,options:u}=e,{margins:s,marginLines:a}=u,c=r[t],f=t==="x"?r.y:r.x,d=n[`${t}Axis`],{context:o}=d,{labels:i,positions:l}=exports.Scale.breaks(c),[p,x,b,m]=s,S=parseInt(o.font.match(/^[0-9]*/)[0],10),M=f.codomain.props.min-S/2,{width:E,height:A}=d;if(Frame.clear(d),t==="x"){let[h,y]=[0,0];for(let v=0;v<i.length;v++){const g=i[v],w=l[v],R=Frame.textWidth(d,g)+1;outside(w,x,E-m)||overlap(h,w,y,R)||([h,y]=[w,R],Frame.text(d,w,M,g))}}else if(t==="y"){let[h,y]=[0,0];for(let v=0;v<i.length;v++){const g=i[v],w=l[v],R=Frame.textWidth(d,g)+1,I=Frame.textHeight(d,g)+1;if(!outside(w,p,A-b)&&!overlap(h,w,y,I)){for(;s[1]/2<R+I;)a[1]*=1.05,exports.Plot.resize(e);[h,y]=[w,I],Frame.text(d,M,w,g)}}}}function renderAxisTitles(e){renderSingleAxisTitle(e,"x"),renderSingleAxisTitle(e,"y")}function renderSingleAxisTitle(e,t){const{scales:n,frames:r,options:u}=e,{margins:s}=u,a=n[t],c=t==="x"?e.scales.y:e.scales.x,f=r.base,d=Meta.get(a,"name"),o=t==="x"?s[0]:s[1],i=exports.Expanse.unnormalize(a.codomain,.5),l=exports.Expanse.unnormalize(c.codomain,0)-o*2/3;t==="x"&&Frame.text(f,i,l,d),t==="y"&&Frame.text(f,l,i,d,{vertical:!0})}function outside(e,t,n){return e<t||e>n}function overlap(e,t,n,r){const[u,s]=[e-n/2,e+n/2],[a,c]=[t-r/2,t+r/2];return u<c&&s>=a}function _typeof(e){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(e)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(e,t){if(e=e||"",t=t||{},e instanceof tinycolor)return e;if(!(this instanceof tinycolor))return new tinycolor(e,t);var n=inputToRGB(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}tinycolor.prototype={isDark:function e(){return this.getBrightness()<128},isLight:function e(){return!this.isDark()},isValid:function e(){return this._ok},getOriginalInput:function e(){return this._originalInput},getFormat:function e(){return this._format},getAlpha:function e(){return this._a},getBrightness:function e(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},getLuminance:function e(){var t=this.toRgb(),n,r,u,s,a,c;return n=t.r/255,r=t.g/255,u=t.b/255,n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),u<=.03928?c=u/12.92:c=Math.pow((u+.055)/1.055,2.4),.2126*s+.7152*a+.0722*c},setAlpha:function e(t){return this._a=boundAlpha(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function e(){var t=rgbToHsv(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},toHsvString:function e(){var t=rgbToHsv(this._r,this._g,this._b),n=Math.round(t.h*360),r=Math.round(t.s*100),u=Math.round(t.v*100);return this._a==1?"hsv("+n+", "+r+"%, "+u+"%)":"hsva("+n+", "+r+"%, "+u+"%, "+this._roundA+")"},toHsl:function e(){var t=rgbToHsl(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},toHslString:function e(){var t=rgbToHsl(this._r,this._g,this._b),n=Math.round(t.h*360),r=Math.round(t.s*100),u=Math.round(t.l*100);return this._a==1?"hsl("+n+", "+r+"%, "+u+"%)":"hsla("+n+", "+r+"%, "+u+"%, "+this._roundA+")"},toHex:function e(t){return rgbToHex(this._r,this._g,this._b,t)},toHexString:function e(t){return"#"+this.toHex(t)},toHex8:function e(t){return rgbaToHex(this._r,this._g,this._b,this._a,t)},toHex8String:function e(t){return"#"+this.toHex8(t)},toRgb:function e(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function e(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function e(){return{r:Math.round(bound01(this._r,255)*100)+"%",g:Math.round(bound01(this._g,255)*100)+"%",b:Math.round(bound01(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function e(){return this._a==1?"rgb("+Math.round(bound01(this._r,255)*100)+"%, "+Math.round(bound01(this._g,255)*100)+"%, "+Math.round(bound01(this._b,255)*100)+"%)":"rgba("+Math.round(bound01(this._r,255)*100)+"%, "+Math.round(bound01(this._g,255)*100)+"%, "+Math.round(bound01(this._b,255)*100)+"%, "+this._roundA+")"},toName:function e(){return this._a===0?"transparent":this._a<1?!1:hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1},toFilter:function e(t){var n="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),r=n,u=this._gradientType?"GradientType = 1, ":"";if(t){var s=tinycolor(t);r="#"+rgbaToArgbHex(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+u+"startColorstr="+n+",endColorstr="+r+")"},toString:function e(t){var n=!!t;t=t||this._format;var r=!1,u=this._a<1&&this._a>=0,s=!n&&u&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");return s?t==="name"&&this._a===0?this.toName():this.toRgbString():(t==="rgb"&&(r=this.toRgbString()),t==="prgb"&&(r=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(r=this.toHexString()),t==="hex3"&&(r=this.toHexString(!0)),t==="hex4"&&(r=this.toHex8String(!0)),t==="hex8"&&(r=this.toHex8String()),t==="name"&&(r=this.toName()),t==="hsl"&&(r=this.toHslString()),t==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},clone:function e(){return tinycolor(this.toString())},_applyModification:function e(t,n){var r=t.apply(null,[this].concat([].slice.call(n)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function e(){return this._applyModification(_lighten,arguments)},brighten:function e(){return this._applyModification(_brighten,arguments)},darken:function e(){return this._applyModification(_darken,arguments)},desaturate:function e(){return this._applyModification(_desaturate,arguments)},saturate:function e(){return this._applyModification(_saturate,arguments)},greyscale:function e(){return this._applyModification(_greyscale,arguments)},spin:function e(){return this._applyModification(_spin,arguments)},_applyCombination:function e(t,n){return t.apply(null,[this].concat([].slice.call(n)))},analogous:function e(){return this._applyCombination(_analogous,arguments)},complement:function e(){return this._applyCombination(_complement,arguments)},monochromatic:function e(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function e(){return this._applyCombination(_splitcomplement,arguments)},triad:function e(){return this._applyCombination(polyad,[3])},tetrad:function e(){return this._applyCombination(polyad,[4])}},tinycolor.fromRatio=function(e,t){if(_typeof(e)=="object"){var n={};for(var r in e)e.hasOwnProperty(r)&&(r==="a"?n[r]=e[r]:n[r]=convertToPercentage(e[r]));e=n}return tinycolor(e,t)};function inputToRGB(e){var t={r:0,g:0,b:0},n=1,r=null,u=null,s=null,a=!1,c=!1;return typeof e=="string"&&(e=stringInputToObject(e)),_typeof(e)=="object"&&(isValidCSSUnit(e.r)&&isValidCSSUnit(e.g)&&isValidCSSUnit(e.b)?(t=rgbToRgb(e.r,e.g,e.b),a=!0,c=String(e.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(e.h)&&isValidCSSUnit(e.s)&&isValidCSSUnit(e.v)?(r=convertToPercentage(e.s),u=convertToPercentage(e.v),t=hsvToRgb(e.h,r,u),a=!0,c="hsv"):isValidCSSUnit(e.h)&&isValidCSSUnit(e.s)&&isValidCSSUnit(e.l)&&(r=convertToPercentage(e.s),s=convertToPercentage(e.l),t=hslToRgb(e.h,r,s),a=!0,c="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=boundAlpha(n),{ok:a,format:e.format||c,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}function rgbToRgb(e,t,n){return{r:bound01(e,255)*255,g:bound01(t,255)*255,b:bound01(n,255)*255}}function rgbToHsl(e,t,n){e=bound01(e,255),t=bound01(t,255),n=bound01(n,255);var r=Math.max(e,t,n),u=Math.min(e,t,n),s,a,c=(r+u)/2;if(r==u)s=a=0;else{var f=r-u;switch(a=c>.5?f/(2-r-u):f/(r+u),r){case e:s=(t-n)/f+(t<n?6:0);break;case t:s=(n-e)/f+2;break;case n:s=(e-t)/f+4;break}s/=6}return{h:s,s:a,l:c}}function hslToRgb(e,t,n){var r,u,s;e=bound01(e,360),t=bound01(t,100),n=bound01(n,100);function a(d,o,i){return i<0&&(i+=1),i>1&&(i-=1),i<.16666666666666666?d+(o-d)*6*i:i<.5?o:i<.6666666666666666?d+(o-d)*(.6666666666666666-i)*6:d}if(t===0)r=u=s=n;else{var c=n<.5?n*(1+t):n+t-n*t,f=2*n-c;r=a(f,c,e+.3333333333333333),u=a(f,c,e),s=a(f,c,e-.3333333333333333)}return{r:r*255,g:u*255,b:s*255}}function rgbToHsv(e,t,n){e=bound01(e,255),t=bound01(t,255),n=bound01(n,255);var r=Math.max(e,t,n),u=Math.min(e,t,n),s,a,c=r,f=r-u;if(a=r===0?0:f/r,r==u)s=0;else{switch(r){case e:s=(t-n)/f+(t<n?6:0);break;case t:s=(n-e)/f+2;break;case n:s=(e-t)/f+4;break}s/=6}return{h:s,s:a,v:c}}function hsvToRgb(e,t,n){e=bound01(e,360)*6,t=bound01(t,100),n=bound01(n,100);var r=Math.floor(e),u=e-r,s=n*(1-t),a=n*(1-u*t),c=n*(1-(1-u)*t),f=r%6,d=[n,a,s,s,c,n][f],o=[c,n,n,a,s,s][f],i=[s,s,c,n,n,a][f];return{r:d*255,g:o*255,b:i*255}}function rgbToHex(e,t,n,r){var u=[pad2(Math.round(e).toString(16)),pad2(Math.round(t).toString(16)),pad2(Math.round(n).toString(16))];return r&&u[0].charAt(0)==u[0].charAt(1)&&u[1].charAt(0)==u[1].charAt(1)&&u[2].charAt(0)==u[2].charAt(1)?u[0].charAt(0)+u[1].charAt(0)+u[2].charAt(0):u.join("")}function rgbaToHex(e,t,n,r,u){var s=[pad2(Math.round(e).toString(16)),pad2(Math.round(t).toString(16)),pad2(Math.round(n).toString(16)),pad2(convertDecimalToHex(r))];return u&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function rgbaToArgbHex(e,t,n,r){var u=[pad2(convertDecimalToHex(r)),pad2(Math.round(e).toString(16)),pad2(Math.round(t).toString(16)),pad2(Math.round(n).toString(16))];return u.join("")}tinycolor.equals=function(e,t){return!e||!t?!1:tinycolor(e).toRgbString()==tinycolor(t).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function _desaturate(e,t){t=t===0?0:t||10;var n=tinycolor(e).toHsl();return n.s-=t/100,n.s=clamp01(n.s),tinycolor(n)}function _saturate(e,t){t=t===0?0:t||10;var n=tinycolor(e).toHsl();return n.s+=t/100,n.s=clamp01(n.s),tinycolor(n)}function _greyscale(e){return tinycolor(e).desaturate(100)}function _lighten(e,t){t=t===0?0:t||10;var n=tinycolor(e).toHsl();return n.l+=t/100,n.l=clamp01(n.l),tinycolor(n)}function _brighten(e,t){t=t===0?0:t||10;var n=tinycolor(e).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(t/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(t/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(t/100)))),tinycolor(n)}function _darken(e,t){t=t===0?0:t||10;var n=tinycolor(e).toHsl();return n.l-=t/100,n.l=clamp01(n.l),tinycolor(n)}function _spin(e,t){var n=tinycolor(e).toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,tinycolor(n)}function _complement(e){var t=tinycolor(e).toHsl();return t.h=(t.h+180)%360,tinycolor(t)}function polyad(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var n=tinycolor(e).toHsl(),r=[tinycolor(e)],u=360/t,s=1;s<t;s++)r.push(tinycolor({h:(n.h+s*u)%360,s:n.s,l:n.l}));return r}function _splitcomplement(e){var t=tinycolor(e).toHsl(),n=t.h;return[tinycolor(e),tinycolor({h:(n+72)%360,s:t.s,l:t.l}),tinycolor({h:(n+216)%360,s:t.s,l:t.l})]}function _analogous(e,t,n){t=t||6,n=n||30;var r=tinycolor(e).toHsl(),u=360/n,s=[tinycolor(e)];for(r.h=(r.h-(u*t>>1)+720)%360;--t;)r.h=(r.h+u)%360,s.push(tinycolor(r));return s}function _monochromatic(e,t){t=t||6;for(var n=tinycolor(e).toHsv(),r=n.h,u=n.s,s=n.v,a=[],c=1/t;t--;)a.push(tinycolor({h:r,s:u,v:s})),s=(s+c)%1;return a}tinycolor.mix=function(e,t,n){n=n===0?0:n||50;var r=tinycolor(e).toRgb(),u=tinycolor(t).toRgb(),s=n/100,a={r:(u.r-r.r)*s+r.r,g:(u.g-r.g)*s+r.g,b:(u.b-r.b)*s+r.b,a:(u.a-r.a)*s+r.a};return tinycolor(a)},tinycolor.readability=function(e,t){var n=tinycolor(e),r=tinycolor(t);return(Math.max(n.getLuminance(),r.getLuminance())+.05)/(Math.min(n.getLuminance(),r.getLuminance())+.05)},tinycolor.isReadable=function(e,t,n){var r=tinycolor.readability(e,t),u,s;switch(s=!1,u=validateWCAG2Parms(n),u.level+u.size){case"AAsmall":case"AAAlarge":s=r>=4.5;break;case"AAlarge":s=r>=3;break;case"AAAsmall":s=r>=7;break}return s},tinycolor.mostReadable=function(e,t,n){var r=null,u=0,s,a,c,f;n=n||{},a=n.includeFallbackColors,c=n.level,f=n.size;for(var d=0;d<t.length;d++)s=tinycolor.readability(e,t[d]),s>u&&(u=s,r=tinycolor(t[d]));return tinycolor.isReadable(e,r,{level:c,size:f})||!a?r:(n.includeFallbackColors=!1,tinycolor.mostReadable(e,["#fff","#000"],n))};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names);function flip(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function boundAlpha(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function bound01(e,t){isOnePointZero(e)&&(e="100%");var n=isPercentage(e);return e=Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function clamp01(e){return Math.min(1,Math.max(0,e))}function parseIntFromHex(e){return parseInt(e,16)}function isOnePointZero(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function isPercentage(e){return typeof e=="string"&&e.indexOf("%")!=-1}function pad2(e){return e.length==1?"0"+e:""+e}function convertToPercentage(e){return e<=1&&(e=e*100+"%"),e}function convertDecimalToHex(e){return Math.round(parseFloat(e)*255).toString(16)}function convertHexToDecimal(e){return parseIntFromHex(e)/255}var matchers=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",n="(?:"+t+")|(?:"+e+")",r="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",u="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+u),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+u),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+u),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function isValidCSSUnit(e){return!!matchers.CSS_UNIT.exec(e)}function stringInputToObject(e){e=e.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var t=!1;if(names[e])e=names[e],t=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=matchers.rgb.exec(e))?{r:n[1],g:n[2],b:n[3]}:(n=matchers.rgba.exec(e))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=matchers.hsl.exec(e))?{h:n[1],s:n[2],l:n[3]}:(n=matchers.hsla.exec(e))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=matchers.hsv.exec(e))?{h:n[1],s:n[2],v:n[3]}:(n=matchers.hsva.exec(e))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=matchers.hex8.exec(e))?{r:parseIntFromHex(n[1]),g:parseIntFromHex(n[2]),b:parseIntFromHex(n[3]),a:convertHexToDecimal(n[4]),format:t?"name":"hex8"}:(n=matchers.hex6.exec(e))?{r:parseIntFromHex(n[1]),g:parseIntFromHex(n[2]),b:parseIntFromHex(n[3]),format:t?"name":"hex"}:(n=matchers.hex4.exec(e))?{r:parseIntFromHex(n[1]+""+n[1]),g:parseIntFromHex(n[2]+""+n[2]),b:parseIntFromHex(n[3]+""+n[3]),a:convertHexToDecimal(n[4]+""+n[4]),format:t?"name":"hex8"}:(n=matchers.hex3.exec(e))?{r:parseIntFromHex(n[1]+""+n[1]),g:parseIntFromHex(n[2]+""+n[2]),b:parseIntFromHex(n[3]+""+n[3]),format:t?"name":"hex"}:!1}function validateWCAG2Parms(e){var t,n;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),t!=="AA"&&t!=="AAA"&&(t="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:t,size:n}}var QueryTable;(e=>{function t(r,u){if(DOM.clearChildren(r),!Array.isArray(u)){for(const[s,a]of Object.entries(u)){const c=n(s,a);DOM.append(r,c)}return}for(const s of Object.values(u))for(const[a,c]of Object.entries(s)){const f=n(a,c,defaultOptions.colors[s[LAYER]]);DOM.append(r,f)}}e.formatQueryTable=t;function n(r,u,s){const a=DOM.element("tr"),c=DOM.element("td",{classes:tw("tw-border tw-border-black tw-px-3 tw-py-1"),textContent:r}),f=DOM.element("td",{classes:tw("tw-border tw-border-black tw-px-3 tw-py-1 tw-font-mono"),textContent:formatLabel(u)});if(s){const[d,o]=[s,"black"];DOM.setStyles(c,{backgroundColor:d,borderColor:o}),DOM.setStyles(f,{backgroundColor:d,borderColor:o}),tinycolor(s).getBrightness()<127&&(DOM.setStyles(c,{color:"white"}),DOM.setStyles(f,{color:"white"}))}return DOM.append(a,c),DOM.append(a,f),a}})(QueryTable||(QueryTable={})),exports.Plot=void 0,(e=>{(k=>{k.Select="select",k.Pan="pan",k.Query="query"})(e.Mode||(e.Mode={}));function t(k){const O=(k==null?void 0:k.type)??"unknown",D=DOM.element("div",{id:"plot",classes:tw("tw-relative tw-h-full tw-w-full tw-drop-shadow-md")}),C=[],L={},P={},q=[],G=[],H=[],$=structuredClone({...defaultOptions,...k}),{expandX:N,expandY:V}=$,W=[[N,V,1-N,1-V]],B={active:!1,locked:!1,mousedown:!1,mousebutton:MouseButton.Left,mode:"select",mousecoords:[0,0,0,0],lastkey:"",ratio:(k==null?void 0:k.ratio)??void 0},Q=Reactive.of()({type:O,data:C,container:D,frames:L,scales:P,renderables:q,selectables:G,queryables:H,zoomStack:W,parameters:B,options:$});return setupFrames(Q,$),setupScales(Q,$),setupEvents$1(Q),Q}e.of=t,e.scatter=Scatterplot,e.bar=Barplot,e.fluct=Fluctuationplot,e.histo=Histogram,e.histo2d=Histogram2d,e.pcoords=Pcoordsplot;function n(k,O){k.appendChild(O.container),e.resize(O)}e.append=n;function r(k,O){for(const D of k.data)Reactive.is(D)&&Reactive.removeAll(D,"changed");k.data.length=0;for(let D=0;D<O.length;D++)k.data.push(O[D]);Reactive.listen(last(O),"changed",()=>e.render(k))}e.setData=r;function u(k,O){O.scales=k.scales,O.data=k.data;const{renderables:D,selectables:C,queryables:L}=k;for(const P of[D,C,L])P.push(O)}e.addGeom=u;function s(k,O){const{renderables:D,selectables:C,queryables:L}=k;for(const P of[D,C,L])remove(P,O)}e.deleteGeom=s;const a=tw("tw-outline tw-outline-2 tw-outline-slate-600");function c(k){DOM.addClasses(k.container,a),k.parameters.active=!0,Reactive.dispatch(k,"activated")}e.activate=c;function f(k){DOM.removeClasses(k.container,a),k.parameters.active=!1,Reactive.dispatch(k,"deactivated")}e.deactivate=f;function d(k){k.parameters.locked=!0}e.lock=d;function o(k){k.parameters.locked=!1}e.unlock=o;function i(k){for(const O of dataLayers)Frame.clear(k.frames[O]);for(const O of k.renderables)Geom.render(O,k.frames)}e.render=i;function l(k){for(const O of["base","xAxis","yAxis"])Frame.clear(k.frames[O]);renderAxisLabels(k),renderAxisTitles(k)}e.renderAxes=l;function p(k){Frame.clear(k.frames.user)}e.clearUserFrame=p;function x(k){const{container:O,scales:D,frames:C,parameters:L,options:P}=k,{clientWidth:q,clientHeight:G}=O,{x:H,y:$,width:N,height:V,area:W}=D,{margins:B,marginLines:Q}=P,ee=getComputedStyle(k.container),Z=parseFloat(ee.fontSize);for(let J=0;J<B.length;J++)B[J]=Q[J]*Z;for(const J of Object.values(k.frames))Frame.resize(J);const[K,Y]=[B[0],B[1]],[ne,X]=[G-B[2],q-B[3]];DOM.setStyles(C.under.canvas,{width:`calc(100% - ${Y}px - ${B[3]}px)`,height:`calc(100% - ${K}px - ${B[2]}px)`,top:`${B[2]}px`,right:`${B[3]}px`}),DOM.setStyles(C.over.canvas,{width:`calc(100% - ${Y}px - ${B[3]}px)`,height:`calc(100% - ${K}px - ${B[2]}px)`,top:`${B[2]}px`,right:`${B[3]}px`});const te={default:!0,silent:!0};exports.Expanse.set(H.codomain,()=>({min:Y,max:X}),te),exports.Expanse.set($.codomain,()=>({min:K,max:ne}),te);const[re,oe]=[X-Y,ne-K];if(exports.Expanse.set(N.codomain,()=>({max:re}),te),exports.Expanse.set(V.codomain,()=>({max:oe}),te),exports.Expanse.set(W.codomain,()=>({max:Math.min(re,oe)}),te),L.ratio){const{expandX:J,expandY:se}=defaultOptions;exports.Scale.set(H,()=>({zero:J,one:1-J}),te),exports.Scale.set($,()=>({zero:se,one:1-se}),te),e.applyRatio(k,L.ratio)}e.render(k),e.renderAxes(k)}e.resize=x;function b(k){const{selectables:O,parameters:D}=k,C=new Set;for(const L of O){const P=Geom.check(L,D.mousecoords);for(let q=0;q<P.length;q++)C.add(P[q])}Reactive.dispatch(k,"set-selected",{cases:Array.from(C)})}e.checkSelection=b;function m(k,O){k.parameters.mode=O}e.setMode=m;function S(k,O){k.parameters.mousedown=O}e.setMousedown=S;function M(k,O){k.parameters.mousebutton=O}e.setMouseButton=M,e.mousemoveHandlers={select:E,pan:A,query:h};function E(k,O){const{container:D,parameters:C,frames:L}=k;if(!C.active||!C.mousedown)return;Reactive.dispatch(k,"clear-transient");const{mousecoords:P}=C,{clientHeight:q}=D,G=O.offsetX,H=q-O.offsetY;P[2]=G,P[3]=H,e.checkSelection(k),Reactive.dispatch(k,"lock-others"),Frame.clear(L.user),Frame.rectangleXY(L.user,...C.mousecoords,1)}function A(k,O){const{container:D,scales:C,parameters:L}=k;if(!L.active||!L.mousedown)return;const{mousecoords:P}=L,{clientWidth:q,clientHeight:G}=D,[H,$]=P,N=O.offsetX,V=G-O.offsetY,W=(N-H)/q,B=(V-$)/G;exports.Scale.move(C.x,W),exports.Scale.move(C.y,B),P[0]=N,P[1]=V,e.clearUserFrame(k)}function h(k,O){const{offsetX:D,offsetY:C}=O,{queryTable:L,queryables:P,container:q}=k,{clientHeight:G}=q;if(!L)return;DOM.setStyles(L,{display:"none"});const[H,$]=[D,G-C];let N;for(const V of P)if(N=Geom.query(V,[H,$]),N)break;N&&(QueryTable.formatQueryTable(L,N),L.style.display="inline-block")}e.keybindings={"=":"grow","-":"shrink","]":"unfade","[":"fade",z:"zoom",x:"pop-zoom",o:"reorder",";":"decrement-anchor","'":"increment-anchor",n:"normalize"};function y(k){const{area:O,size:D,width:C}=k.scales,L=10/9;exports.Expanse.set(O.codomain,P=>({min:P.min*L,max:P.max*L})),exports.Expanse.set(D.codomain,P=>({min:P.min*L,max:P.max*L})),exports.Expanse.set(C.codomain,P=>P.mult<1?{mult:P.mult*10/9}:{})}e.grow=y;function v(k){const{area:O,width:D,size:C}=k.scales,L=9/10;exports.Expanse.set(O.codomain,P=>({min:P.min*L,max:P.max*L})),exports.Expanse.set(C.codomain,P=>({min:P.min*L,max:P.max*L})),exports.Expanse.set(D.codomain,P=>({mult:P.mult*9/10}))}e.shrink=v;function g(k){const{frames:O}=k;for(const D of baseLayers)Frame.setAlpha(O[D],C=>C*9/10);e.render(k)}e.fade=g;function w(k){const{frames:O}=k;for(const D of baseLayers)Frame.setAlpha(O[D],C=>C*10/9);e.render(k)}e.unfade=w;function R(k){const{frames:O,scales:D}=k;for(const C of baseLayers)Frame.resetAlpha(O[C]);for(const C of Object.values(D))exports.Scale.restore(C);k.zoomStack.length=1,e.clearUserFrame(k)}e.reset=R;function I(k){e.setMode(k,"query")}e.setQueryMode=I;function T(k,O){const{scales:D,parameters:C,zoomStack:L}=k;let{coords:P,units:q}=O??{};q=q??"screen";let[G,H,$,N]=P??C.mousecoords;const{x:V,y:W}=D;if(q==="data"){const X={silent:!0};exports.Scale.set(V,()=>({zero:0,one:1}),X),exports.Scale.set(W,()=>({zero:0,one:1}),X),G=exports.Expanse.normalize(V.domain,G),$=exports.Expanse.normalize(V.domain,$),H=exports.Expanse.normalize(W.domain,H),N=exports.Expanse.normalize(W.domain,N)}if(q==="screen"){if(Math.abs($-G)<10||Math.abs(N-H)<10)return;G=trunc(exports.Expanse.normalize(V.codomain,G)),$=trunc(exports.Expanse.normalize(V.codomain,$)),H=trunc(exports.Expanse.normalize(W.codomain,H)),N=trunc(exports.Expanse.normalize(W.codomain,N))}[G,$]=[G,$].sort(diff),[H,N]=[H,N].sort(diff),exports.Scale.expand(D.x,G,$),exports.Scale.expand(D.y,H,N);const B=rangeInverse(G,$),Q=rangeInverse(H,N),ee=sqrt(max(B,Q)),{width:Z,height:K,area:Y,size:ne}=D;Z.codomain!==Y.codomain&&exports.Expanse.set(Z.codomain,X=>({max:X.max*B})),K.codomain!==Y.codomain&&exports.Expanse.set(K.codomain,X=>({max:X.max*Q})),exports.Expanse.set(Y.codomain,X=>({max:X.max*ee})),exports.Expanse.set(ne.codomain,X=>({max:X.max*ee})),L.push([G,H,$,N]),Reactive.dispatch(k,"clear-transient"),e.render(k)}e.zoom=T;function z(k){const{scales:O,zoomStack:D}=k;if(D.length===1)return;const[C,L,P,q]=D[D.length-1],[G,H]=invertRange(C,P),[$,N]=invertRange(L,q);exports.Scale.expand(O.x,G,H),exports.Scale.expand(O.y,$,N);const V=rangeInverse(G,H),W=rangeInverse($,N),B=1/sqrt(max(1/V,1/W)),{width:Q,height:ee,area:Z,size:K}=O;Q.codomain!==Z.codomain&&exports.Expanse.set(Q.codomain,Y=>({max:Y.max*V})),ee.codomain!==Z.codomain&&exports.Expanse.set(ee.codomain,Y=>({max:Y.max*W})),exports.Expanse.set(Z.codomain,Y=>({max:Y.max*B})),exports.Expanse.set(K.codomain,Y=>({max:Y.max*B})),D.pop(),e.clearUserFrame(k),e.render(k)}e.popZoom=z;function F(k,O){const{x:D,y:C}=k.scales;if(!exports.Expanse.isContinuous(D.domain)||!exports.Expanse.isContinuous(C.domain))throw new Error("Both axes need to be continuous to set a ratio");k.parameters.ratio=O,e.resize(k)}e.setRatio=F;function _(k,O){const{scales:D}=k,{x:C,y:L}=D,P=exports.Scale.unitRatio(C),q=exports.Scale.unitRatio(L)*O,G={default:!0,silent:!0};if(P>q){const H=q/P*exports.Scale.unitRange(L),[$,N]=[(1-H)/2,(1+H)/2];exports.Scale.set(C,()=>({zero:$,one:N}),G)}else{const H=P/q*exports.Scale.unitRange(C),[$,N]=[(1-H)/2,(1+H)/2];exports.Scale.set(L,()=>({zero:$,one:N}),G)}}e.applyRatio=_;function U(k,O){return k.scales[O].domain}e.getScale=U;function j(k,O,D){let{min:C,max:L,zero:P,one:q,mult:G,labels:H,direction:$}=D;const N=k.scales[O],V=N.domain,W=N.codomain;if(!Object.keys(k.scales).includes(O))throw new Error(`Unrecognized scale '${O}'`);const B={default:D.default??!1,unfreeze:D.unfreeze??!1};if([P,q].some(isDefined)&&(P=P??V.zero,L=L??V.max,exports.Scale.set(N,()=>({zero:P,one:q}),B),k.parameters.ratio=void 0),[C,L].some(isDefined)){if(!exports.Expanse.isContinuous(V))throw new Error("Limits can only be set with a continuous domain");C=C??V.props.min,L=L??V.props.max,exports.Expanse.set(V,()=>({min:C,max:L}),B),exports.Scale.set(N,()=>({zero:0,one:1}),B),k.parameters.ratio=void 0}if(H){if(!exports.Expanse.isDiscrete(V))throw new Error("Labels can be ordered with a discrete domain only");if(!stringArraysMatch(V.props.labels,H))throw new Error("Labels must match the scale's labels");const Q=orderIndicesByTable(V.props.labels,H);exports.Expanse.reorder(V,Q)}$&&exports.Scale.set(N,()=>({direction:$}),B),G&&exports.Expanse.set(W,()=>({mult:G}),B)}e.setScale=j})(exports.Plot||(exports.Plot={}));function setupFrames(e,t){const{container:n,frames:r}=e,{margins:u,colors:s,axisLabelSize:a,axisTitleSize:c}=t,[f,d,o,i]=u,l=[7,6,5,4,3,2,1,0],p="tw-absolute tw-top-0 tw-right-0 tw-w-full tw-h-full ";for(const w of l){const R={zIndex:`${7-w+2}`},I=s[w],T={fillStyle:I,strokeStyle:I},z=Frame.of({classes:p,contextProps:T,canvasStyles:R,margins:u});r[w]=z}const x=Frame.of({classes:p+"tw-bg-gray-100"});Frame.setContext(x,{font:`${c}em sans-serif`,textBaseline:"middle",textAlign:"center"});const b=`calc(100% - ${d}px - ${i}px)`,m=`calc(100% - ${f}px - ${o}px)`,S={width:b,height:m,top:o+"px",right:i+"px"},M=Frame.of({classes:p+"tw-z-1 tw-bg-white",canvasStyles:S}),A=Frame.of({classes:p+"tw-z-10 tw-border tw-border-b-black tw-border-l-black",canvasStyles:S}),h=Frame.of({classes:p+"tw-z-10",margins:u});Frame.setContext(h,{globalAlpha:.06666666666666667});const y="#3B4854",v=Frame.of({classes:p});Frame.setContext(v,{fillStyle:y,textBaseline:"top",textAlign:"center",font:`${a}em serif`});const g=Frame.of({classes:p});Frame.setContext(g,{fillStyle:"#3B4854",textBaseline:"middle",textAlign:"right",font:`${a}em serif`}),Object.assign(r,{base:x,under:M,over:A,user:h,xAxis:v,yAxis:g});for(let[w,R]of Object.entries(r))isNaN(parseFloat(w))||(w="data-"+w),R.canvas.id=`frame-${w}`,Frame.append(R,n)}function setupEvents$1(e){const{container:t,parameters:n,frames:r}=e,{mousecoords:u}=n;for(const[s,a]of Object.entries(exports.Plot.keybindings))Reactive.listen(e,s,()=>Reactive.dispatch(e,a));t.addEventListener("mousedown",s=>{s.stopPropagation();const{locked:a}=n;exports.Plot.activate(e),exports.Plot.setMousedown(e,!0),exports.Plot.setMouseButton(e,s.button),s.button===MouseButton.Left?exports.Plot.setMode(e,"select"):s.button===MouseButton.Right&&exports.Plot.setMode(e,"pan");const c=s.offsetX,f=t.clientHeight-s.offsetY;copyValues([c,f,c,f],u),!a&&n.mode==="select"&&(Reactive.dispatch(e,"clear-transient"),exports.Plot.checkSelection(e)),exports.Plot.unlock(e)}),t.addEventListener("contextmenu",s=>{s.preventDefault(),exports.Plot.setMousedown(e,!0),exports.Plot.setMouseButton(e,MouseButton.Right),exports.Plot.setMode(e,"pan"),u[0]=s.offsetX,u[1]=t.clientHeight-s.offsetY,Frame.clear(r.user)}),t.addEventListener("mouseup",()=>exports.Plot.setMousedown(e,!1)),t.addEventListener("mousemove",throttle(s=>{exports.Plot.mousemoveHandlers[n.mode](e,s)},20)),Reactive.listen(e,"reset",()=>exports.Plot.reset(e)),Reactive.listen(e,"resize",()=>exports.Plot.resize(e)),Reactive.listen(e,"activate",()=>exports.Plot.activate(e)),Reactive.listen(e,"deactivate",()=>exports.Plot.deactivate(e)),Reactive.listen(e,"render",()=>exports.Plot.render(e)),Reactive.listen(e,"lock",()=>exports.Plot.lock(e)),Reactive.listen(e,"unlock",()=>exports.Plot.unlock(e)),Reactive.listen(e,"query-mode",()=>exports.Plot.setMode(e,"query")),Reactive.listen(e,"render-axes",()=>exports.Plot.renderAxes(e)),Reactive.listen(e,"clear-transient",()=>exports.Plot.clearUserFrame(e)),Reactive.listen(e,"get-scale",s=>{if(!(!s||!s.scale))return exports.Plot.getScale(e,s.scale)}),Reactive.listen(e,"set-scale",s=>{!s||!s.scale||exports.Plot.setScale(e,s.scale,s)}),Reactive.listen(e,"grow",()=>exports.Plot.grow(e)),Reactive.listen(e,"shrink",()=>exports.Plot.shrink(e)),Reactive.listen(e,"fade",()=>exports.Plot.fade(e)),Reactive.listen(e,"unfade",()=>exports.Plot.unfade(e)),Reactive.listen(e,"zoom",s=>exports.Plot.zoom(e,s)),Reactive.listen(e,"pop-zoom",()=>exports.Plot.popZoom(e));for(const s of Object.values(e.scales))Reactive.listen(s,"changed",()=>{exports.Plot.render(e),exports.Plot.renderAxes(e)})}function setupScales(e,t){var A,h;const{scales:n,container:r}=e,{clientWidth:u,clientHeight:s}=r,a={continuous:ExpanseContinuous,point:ExpansePoint,band:ExpanseBand},c=a[((A=t==null?void 0:t.scales)==null?void 0:A.x)??"continuous"].of(),f=a[((h=t==null?void 0:t.scales)==null?void 0:h.y)??"continuous"].of();n.x=exports.Scale.of(c,ExpanseContinuous.of(0,u)),n.y=exports.Scale.of(f,ExpanseContinuous.of(0,s)),n.height=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of()),n.width=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of()),n.area=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of()),n.size=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of(0,t.size)),n.areaPct=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of());const{x:d,y:o,width:i,height:l,size:p,area:x,areaPct:b}=n,m={default:!0,silent:!0},{expandX:S,expandY:M}=defaultOptions;exports.Expanse.set(x.domain,()=>({ratio:!0}),m),exports.Expanse.set(b.domain,()=>({ratio:!0}),m),exports.Expanse.set(p.domain,()=>({ratio:!0}),m),exports.Expanse.set(p.codomain,()=>({trans:square,inv:sqrt}),m),exports.Expanse.set(x.codomain,()=>({trans:square,inv:sqrt}),m),exports.Expanse.set(b.codomain,()=>({trans:square,inv:sqrt}),m),exports.Scale.set(d,()=>({zero:S,one:1-S}),m),exports.Scale.set(o,()=>({zero:M,one:1-M}),m),exports.Scale.set(i,()=>({one:1-2*S}),m),exports.Scale.set(l,()=>({one:1-2*M}),m),exports.Scale.set(x,()=>({one:1-2*Math.max(S,M)}),m);const E=y=>Math.max(y,0);exports.Expanse.set(i.codomain,()=>({inv:E}),m),exports.Expanse.set(l.codomain,()=>({inv:E}),m)}var KeybindingsMenu;(e=>{function t(r){const u=DOM.element("div"),s=DOM.element("div",{id:"modal"}),a=DOM.element("div",{id:"bindings"}),c=DOM.element("button",{textContent:"key bindings"});DOM.addClasses(s,tw("tw-absolute tw-left-0 tw-top-0 tw-z-50 tw-flex tw-size-full tw-flex-col tw-items-center tw-bg-slate-800 tw-bg-opacity-80 tw-p-10")),DOM.addClasses(a,tw("tw-relative tw-flex tw-h-full tw-w-fit tw-flex-col tw-flex-wrap tw-justify-start tw-py-10")),DOM.addClasses(c,tw("tw-absolute tw-right-0 tw-top-0 tw-z-30 tw-select-none tw-rounded-bl-md tw-bg-gray-300 tw-p-1 tw-px-2 tw-text-sm tw-text-white hover:tw-bg-gray-400")),DOM.append(u,s),DOM.append(u,c),DOM.append(s,a),a.style.columnFill="auto",s.style.display="none";let f=!1;function d(){s.style.display="flex"}function o(){f||(s.style.display="none")}c.addEventListener("click",d),s.addEventListener("click",o);for(const[i,l]of Object.entries(r)){const p=DOM.element("span",{classes:tw("tw-m-1 tw-flex tw-flex-row")}),x=DOM.element("button",{textContent:i}),b=DOM.element("div",{classes:tw("tw-m-1 tw-p-1 tw-px-2 tw-text-white"),textContent:capitalize(l.replaceAll("-"," "))});DOM.addClasses(x,tw("tw-m-1 tw-w-8 tw-rounded-md tw-bg-gray-400 tw-p-1 tw-px-2 tw-text-center tw-text-white tw-outline-none hover:tw-bg-gray-500")),DOM.append(p,x),DOM.append(p,b),b.addEventListener("click",S=>S.stopPropagation()),x.addEventListener("click",S=>{f||(S.stopPropagation(),DOM.addClasses(x,tw("text-black bg-slate-200 hover:bg-slate-200")),window.addEventListener("keydown",m),f=!0)});const m=S=>{const{key:M}=S,E=x.innerText;M in r&&M!==E||(n(r,M,l),x.innerText=S.key,DOM.removeClasses(x,tw("tw-text-black tw-bg-slate-200 hover:tw-bg-slate-200")),window.removeEventListener("keydown",m),f=!1)};a.appendChild(p)}return u}e.of=t;function n(r,u,s){let a;for(const[c,f]of Object.entries(r))if(f===s){a=c;break}a&&delete r[a],r[u]=s}})(KeybindingsMenu||(KeybindingsMenu={})),exports.Scene=void 0,(e=>{function t(g,w){const R=DOM.element("div",{id:"scene-container"}),I=DOM.element("div",{id:"plots-container"});DOM.addClasses(R,tw("tailwind tw-pr-15 tw-relative tw-flex tw-h-full tw-w-full tw-content-center tw-items-center tw-justify-center tw-bg-[#deded9] tw-p-10  tw-text-[max(min(2vmin,16px),8px)]")),DOM.addClasses(I,tw("tw-grid tw-h-full tw-w-full tw-grid-cols-1 tw-grid-rows-1 tw-gap-[1em]"));const T=DOM.element("table",{classes:tw("tw-fixed tw-z-30 tw-bg-gray-100 tw-shadow-md")}),z={...e.keybindings,...exports.Plot.keybindings},F=KeybindingsMenu.of(z);DOM.append(R,I),DOM.append(R,T),DOM.append(R,F);const[_,U]=[1,1],j=Marker.of(Object.values(g)[0].length),k=[],O={},D=Object.assign(defaultOptions,w);for(const[P,q]of Object.entries(g))Meta.has(q,"name")||Meta.set(q,{name:P});const C={send:console.log},L=Reactive.of()({data:g,container:R,plotsContainer:I,queryTable:T,rows:_,cols:U,marker:j,client:C,plots:k,plotsByType:O,options:D,keybindings:z});if(w!=null&&w.websocketURL){const P=new WebSocket(w.websocketURL),q={sender:"scene",target:"server",type:"connected"};P.addEventListener("open",()=>P.send(JSON.stringify(q))),P.addEventListener("message",G=>{m(L,JSON.parse(G.data))}),window.addEventListener("beforeunload",()=>P.close()),L.client=P}return setupEvents(L),L}e.of=t;async function n(g,w){const R=await fetchJSON(g);return e.of(R,w)}e.ofAsync=n;function r(g,w){g.appendChild(w.container),e.resize(w)}e.append=r;function u(g,w){const{plotsContainer:R,marker:I,plots:T,plotsByType:z}=g;Reactive.listen(w,"activated",()=>{for(const _ of T)_!=w&&Reactive.dispatch(_,"deactivate");g.activePlot=w}),Reactive.listen(w,"lock-others",()=>{for(const _ of T)_!==w&&Reactive.dispatch(_,"lock")}),Reactive.listen(w,"set-selected",_=>{Marker.update(I,_.cases)}),Reactive.listen(w,"clear-transient",()=>{for(const _ of T)exports.Plot.clearUserFrame(_);Marker.clearTransient(I)});const{type:F}=w;z[F]||(z[F]=[]),z[F].push(T.length),T.push(w),exports.Plot.append(R,w),w.queryTable=g.queryTable,a(g),l(g),e.resize(g)}e.addPlot=u;function s(g,w){const{type:R,variables:I,reducer:T,queries:z}=w??{};if(!R||R==="unknown"||!I)return;for(const j of I)if(!Object.keys(g.data).includes(j))throw new Error(`Variable '${j}' is not present in the data`);const F=keysToSelectors(I),_={};if(T&&(_.reducer=exports.Reducer.parse(T)),z)if(isStringArray(z))_.queries=keysToSelectors(z);else{const j=k=>z.map(([O,D])=>[k[O],exports.Reducer.parse(D)]);_.queries=j}const U=exports.Plot[R](g,F,_);e.addPlot(g,U)}e.addPlotBySpec=s;function a(g){for(let w=0;w<g.plots.length;w++)g.plots[w].container.id=`plot${w+1}`}function c(g){const w=last(g.plots);w&&d(g,w)}e.popPlot=c;function f(g,w){const R=i(g,w);R&&d(g,R)}e.removePlot=f;function d(g,w){const{plots:R,plotsByType:I,plotsContainer:T}=g,z=R.indexOf(w);for(const F of Object.values(I))if(F.indexOf(z)!==-1){remove(F,z);break}remove(R,w),T.removeChild(w.container),Reactive.removeAllListeners(w),a(g),l(g),e.resize(g)}function o(g,w){return w==="scene"?g:i(g,w)}e.getTarget=o;function i(g,w){const{plots:R,plotsByType:I}=g;let[T,z]=splitNumericSuffix(w);const F=parseInt(z,10)-1;if(T==="plot"||T==="p")return R[F];if(T=T.replace("plot","").replace("gram",""),T in Object.keys(plotIdShort)&&(T=plotIdShort[T]),T in I)return R[I[T][F]]}e.getPlot=i;function l(g){const{plots:w}=g;if(w.length===0)return;const R=Math.ceil(Math.sqrt(w.length)),I=Math.ceil(w.length/R);e.setDimensions(g,I,R)}function p(g,w,R){const{plotsContainer:I}=g;g.rows=w,g.cols=R,I.style.gridTemplateRows=Array(w).fill("1fr").join(" "),I.style.gridTemplateColumns=Array(R).fill("1fr").join(" "),e.resize(g)}e.setDimensions=p;function x(g,w){const{plotsContainer:R,plots:I}=g,T=new Set(w.flat()),z=new Set(seq(0,I.length-1));for(const j of T)z.delete(j);z.size>0&&alert("Warning: Some plots are not included in the layout and will be hidden.");for(let j=0;j<I.length;j++)I[j].container.style.gridArea=`plot${j}`;let F="";for(const j of w)F+=`"${j.map(k=>`plot${k}`).join(" ")}" `;const[_,U]=[w.length,w[0].length];R.style.gridTemplateAreas=F,R.style.gridTemplateRows=Array(_).fill("1fr").join(" "),R.style.gridTemplateColumns=Array(U).fill("1fr").join(" "),e.resize(g)}e.setLayout=x;function b(g){g.plotsContainer.style.gridTemplateAreas="";for(const w of g.plots)w.container.style.gridArea="auto";l(g)}e.clearLayout=b;function m(g,w){if(!g.client)return;const{type:R,target:I,data:T}=w,z=o(g,I);z&&Reactive.dispatch(z,R,T)}e.handleMessage=m;function S(g,w,R){const[I,T]=["scene","server"],z=JSON.stringify({sender:I,target:T,type:w,data:R});g.client.send(z)}e.sendMessage=S;function M(g){for(const w of g.plots)Reactive.dispatch(w,"resize")}e.resize=M;function E(g){for(const w of g.plots)Reactive.dispatch(w,"reset");Marker.clearTransient(g.marker)}e.reset=E;function A(g){for(const w of g.plots)Reactive.dispatch(w,"query-mode")}e.setQueryMode=A;function h(g){Marker.setGroup(g.marker,Group.First)}e.setGroupFirst=h;function y(g){Marker.setGroup(g.marker,Group.Second)}e.setGroupSecond=y;function v(g){Marker.setGroup(g.marker,Group.Third)}e.setGroupThird=v,e.keybindings={r:"reset",q:"query-mode",1:"group-1",2:"group-2",3:"group-3"}})(exports.Scene||(exports.Scene={}));function setupEvents(e){const{marker:t,plots:n,container:r,keybindings:u,queryTable:s}=e;r.addEventListener("mousedown",()=>{for(const a of n)Reactive.dispatch(a,"deactivate")}),r.addEventListener("dblclick",()=>{for(const a of n)Reactive.dispatch(a,"deactivate"),Frame.clear(a.frames.user);Marker.clearAll(e.marker),e.activePlot=void 0}),r.addEventListener("mousemove",throttle(function(a){const{parentElement:c}=r,{clientX:f,clientY:d}=a,{clientWidth:o,clientHeight:i}=c,{clientWidth:l,clientHeight:p}=s;let[x,b]=[f+2,d+2];f+l>o&&(x=x-l-4),d+p>i&&(b=x-p-4),DOM.setStyles(s,{left:x+"px",top:b+"px"})},20)),window.addEventListener("keydown",a=>{const c=u[a.key];c&&(e.activePlot&&Reactive.dispatch(e.activePlot,c),Reactive.dispatch(e,c))}),window.addEventListener("keyup",()=>{Marker.setGroup(t,Transient);for(const a of e.plots)a.parameters.mode=exports.Plot.Mode.Select,a.queryTable&&(a.queryTable.style.display="none")}),window.addEventListener("resize",throttle(()=>exports.Scene.resize(e),10)),Reactive.listen(t,"cleared",()=>{for(const a of n)Reactive.dispatch(a,"unlock")}),Reactive.listen(e,"resize",()=>exports.Scene.resize(e)),Reactive.listen(e,"reset",()=>exports.Scene.reset(e)),Reactive.listen(e,"query-mode",()=>exports.Scene.setQueryMode(e)),Reactive.listen(e,"group-1",()=>exports.Scene.setGroupFirst(e)),Reactive.listen(e,"group-2",()=>exports.Scene.setGroupSecond(e)),Reactive.listen(e,"group-3",()=>exports.Scene.setGroupThird(e)),Reactive.listen(e,"connected",()=>{var a;return console.log(`Connected to Websocket server on: ${(a=e.client)==null?void 0:a.url}`)}),Reactive.listen(e,"set-dims",a=>{!a||!a.rows||!a.columns||exports.Scene.setDimensions(e,a.rows,a.cols)}),Reactive.listen(e,"add-plot",a=>{a&&exports.Scene.addPlotBySpec(e,a)}),Reactive.listen(e,"pop-plot",()=>exports.Scene.popPlot(e)),Reactive.listen(e,"remove-plot",a=>{!a||!a.id||exports.Scene.removePlot(e,a.id)}),Reactive.listen(e,"set-selected",a=>{!a||!a.cases||Marker.update(t,a.cases)}),Reactive.listen(e,"set-assigned",a=>{if(!a||!a.group)return;const c=7-Math.min(a.group,3);Marker.update(t,a.cases,{group:c})}),Reactive.listen(e,"get-selected",()=>{const a=filterIndices(Array.from(t.indices),Marker.isTransient);exports.Scene.sendMessage(e,"get-selected",{cases:a})}),Reactive.listen(e,"get-assigned",a=>{if(!a||!a.group)return;const c=d=>(d|4)===7-Math.min(a.group,3),f=filterIndices(Array.from(t.indices),c);exports.Scene.sendMessage(e,"get-assigned",{cases:f,group:a.group})}),Reactive.listen(e,"clear-selection",()=>Marker.clearAll(t)),Reactive.listen(e,"get-scale",a=>{if(!a||!a.id)return;const c=exports.Scene.getPlot(e,a.id);c&&Reactive.dispatch(c,"get-scale",a)}),Reactive.listen(e,"set-scale",a=>{if(!a||!a.id)return;const c=exports.Scene.getPlot(e,a.id);c&&Reactive.dispatch(c,"set-scale",a)}),Reactive.listen(e,"normalize",a=>{if(!a||!a.id)return;const c=exports.Scene.getPlot(e,a.id);c&&Reactive.dispatch(c,"normalize")}),Reactive.listen(e,"zoom",a=>{if(!a||!a.id)return;const c=exports.Scene.getPlot(e,a.id);c&&Reactive.dispatch(c,"zoom",a)}),Reactive.listen(e,"set-layout",a=>{!a||!a.layout||exports.Scene.setLayout(e,a.layout)}),Reactive.listen(e,"set-parameters",a=>{if(!a||!a.id)return;const c=exports.Scene.getPlot(e,a.id);c&&Reactive.dispatch(c,"set-parameters",a)}),Reactive.listen(e,"clear-layout",()=>exports.Scene.clearLayout(e))}const plotIdShort={s:"scatter",b:"bar",h:"histo",f:"fluct",hh:"histo2d",pc:"pcoords"};return exports.METHODS=METHODS,exports.addIndexed=addIndexed,exports.addTailwind=addTailwind,exports.applyDirection=applyDirection,exports.applyWith=applyWith,exports.bimap=bimap,exports.binBreaks=binBreaks,exports.call=call,exports.capitalize=capitalize,exports.compareAlphaNumeric=compareAlphaNumeric,exports.convertToSuperscript=convertToSuperscript,exports.copyProps=copyProps,exports.copyValues=copyValues,exports.cumsum=cumsum,exports.dec=dec,exports.diff=diff,exports.exp10=exp10,exports.exponentialToSuperscript=exponentialToSuperscript,exports.fetchJSON=fetchJSON,exports.filterIndices=filterIndices,exports.findLength=findLength,exports.formatAxisLabels=formatAxisLabels,exports.formatLabel=formatLabel,exports.formatText=formatText,exports.identity=identity,exports.inc=inc,exports.invertRange=invertRange,exports.isDefined=isDefined,exports.isEventTarget=isEventTarget,exports.isIntegerString=isIntegerString,exports.isNumber=isNumber,exports.isNumberArray=isNumberArray,exports.isObject=isObject,exports.isPrimitive=isPrimitive,exports.isStringArray=isStringArray,exports.isTypedArray=isTypedArray,exports.just=just,exports.keysToSelectors=keysToSelectors,exports.last=last,exports.log10=log10,exports.max=max,exports.merge=merge,exports.minDecimal=minDecimal,exports.minmax=minmax,exports.one=one,exports.orderBy=orderBy,exports.orderIndices=orderIndices,exports.orderIndicesByTable=orderIndicesByTable,exports.ordered=ordered,exports.pointInRect=pointInRect,exports.prettyBreaks=prettyBreaks,exports.prod=prod,exports.randomInteger=randomInteger,exports.rangeInverse=rangeInverse,exports.rectSegmentIntersect=rectSegmentIntersect,exports.rectsIntersect=rectsIntersect,exports.remove=remove,exports.removeTailwind=removeTailwind,exports.rep=rep,exports.round=round,exports.row=row,exports.segmentsIntersect=segmentsIntersect,exports.selector=selector,exports.seq=seq,exports.seqLength=seqLength,exports.splitNumericSuffix=splitNumericSuffix,exports.sqrt=sqrt,exports.square=square,exports.stringArraysMatch=stringArraysMatch,exports.stripWS=stripWS,exports.subset=subset,exports.sum=sum,exports.throttle=throttle,exports.timeExecution=timeExecution,exports.toLowerCase=toLowerCase,exports.toUpperCase=toUpperCase,exports.trunc=trunc,exports.tw=tw,exports.uniqueIntegers=uniqueIntegers,exports.zero=zero,Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),exports}({});
