var plotscape=function(exports){"use strict";var __vite_style__=document.createElement("style");__vite_style__.textContent=`*:where(.tailwind,.tailwind *),:before:where(.tailwind,.tailwind *),:after:where(.tailwind,.tailwind *){box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before:where(.tailwind,.tailwind *),:after:where(.tailwind,.tailwind *){--tw-content: ""}.tailwind{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}.tailwind{margin:0;line-height:inherit}hr:where(.tailwind,.tailwind *){height:0;color:inherit;border-top-width:1px}abbr:where([title]):where(.tailwind,.tailwind *){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1:where(.tailwind,.tailwind *),h2:where(.tailwind,.tailwind *),h3:where(.tailwind,.tailwind *),h4:where(.tailwind,.tailwind *),h5:where(.tailwind,.tailwind *),h6:where(.tailwind,.tailwind *){font-size:inherit;font-weight:inherit}a:where(.tailwind,.tailwind *){color:inherit;text-decoration:inherit}b:where(.tailwind,.tailwind *),strong:where(.tailwind,.tailwind *){font-weight:bolder}code:where(.tailwind,.tailwind *),kbd:where(.tailwind,.tailwind *),samp:where(.tailwind,.tailwind *),pre:where(.tailwind,.tailwind *){font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small:where(.tailwind,.tailwind *){font-size:80%}sub:where(.tailwind,.tailwind *),sup:where(.tailwind,.tailwind *){font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub:where(.tailwind,.tailwind *){bottom:-.25em}sup:where(.tailwind,.tailwind *){top:-.5em}table:where(.tailwind,.tailwind *){text-indent:0;border-color:inherit;border-collapse:collapse}button:where(.tailwind,.tailwind *),input:where(.tailwind,.tailwind *),optgroup:where(.tailwind,.tailwind *),select:where(.tailwind,.tailwind *),textarea:where(.tailwind,.tailwind *){font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button:where(.tailwind,.tailwind *),select:where(.tailwind,.tailwind *){text-transform:none}button:where(.tailwind,.tailwind *),input:where([type=button]):where(.tailwind,.tailwind *),input:where([type=reset]):where(.tailwind,.tailwind *),input:where([type=submit]):where(.tailwind,.tailwind *){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring:where(.tailwind,.tailwind *){outline:auto}:-moz-ui-invalid:where(.tailwind,.tailwind *){box-shadow:none}progress:where(.tailwind,.tailwind *){vertical-align:baseline}::-webkit-inner-spin-button:where(.tailwind,.tailwind *),::-webkit-outer-spin-button:where(.tailwind,.tailwind *){height:auto}[type=search]:where(.tailwind,.tailwind *){-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration:where(.tailwind,.tailwind *){-webkit-appearance:none}::-webkit-file-upload-button:where(.tailwind,.tailwind *){-webkit-appearance:button;font:inherit}summary:where(.tailwind,.tailwind *){display:list-item}blockquote:where(.tailwind,.tailwind *),dl:where(.tailwind,.tailwind *),dd:where(.tailwind,.tailwind *),h1:where(.tailwind,.tailwind *),h2:where(.tailwind,.tailwind *),h3:where(.tailwind,.tailwind *),h4:where(.tailwind,.tailwind *),h5:where(.tailwind,.tailwind *),h6:where(.tailwind,.tailwind *),hr:where(.tailwind,.tailwind *),figure:where(.tailwind,.tailwind *),p:where(.tailwind,.tailwind *),pre:where(.tailwind,.tailwind *){margin:0}fieldset:where(.tailwind,.tailwind *){margin:0;padding:0}legend:where(.tailwind,.tailwind *){padding:0}ol:where(.tailwind,.tailwind *),ul:where(.tailwind,.tailwind *),menu:where(.tailwind,.tailwind *){list-style:none;margin:0;padding:0}dialog:where(.tailwind,.tailwind *){padding:0}textarea:where(.tailwind,.tailwind *){resize:vertical}input::-moz-placeholder:where(.tailwind,.tailwind *),textarea::-moz-placeholder:where(.tailwind,.tailwind *){opacity:1;color:#9ca3af}input::placeholder:where(.tailwind,.tailwind *),textarea::placeholder:where(.tailwind,.tailwind *){opacity:1;color:#9ca3af}button:where(.tailwind,.tailwind *),[role=button]:where(.tailwind,.tailwind *){cursor:pointer}:disabled:where(.tailwind,.tailwind *){cursor:default}img:where(.tailwind,.tailwind *),svg:where(.tailwind,.tailwind *),video:where(.tailwind,.tailwind *),canvas:where(.tailwind,.tailwind *),audio:where(.tailwind,.tailwind *),iframe:where(.tailwind,.tailwind *),embed:where(.tailwind,.tailwind *),object:where(.tailwind,.tailwind *){display:block;vertical-align:middle}img:where(.tailwind,.tailwind *),video:where(.tailwind,.tailwind *){max-width:100%;height:auto}[hidden]:where(.tailwind,.tailwind *){display:none}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.tw-absolute{position:absolute}.tw-relative{position:relative}.tw-left-0{left:0}.tw-right-0{right:0}.tw-top-0{top:0}.tw-z-10{z-index:10}.tw-z-30{z-index:30}.tw-z-50{z-index:50}.tw-m-1{margin:.25rem}.tw-flex{display:flex}.tw-grid{display:grid}.tw-size-full{width:100%;height:100%}.tw-h-5\\/6{height:83.333333%}.tw-h-full{height:100%}.tw-h-screen{height:100vh}.tw-w-5\\/6{width:83.333333%}.tw-w-8{width:2rem}.tw-w-fit{width:-moz-fit-content;width:fit-content}.tw-w-full{width:100%}.tw-select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.tw-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.tw-grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.tw-flex-row{flex-direction:row}.tw-flex-col{flex-direction:column}.tw-flex-wrap{flex-wrap:wrap}.tw-content-center{align-content:center}.tw-items-center{align-items:center}.tw-justify-start{justify-content:flex-start}.tw-justify-center{justify-content:center}.tw-gap-5{gap:1.25rem}.tw-rounded-md{border-radius:.375rem}.tw-rounded-bl-md{border-bottom-left-radius:.375rem}.tw-border{border-width:1px}.tw-border-gray-400{--tw-border-opacity: 1;border-color:rgb(156 163 175 / var(--tw-border-opacity))}.tw-border-b-black{--tw-border-opacity: 1;border-bottom-color:rgb(0 0 0 / var(--tw-border-opacity))}.tw-border-l-black{--tw-border-opacity: 1;border-left-color:rgb(0 0 0 / var(--tw-border-opacity))}.tw-bg-\\[\\#deded9\\]{--tw-bg-opacity: 1;background-color:rgb(222 222 217 / var(--tw-bg-opacity))}.tw-bg-gray-100{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity))}.tw-bg-gray-300{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity))}.tw-bg-gray-400{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity))}.tw-bg-gray-50{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity))}.tw-bg-slate-200{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity))}.tw-bg-slate-800{--tw-bg-opacity: 1;background-color:rgb(30 41 59 / var(--tw-bg-opacity))}.tw-bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.tw-bg-opacity-80{--tw-bg-opacity: .8}.tw-p-1{padding:.25rem}.tw-p-10{padding:2.5rem}.tw-px-2{padding-left:.5rem;padding-right:.5rem}.tw-px-3{padding-left:.75rem;padding-right:.75rem}.tw-py-1{padding-top:.25rem;padding-bottom:.25rem}.tw-py-10{padding-top:2.5rem;padding-bottom:2.5rem}.tw-text-center{text-align:center}.tw-font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.tw-text-sm{font-size:.875rem;line-height:1.25rem}.tw-text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity))}.tw-text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.tw-shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.tw-outline-none{outline:2px solid transparent;outline-offset:2px}.tw-outline{outline-style:solid}.tw-outline-2{outline-width:2px}.tw-outline-slate-600{outline-color:#475569}.tw-drop-shadow-md{--tw-drop-shadow: drop-shadow(0 4px 3px rgb(0 0 0 / .07)) drop-shadow(0 2px 2px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.hover\\:tw-bg-gray-400:hover{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity))}.hover\\:tw-bg-gray-500:hover{--tw-bg-opacity: 1;background-color:rgb(107 114 128 / var(--tw-bg-opacity))}.hover\\:tw-bg-slate-200:hover{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity))}
`,document.head.appendChild(__vite_style__);const NAME=Symbol("name"),LENGTH=Symbol("length"),MIN=Symbol("min"),MAX=Symbol("max"),QUERYABLE=Symbol("queryable"),PARENTVALUES=Symbol("parentValues"),keyToSymbolMap={name:NAME,length:LENGTH,min:MIN,max:MAX,queryable:QUERYABLE,parent:PARENTVALUES};var Meta;(e=>{function t(s,c){return!!s[keyToSymbolMap[c]]}e.has=t;function n(s,c){return c==="length"&&Array.isArray(s)?s.length:s[keyToSymbolMap[c]]}e.get=n;function o(s,c){const x=[];for(let a=0;a<c.length;a++)x.push(n(s,c[a]));return x}e.getN=o;function u(s,c,x){s[keyToSymbolMap[c]]=x}e.set=u;function r(s,c,x){for(let a=0;a<c.length;a++)u(s,c[a],x[a])}e.setN=r;function d(s,c,x){const a=x??Object.keys(keyToSymbolMap);for(const i of a)s[keyToSymbolMap[i]]=n(c,i)}e.copy=d})(Meta||(Meta={}));var Getter;(e=>{function t(s){if(typeof s=="function")return s;if(Array.isArray(s)){const c=x=>s[x];return Meta.set(c,"length",s.length),c}if(isTypedArray(s)){const c=x=>s[x];return Meta.set(c,"length",s.length),c}return()=>s}e.of=t;function n(s){return()=>s}e.constant=n;function o(s,c){const x=e.of(s),a=i=>x(c[i]);return isObject(s)&&Meta.copy(a,s),Meta.set(a,"length",c.length),a}e.proxy=o;function u(s){const c=s.map(e.of),x=a=>c.map(i=>i(a));return Meta.copy(x,s[0],["length"]),x}e.multi=u;function r(s){const c={};for(const x of Reflect.ownKeys(s))c[x]=e.of(s[x]);return c}e.mapObject=r;function d(s,c){const x=e.of(c),a=Array(s);for(let i=0;i<s;i++)a[i]=x(i);return a}e.array=d})(Getter||(Getter={}));function identity(e){return e}const just=e=>()=>e,zero=just(0),one=just(1);function inc(e){return e+1}function dec(e){return e-1}function call(e){return e()}function bimap(e,t,n){if(e.length!==t.length)throw new Error("Arrays must be of the same length");const o=Array(e.length);for(let u=0;u<e.length;u++)o[u]=n(e[u],t[u]);return o}function square(e){return e**2}const sqrt=Math.sqrt,log10=Math.log10;function exp10(e){return 10**e}const max=Math.max;function diff(e,t){return e-t}function sum(e,t){return e+t}function prod(e,t){return e*t}function trunc(e,t=0,n=1){return Math.min(Math.max(e,t),n)}function rangeInverse(e,t){return 1/(t-e)}function invertRange(e,t){const n=rangeInverse(e,t);return[-e*n,n-e*n]}function round(e,t=0){return Math.round(e*10**t)/10**t}function compareAlphaNumeric(e,t){return e.localeCompare(t,"en",{numeric:!0})}function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}function toLowerCase(e){return e.toLocaleLowerCase()}function toUpperCase(e){return e.toLocaleUpperCase()}function stripWS(e){return e.replace(/\s/g,"")}function last(e){return e[e.length-1]}function rep(e,t){return Array(t).fill(e)}function seq(e,t,n){const o=Math.abs(t-e);n=n??Math.ceil(o)+1;const u=o/(n-1),r=t>=e?1:-1;return Array.from(Array(n),(d,s)=>e+r*u*s)}function seqLength(e,t){return Array.from(Array(t),(n,o)=>e+o)}function subset(e,t){const n=Array(t.length);for(let o=0;o<t.length;o++)n[o]=e[t[o]];return n}function remove(e,t){const n=e.indexOf(t);n!==-1&&e.splice(n,1)}function ordered(e,t){const n=Array(t.length);for(let o=0;o<t.length;o++)n[t[o]]=e[o];return n}function orderIndices(e){const t=e.toSorted(diff),n={},o={};for(let u=0;u<t.length;u++){const r=e[u];o[r]=o[r]+1||0,n[u]=t.indexOf(r)+o[r]}return Object.values(n)}function orderBy(e,t){const n=Array(e.length);for(let o=0;o<e.length;o++)n[o]=e[t[o]];for(let o=0;o<e.length;o++)e[o]=n[o]}function orderIndicesByTable(e,t){const n=Array(e.length);for(let o=0;o<e.length;o++)n[o]=t.indexOf(e[o]);return n}function minmax(e){let[t,n]=[1/0,-1/0];for(let o=0;o<e.length;o++)t=Math.min(t,e[o]),n=Math.max(n,e[o]);return[t,n]}function cumsum(e){const t=Array(e.length);t[0]=e[0];for(let n=1;n<e.length;n++)t[n]=e[n]+t[n-1];return t}function randomInteger(e,t){return Math.floor(e+Math.random()*t)}function uniqueIntegers(e,t,n=t-e){const o=t-e,u=[],r=new Set;for(;u.length<Math.min(n,o);){let d=randomInteger(e,t);for(;r.has(d);)d=randomInteger(e,t);u.push(d),r.add(d)}return u}async function fetchJSON(e){return await(await fetch(e)).json()}function merge(e,t){return{...e,...t}}function copyValues(e,t){if(e!==t){if(isTypedArray(e)&&isTypedArray(t))t.set(e);else if(Array.isArray(e)&&Array.isArray(t)){t.length=e.length;for(let n=0;n<e.length;n++)t[n]=e[n]}}}function copyProps(e,t){for(const[n,o]of Object.entries(e))Array.isArray(o)&&Array.isArray(e[n])?copyValues(o,e[n]):t[n]=o}function applyDirection(e,t){return .5*(1-t)+t*e}function prettyBreaks(e,t,n=4){const o=(t-e)/n,u=Math.floor(Math.log10(o)),r=[1,2,4,5,10];let[d,s]=[1/0,0];for(let f=0;f<r.length;f++){const g=(r[f]*10**u-o)**2;g<d&&([d,s]=[g,r[f]])}const c=10**u*s,x=Math.ceil(e/c)*c,a=Math.floor(t/c)*c,i=Math.round((a-x)/c),l=[];for(let f=0;f<i+1;f++){const g=x+f*c;l.push(g)}return l}function binBreaks(e,t){let{width:n,anchor:o,nBins:u}=t||{};const[r,d]=minmax(e),s=d-r;u=u??(n?Math.ceil(s/n)+1:10),n=n??s/(u-1),o=o??r;const c=r-n+(o-r)%n,x=d+n-(d-o)%n,a=Array(u+2);a[0]=c,a[a.length-1]=x;for(let i=1;i<a.length-1;i++)a[i]=c+i*n;return a}function tw(e){return e.trim().split(/\s+/)}function addTailwind(e,t){for(const n of t.trim().split(/\s+/))e.classList.add(n)}function removeTailwind(e,t){for(const n of t.trim().split(/\s+/))e.classList.remove(n)}function throttle(e,t){let n=0;return function(...o){const u=new Date().getTime();u-n<t||(n=u,e(...o))}}function timeExecution(e){const t=performance.now();return e(),performance.now()-t}function segmentToPointVec(e){const[t,n,o,u]=e;return[t,n,o-t,u-n]}function inRange(e,t,n){return!(e<t)&&!(e>n)}function segmentsIntersect(e,t){let[n,o,u,r]=segmentToPointVec(e),[d,s,c,x]=segmentToPointVec(t);const a=c*r-u*x,i=((n-d)*r-(o-s)*u)/a,l=-(-(n-d)*x+(o-s)*c)/a;return inRange(i,0,1)&&inRange(l,0,1)}function rectSegmentIntersect(e,t){const[n,o,u,r]=e;return segmentsIntersect([n,o,u,o],t)||segmentsIntersect([n,o,n,r],t)||segmentsIntersect([u,o,u,r],t)||segmentsIntersect([n,r,u,r],t)}function pointInRect(e,t){const[n,o]=e,[u,r,d,s]=t;return!(n<u||n>d||o<r||o>s)}function rectsIntersect(e,t){const[n,o]=[e[0],e[2]].sort(diff),[u,r]=[e[1],e[3]].sort(diff),[d,s]=[t[0],t[2]].sort(diff),[c,x]=[t[1],t[3]].sort(diff);return!(o<d||n>s||r<c||u>x)}function addIndexed(e,t,n){const u=Object.keys(e).filter(s=>s.replace(/[0-9]*$/,"")===t);if(u.length===0){e[`${t}1`]=n;return}const r=u.map(s=>parseInt(s.match(/[0-9]*$/)[0],10)),d=Math.max(...r);e[`${t}${d+1}`]=n}function minDecimal(e){let t=1/0;for(let n=0;n<e.length;n++)e[n]!==0&&(t=Math.min(t,Math.log10(Math.abs(e[n]))));return t>3?0:Math.floor(Math.abs(t))+2}function formatText(e,t={lowercase:!0,capitalize:!0,split:!0}){return t!=null&&t.split&&(e=e.replace(/_/g," ")),t!=null&&t.lowercase&&(e=e.toLocaleLowerCase()),t!=null&&t.capitalize&&(e=capitalize(e)),e}function formatLabel(e){if(typeof e=="string")return e;if(e===0)return e.toString();const t=Math.floor(Math.log10(Math.abs(e)));return t>=3?round(e).toString():t<=-3?round(e,-t+1).toString():round(e,2).toString()}function formatAxisLabels(e,t){if(!isNumberArray(e))return e;const n=(t==null?void 0:t.tens)??4,o=s=>s!=0&&Math.abs(Math.log10(s))>n,u=(t==null?void 0:t.decimals)??minDecimal(e);e=e.map(s=>round(s,u));const d=minmax(e).some(o)?superscriptFn:noSuperscriptFn;return e.map(d)}function superscriptFn(e){return e===0?"0":exponentialToSuperscript(e.toExponential())}function noSuperscriptFn(e){return e===0?"0":parseFloat(e.toPrecision(12)).toString()}function exponentialToSuperscript(e){let[t,n]=e.split("e");return n=convertToSuperscript(n),t+"×10"+n}const sups={"-":"⁻","+":"",0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹"};function convertToSuperscript(e){return e.split("").map(t=>sups[t]).join("")}function isDefined(e){return e!=null}const primitives=["string","number","boolean","undefined"];function isPrimitive(e){return e===null||primitives.includes(typeof e)}function isObject(e){return typeof e=="object"&&e!==null}function isTypedArray(e){return ArrayBuffer.isView(e)}function isNumber(e){return typeof e=="number"}function isIntegerString(e){return/^[0-9]+/.test(e)}function isNumberArray(e){return typeof e[0]=="number"&&typeof last(e)=="number"}function isStringArray(e){return typeof e[0]=="string"&&typeof last(e)=="string"}function isEventTarget(e){return"addEventListener"in e}function findLength(e){for(const n of e){if(!n)continue;const o=Meta.get(n,"length");if(o)return o}const t="At least one variable needs to be of fixed length";throw new Error(t)}function applyWith(...e){return function(t){return t(...e)}}function row(e,t){const n={};for(const[o,u]of Object.entries(e))n[o]=Getter.of(u)(t);return n}function selector(e){return function(t){return t[e]}}function keysToSelectors(e){return function(t){return e.map(n=>t[n])}}function splitNumericSuffix(e){let t=e.length-1;for(;t>0&&/[0-9]/.test(e[t]);)t--;return t+=1,[e.substring(0,t),e.substring(t,e.length)]}function filterIndices(e,t){const n=[];for(let o=0;o<e.length;o++)t(e[o])&&n.push(o);return n}function stringArraysMatch(e,t){if(e.length!==t.length)return!1;const n=e.toSorted(compareAlphaNumeric).join(""),o=t.toSorted(compareAlphaNumeric).join("");return n===o}function clearNodeChildren(e){e.innerHTML=""}const LISTENERS=Symbol("listeners"),DEFERRED=Symbol("deferred");var Reactive;(e=>{function t(){return function(a){return{...a,[LISTENERS]:{},[DEFERRED]:{}}}}e.of=t;function n(a){return a[LISTENERS]!==void 0}e.is=n;function o(a,i,l,f){f!=null&&f.throttle&&(l=throttle(l,f.throttle));const g=f!=null&&f.defer?a[DEFERRED]:a[LISTENERS];g[i]||(g[i]=[]),g[i].includes(l)||g[i].push(l)}e.listen=o;function u(a,i,l){const[f,g]=[a[LISTENERS][i],a[DEFERRED][i]];if(f)for(const p of f)p(l);if(g)for(const p of g)p(l)}e.dispatch=u;function r(a,i,l){const f=()=>e.dispatch(i,l);e.listen(a,l,f,{defer:!0})}e.propagate=r;function d(a,i){i(a),e.dispatch(a,"changed")}e.set=d;function s(a,i,l){const[f,g]=[a[LISTENERS][i],a[DEFERRED][i]];f&&remove(f,l),g&&remove(g,l)}e.remove=s;function c(a,i){const[l,f]=[a[LISTENERS][i],a[DEFERRED][i]];if(l)for(const g of l)remove(l,g);if(f)for(const g of f)remove(f,g)}e.removeAll=c;function x(a){const[i,l]=[a[LISTENERS],a[DEFERRED]];if(i)for(const f of Object.values(i))f.length=0;if(l)for(const f of Object.values(l))f.length=0}e.removeAllListeners=x})(Reactive||(Reactive={}));const METHODS=Symbol("methods");exports.Poly=void 0,(e=>{function t(u){const r=function(...d){return n(r,u,d[0].type)(...d)};return r[METHODS]={},r}e.of=t;function n(u,r,d){return u[METHODS][d]??r}e.dispatch=n;function o(u,r,d){u[METHODS][r]=d}e.set=o})(exports.Poly||(exports.Poly={})),exports.Expanse=void 0,(e=>{e.normalize=exports.Poly.of(t),e.unnormalize=exports.Poly.of(n),e.train=exports.Poly.of(o),e.breaks=exports.Poly.of(u),e.reorder=exports.Poly.of(r);function t(m,S){throw new Error(`Method 'normalize' not implemented for expanse of type '${m.type}'`)}function n(m,S){throw new Error(`Method 'unnormalize' not implemented for expanse of type '${m.type}'`)}function o(m,S,M){throw new Error(`Method 'train' not implemented for expanse of type '${m.type}'`)}e.trainDefault=o;function u(m){throw new Error(`Method 'breaks' not implemented for expanse of type '${m.type}'`)}function r(m,S){throw new Error(`Method 'reorder' not implemented for expanse of type '${m.type}'`)}function d(m){const S=(m==null?void 0:m.zero)??0,M=(m==null?void 0:m.one)??1,b=(m==null?void 0:m.direction)??1,w=[],A=[],C={zero:S,one:M,direction:b};return Reactive.of()({zero:S,one:M,direction:b,frozen:w,linked:A,defaults:C})}e.base=d;function s(m,S,M){const{linked:b,frozen:w}=m,A={...m};if(S(A),!(M!=null&&M.unfreeze))for(const C of w)delete A[C];for(const C of Object.keys(A))A[C]===m[C]&&delete A[C];copyProps(A,m);for(const C of b)e.set(C,S);M!=null&&M.default&&copyProps(A,m.defaults),M!=null&&M.silent||Reactive.dispatch(m,"changed")}e.set=s;function c(m,S){for(const M of S)m.frozen.includes(M)||m.frozen.push(M)}e.freeze=c;function x(m,S){m.linked.includes(S)||m.linked.push(S)}e.linkTo=x;function a(m){const{defaults:S}=m;for(const[M,b]of Object.entries(S))Array.isArray(b)&&Array.isArray(m[M])?copyValues(b,m[M]):m[M]=b;Reactive.dispatch(m,"changed")}e.reset=a;function i(m,S){const{direction:M}=m,b=S;e.set(m,w=>(w.zero+=M*b,w.one+=M*b))}e.move=i;function l(m,S,M,b){const{zero:w,one:A,direction:C}=m,z=A-w;C===-1&&([S,M]=[1-S,1-M]);let[T,D]=[S,M].map(L=>(L-w)/z);[T,D]=invertRange(T,D),C===-1&&([T,D]=[1-T,1-D]),e.set(m,L=>(L.zero=T,L.one=D),b)}e.expand=l;function f(m){e.set(m,S=>S.direction*=-1)}e.flip=f;function g(m){return m.one-m.zero}e.unitRange=g;function p(m){return m.type==="continuous"||m.type==="split"}e.isContinuous=p;function h(m){return m.type==="point"}e.isPoint=h;function y(m){return m.type==="point"||m.type==="band"}e.isDiscrete=y;function R(m){return m.type==="band"}e.isBand=R;function E(m){return m.type==="compound"}e.isCompound=E;function v(m){return m.type==="split"}e.isSplit=v})(exports.Expanse||(exports.Expanse={}));var ExpanseBand;(e=>{const t="band";function n(l=[],f){const g="",p=exports.Expanse.base(f),[h,y]=[!1,seqLength(0,l.length)],R=(f==null?void 0:f.weights)??Array(l.length).fill(1),E=cumsum(R),v={labels:l,ordered:h,order:y,weights:R,cumulativeWeights:E},m={ordered:h,labels:[...l],order:[...y],weights:[...R],cumulativeWeights:[...E],...p.defaults};return{value:g,type:t,...v,...p,defaults:m}}e.of=n,exports.Poly.set(exports.Expanse.normalize,t,r),exports.Poly.set(exports.Expanse.unnormalize,t,d),exports.Poly.set(exports.Expanse.train,t,s),exports.Poly.set(exports.Expanse.breaks,t,x),exports.Poly.set(exports.Expanse.reorder,t,c);function o(l,f){const{order:g,cumulativeWeights:p}=l;f=g[f];const h=p[f-1]??0,y=p[f],R=last(p);return(h+y)/2/R}function u(l,f){if(f=f??Array(l.labels.length).fill(1),f.length!=l.labels.length){const h="The length of the weights must match the length of labels";throw new Error(h)}const{order:g}=l,p=cumsum(ordered(f,g));copyValues(f,l.weights),copyValues(f,l.defaults.weights),copyValues(p,l.cumulativeWeights),copyValues(p,l.defaults.cumulativeWeights),Reactive.dispatch(l,"changed")}e.setWeights=u;function r(l,f){const{labels:g,zero:p,one:h,direction:y}=l,R=g.indexOf(f);if(R===-1)throw new Error(`Label ${f} not found in: ${g}`);const E=o(l,R),v=p+E*(h-p);return applyDirection(v,y)}e.normalize=r;function d(l,f){const{labels:g,zero:p,one:h,direction:y}=l;f=applyDirection(f,y);const R=(f-p)/(h-p),E=Math.round((2*R*g.length-1)/2);return g[E]}e.unnormalize=d;function s(l,f,g){const{order:p}=l,h=Array.from(new Set(f)).sort(compareAlphaNumeric);if(!p.length){for(let v=0;v<h.length;v++)p[v]=v;l.defaults.order=[...p],l.ordered=!1}const y=Array(h.length).fill(1),R=cumsum(ordered(y,p)),E={labels:h,weights:y,cumulativeWeights:R};for(const[v,m]of Object.entries(E))Array.isArray(l[v])&&copyValues(m,l[v]),g!=null&&g.default&&copyValues(m,l.defaults[v]);exports.Expanse.set(l,()=>{},g)}e.train=s;function c(l,f){const{order:g,weights:p,cumulativeWeights:h,defaults:y}=l;if(!f){copyValues(y.order,g),copyValues(cumsum(ordered(p,g)),h),l.ordered=!1,Reactive.dispatch(l,"changed");return}copyValues(f,g),copyValues(cumsum(ordered(p,f)),h),l.ordered=!0,Reactive.dispatch(l,"changed")}e.reorder=c;function x(l){return ordered(l.labels,l.order)}e.breaks=x;function a(){return!1}e.isContinuous=a;function i(){return!0}e.isDiscrete=i})(ExpanseBand||(ExpanseBand={}));var ExpanseContinuous;(e=>{const t="continuous";function n(c=0,x=1,a){const l=exports.Expanse.base(a),[f,g]=[identity,identity],{scale:p=1,mult:h=1,offset:y=0,ratio:R=!1}=a??{},E={min:c,max:x,scale:p,mult:h,offset:y},v={...E,...l.defaults,offset:y,trans:f,inv:g};return{value:0,type:t,ratio:R,...E,...l,trans:f,inv:g,defaults:v}}e.of=n,exports.Poly.set(exports.Expanse.normalize,t,o),exports.Poly.set(exports.Expanse.unnormalize,t,u),exports.Poly.set(exports.Expanse.train,t,r),exports.Poly.set(exports.Expanse.breaks,t,d);function o(c,x){const{min:a,max:i,zero:l,one:f}=c,{direction:g,scale:p,mult:h,offset:y,trans:R}=c,E=R(i)-R(a);let v=x/(p*h)-y;return v=(R(v-y)-R(a))/E,v=l+v*(f-l),v=applyDirection(v,g),v}e.normalize=o;function u(c,x){const{min:a,max:i,zero:l,one:f}=c,{scale:g,mult:p,offset:h,trans:y,inv:R}=c,E=y(i)-y(a);let v=(x-l)/(f-l);return v=R(y(a)+v*E),v=v*(g*p)+h,v}e.unnormalize=u;function r(c,x,a){let[i,l]=Meta.getN(x,["min","max"]);(!i||!l)&&([i,l]=minmax(x)),i=c.ratio||a!=null&&a.ratio?0:i,exports.Expanse.set(c,f=>(f.min=i,f.max=l),a)}e.train=r;function d(c,x=4){const[a,i]=[0,1].map(f=>u(c,f)).sort(diff);return prettyBreaks(a,i,x)}e.breaks=d;function s(c){const{min:x,max:a}=c;return a-x}e.range=s})(ExpanseContinuous||(ExpanseContinuous={})),exports.Scale=void 0,(e=>{function t(p,h){const y=Reactive.of()({domain:p,codomain:h});return Reactive.propagate(p,y,"changed"),Reactive.propagate(h,y,"changed"),y}e.of=t;function n(p,h){p.domain=h,Reactive.propagate(p.domain,p,"changed")}e.setDomain=n;function o(p,h){p.codomain=h,Reactive.propagate(p.codomain,p,"changed")}e.setCoomain=o;function u(p,h){const{domain:y,codomain:R}=p;return exports.Expanse.unnormalize(R,exports.Expanse.normalize(y,h))}e.pushforward=u;function r(p,h){const{domain:y,codomain:R}=p;return exports.Expanse.unnormalize(y,exports.Expanse.normalize(R,h))}e.pullback=r;function d(p,h,y,R){exports.Expanse.expand(p.domain,h,y,R)}e.expand=d;function s(p,h,y){if(((y==null?void 0:y.name)??!0)&&Meta.has(h,"name")&&Meta.copy(p,h,["name"]),typeof h[0]=="string"&&exports.Expanse.isContinuous(p.domain)){const E=Array.from(new Set(h));p.domain=ExpanseBand.of(E)}exports.Expanse.train(p.domain,h,y)}e.train=s;function c(p){exports.Expanse.reset(p.domain),exports.Expanse.reset(p.codomain)}e.restoreDefaults=c;function x(p){const h=exports.Expanse.breaks(p.domain);let y=formatAxisLabels(h);if(exports.Expanse.isCompound(p.domain)){y=formatAxisLabels(h,{decimals:1});const E=h.map(v=>exports.Expanse.unnormalize(p.codomain,ExpanseContinuous.normalize(p.domain,v)));return{labels:y,positions:E}}else if(exports.Expanse.isSplit(p.codomain)){const E=e.pushforward(p,h);return{labels:y,positions:E}}const R=h.map(E=>e.pushforward(p,E));return{labels:y,positions:R}}e.breaks=x;function a(p,h){exports.Expanse.move(p.domain,h)}e.move=a;function i(p,h){h.codomain=p.codomain}e.shareCodomain=i;function l(p){const{domain:h}=p;if(exports.Expanse.isContinuous(h))return ExpanseContinuous.range(h)/exports.Expanse.unitRange(h)}e.domainRange=l;function f(p){const{codomain:h}=p;if(exports.Expanse.isContinuous(h))return ExpanseContinuous.range(h)*exports.Expanse.unitRange(h)}e.codomainRange=f;function g(p){const{domain:h,codomain:y}=p;if(!exports.Expanse.isContinuous(h)||!exports.Expanse.isContinuous(y))throw new Error("Both domain and codomain need to be continuous");const R=ExpanseContinuous.range(h);return ExpanseContinuous.range(y)*exports.Expanse.unitRange(y)/R}e.unitRatio=g})(exports.Scale||(exports.Scale={}));var DOM;(e=>{function t(d,s){const c=document.createElement(d);return s!=null&&s.id&&(c.id=s.id),s!=null&&s.classes&&u(c,s.classes),s!=null&&s.textContent&&(c.textContent=s.textContent),c}e.element=t;function n(d,s){d.appendChild(s)}e.append=n;function o(d,s){return d.querySelector(s)}e.select=o;function u(d,s){for(const c of s)d.classList.add(c)}e.addClasses=u;function r(d,s){for(const c of s)d.classList.remove(c)}e.removeClasses=r})(DOM||(DOM={}));var VAnchor=(e=>(e[e.Middle=.5]="Middle",e[e.Top=1]="Top",e[e.Bottom=0]="Bottom",e))(VAnchor||{}),HAnchor=(e=>(e[e.Center=.5]="Center",e[e.Left=1]="Left",e[e.Right=0]="Right",e))(HAnchor||{}),MouseButton=(e=>(e[e.Left=0]="Left",e[e.Right=2]="Right",e))(MouseButton||{});const dataLayers=[0,1,2,3,4,5,6,7],baseLayers=[4,5,6,7];var Frame;(e=>{function t(v){const m=DOM.element("canvas"),S=m.getContext("2d");DOM.addClasses(m,tw(v.classes??""));for(const[W,$]of Object.entries(v.canvasStyles??{}))m.style[W]=$;const{clientWidth:M,clientHeight:b,clientLeft:w,clientTop:A}=m,C=M-w,z=b-A,T=2,{margins:D=[0,0,0,0],contextProps:L={}}=v;return{canvas:m,context:S,width:C,height:z,margins:D,scalingFactor:T,contextProps:L}}e.of=t;function n(v,m){m.appendChild(v.canvas),v.parent=m,e.resize(v)}e.append=n;function o(v,m){for(const[S,M]of Object.entries(m))v.contextProps[S]=M,v.context[S]=M}e.setContext=o;function u(v){const{context:m,canvas:S,scalingFactor:M}=v,{clientWidth:b,clientHeight:w,clientLeft:A,clientTop:C}=S,z=b-A,T=w-C;v.width=z,v.height=T,v.canvas.width=z*M,v.canvas.height=T*M;for(const[D,L]of Object.entries(v.contextProps))v.context[D]=L;m.scale(M,M),e.clip(v)}e.resize=u;function r(v){const{context:m}=v;let{width:S,height:M}=v;const[b,w,A,C]=v.margins;S=Math.max(S-w-C,0),M=Math.max(M-A-b,0),m.beginPath(),m.rect(w,A,S,M),m.clip()}e.clip=r;function d(v){v.context.clearRect(0,0,v.width,v.height)}e.clear=d;function s(v,m){v.context.globalAlpha=m(v.context.globalAlpha)}e.setAlpha=s;function c(v){v.context.globalAlpha=1}e.resetAlpha=c;function x(v,m){return v.context.measureText(m).width}e.textWidth=x;function a(v,m){const S=v.context.measureText(m);return S.actualBoundingBoxAscent+S.actualBoundingBoxDescent}e.textHeight=a;function i(v,m,S,M,b){const{context:w}=v,A=v.canvas.clientHeight,C=(b==null?void 0:b.hAnchor)??HAnchor.Center,z=(b==null?void 0:b.vAnchor)??VAnchor.Middle;m=m+2*(C-.5)*M,S=A-S+2*(.5-z)*M,w.beginPath(),w.arc(m,S,M,0,Math.PI*2),w.fill()}e.point=i;function l(v,m,S,M,b){for(let w=0;w<m.length;w++)i(v[w],m[w],S[w],M[w],b)}e.points=l;function f(v,m,S,M,b,w){const{context:A,height:C}=v,z=M-m,T=b-S;m=m+(1-w)/2*z,M=M-(1-w)/2*z,S=S+(1-w)/2*T,b=b-(1-w)/2*T,A.fillRect(m,C-S,M-m,S-b)}e.rectangleXY=f;function g(v,m,S,M,b,w){for(let A=0;A<m.length;A++)f(v[A],m[A],S[A],M[A],b[A],w[A])}e.rectanglesXY=g;function p(v,m,S,M,b,w){const{context:A,height:C}=v,z=(w==null?void 0:w.hAnchor)??HAnchor.Center,T=(w==null?void 0:w.vAnchor)??VAnchor.Middle;m=m-z*M,S=C-S+T*b,A.fillRect(m,S,M,-b)}e.rectangleWH=p;function h(v,m,S,M,b,w){for(let A=0;A<m.length;A++)p(v[A],m[A],S[A],M[A],b[A],w)}e.rectanglesWH=h;function y(v,m,S){const{context:M,height:b}=v;M.beginPath(),M.moveTo(m[0],b-S[0]);for(let w=0;w<m.length;w++)M.lineTo(m[w],b-S[w]);M.stroke()}e.line=y;function R(v,m,S){for(let M=0;M<m.length;M++)y(v[M],m[M],S[M])}e.lines=R;function E(v,m,S,M,b){const{context:w,height:A}=v;w.save(),w.translate(m,A-S),b!=null&&b.vertical&&w.rotate(-Math.PI/2),w.fillText(M,0,0),w.translate(-m,-(A-S)),w.restore()}e.text=E})(Frame||(Frame={}));const POSITIONS=Symbol("positions");exports.Factor=void 0,(e=>{(a=>{a[a.Constant=0]="Constant",a[a.Bijection=1]="Bijection",a[a.Surjection=2]="Surjection"})(e.Type||(e.Type={}));function t(a,i,l,f){return Reactive.of()({type:a,cardinality:i,indices:l,data:f})}e.of=t;function n(a,i){i.cardinality=a.cardinality,copyValues(a.indices,i.indices);for(const l of Reflect.ownKeys(a.data))Array.isArray(a.data[l])&&Array.isArray(i.data[l])?(copyValues(a.data[l],i.data[l]),Meta.copy(i.data[l],a.data[l])):i.data[l]=a.data[l]}e.copyFrom=n;function o(a,i){if([a,i].some(l=>l.type===1))return!0;if(a.indices.length!==i.indices.length)throw new Error("Factors do not have matching length")}function u(a){const l=new Uint32Array,f=h=>[h],g=1,p={...a,[POSITIONS]:f};return t(g,1/0,l,p)}e.bijection=u;function r(a){const l=new Uint32Array(a).fill(0),f=()=>Array.from(l),g=0,p={[POSITIONS]:f};return t(g,1,l,p)}e.mono=r;function d(a,i){const l=a.map(y=>y.toString());i=i??Array.from(new Set(l)).sort(compareAlphaNumeric),Meta.has(a,"name")&&Meta.copy(i,a,["name"]);const f=new Uint32Array(a.length),g={};for(let y=0;y<l.length;y++){const R=i.indexOf(l[y]);g[R]||(g[R]=[]),f[y]=R,g[R].push(y)}const p=2,h={label:i,[POSITIONS]:Object.values(g)};return t(p,i.length,f,h)}e.from=d;function s(a,i){function l(){const g=(i==null?void 0:i.breaks)??binBreaks(a,i),p=new Set,h=new Uint32Array(a.length),y={};for(let w=0;w<a.length;w++){const A=g.findIndex(C=>C>=a[w])-1;y[A]||(y[A]=[]),h[w]=A,y[A].push(w),p.add(A)}const R=Array.from(p).sort(diff);for(let w=0;w<h.length;w++)h[w]=R.indexOf(h[w]);const[E,v]=[[],[]];for(let w=0;w<R.length;w++)E.push(g[R[w]]),v.push(g[R[w]+1]);const[m,S]=[g[R[0]],g[last(R)+1]];Meta.setN(E,["min","max"],[m,S]),Meta.setN(v,["min","max"],[m,S]),Meta.set(E,"name",`min of ${Meta.get(a,"name")}`),Meta.set(v,"name",`max of ${Meta.get(a,"name")}`),Meta.copy(g,a,["name"]);const M=2,b={binMin:E,binMax:v,breaks:g,[POSITIONS]:Object.values(y)};return t(M,R.length,h,b)}const f=l();return i&&Reactive.is(i)&&Reactive.listen(i,"changed",()=>{const g=l();e.copyFrom(g,f),Reactive.dispatch(f,"changed")}),f}e.bin=s;function c(a,i){o(a,i);function l(){if(a.type===1){const z={};for(const $ of Reflect.ownKeys(a.data))z[$]=Getter.of(a.data[$]);for(const $ of Reflect.ownKeys(i.data))z[$]=Getter.proxy(i.data[$],i.indices);const T=1,D=i.indices.length,L=new Uint32Array(a.indices.length),W=t(T,D,L,z);return W.parent=a,W}if(a.type===0){const{type:z,data:T,cardinality:D,indices:L}=i,W=t(z,D,L,T);return W.parent=a,W}const g=Math.max(a.cardinality,i.cardinality)+1,p=new Set,h=new Uint32Array(a.indices.length),y={},R={},E={},v=Getter.of(a.indices),m=Getter.of(i.indices);for(let z=0;z<a.indices.length;z++){const[T,D]=[v(z),m(z)],L=g*T+D;L in R||(R[L]=T,E[L]=D,y[L]=[]),h[z]=L,y[L].push(z),p.add(L)}const S=Array.from(p).sort(diff);for(let z=0;z<h.length;z++)h[z]=S.indexOf(h[z]);const M=Object.values(R),b=Object.values(E),w={};for(let z of Reflect.ownKeys(a.data)){let T=z;if(typeof z=="string")for(;T in w;)z+="$";const[D,L]=[a.data[z],M],W=Array.isArray(D)?subset(D,L):Getter.proxy(D,L);Meta.copy(W,D),w[T]=W}for(let z of Reflect.ownKeys(i.data)){let T=z;if(typeof z=="string")for(;T in w;)T+="$";const[D,L]=[i.data[z],b],W=Array.isArray(D)?subset(D,L):Getter.proxy(D,L);Meta.copy(W,D),w[T]=W}const A=2;w[POSITIONS]=Object.values(y);const C=t(A,S.length,h,w);return C.parent=a,C}const f=l();return Reactive.listen(a,"changed",()=>{const g=l();e.copyFrom(g,f)}),Reactive.listen(i,"changed",()=>{const g=l();e.copyFrom(g,f)}),Reactive.propagate(a,f,"changed"),Reactive.propagate(i,f,"changed"),f}e.product=c;function x(a,i){const l={};for(let f=0;f<i.indices.length&&(l[i.indices[f]]=a.indices[f],!(Object.keys(l).length>=i.cardinality));f++);return Object.values(l)}e.parentIndices=x})(exports.Factor||(exports.Factor={}));const Transient=255;var Group=(e=>(e[e.Base=7]="Base",e[e.First=6]="First",e[e.Second=5]="Second",e[e.Third=4]="Third",e[e.BaseTransient=3]="BaseTransient",e[e.FirstTransient=2]="FirstTransient",e[e.SecondTransient=1]="SecondTransient",e[e.ThirdTransient=0]="ThirdTransient",e))(Group||{}),Marker;(e=>{function t(a){const i=Transient,l=new Uint32Array(a).fill(7),f=[],g=exports.Factor.Type.Surjection,p=exports.Factor.of(g,8,l,{[LAYER]:[0,1,2,3,4,5,6,7]}),h=Reactive.of()({group:i,indices:l,transientIndices:f,factor:p});return Reactive.listen(h,"updated",()=>Reactive.dispatch(p,"changed")),Reactive.listen(h,"cleared",()=>Reactive.dispatch(p,"changed")),h}e.of=t;function n(a,i){a.group=i}e.setGroup=n;function o(a,i,l){const f=(l==null?void 0:l.group)??a.group;if(r(a,{silent:!0}),f===Transient){for(let g=0;g<i.length;g++){const p=i[g];a.indices[p]=c(a.indices[p])}a.transientIndices=i}else for(let g=0;g<i.length;g++){const p=i[g];a.indices[p]=f}l!=null&&l.silent||Reactive.dispatch(a,"updated")}e.update=o;function u(a,i){for(let l=0;l<a.indices.length;l++)a.indices[l]=7;i!=null&&i.silent||Reactive.dispatch(a,"cleared")}e.clearAll=u;function r(a,i){for(let l=0;l<a.transientIndices.length;l++){const f=a.transientIndices[l];a.indices[f]=x(a.indices[f])}i!=null&&i.silent||Reactive.dispatch(a,"cleared")}e.clearTransient=r;function d(a){const{factor:i,indices:l}=a;return f=>i.data[LAYER][l[f]]}e.getLayer=d;function s(a){return!(a&4)}e.isTransient=s;function c(a){return a&-5}function x(a){return a|4}})(Marker||(Marker={}));const LAYER=Symbol("layer");var Bars;(e=>{function t(r){const d={},s=[],c=Geom.Type.Bars,x=(r==null?void 0:r.vAnchor)??VAnchor.Bottom,a=(r==null?void 0:r.hAnchor)??HAnchor.Center;return{type:c,data:s,scales:d,vAnchor:x,hAnchor:a}}e.of=t;function n(r,d){const{scales:s,hAnchor:c,vAnchor:x}=r,a=Geom.groupedData(r),i=findLength(Object.values(a)),[l,f,g,p]=Geom.scaledArrays(i,[[a.x,s.x],[a.y,s.y],[a.width,s.width],[a.height,s.height]]),h=Geom.frames(i,a[LAYER],d);Frame.rectanglesWH(h,l,f,g,p,{hAnchor:c,vAnchor:x})}e.render=n;function o(r,d){const{scales:s,hAnchor:c,vAnchor:x}=r,a=Geom.flatData(r),i=findLength(Object.values(a)),{x:l,y:f,width:g,height:p}=Getter.mapObject(a),h=Getter.of(a[POSITIONS]),y=[];for(let R=0;R<i;R++){let E=exports.Scale.pushforward(s.x,l(R)),v=exports.Scale.pushforward(s.y,f(R)),m=exports.Scale.pushforward(s.width,g(R)),S=exports.Scale.pushforward(s.height,p(R));[E,v,m,S]=[E,v,m,S];const b=[E-m*c,v-S*x,E+m*c,v+S*(1-x)];if(rectsIntersect(d,b)){const w=h(R);for(let A=0;A<w.length;A++)y.push(w[A])}}return y}e.check=o;function u(r,d){const{scales:s,hAnchor:c,vAnchor:x}=r,a=Geom.flatData(r),i=findLength(Object.values(a)),{x:l,y:f,width:g,height:p}=Getter.mapObject(a);for(let h=0;h<i;h++){let y=exports.Scale.pushforward(s.x,l(h)),R=exports.Scale.pushforward(s.y,f(h)),E=exports.Scale.pushforward(s.width,g(h)),v=exports.Scale.pushforward(s.height,p(h));[y,R,E,v]=[y,R,E,v];const S=[y-E*c,R-v*x,y+E*c,R+v*(1-x)];if(pointInRect(d,S)){const M={};Meta.has(a.x,"name")&&(M[Meta.get(a.x,"name")]=l(h)),Meta.has(a.y,"name")&&(M[Meta.get(a.y,"name")]=f(h)),Meta.has(a.height,"name")&&(M[Meta.get(a.height,"name")]=p(h));for(const[b,w]of Object.entries(a))["x","y","width","height"].includes(b)||w&&Meta.has(w,"name")&&(M[Meta.get(w,"name")]=Geom.getter(w)(h));return M}}}e.query=u})(Bars||(Bars={}));var Lines;(e=>{function t(){const r={},d=[];return{type:Geom.Type.Lines,data:d,scales:r}}e.of=t;function n(r,d){const{scales:s}=r,c=Geom.groupedData(r),x=findLength(Object.values(c)),[a,i]=Geom.scaledArrays(x,[[c.x,s.x],[c.y,s.y]]),l=Geom.frames(x,c[LAYER],d);Frame.lines(l,a,i)}e.render=n;function o(r,d){const{scales:s}=r,c=Geom.flatData(r),x=findLength(Object.values(c)),{x:a,y:i}=Getter.mapObject(c),l=Getter.of(c[POSITIONS]),f=[];for(let g=0;g<x;g++){const p=exports.Scale.pushforward(s.x,a(g)),h=exports.Scale.pushforward(s.y,i(g));for(let y=1;y<p.length;y++){const R=[p[y-1],h[y-1],p[y],h[y]];if(rectSegmentIntersect(d,R)){const E=l(g);for(let v=0;v<E.length;v++)f.push(E[v])}}}return f}e.check=o;function u(r,d){let{scales:s}=r;const c=Geom.flatData(r),x=findLength(Object.values(c)),{x:a,y:i}=Getter.mapObject(c),l=bimap([...d,...d],[-1,-1,1,1],sum);for(let f=0;f<x;f++){const g=exports.Scale.pushforward(s.x,a(f)),p=exports.Scale.pushforward(s.y,i(f));for(let h=1;h<g.length;h++){const y=[g[h-1],p[h-1],g[h],p[h]];if(rectSegmentIntersect(l,y)){const R={},[E,v]=[a(f),i(f)];for(let m=0;m<E.length;m++)R[E[m]]=v[m];for(const[m,S]of Object.entries(c))m==="x"||m==="y"||S&&Meta.has(S,"name")&&(R[Meta.get(S,"name")]=Geom.getter(S)(f));return R}}}}e.query=u})(Lines||(Lines={}));var Points;(e=>{function t(){const r={},d=[];return{type:Geom.Type.Points,data:d,scales:r}}e.of=t;function n(r,d){const{scales:s}=r,c=Geom.groupedData(r),x=findLength(Object.values(c)),[a,i,l]=Geom.scaledArrays(x,[[c.x,s.x],[c.y,s.y],[c.size,s.size]]),f=Geom.frames(x,c[LAYER],d);Frame.points(f,a,i,l)}e.render=n;function o(r,d){const{scales:s}=r,c=Geom.flatData(r),x=findLength(Object.values(c)),{x:a,y:i,size:l}=Getter.mapObject(c),f=Getter.of(c[POSITIONS]),g=[];for(let p=0;p<x;p++){const h=exports.Scale.pushforward(s.x,a(p)),y=exports.Scale.pushforward(s.y,i(p));let R=exports.Scale.pushforward(s.size,l(p));R=R/Math.sqrt(2);const E=[h-R,y-R,h+R,y+R];if(rectsIntersect(d,E)){const v=f(p);for(let m=0;m<v.length;m++)g.push(v[m])}}return g}e.check=o;function u(r,d){const{scales:s}=r,c=Geom.flatData(r),x=findLength(Object.values(c)),{x:a,y:i,size:l}=Getter.mapObject(c);for(let f=0;f<x;f++){const g=exports.Scale.pushforward(s.x,a(f)),p=exports.Scale.pushforward(s.y,i(f));let h=exports.Scale.pushforward(s.size,l(f));h=h/Math.sqrt(2);const y=[g-h,p-h,g+h,p+h];if(pointInRect(d,y)){const R={};R[Meta.get(c.x,"name")]=a(f),R[Meta.get(c.y,"name")]=i(f);for(const[E,v]of Object.entries(c))E==="x"||E==="y"||v&&Meta.has(v,"name")&&(R[Meta.get(v,"name")]=Geom.getter(v)(f));return R}}}e.query=u})(Points||(Points={}));var Rectangles;(e=>{function t(){const r={},d=[];return{type:Geom.Type.Rectangles,data:d,scales:r}}e.of=t;function n(r,d){const{scales:s}=r,c=Geom.groupedData(r),x=findLength(Object.values(c)),[a,i,l,f,g]=Geom.scaledArrays(x,[[c.x0,s.x],[c.y0,s.y],[c.x1,s.x],[c.y1,s.y],[c.area,s.areaPct]]),p=Geom.frames(x,c[LAYER],d);Frame.rectanglesXY(p,a,i,l,f,g)}e.render=n;function o(r,d){const{scales:s}=r,c=Geom.flatData(r),x=findLength(Object.values(c)),{x0:a,y0:i,x1:l,y1:f,area:g}=Getter.mapObject(c),p=Getter.of(c[POSITIONS]),h=[];for(let y=0;y<x;y++){let R=exports.Scale.pushforward(s.x,a(y)),E=exports.Scale.pushforward(s.y,i(y)),v=exports.Scale.pushforward(s.x,l(y)),m=exports.Scale.pushforward(s.y,f(y));if(c.area){const S=exports.Scale.pushforward(s.areaPct,g(y)),M=v-R,b=m-E;R=R+(1-S)/2*M,v=v-(1-S)/2*M,E=E+(1-S)/2*b,m=m-(1-S)/2*b}if(rectsIntersect(d,[R,E,v,m])){const S=p(y);for(let M=0;M<S.length;M++)h.push(S[M])}}return h}e.check=o;function u(r,d){const{scales:s}=r,c=Geom.flatData(r),x=findLength(Object.values(c)),{x0:a,y0:i,x1:l,y1:f,area:g}=Getter.mapObject(c);for(let p=0;p<x;p++){let h=exports.Scale.pushforward(s.x,a(p)),y=exports.Scale.pushforward(s.y,i(p)),R=exports.Scale.pushforward(s.x,l(p)),E=exports.Scale.pushforward(s.y,f(p));if(c.area){const v=exports.Scale.pushforward(s.areaPct,g(p)),m=R-h,S=E-y;h=h+(1-v)/2*m,R=R-(1-v)/2*m,y=y+(1-v)/2*S,E=E-(1-v)/2*S}if(pointInRect(d,[h,y,R,E])){const v={};for(const m of Object.values(c))m&&Meta.has(m,"name")&&(v[Meta.get(m,"name")]=Geom.getter(m)(p));return v}}}e.query=u})(Rectangles||(Rectangles={}));var Geom;(e=>{(i=>{i[i.Points=0]="Points",i[i.Bars=1]="Bars",i[i.Rectangles=2]="Rectangles",i[i.Lines=3]="Lines"})(e.Type||(e.Type={}));const t={0:Points,1:Bars,2:Rectangles,3:Lines};function n(i){return i.data[i.data.length-2]}e.flatData=n;function o(i){return i.data[i.data.length-1]}e.groupedData=o;function u(i,l=()=>.5){return Getter.of(i??l)}e.getter=u;function r(i,l,f=()=>.5){return l.map(g=>e.getter(i[g],f))}e.getters=r;function d(i,l,f){const[g,p]=[Array(i),Getter.of(l)];for(let h=0;h<i;h++)g[h]=f[p(h)];return g}e.frames=d;function s(i,l){const f=[];for(const[g,p]of l){const h=Array(i),y=Getter.of(g??1);for(let R=0;R<i;R++)h[R]=exports.Scale.pushforward(p,y(R));f.push(h)}return f}e.scaledArrays=s;function c(i,l){t[i.type].render(i,l)}e.render=c;function x(i,l){return t[i.type].check(i,l)}e.check=x;function a(i,l){return t[i.type].query(i,l)}e.query=a})(Geom||(Geom={}));const PARENT=Symbol("parent"),VALUES=Symbol("values"),INDICES=Symbol("indices"),FACTOR=Symbol("factor"),REDUCER=Symbol("reducer");var Reduced;(e=>{function t(l,f,g,p){const h=l;return h[VALUES]=l,h[FACTOR]=f,h[REDUCER]=g,p&&n(h,p),h}e.of=t;function n(l,f){l[PARENT]=f}e.setParent=n;function o(l){const[,f,g,p]=i(l);if(!p)throw new Error("Parent missing");const h=exports.Factor.parentIndices(s(p),f),y=subset(p,h),R=t(y,s(p),g,c(p));return x(R,p),a(R,h),Meta.copy(R,l,["name"]),R}e.parent=o;function u(l){const[f,g,p,h,y]=i(l);if(!h)throw new Error("Cannot stack a without a parent");const R=exports.Factor.parentIndices(s(h),g),{reducefn:E,initialfn:v}=p,[m,S]=[f.length,[]],M=Array.from(Array(m),()=>v()),b=Getter.of(R);for(let C=0;C<f.length;C++){const z=b(C);S[z]===void 0&&(S[z]=v()),S[z]=E(S[z],f[C]),M[C]=S[z]}const w=y?subset(M,y):M,A=e.of(w,g,p,h);return x(A,M),y&&a(A,y),Meta.copy(A,l,["name"]),A}e.stack=u;function r(l,f){const[g,p,h,y,R]=i(l);if(!y)throw new Error("Cannot normalize a without a parent");const E=exports.Factor.parentIndices(s(y),p),v=subset(y,E),m=[...g];for(let b=0;b<l.length;b++)m[b]=f(m[b],v[b]);const S=R?subset(m,R):m,M=e.of(S,p,h,y);return x(M,m),R&&a(M,R),Meta.copy(M,l,["name"]),M}e.normalize=r;function d(l){const[f,g,p,h,y]=i(l),R=[];R.push(p.initialfn());for(let m=0;m<f.length-1;m++)R.push(f[m]);const E=y?subset(R,y):R,v=e.of(E,g,p,h);return x(v,R),y&&a(v,y),Meta.copy(v,l,["name"]),v}e.shiftLeft=d;function s(l){return l[FACTOR]}function c(l){return l[PARENT]}e.getParent=c;function x(l,f){l[VALUES]=f}function a(l,f){l[INDICES]=f}function i(l){return[l[VALUES],l[FACTOR],l[REDUCER],l[PARENT],l[INDICES]]}})(Reduced||(Reduced={})),exports.Reducer=void 0,(Reducer=>{Reducer.sum={name:"sum",fallback:"count",initialfn:()=>0,reducefn:(e,t)=>e+t},Reducer.max={name:"max",initialfn:()=>-1/0,reducefn:(e,t)=>Math.max(e,t)},Reducer.product={name:"product",initialfn:()=>1,reducefn:(e,t)=>e*t},Reducer.table={name:"table",initialfn:()=>({}),reducefn:(e,t)=>(e[t]=e[t]+1||0,e)};function parse(value){if(typeof value=="string")return Reducer[value];if(typeof value.initialfn=="string"&&typeof value.reducefn=="string"){const parsed={name:value.name};return parsed.initialfn=eval(value.initialfn),parsed.reducefn=eval(value.reducefn),parsed}return value}Reducer.parse=parse;function reduce(e,t,n){const{indices:o,cardinality:u}=t,{initialfn:r,reducefn:d}=n,s=Array.from(Array(u),()=>r()),c=Getter.of(o),x=Getter.of(e);for(let i=0;i<o.length;i++){const l=c(i);s[l]=d(s[l],x(i))}const a=Reduced.of(s,t,n);return Meta.copy(a,e),Meta.set(a,"name",getName(s,n)??"[unknown summary]"),a}Reducer.reduce=reduce;function getName(e,t){return Meta.has(e,"name")?`${t.name} of ${Meta.get(e,"name")}`:t.fallback}Reducer.getName=getName})(exports.Reducer||(exports.Reducer={}));var Summaries;(e=>{function t(r,d){const s=[];for(let c=0;c<d.length;c++){const x=d[c],a=n(r,x),i=Reactive.of()(merge(a,x.data));if(s.push(i),c>0)for(const l of Object.keys(a)){const f=s[c-1][l];Reduced.setParent(a[l],f)}Reactive.listen(x,"changed",()=>{const l=n(r,x);for(const f of Object.keys(l))copyValues(l[f],a[f])}),Reactive.propagate(x,i,"changed")}return s}e.of=t;function n(r,d){const s={};for(const[c,x]of Object.entries(r)){const[a,i]=x;s[c]=exports.Reducer.reduce(a,d,i)}return s}function o(r,d){const s=[];for(let c=0;c<r.length;c++){let x=function(i){const l=d[c](i),f=Reflect.ownKeys(i);for(const g of f)(typeof g=="symbol"||isIntegerString(g))&&(l[g]=i[g]);return l};const a=Reactive.of()(x(r[c]));s.push(a),Reactive.listen(r[c],"changed",()=>{const i=x(r[c]);for(const l of Reflect.ownKeys(i))Array.isArray(i[l])&&Array.isArray(a[l])&&copyValues(i[l],a[l]);Reactive.dispatch(a,"changed")})}return s}e.translate=o;function u(r,d){const s={};let c=0;for(const[x,a]of r)s[`q${c++}`]=[x(d),a];return s}e.formatQueries=u})(Summaries||(Summaries={}));function Barplot(e,t,n){const{data:o,marker:u}=e;let[r,d]=t(o);const s=d&&(n!=null&&n.reducer)?n.reducer:exports.Reducer.sum,c=d||(()=>1),x=exports.Factor.from(r),a=exports.Factor.product(x,u.factor),i=[x,a],l=n!=null&&n.queries?n.queries(o):{},f=Summaries.of({stat:[c,s],...l},i),g=[],p=0,h={type:"bar",scales:{x:"band"}},y={representation:p,...exports.Plot.of(h),summaries:f,coordinates:g};return Reactive.listen(y,"normalize",()=>switchRepresentation$3(y)),barplot(y),exports.Plot.addGeom(y,Bars.of()),y}function sortAxis(e,t){if(e.ordered)ExpanseBand.reorder(e);else{const n=orderIndices(t);ExpanseBand.reorder(e,n)}}function switchRepresentation$3(e){e.representation===0?spineplot(e):barplot(e)}function barplot(e){const{summaries:t,scales:n}=e,o=Summaries.translate(t,[s=>({x:s.label,y:zero,height:s.stat,width:one}),s=>({x:s.label,y:zero,height:Reduced.stack(s.stat),width:one})]),[u]=o,r={default:!0,ratio:!0};exports.Scale.train(n.x,u.x,r),exports.Scale.train(n.y,u.height,r),exports.Scale.train(n.width,[0,1],r),exports.Scale.train(n.height,u.height,r),exports.Expanse.freeze(n.y.domain,["zero"]),exports.Expanse.freeze(n.height.domain,["zero"]),ExpanseBand.setWeights(n.x.domain);const d=1/new Set(u.x).size;exports.Expanse.linkTo(n.y.domain,n.height.domain),exports.Expanse.set(n.width.codomain,s=>{s.scale=d,s.mult=.9,s.offset=0},{default:!0}),Meta.copy(n.y,u.height,["name"]),Reactive.removeAll(e,"reorder"),Reactive.listen(e,"reorder",()=>sortAxis(n.x.domain,u.height)),e.representation=0,exports.Plot.setData(e,o),exports.Plot.render(e),exports.Plot.renderAxes(e)}function spineplot(e){const{summaries:t,scales:n}=e,o=Summaries.translate(t,[d=>({x:d.label,y:zero,height:one,width:d.stat}),d=>({x:d.label,y:zero,height:Reduced.normalize(Reduced.stack(d.stat),(s,c)=>s/c),width:Reduced.parent(d.stat)})]),[u]=o,r={default:!0,ratio:!0};exports.Scale.train(n.x,u.x,r),exports.Scale.train(n.y,[0,1],r),exports.Scale.train(n.width,cumsum(u.width),r),exports.Scale.train(n.height,[0,1],r),exports.Expanse.freeze(n.y.domain,["zero"]),exports.Expanse.freeze(n.height.domain,["zero"]),ExpanseBand.setWeights(n.x.domain,u.width),exports.Expanse.linkTo(n.y.domain,n.height.domain),exports.Expanse.set(n.width.codomain,d=>{d.scale=1,d.mult=1,d.offset=-1},{default:!0}),Meta.set(n.y,"name","proportion"),Reactive.removeAll(e,"reorder"),Reactive.listen(e,"reorder",()=>sortAxis(n.x.domain,u.width)),e.representation=1,exports.Plot.setData(e,o),exports.Plot.render(e),exports.Plot.renderAxes(e)}function Fluctuationplot(e,t,n){const{data:o,marker:u}=e;let[r,d,s]=t(o);const c=s&&(n!=null&&n.reducer)?n.reducer:exports.Reducer.sum,x=s?[...s]:()=>1,a=exports.Factor.product(exports.Factor.from(r),exports.Factor.from(d)),i=exports.Factor.product(a,u.factor),l=[a,i],f=Summaries.formatQueries((n==null?void 0:n.queries)??[],o),g=Summaries.of({stat:[x,c],...f},l),p=[],h=0,y={type:"fluct",scales:{x:"band",y:"band"}},R={representation:h,...exports.Plot.of(y),summaries:g,coordinates:p};return exports.Scale.shareCodomain(R.scales.area,R.scales.width),exports.Scale.shareCodomain(R.scales.area,R.scales.height),Reactive.listen(R,"normalize",()=>switchRepresentation$2(R)),fluctplot(R),exports.Plot.addGeom(R,Bars.of({vAnchor:VAnchor.Middle})),R}function switchRepresentation$2(e){e.representation===0?pctfluctplot(e):fluctplot(e)}function fluctplot(e){const{summaries:t,scales:n}=e,o=Summaries.translate(t,[s=>({x:s.label,y:s.label$,height:s.stat,width:s.stat}),s=>({x:s.label,y:s.label$,height:Reduced.stack(s.stat),width:Reduced.stack(s.stat)})]),[u]=o,r={default:!0,ratio:!0};exports.Scale.train(n.x,u.x,r),exports.Scale.train(n.y,u.y,r),exports.Scale.train(n.width,u.width,r),exports.Scale.train(n.height,u.height,r);const d=max(new Set(u.x).size,new Set(u.y).size);exports.Expanse.set(n.area.codomain,s=>{s.scale=1/d,s.mult=.9,s.offset=0},{default:!0}),exports.Plot.setData(e,o),e.representation=0,exports.Plot.render(e)}function pctfluctplot(e){const{summaries:t,scales:n}=e,o=Summaries.translate(t,[s=>({x:s.label,y:s.label$,height:one,width:one}),s=>({x:s.label,y:s.label$,height:Reduced.normalize(Reduced.stack(s.stat),(c,x)=>c/x),width:Reduced.normalize(Reduced.stack(s.stat),(c,x)=>c/x)})]),[u]=o,r={default:!0,ratio:!0};exports.Scale.train(n.x,u.x,r),exports.Scale.train(n.y,u.y,r),exports.Scale.train(n.width,[0,1],r),exports.Scale.train(n.height,[0,1],r);const d=max(new Set(u.x).size,new Set(u.y).size);exports.Expanse.set(n.area.codomain,s=>{s.scale=1/d,s.mult=.9,s.offset=-1},{default:!0}),exports.Plot.setData(e,o),e.representation=1,exports.Plot.render(e)}function Histogram(e,t,n){const{data:o,marker:u}=e;let[r,d]=t(o);const s=d&&(n!=null&&n.reducer)?n.reducer:exports.Reducer.sum,c=d||(()=>1),[x,a]=minmax(r),i=a-x,l=Reactive.of()({anchor:x,width:i/15}),f=exports.Factor.mono(r.length),g=exports.Factor.product(f,exports.Factor.bin(r,l)),p=exports.Factor.product(g,u.factor),h=[f,g,p],y=n!=null&&n.queries?n.queries(o):{},R=Summaries.of({stat:[c,s],...y},h),E=0,v=[],m={type:"histo"},S={representation:E,...exports.Plot.of(m),summaries:R,coordinates:v};Reactive.listen(S,"normalize",()=>switchRepresentation$1(S));const M=i/10;return Reactive.listen(S,"set-parameters",b=>{b&&(b.width&&Reactive.set(l,w=>w.width=b.width),b.anchor&&Reactive.set(l,w=>w.anchor=b.anchor))}),Reactive.listen(S,"grow",()=>Reactive.set(l,b=>b.width*=1.1111111111111112)),Reactive.listen(S,"shrink",()=>Reactive.set(l,b=>b.width*=.9)),Reactive.listen(S,"increment-anchor",()=>Reactive.set(l,b=>b.anchor+=M)),Reactive.listen(S,"decrement-anchor",()=>Reactive.set(l,b=>b.anchor-=M)),Reactive.listen(S,"reset",()=>{Reactive.set(l,b=>(b.anchor=x,b.width=i/15))}),histogram(S),exports.Plot.addGeom(S,Rectangles.of()),S}function switchRepresentation$1(e){e.representation===0?spinogram(e):histogram(e)}function histogram(e){const{summaries:t}=e,n=Summaries.translate(t,[r=>r,r=>({x0:r.binMin,y0:zero,x1:r.binMax,y1:r.stat}),r=>({x0:r.binMin,y0:zero,x1:r.binMax,y1:Reduced.stack(r.stat)})]),{scales:o}=e,[,u]=n;exports.Scale.train(o.x,u.x1,{default:!0,name:!1}),exports.Scale.train(o.y,u.y1,{default:!0,ratio:!0});for(const r of e.data)Reactive.removeAll(r,"changed");Reactive.listen(u,"changed",()=>{exports.Scale.train(o.x,u.x1,{default:!0,name:!1}),exports.Scale.train(o.y,u.y1,{default:!0,ratio:!0})}),exports.Expanse.freeze(o.y.domain,["zero"]),Meta.copy(o.x,t[1].breaks,["name"]),Meta.copy(o.y,u.y1,["name"]),e.representation=0,exports.Plot.setData(e,n),exports.Plot.render(e),exports.Plot.renderAxes(e)}function spinogram(e){const{summaries:t}=e,n=Summaries.translate(t,[r=>r,r=>({x0:Reduced.shiftLeft(Reduced.stack(r.stat)),y0:zero,x1:Reduced.stack(r.stat),y1:one,query1:r.binMin,query2:r.binMax}),r=>({x0:Reduced.shiftLeft(Reduced.stack(Reduced.parent(r.stat))),y0:zero,x1:Reduced.stack(Reduced.parent(r.stat)),y1:Reduced.normalize(Reduced.stack(r.stat),(d,s)=>d/s)})]),{scales:o}=e,[,u]=n;exports.Scale.train(o.x,[0,...u.x1],{default:!0,name:!1}),exports.Scale.train(o.y,[0,1],{default:!0,ratio:!0}),Reactive.listen(u,"changed",()=>{exports.Scale.train(o.x,[0,...u.x1],{default:!0,name:!1})}),exports.Expanse.freeze(o.y.domain,["zero"]),Meta.set(o.x,"name","cumulative count"),Meta.set(o.y,"name","proportion"),exports.Plot.setData(e,n),e.representation=1,exports.Plot.render(e),exports.Plot.renderAxes(e)}function Histogram2d(e,t,n){const{data:o,marker:u}=e;let[r,d,s]=t(o);const c=s&&(n!=null&&n.reducer)?n.reducer:exports.Reducer.sum,x=s||(()=>1),[a,i]=minmax(r),[l,f]=minmax(d),[g,p]=[i-a,f-l],h=Reactive.of()({anchor:a,width:g/15}),y=Reactive.of()({anchor:l,width:p/15}),R=exports.Factor.bin(r,h),E=exports.Factor.bin(d,y),v=exports.Factor.product(R,E),m=exports.Factor.product(v,u.factor),S=[v,m],M=n!=null&&n.queries?n.queries(o):{},b=Summaries.of({stat:[x,c],...M},S),w=0,A=[],C={type:"histo2d",ratio:n==null?void 0:n.ratio},z={representation:w,...exports.Plot.of(C),summaries:b,coordinates:A};return Reactive.listen(z,"normalize",()=>switchRepresentation(z)),Reactive.listen(z,"set-parameters",T=>{T&&(T.width1&&Reactive.set(h,D=>D.width=T.width1),T.anchor1&&Reactive.set(h,D=>D.anchor=T.anchor1),T.width2&&Reactive.set(y,D=>D.width=T.width2),T.anchor2&&Reactive.set(y,D=>D.anchor=T.anchor2))}),Reactive.listen(z,"grow",()=>{Reactive.set(h,T=>T.width*=1.1111111111111112),Reactive.set(y,T=>T.width*=1.1111111111111112)}),Reactive.listen(z,"shrink",()=>{Reactive.set(h,T=>T.width*=.9),Reactive.set(y,T=>T.width*=.9)}),Reactive.listen(z,"reset",()=>{Reactive.set(h,T=>(T.anchor=a,T.width=g/15)),Reactive.set(y,T=>(T.anchor=l,T.width=p/15))}),histogram2d(z),exports.Plot.addGeom(z,Rectangles.of()),z}function switchRepresentation(e){e.representation===0?spinogram2d(e):histogram2d(e)}function histogram2d(e){const{summaries:t}=e,n=Summaries.translate(t,[r=>({x0:r.binMin,y0:r.binMin$,x1:r.binMax,y1:r.binMax$,area:r.stat}),r=>({x0:r.binMin,y0:r.binMin$,x1:r.binMax,y1:r.binMax$,area:Reduced.stack(r.stat)})]),{scales:o}=e,[,u]=n;exports.Scale.train(o.x,u.x1,{default:!0}),exports.Scale.train(o.y,u.y1,{default:!0}),exports.Scale.train(o.areaPct,u.area,{default:!0}),exports.Expanse.set(o.area.codomain,r=>(r.min=0,r.max=1),{default:!0}),exports.Expanse.freeze(o.area.codomain,["min","max"]);for(const r of e.data)Reactive.removeAll(r,"changed");Reactive.listen(u,"changed",()=>{exports.Scale.train(o.x,u.x1,{default:!0,name:!1}),exports.Scale.train(o.y,u.y1,{default:!0,name:!1}),exports.Scale.train(o.areaPct,u.area,{default:!0})}),e.representation=0,exports.Plot.setData(e,n),Meta.copy(o.x,t[1].breaks,["name"]),Meta.copy(o.y,t[1].breaks$,["name"]),exports.Plot.render(e),exports.Plot.renderAxes(e)}function spinogram2d(e){const{summaries:t}=e,n=Summaries.translate(t,[r=>({x0:r.binMin,y0:r.binMin$,x1:r.binMax,y1:r.binMax$,area:one}),r=>({x0:r.binMin,y0:r.binMin$,x1:r.binMax,y1:r.binMax$,area:Reduced.normalize(Reduced.stack(r.stat),(d,s)=>d/s)})]),{scales:o}=e,[,u]=n;exports.Scale.train(o.x,u.x1,{default:!0}),exports.Scale.train(o.y,u.y1,{default:!0}),exports.Scale.train(o.areaPct,[0,1],{default:!0}),exports.Expanse.set(o.area.codomain,r=>(r.min=0,r.max=1),{default:!0}),exports.Expanse.freeze(o.area.codomain,["min","max"]);for(const r of e.data)Reactive.removeAll(r,"changed");Reactive.listen(u,"changed",()=>{exports.Scale.train(o.x,u.x1,{default:!0,name:!1}),exports.Scale.train(o.y,u.y1,{default:!0,name:!1})}),e.representation=1,exports.Plot.setData(e,n),Meta.copy(o.x,t[1].breaks,["name"]),Meta.copy(o.y,t[1].breaks$,["name"]),exports.Plot.render(e),exports.Plot.renderAxes(e)}var ExpanseCompound;(e=>{const t="compound";function n(c=[],x){const a=[],i=ExpanseContinuous.of(0,1,x),{zero:l,one:f,direction:g}=i,p={zero:l,one:f,direction:g};for(const y of c)Object.assign(y,{zero:l,one:f,direction:g}),Object.assign(y.defaults,{zero:l,one:f,direction:g});const h={expanses:c,...i,value:a,type:t,defaults:p};return Reactive.listen(h,"changed",()=>{const{zero:y,one:R,direction:E}=h;for(const v of c)Object.assign(v,{zero:y,one:R,direction:E}),Object.assign(v.defaults,{zero:y,one:R,direction:E})}),h}e.of=n,exports.Poly.set(exports.Expanse.normalize,t,o),exports.Poly.set(exports.Expanse.unnormalize,t,u),exports.Poly.set(exports.Expanse.train,t,r),exports.Poly.set(exports.Expanse.breaks,t,d);function o(c,x){const{expanses:a}=c;return x.map((i,l)=>exports.Expanse.normalize(a[l],i))}e.normalize=o;function u(c,x){const{expanses:a}=c;return x.map((i,l)=>exports.Expanse.unnormalize(a[l],i))}e.unnormalize=u;function r(c,x){const{expanses:a}=c;if(x.length!=a.length){const i="The number of arrays does not match the number of expanses.";throw new Error(i)}for(let i=0;i<x.length;i++)exports.Expanse.train(a[i],x[i])}e.train=r;function d(c){return ExpanseContinuous.breaks(c)}e.breaks=d;function s(c){for(const x of c.expanses)exports.Expanse.reset(x)}e.reset=s})(ExpanseCompound||(ExpanseCompound={}));var ExpansePoint;(e=>{const t="point";function n(c=[],x){const a="",i=exports.Expanse.base(x),[l,f]=[!1,seqLength(0,c.length)],g={labels:c,ordered:l,order:f},p={ordered:l,labels:[...c],order:[...f],...i.defaults};return{type:t,value:a,...i,...g,defaults:p}}e.of=n,exports.Poly.set(exports.Expanse.normalize,t,o),exports.Poly.set(exports.Expanse.unnormalize,t,u),exports.Poly.set(exports.Expanse.train,t,r),exports.Poly.set(exports.Expanse.breaks,t,s),exports.Poly.set(exports.Expanse.reorder,t,d);function o(c,x){const{labels:a,order:i,zero:l,one:f,direction:g}=c,p=i[a.indexOf(x)];if(p===-1)return p;let h=p/(a.length-1);return h=l+h*(f-l),h=applyDirection(h,g),h}e.normalize=o;function u(c,x){const{labels:a,order:i,zero:l,one:f,direction:g}=c;let p=applyDirection(x,g);return p=(p-l)/(f-l),p=Math.round(p*(a.length-1)),a[i[p]]}e.unnormalize=u;function r(c,x,a){const{order:i}=c,l=Array.from(new Set(x)).sort(compareAlphaNumeric);if(!i.length){for(let f=0;f<l.length;f++)i[f]=f;c.defaults.order=[...i],c.ordered=!1}copyValues(l,c.labels),a!=null&&a.default&&copyValues(l,c.defaults.labels),exports.Expanse.set(c,()=>{},a)}e.train=r;function d(c,x){const{order:a,defaults:i}=c;if(!x){copyValues(i.order,a),c.ordered=!1,Reactive.dispatch(c,"changed");return}copyValues(x,a),c.ordered=!0,Reactive.dispatch(c,"changed")}e.reorder=d;function s(c){return ordered(c.labels,c.order)}e.breaks=s})(ExpansePoint||(ExpansePoint={}));var ExpanseSplit;(e=>{const t="split";function n(s){const c=[],x=s.type;return{...s,value:c,type:t,innerType:x}}e.of=n,exports.Poly.set(exports.Expanse.normalize,t,o),exports.Poly.set(exports.Expanse.unnormalize,t,u),exports.Poly.set(exports.Expanse.train,t,r),exports.Poly.set(exports.Expanse.breaks,t,d);function o(s,c){const{innerType:x}=s,a=exports.Poly.dispatch(exports.Expanse.normalize,identity,x);return Array.isArray(c)?c.map(i=>a(s,i)):a(s,c)}e.normalize=o;function u(s,c){const{innerType:x}=s,a=exports.Poly.dispatch(exports.Expanse.unnormalize,identity,x);return Array.isArray(c)?c.map(i=>a(s,i)):a(s,c)}e.unnormalize=u;function r(s,c){const{innerType:x}=s;exports.Poly.dispatch(exports.Expanse.train,identity,x)(s,c)}e.train=r;function d(s){const{innerType:c}=s;return exports.Poly.dispatch(exports.Expanse.breaks,identity,c)(s)}e.breaks=d})(ExpanseSplit||(ExpanseSplit={}));function inferExpanse(e,t={train:!0}){const o=isNumberArray(e)?ExpanseContinuous.of():ExpansePoint.of();return t.train&&exports.Expanse.train(o,e),o}function Pcoordsplot(e,t,n){const{data:o,marker:u}=e,r=t(o),d=r.map(m=>Meta.get(m,"name")),s=Getter.constant(d),c=Getter.multi(r),x=n!=null&&n.queries?n.queries(o):{},a=exports.Factor.bijection({x:s,y:c,...x}),i=exports.Factor.product(a,u.factor),l=Summaries.of({},[a,i]),f=Summaries.translate(l,[m=>m,m=>m]),g=exports.Plot.of({type:"pcoords"}),{scales:p}=g,{expandX:h,expandY:y}=e.options,R={zero:h,one:1-h},E={zero:y,one:1-y};exports.Scale.setDomain(p.x,ExpanseSplit.of(ExpansePoint.of(d,R))),exports.Scale.setCoomain(p.x,ExpanseSplit.of(p.x.codomain));const v=r.map(m=>inferExpanse(m));return exports.Scale.setDomain(p.y,ExpanseCompound.of(v,E)),exports.Scale.setCoomain(p.y,ExpanseSplit.of(p.y.codomain)),Meta.set(p.x,"name","variable"),Meta.set(p.y,"name","value"),exports.Plot.setData(g,f),exports.Plot.addGeom(g,Lines.of()),g}function Scatterplot(e,t,n){const{data:o,marker:u}=e,[r,d,s]=t(o),c=n!=null&&n.queries?n==null?void 0:n.queries(o):{},x={x:r,y:d,size:s??(()=>.5),...c},a=exports.Factor.bijection(x),i=exports.Factor.product(a,u.factor),l=Summaries.of({},[a,i]),f=Summaries.translate(l,[h=>h,h=>h]),g=exports.Plot.of({type:"scatter",ratio:n==null?void 0:n.ratio}),{scales:p}=g;return exports.Scale.train(p.x,r,{default:!0}),exports.Scale.train(p.y,d,{default:!0}),s&&exports.Scale.train(p.size,s,{default:!0}),exports.Plot.setData(g,f),exports.Plot.addGeom(g,Points.of()),{...g,summaries:l}}function _typeof(e){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(e)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(e,t){if(e=e||"",t=t||{},e instanceof tinycolor)return e;if(!(this instanceof tinycolor))return new tinycolor(e,t);var n=inputToRGB(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}tinycolor.prototype={isDark:function e(){return this.getBrightness()<128},isLight:function e(){return!this.isDark()},isValid:function e(){return this._ok},getOriginalInput:function e(){return this._originalInput},getFormat:function e(){return this._format},getAlpha:function e(){return this._a},getBrightness:function e(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},getLuminance:function e(){var t=this.toRgb(),n,o,u,r,d,s;return n=t.r/255,o=t.g/255,u=t.b/255,n<=.03928?r=n/12.92:r=Math.pow((n+.055)/1.055,2.4),o<=.03928?d=o/12.92:d=Math.pow((o+.055)/1.055,2.4),u<=.03928?s=u/12.92:s=Math.pow((u+.055)/1.055,2.4),.2126*r+.7152*d+.0722*s},setAlpha:function e(t){return this._a=boundAlpha(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function e(){var t=rgbToHsv(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},toHsvString:function e(){var t=rgbToHsv(this._r,this._g,this._b),n=Math.round(t.h*360),o=Math.round(t.s*100),u=Math.round(t.v*100);return this._a==1?"hsv("+n+", "+o+"%, "+u+"%)":"hsva("+n+", "+o+"%, "+u+"%, "+this._roundA+")"},toHsl:function e(){var t=rgbToHsl(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},toHslString:function e(){var t=rgbToHsl(this._r,this._g,this._b),n=Math.round(t.h*360),o=Math.round(t.s*100),u=Math.round(t.l*100);return this._a==1?"hsl("+n+", "+o+"%, "+u+"%)":"hsla("+n+", "+o+"%, "+u+"%, "+this._roundA+")"},toHex:function e(t){return rgbToHex(this._r,this._g,this._b,t)},toHexString:function e(t){return"#"+this.toHex(t)},toHex8:function e(t){return rgbaToHex(this._r,this._g,this._b,this._a,t)},toHex8String:function e(t){return"#"+this.toHex8(t)},toRgb:function e(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function e(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function e(){return{r:Math.round(bound01(this._r,255)*100)+"%",g:Math.round(bound01(this._g,255)*100)+"%",b:Math.round(bound01(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function e(){return this._a==1?"rgb("+Math.round(bound01(this._r,255)*100)+"%, "+Math.round(bound01(this._g,255)*100)+"%, "+Math.round(bound01(this._b,255)*100)+"%)":"rgba("+Math.round(bound01(this._r,255)*100)+"%, "+Math.round(bound01(this._g,255)*100)+"%, "+Math.round(bound01(this._b,255)*100)+"%, "+this._roundA+")"},toName:function e(){return this._a===0?"transparent":this._a<1?!1:hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1},toFilter:function e(t){var n="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),o=n,u=this._gradientType?"GradientType = 1, ":"";if(t){var r=tinycolor(t);o="#"+rgbaToArgbHex(r._r,r._g,r._b,r._a)}return"progid:DXImageTransform.Microsoft.gradient("+u+"startColorstr="+n+",endColorstr="+o+")"},toString:function e(t){var n=!!t;t=t||this._format;var o=!1,u=this._a<1&&this._a>=0,r=!n&&u&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");return r?t==="name"&&this._a===0?this.toName():this.toRgbString():(t==="rgb"&&(o=this.toRgbString()),t==="prgb"&&(o=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(o=this.toHexString()),t==="hex3"&&(o=this.toHexString(!0)),t==="hex4"&&(o=this.toHex8String(!0)),t==="hex8"&&(o=this.toHex8String()),t==="name"&&(o=this.toName()),t==="hsl"&&(o=this.toHslString()),t==="hsv"&&(o=this.toHsvString()),o||this.toHexString())},clone:function e(){return tinycolor(this.toString())},_applyModification:function e(t,n){var o=t.apply(null,[this].concat([].slice.call(n)));return this._r=o._r,this._g=o._g,this._b=o._b,this.setAlpha(o._a),this},lighten:function e(){return this._applyModification(_lighten,arguments)},brighten:function e(){return this._applyModification(_brighten,arguments)},darken:function e(){return this._applyModification(_darken,arguments)},desaturate:function e(){return this._applyModification(_desaturate,arguments)},saturate:function e(){return this._applyModification(_saturate,arguments)},greyscale:function e(){return this._applyModification(_greyscale,arguments)},spin:function e(){return this._applyModification(_spin,arguments)},_applyCombination:function e(t,n){return t.apply(null,[this].concat([].slice.call(n)))},analogous:function e(){return this._applyCombination(_analogous,arguments)},complement:function e(){return this._applyCombination(_complement,arguments)},monochromatic:function e(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function e(){return this._applyCombination(_splitcomplement,arguments)},triad:function e(){return this._applyCombination(polyad,[3])},tetrad:function e(){return this._applyCombination(polyad,[4])}},tinycolor.fromRatio=function(e,t){if(_typeof(e)=="object"){var n={};for(var o in e)e.hasOwnProperty(o)&&(o==="a"?n[o]=e[o]:n[o]=convertToPercentage(e[o]));e=n}return tinycolor(e,t)};function inputToRGB(e){var t={r:0,g:0,b:0},n=1,o=null,u=null,r=null,d=!1,s=!1;return typeof e=="string"&&(e=stringInputToObject(e)),_typeof(e)=="object"&&(isValidCSSUnit(e.r)&&isValidCSSUnit(e.g)&&isValidCSSUnit(e.b)?(t=rgbToRgb(e.r,e.g,e.b),d=!0,s=String(e.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(e.h)&&isValidCSSUnit(e.s)&&isValidCSSUnit(e.v)?(o=convertToPercentage(e.s),u=convertToPercentage(e.v),t=hsvToRgb(e.h,o,u),d=!0,s="hsv"):isValidCSSUnit(e.h)&&isValidCSSUnit(e.s)&&isValidCSSUnit(e.l)&&(o=convertToPercentage(e.s),r=convertToPercentage(e.l),t=hslToRgb(e.h,o,r),d=!0,s="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=boundAlpha(n),{ok:d,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}function rgbToRgb(e,t,n){return{r:bound01(e,255)*255,g:bound01(t,255)*255,b:bound01(n,255)*255}}function rgbToHsl(e,t,n){e=bound01(e,255),t=bound01(t,255),n=bound01(n,255);var o=Math.max(e,t,n),u=Math.min(e,t,n),r,d,s=(o+u)/2;if(o==u)r=d=0;else{var c=o-u;switch(d=s>.5?c/(2-o-u):c/(o+u),o){case e:r=(t-n)/c+(t<n?6:0);break;case t:r=(n-e)/c+2;break;case n:r=(e-t)/c+4;break}r/=6}return{h:r,s:d,l:s}}function hslToRgb(e,t,n){var o,u,r;e=bound01(e,360),t=bound01(t,100),n=bound01(n,100);function d(x,a,i){return i<0&&(i+=1),i>1&&(i-=1),i<.16666666666666666?x+(a-x)*6*i:i<.5?a:i<.6666666666666666?x+(a-x)*(.6666666666666666-i)*6:x}if(t===0)o=u=r=n;else{var s=n<.5?n*(1+t):n+t-n*t,c=2*n-s;o=d(c,s,e+.3333333333333333),u=d(c,s,e),r=d(c,s,e-.3333333333333333)}return{r:o*255,g:u*255,b:r*255}}function rgbToHsv(e,t,n){e=bound01(e,255),t=bound01(t,255),n=bound01(n,255);var o=Math.max(e,t,n),u=Math.min(e,t,n),r,d,s=o,c=o-u;if(d=o===0?0:c/o,o==u)r=0;else{switch(o){case e:r=(t-n)/c+(t<n?6:0);break;case t:r=(n-e)/c+2;break;case n:r=(e-t)/c+4;break}r/=6}return{h:r,s:d,v:s}}function hsvToRgb(e,t,n){e=bound01(e,360)*6,t=bound01(t,100),n=bound01(n,100);var o=Math.floor(e),u=e-o,r=n*(1-t),d=n*(1-u*t),s=n*(1-(1-u)*t),c=o%6,x=[n,d,r,r,s,n][c],a=[s,n,n,d,r,r][c],i=[r,r,s,n,n,d][c];return{r:x*255,g:a*255,b:i*255}}function rgbToHex(e,t,n,o){var u=[pad2(Math.round(e).toString(16)),pad2(Math.round(t).toString(16)),pad2(Math.round(n).toString(16))];return o&&u[0].charAt(0)==u[0].charAt(1)&&u[1].charAt(0)==u[1].charAt(1)&&u[2].charAt(0)==u[2].charAt(1)?u[0].charAt(0)+u[1].charAt(0)+u[2].charAt(0):u.join("")}function rgbaToHex(e,t,n,o,u){var r=[pad2(Math.round(e).toString(16)),pad2(Math.round(t).toString(16)),pad2(Math.round(n).toString(16)),pad2(convertDecimalToHex(o))];return u&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)&&r[3].charAt(0)==r[3].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)+r[3].charAt(0):r.join("")}function rgbaToArgbHex(e,t,n,o){var u=[pad2(convertDecimalToHex(o)),pad2(Math.round(e).toString(16)),pad2(Math.round(t).toString(16)),pad2(Math.round(n).toString(16))];return u.join("")}tinycolor.equals=function(e,t){return!e||!t?!1:tinycolor(e).toRgbString()==tinycolor(t).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function _desaturate(e,t){t=t===0?0:t||10;var n=tinycolor(e).toHsl();return n.s-=t/100,n.s=clamp01(n.s),tinycolor(n)}function _saturate(e,t){t=t===0?0:t||10;var n=tinycolor(e).toHsl();return n.s+=t/100,n.s=clamp01(n.s),tinycolor(n)}function _greyscale(e){return tinycolor(e).desaturate(100)}function _lighten(e,t){t=t===0?0:t||10;var n=tinycolor(e).toHsl();return n.l+=t/100,n.l=clamp01(n.l),tinycolor(n)}function _brighten(e,t){t=t===0?0:t||10;var n=tinycolor(e).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(t/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(t/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(t/100)))),tinycolor(n)}function _darken(e,t){t=t===0?0:t||10;var n=tinycolor(e).toHsl();return n.l-=t/100,n.l=clamp01(n.l),tinycolor(n)}function _spin(e,t){var n=tinycolor(e).toHsl(),o=(n.h+t)%360;return n.h=o<0?360+o:o,tinycolor(n)}function _complement(e){var t=tinycolor(e).toHsl();return t.h=(t.h+180)%360,tinycolor(t)}function polyad(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var n=tinycolor(e).toHsl(),o=[tinycolor(e)],u=360/t,r=1;r<t;r++)o.push(tinycolor({h:(n.h+r*u)%360,s:n.s,l:n.l}));return o}function _splitcomplement(e){var t=tinycolor(e).toHsl(),n=t.h;return[tinycolor(e),tinycolor({h:(n+72)%360,s:t.s,l:t.l}),tinycolor({h:(n+216)%360,s:t.s,l:t.l})]}function _analogous(e,t,n){t=t||6,n=n||30;var o=tinycolor(e).toHsl(),u=360/n,r=[tinycolor(e)];for(o.h=(o.h-(u*t>>1)+720)%360;--t;)o.h=(o.h+u)%360,r.push(tinycolor(o));return r}function _monochromatic(e,t){t=t||6;for(var n=tinycolor(e).toHsv(),o=n.h,u=n.s,r=n.v,d=[],s=1/t;t--;)d.push(tinycolor({h:o,s:u,v:r})),r=(r+s)%1;return d}tinycolor.mix=function(e,t,n){n=n===0?0:n||50;var o=tinycolor(e).toRgb(),u=tinycolor(t).toRgb(),r=n/100,d={r:(u.r-o.r)*r+o.r,g:(u.g-o.g)*r+o.g,b:(u.b-o.b)*r+o.b,a:(u.a-o.a)*r+o.a};return tinycolor(d)},tinycolor.readability=function(e,t){var n=tinycolor(e),o=tinycolor(t);return(Math.max(n.getLuminance(),o.getLuminance())+.05)/(Math.min(n.getLuminance(),o.getLuminance())+.05)},tinycolor.isReadable=function(e,t,n){var o=tinycolor.readability(e,t),u,r;switch(r=!1,u=validateWCAG2Parms(n),u.level+u.size){case"AAsmall":case"AAAlarge":r=o>=4.5;break;case"AAlarge":r=o>=3;break;case"AAAsmall":r=o>=7;break}return r},tinycolor.mostReadable=function(e,t,n){var o=null,u=0,r,d,s,c;n=n||{},d=n.includeFallbackColors,s=n.level,c=n.size;for(var x=0;x<t.length;x++)r=tinycolor.readability(e,t[x]),r>u&&(u=r,o=tinycolor(t[x]));return tinycolor.isReadable(e,o,{level:s,size:c})||!d?o:(n.includeFallbackColors=!1,tinycolor.mostReadable(e,["#fff","#000"],n))};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names);function flip(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function boundAlpha(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function bound01(e,t){isOnePointZero(e)&&(e="100%");var n=isPercentage(e);return e=Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function clamp01(e){return Math.min(1,Math.max(0,e))}function parseIntFromHex(e){return parseInt(e,16)}function isOnePointZero(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function isPercentage(e){return typeof e=="string"&&e.indexOf("%")!=-1}function pad2(e){return e.length==1?"0"+e:""+e}function convertToPercentage(e){return e<=1&&(e=e*100+"%"),e}function convertDecimalToHex(e){return Math.round(parseFloat(e)*255).toString(16)}function convertHexToDecimal(e){return parseIntFromHex(e)/255}var matchers=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",n="(?:"+t+")|(?:"+e+")",o="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",u="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+o),rgba:new RegExp("rgba"+u),hsl:new RegExp("hsl"+o),hsla:new RegExp("hsla"+u),hsv:new RegExp("hsv"+o),hsva:new RegExp("hsva"+u),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function isValidCSSUnit(e){return!!matchers.CSS_UNIT.exec(e)}function stringInputToObject(e){e=e.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var t=!1;if(names[e])e=names[e],t=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=matchers.rgb.exec(e))?{r:n[1],g:n[2],b:n[3]}:(n=matchers.rgba.exec(e))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=matchers.hsl.exec(e))?{h:n[1],s:n[2],l:n[3]}:(n=matchers.hsla.exec(e))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=matchers.hsv.exec(e))?{h:n[1],s:n[2],v:n[3]}:(n=matchers.hsva.exec(e))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=matchers.hex8.exec(e))?{r:parseIntFromHex(n[1]),g:parseIntFromHex(n[2]),b:parseIntFromHex(n[3]),a:convertHexToDecimal(n[4]),format:t?"name":"hex8"}:(n=matchers.hex6.exec(e))?{r:parseIntFromHex(n[1]),g:parseIntFromHex(n[2]),b:parseIntFromHex(n[3]),format:t?"name":"hex"}:(n=matchers.hex4.exec(e))?{r:parseIntFromHex(n[1]+""+n[1]),g:parseIntFromHex(n[2]+""+n[2]),b:parseIntFromHex(n[3]+""+n[3]),a:convertHexToDecimal(n[4]+""+n[4]),format:t?"name":"hex8"}:(n=matchers.hex3.exec(e))?{r:parseIntFromHex(n[1]+""+n[1]),g:parseIntFromHex(n[2]+""+n[2]),b:parseIntFromHex(n[3]+""+n[3]),format:t?"name":"hex"}:!1}function validateWCAG2Parms(e){var t,n;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),t!=="AA"&&t!=="AAA"&&(t="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:t,size:n}}const defaultOptions={size:10,expandX:.1,expandY:.1,gapPct:.8,gapPx:1,axisLabelSize:1,axisTitleSize:1.25,margins:[0,0,0,0],colors:[],marginLines:[3.5,3.5,1,1],groupColors:["#984ea3","#e41a1c","#4daf4a","#377eb8"],plotBackground:"#fefffe"};updateOptions(defaultOptions);function updateOptions(e){if(!globalThis.window)return;const t=e.groupColors.length;e.colors.length=2*t;for(let r=0;r<t;r++){const d=e.groupColors[r];e.colors[r]=tinycolor(d).darken(10).saturate(20).toString(),e.colors[t+r]=tinycolor(d).lighten(20).saturate(20).toString()}const{marginLines:n,axisTitleSize:o}=e,u=parseFloat(getComputedStyle(document.documentElement).fontSize);e.margins=n.map(r=>r*u*o)}function renderAxisLabels(e){renderSingleAxisLabels(e,"x"),renderSingleAxisLabels(e,"y")}function renderSingleAxisLabels(e,t){const{frames:n,scales:o,options:u}=e,{margins:r}=u,d=o[t],s=t==="x"?o.y:o.x,c=n[`${t}Axis`],{context:x}=c,{labels:a,positions:i}=exports.Scale.breaks(d),[l,f,g,p]=r,h=parseInt(x.font.match(/^[0-9]*/)[0],10),y=s.codomain.min-h/2,{width:R,height:E}=c;if(Frame.clear(c),t==="x"){let[v,m]=[0,0];for(let S=0;S<a.length;S++){const M=a[S],b=i[S],w=Frame.textWidth(c,M)+1;outside(b,f,R-p)||overlap(v,b,m,w)||([v,m]=[b,w],Frame.text(c,b,y,M))}}else if(t==="y"){let[v,m]=[0,0];for(let S=0;S<a.length;S++){const M=a[S],b=i[S],w=Frame.textWidth(c,M)+1,A=Frame.textHeight(c,M)+1;if(!outside(b,l,E-g)&&!overlap(v,b,m,A)){for(;r[1]/2<w+A;)r[1]*=1.01,exports.Plot.resize(e);[v,m]=[b,A],Frame.text(c,y,b,M)}}}}function renderAxisTitles(e){renderSingleAxisTitle(e,"x"),renderSingleAxisTitle(e,"y")}function renderSingleAxisTitle(e,t){const{scales:n,frames:o,options:u}=e,{margins:r}=u,d=n[t],s=t==="x"?e.scales.y:e.scales.x,c=o.base,x=Meta.get(d,"name"),a=t==="x"?r[0]:r[1],i=exports.Expanse.unnormalize(d.codomain,.5),l=exports.Expanse.unnormalize(s.codomain,0)-a*2/3;t==="x"&&Frame.text(c,i,l,x),t==="y"&&Frame.text(c,l,i,x,{vertical:!0})}function outside(e,t,n){return e<t||e>n}function overlap(e,t,n,o){const[u,r]=[e-n/2,e+n/2],[d,s]=[t-o/2,t+o/2];return u<s&&r>=d}exports.Plot=void 0,(e=>{(k=>{k.Select="select",k.Pan="pan",k.Query="query"})(e.Mode||(e.Mode={}));function t(k){const O=(k==null?void 0:k.type)??"unknown",P=DOM.element("div",{id:"plot"}),I=DOM.element("table");DOM.addClasses(P,tw("tw-relative tw-h-full tw-w-full tw-drop-shadow-md")),DOM.addClasses(I,tw("tw-relative tw-z-30 tw-bg-gray-50 tw-shadow-md")),DOM.append(P,I);const _=[],F={},G={},B=[],N=[],H=[],j=structuredClone({...defaultOptions,...k}),{expandX:V,expandY:U}=j,q=[[V,U,1-V,1-U]],Y={active:!1,locked:!1,mousedown:!1,mousebutton:MouseButton.Left,mode:"select",mousecoords:[0,0,0,0],lastkey:"",ratio:(k==null?void 0:k.ratio)??void 0},K=Reactive.of()({type:O,data:_,container:P,queryTable:I,frames:F,scales:G,renderables:B,selectables:N,queryables:H,zoomStack:q,parameters:Y,options:j});return setupFrames(K,j),setupScales(K,j),setupEvents$1(K),K}e.of=t,e.scatter=Scatterplot,e.bar=Barplot,e.fluct=Fluctuationplot,e.histo=Histogram,e.histo2d=Histogram2d,e.pcoords=Pcoordsplot;function n(k,O){k.appendChild(O.container),e.resize(O)}e.append=n;function o(k,O){for(const P of k.data)Reactive.is(P)&&Reactive.removeAll(P,"changed");k.data.length=0;for(let P=0;P<O.length;P++)k.data.push(O[P]);Reactive.listen(last(O),"changed",()=>e.render(k))}e.setData=o;function u(k,O){O.scales=k.scales,O.data=k.data;const{renderables:P,selectables:I,queryables:_}=k;for(const F of[P,I,_])F.push(O)}e.addGeom=u;function r(k,O){const{renderables:P,selectables:I,queryables:_}=k;for(const F of[P,I,_])remove(F,O)}e.deleteGeom=r;const d=tw("tw-outline tw-outline-2 tw-outline-slate-600");function s(k){DOM.addClasses(k.container,d),k.parameters.active=!0,Reactive.dispatch(k,"activated")}e.activate=s;function c(k){DOM.removeClasses(k.container,d),k.parameters.active=!1,Reactive.dispatch(k,"deactivated")}e.deactivate=c;function x(k){k.parameters.locked=!0}e.lock=x;function a(k){k.parameters.locked=!1}e.unlock=a;function i(k){for(const O of dataLayers)Frame.clear(k.frames[O]);for(const O of k.renderables)Geom.render(O,k.frames)}e.render=i;function l(k){for(const O of["base","xAxis","yAxis"])Frame.clear(k.frames[O]);renderAxisLabels(k),renderAxisTitles(k)}e.renderAxes=l;function f(k){Frame.clear(k.frames.user)}e.clearUserFrame=f;function g(k){for(const X of Object.values(k.frames))Frame.resize(X);const{container:O,scales:P,frames:I,parameters:_,options:F}=k,{clientWidth:G,clientHeight:B}=O,{x:N,y:H,width:j,height:V,area:U}=P,{margins:q}=F,[Y,K]=[q[0],q[1]],[Q,J]=[B-q[2],G-q[3]];I.under.canvas.style.width=`calc(100% - ${K}px - ${q[3]}px)`,I.under.canvas.style.height=`calc(100% - ${Y}px - ${q[2]}px)`,I.over.canvas.style.width=`calc(100% - ${K}px - ${q[3]}px)`,I.over.canvas.style.height=`calc(100% - ${Y}px - ${q[2]}px)`;for(const X of Object.values(I))Frame.clip(X);const Z={default:!0,silent:!0};exports.Expanse.set(N.codomain,X=>(X.min=K,X.max=J),Z),exports.Expanse.set(H.codomain,X=>(X.min=Y,X.max=Q),Z);const[te,ne]=[J-K,Q-Y];if(exports.Expanse.set(j.codomain,X=>X.max=te,Z),exports.Expanse.set(V.codomain,X=>X.max=ne,Z),exports.Expanse.set(U.codomain,X=>X.max=Math.min(te,ne),Z),_.ratio){const{expandX:X,expandY:re}=defaultOptions;exports.Expanse.set(N.domain,ee=>(ee.zero=X,ee.one=1-X),Z),exports.Expanse.set(H.domain,ee=>(ee.zero=re,ee.one=1-re),Z),e.applyRatio(k,_.ratio)}e.render(k),e.renderAxes(k)}e.resize=g;function p(k){const{selectables:O,parameters:P}=k,I=new Set;for(const _ of O){const F=Geom.check(_,P.mousecoords);for(let G=0;G<F.length;G++)I.add(F[G])}Reactive.dispatch(k,"set-selected",{cases:Array.from(I)})}e.checkSelection=p;function h(k,O){k.parameters.mode=O}e.setMode=h;function y(k,O){k.parameters.mousedown=O}e.setMousedown=y;function R(k,O){k.parameters.mousebutton=O}e.setMouseButton=R,e.mousemoveHandlers={select:E,pan:v,query:m};function E(k,O){const{container:P,parameters:I,frames:_}=k;if(!I.active||!I.mousedown)return;Reactive.dispatch(k,"clear-transient");const{mousecoords:F}=I,{clientHeight:G}=P,B=O.offsetX,N=G-O.offsetY;F[2]=B,F[3]=N,e.checkSelection(k),Reactive.dispatch(k,"lock-others"),Frame.clear(_.user),Frame.rectangleXY(_.user,...I.mousecoords,1)}function v(k,O){const{container:P,scales:I,parameters:_}=k;if(!_.active||!_.mousedown)return;const{mousecoords:F}=_,{clientWidth:G,clientHeight:B}=P,[N,H]=F,j=O.offsetX,V=B-O.offsetY,U=(j-N)/G,q=(V-H)/B;exports.Scale.move(I.x,U),exports.Scale.move(I.y,q),F[0]=j,F[1]=V,e.clearUserFrame(k)}function m(k,O){const{offsetX:P,offsetY:I}=O,{container:_,queryTable:F,queryables:G}=k,{clientWidth:B,clientHeight:N}=_;F.style.display="none";const H=P,j=N-I;let V;for(const K of G)if(V=Geom.query(K,[H,j]),V)break;if(!V)return;clearNodeChildren(F);for(const[K,Q]of Object.entries(V)){const J=DOM.element("tr"),Z=DOM.element("td",{classes:tw("tw-border tw-border-gray-400 tw-px-3 py-1"),textContent:K}),te=DOM.element("td",{classes:tw("tw-border tw-border-gray-400 tw-px-3 tw-py-1 tw-font-mono"),textContent:formatLabel(Q)});DOM.append(J,Z),DOM.append(J,te),DOM.append(F,J)}F.style.display="inline-block";const U=getComputedStyle(F),q=parseFloat(U.width.slice(0,-2)),{clientWidth:Y}=F;H+q>B?(F.style.left="auto",F.style.right=`${Y-P+5}px`):(F.style.left=`${H+5}px`,F.style.right="auto"),F.style.top=I+"px"}e.keybindings={"=":"grow","-":"shrink","]":"unfade","[":"fade",z:"zoom",x:"pop-zoom",o:"reorder",";":"decrement-anchor","'":"increment-anchor",n:"normalize"};function S(k){const{area:O,size:P,width:I}=k.scales;exports.Expanse.set(O.codomain,_=>(_.min*=1.1111111111111112,_.max*=1.1111111111111112)),exports.Expanse.set(P.codomain,_=>(_.min*=1.1111111111111112,_.max*=1.1111111111111112)),exports.Expanse.set(I.codomain,_=>_.mult<1?_.mult*=1.1111111111111112:null)}e.grow=S;function M(k){const{area:O,width:P,size:I}=k.scales;exports.Expanse.set(O.codomain,_=>(_.min*=.9,_.max*=.9)),exports.Expanse.set(I.codomain,_=>(_.min*=.9,_.max*=.9)),exports.Expanse.set(P.codomain,_=>_.mult*=.9)}e.shrink=M;function b(k){const{frames:O}=k;for(const P of baseLayers)Frame.setAlpha(O[P],I=>I*9/10);e.render(k)}e.fade=b;function w(k){const{frames:O}=k;for(const P of baseLayers)Frame.setAlpha(O[P],I=>I*10/9);e.render(k)}e.unfade=w;function A(k){const{frames:O,scales:P}=k;for(const I of baseLayers)Frame.resetAlpha(O[I]);for(const I of Object.values(P))exports.Scale.restoreDefaults(I);k.zoomStack.length=1,e.clearUserFrame(k)}e.reset=A;function C(k){e.setMode(k,"query")}e.setQueryMode=C;function z(k,O){const{scales:P,parameters:I,zoomStack:_}=k;let{coords:F,units:G}=O??{};G=G??"screen";let[B,N,H,j]=F??I.mousecoords;const{x:V,y:U}=P;if(G==="data"){const Q={silent:!0};exports.Expanse.set(V.domain,J=>(J.zero=0,J.one=1),Q),exports.Expanse.set(U.domain,J=>(J.zero=0,J.one=1),Q),B=exports.Expanse.normalize(V.domain,B),H=exports.Expanse.normalize(V.domain,H),N=exports.Expanse.normalize(U.domain,N),j=exports.Expanse.normalize(U.domain,j)}if(G==="screen"){if(Math.abs(H-B)<10||Math.abs(j-N)<10)return;B=trunc(exports.Expanse.normalize(V.codomain,B)),H=trunc(exports.Expanse.normalize(V.codomain,H)),N=trunc(exports.Expanse.normalize(U.codomain,N)),j=trunc(exports.Expanse.normalize(U.codomain,j))}[B,H]=[B,H].sort(diff),[N,j]=[N,j].sort(diff),exports.Scale.expand(P.x,B,H),exports.Scale.expand(P.y,N,j);const q=rangeInverse(B,H),Y=rangeInverse(N,j),K=sqrt(max(q,Y));exports.Expanse.set(P.width.codomain,Q=>Q.max*=q),exports.Expanse.set(P.height.codomain,Q=>Q.max*=Y),exports.Expanse.set(P.area.codomain,Q=>Q.max*=K),exports.Expanse.set(P.size.codomain,Q=>Q.max*=K),_.push([B,N,H,j]),Reactive.dispatch(k,"clear-transient"),e.render(k)}e.zoom=z;function T(k){const{scales:O,zoomStack:P}=k;if(P.length===1)return;const[I,_,F,G]=P[P.length-1],[B,N]=invertRange(I,F),[H,j]=invertRange(_,G);exports.Scale.expand(O.x,B,N),exports.Scale.expand(O.y,H,j);const V=rangeInverse(B,N),U=rangeInverse(H,j),q=1/sqrt(max(1/V,1/U));exports.Expanse.set(O.width.codomain,Y=>Y.max*=V),exports.Expanse.set(O.height.codomain,Y=>Y.max*=U),exports.Expanse.set(O.area.codomain,Y=>Y.max*=q),exports.Expanse.set(O.size.codomain,Y=>Y.max*=q),P.pop(),e.clearUserFrame(k),e.render(k)}e.popZoom=T;function D(k,O){const{x:P,y:I}=k.scales;if(!exports.Expanse.isContinuous(P.domain)||!exports.Expanse.isContinuous(I.domain))throw new Error("Both axes need to be continuous to set a ratio");k.parameters.ratio=O,e.resize(k)}e.setRatio=D;function L(k,O){const{scales:P}=k,{x:I,y:_}=P,F=exports.Scale.unitRatio(I),G=exports.Scale.unitRatio(_)*O,B={default:!0,silent:!0};if(F>G){const N=G/F*exports.Expanse.unitRange(_.domain);exports.Expanse.set(I.domain,H=>(H.zero=(1-N)/2,H.one=(1+N)/2),B)}else{const N=F/G*exports.Expanse.unitRange(I.domain);exports.Expanse.set(_.domain,H=>(H.zero=(1-N)/2,H.one=(1+N)/2),B)}}e.applyRatio=L;function W(k,O){return k.scales[O].domain}e.getScale=W;function $(k,O,P){let{min:I,max:_,zero:F,one:G,mult:B,labels:N,direction:H}=P;const j=k.scales[O].domain,V=k.scales[O].codomain;if(!Object.keys(k.scales).includes(O))throw new Error(`Unrecognized scale '${O}'`);const U={default:P.default??!1,unfreeze:P.unfreeze??!1};if([F,G].some(isDefined)&&(F=F??j.zero,_=_??j.max,exports.Expanse.set(j,q=>(q.zero=F,q.one=G),U),k.parameters.ratio=void 0),[I,_].some(isDefined)){if(!exports.Expanse.isContinuous(j))throw new Error("Limits can only be set with a continuous scale");I=I??j.min,_=_??j.max,exports.Expanse.set(j,q=>(q.min=I,q.max=_),U),k.parameters.ratio=void 0}if(N){if(!exports.Expanse.isDiscrete(j))throw new Error("Labels can be ordered with a discrete scale only");if(!stringArraysMatch(j.labels,N))throw new Error("Labels must match the scale's labels");const q=orderIndicesByTable(j.labels,N);exports.Expanse.reorder(j,q)}H&&exports.Expanse.set(j,q=>q.direction=H,U),B&&exports.Expanse.set(V,q=>q.mult=B,U)}e.setScale=$})(exports.Plot||(exports.Plot={}));function setupFrames(e,t){const{container:n,frames:o}=e,{margins:u,colors:r,axisLabelSize:d,axisTitleSize:s}=t,[c,x,a,i]=u,l=[7,6,5,4,3,2,1,0],f="tw-absolute tw-top-0 tw-right-0 tw-w-full tw-h-full ";for(const w of l){const A={zIndex:`${7-w+2}`},C=r[w],z={fillStyle:C,strokeStyle:C},T=Frame.of({classes:f,contextProps:z,canvasStyles:A,margins:u});o[w]=T}const g=Frame.of({classes:f+"tw-bg-gray-100"});Frame.setContext(g,{font:`${s}rem sans-serif`,textBaseline:"middle",textAlign:"center"});const p=`calc(100% - ${x}px - ${i}px)`,h=`calc(100% - ${c}px - ${a}px)`,y={width:p,height:h,top:a+"px",right:i+"px"},R=Frame.of({classes:f+"tw-z-1 tw-bg-white",canvasStyles:y}),v=Frame.of({classes:f+"tw-z-10 tw-border tw-border-b-black tw-border-l-black",canvasStyles:y}),m=Frame.of({classes:f+"tw-z-10",margins:u});Frame.setContext(m,{globalAlpha:.06666666666666667});const S="#3B4854",M=Frame.of({classes:f});Frame.setContext(M,{fillStyle:S,textBaseline:"top",textAlign:"center",font:`${d}rem serif`});const b=Frame.of({classes:f});Frame.setContext(b,{fillStyle:"#3B4854",textBaseline:"middle",textAlign:"right",font:`${d}rem serif`}),Object.assign(o,{base:g,under:R,over:v,user:m,xAxis:M,yAxis:b});for(let[w,A]of Object.entries(o))isNaN(parseFloat(w))||(w="data-"+w),A.canvas.id=`frame-${w}`,Frame.append(A,n)}function setupEvents$1(e){const{container:t,parameters:n,frames:o}=e,{mousecoords:u}=n;for(const[r,d]of Object.entries(exports.Plot.keybindings))Reactive.listen(e,r,()=>Reactive.dispatch(e,d));t.addEventListener("mousedown",r=>{r.stopPropagation();const{locked:d}=n;exports.Plot.activate(e),exports.Plot.setMousedown(e,!0),exports.Plot.setMouseButton(e,r.button),r.button===MouseButton.Left?exports.Plot.setMode(e,"select"):r.button===MouseButton.Right&&exports.Plot.setMode(e,"pan");const s=r.offsetX,c=t.clientHeight-r.offsetY;copyValues([s,c,s,c],u),!d&&n.mode==="select"&&(Reactive.dispatch(e,"clear-transient"),exports.Plot.checkSelection(e)),exports.Plot.unlock(e)}),t.addEventListener("contextmenu",r=>{r.preventDefault(),exports.Plot.setMousedown(e,!0),exports.Plot.setMouseButton(e,MouseButton.Right),exports.Plot.setMode(e,"pan"),u[0]=r.offsetX,u[1]=t.clientHeight-r.offsetY,Frame.clear(o.user)}),t.addEventListener("mouseup",()=>exports.Plot.setMousedown(e,!1)),t.addEventListener("mousemove",throttle(r=>{exports.Plot.mousemoveHandlers[n.mode](e,r)},20)),Reactive.listen(e,"reset",()=>exports.Plot.reset(e)),Reactive.listen(e,"resize",()=>exports.Plot.resize(e)),Reactive.listen(e,"activate",()=>exports.Plot.activate(e)),Reactive.listen(e,"deactivate",()=>exports.Plot.deactivate(e)),Reactive.listen(e,"render",()=>exports.Plot.render(e)),Reactive.listen(e,"lock",()=>exports.Plot.lock(e)),Reactive.listen(e,"unlock",()=>exports.Plot.unlock(e)),Reactive.listen(e,"query-mode",()=>exports.Plot.setMode(e,"query")),Reactive.listen(e,"render-axes",()=>exports.Plot.renderAxes(e)),Reactive.listen(e,"clear-transient",()=>exports.Plot.clearUserFrame(e)),Reactive.listen(e,"get-scale",r=>{if(!(!r||!r.scale))return exports.Plot.getScale(e,r.scale)}),Reactive.listen(e,"set-scale",r=>{!r||!r.scale||exports.Plot.setScale(e,r.scale,r)}),Reactive.listen(e,"grow",()=>exports.Plot.grow(e)),Reactive.listen(e,"shrink",()=>exports.Plot.shrink(e)),Reactive.listen(e,"fade",()=>exports.Plot.fade(e)),Reactive.listen(e,"unfade",()=>exports.Plot.unfade(e)),Reactive.listen(e,"zoom",r=>exports.Plot.zoom(e,r)),Reactive.listen(e,"pop-zoom",()=>exports.Plot.popZoom(e));for(const r of Object.values(e.scales))Reactive.listen(r,"changed",()=>{exports.Plot.render(e),exports.Plot.renderAxes(e)})}function setupScales(e,t){var v,m;const{scales:n,container:o}=e,{clientWidth:u,clientHeight:r}=o,d={continuous:ExpanseContinuous,point:ExpansePoint,band:ExpanseBand},s=d[((v=t==null?void 0:t.scales)==null?void 0:v.x)??"continuous"].of(),c=d[((m=t==null?void 0:t.scales)==null?void 0:m.y)??"continuous"].of();n.x=exports.Scale.of(s,ExpanseContinuous.of(0,u)),n.y=exports.Scale.of(c,ExpanseContinuous.of(0,r)),n.height=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of(0,r)),n.width=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of(0,u)),n.area=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of()),n.size=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of(0,t.size)),n.areaPct=exports.Scale.of(ExpanseContinuous.of(),ExpanseContinuous.of());const{x,y:a,width:i,height:l,size:f,area:g,areaPct:p}=n,h={default:!0,silent:!0},{expandX:y,expandY:R}=defaultOptions;exports.Expanse.set(g.domain,S=>S.ratio=!0,h),exports.Expanse.set(p.domain,S=>S.ratio=!0,h),exports.Expanse.set(f.domain,S=>S.ratio=!0,h),exports.Expanse.set(f.codomain,S=>(S.trans=square,S.inv=sqrt),h),exports.Expanse.set(g.codomain,S=>(S.trans=square,S.inv=sqrt),h),exports.Expanse.set(p.codomain,S=>(S.trans=square,S.inv=sqrt),h),exports.Expanse.set(x.domain,S=>(S.zero=y,S.one=1-y),h),exports.Expanse.set(a.domain,S=>(S.zero=R,S.one=1-R),h),exports.Expanse.set(i.domain,S=>S.one=1-2*y,h),exports.Expanse.set(l.domain,S=>S.one=1-2*R,h),exports.Expanse.set(g.domain,S=>S.one=1-2*Math.max(y,R),h);const E=S=>Math.max(S,0);exports.Expanse.set(i.codomain,S=>S.inv=E,h),exports.Expanse.set(l.codomain,S=>S.inv=E,h)}var KeybindingsMenu;(e=>{function t(o){const u=DOM.element("div"),r=DOM.element("div",{id:"modal"}),d=DOM.element("div",{id:"bindings"}),s=DOM.element("button",{textContent:"key bindings"});DOM.addClasses(r,tw("tw-absolute tw-left-0 tw-top-0 tw-z-50 tw-flex tw-size-full tw-flex-col tw-items-center tw-bg-slate-800 tw-bg-opacity-80 tw-p-10")),DOM.addClasses(d,tw("tw-relative tw-flex tw-h-full tw-w-fit tw-flex-col tw-flex-wrap tw-justify-start tw-py-10")),DOM.addClasses(s,tw("tw-absolute tw-right-0 tw-top-0 tw-z-30 tw-select-none tw-rounded-bl-md tw-bg-gray-300 tw-p-1 tw-px-2 tw-text-sm tw-text-white hover:tw-bg-gray-400")),DOM.append(u,r),DOM.append(u,s),DOM.append(r,d),d.style.columnFill="auto",r.style.display="none";let c=!1;function x(){r.style.display="flex"}function a(){c||(r.style.display="none")}s.addEventListener("click",x),r.addEventListener("click",a);for(const[i,l]of Object.entries(o)){const f=DOM.element("span",{classes:tw("tw-m-1 tw-flex tw-flex-row")}),g=DOM.element("button",{textContent:i}),p=DOM.element("div",{classes:tw("tw-m-1 tw-p-1 tw-px-2 tw-text-white"),textContent:capitalize(l.replaceAll("-"," "))});DOM.addClasses(g,tw("tw-m-1 tw-w-8 tw-rounded-md tw-bg-gray-400 tw-p-1 tw-px-2 tw-text-center tw-text-white tw-outline-none hover:tw-bg-gray-500")),DOM.append(f,g),DOM.append(f,p),p.addEventListener("click",y=>y.stopPropagation()),g.addEventListener("click",y=>{c||(y.stopPropagation(),DOM.addClasses(g,tw("text-black bg-slate-200 hover:bg-slate-200")),window.addEventListener("keydown",h),c=!0)});const h=y=>{const{key:R}=y,E=g.innerText;R in o&&R!==E||(n(o,R,l),g.innerText=y.key,DOM.removeClasses(g,tw("tw-text-black tw-bg-slate-200 hover:tw-bg-slate-200")),window.removeEventListener("keydown",h),c=!1)};d.appendChild(f)}return u}e.of=t;function n(o,u,r){let d;for(const[s,c]of Object.entries(o))if(c===r){d=s;break}d&&delete o[d],o[u]=r}})(KeybindingsMenu||(KeybindingsMenu={})),exports.Scene=void 0,(e=>{function t(b,w){const A=DOM.element("div",{id:"scene-container"}),C=DOM.element("div",{id:"plots-container"});DOM.addClasses(A,tw("tailwind tw-pr-15 tw-relative tw-flex tw-h-full tw-w-full tw-content-center tw-items-center tw-justify-center tw-bg-[#deded9] tw-p-10")),DOM.addClasses(C,tw("tw-grid tw-h-full tw-w-full tw-grid-cols-1 tw-grid-rows-1 tw-gap-5 "));const z={...e.keybindings,...exports.Plot.keybindings},T=KeybindingsMenu.of(z);DOM.append(A,C),DOM.append(A,T);const[D,L]=[1,1],W=Marker.of(Object.values(b)[0].length),$=[],k={},O=Object.assign(defaultOptions,w);updateOptions(O);for(const[_,F]of Object.entries(b))Meta.has(F,"name")||Meta.set(F,"name",_);const P={send:console.log},I=Reactive.of()({data:b,container:A,plotsContainer:C,rows:D,cols:L,marker:W,client:P,plots:$,plotsByType:k,options:O,keybindings:z});if(w!=null&&w.websocketURL){const _=new WebSocket(w.websocketURL),F={sender:"scene",target:"server",type:"connected"};_.addEventListener("open",()=>_.send(JSON.stringify(F))),_.addEventListener("message",G=>{h(I,JSON.parse(G.data))}),window.addEventListener("beforeunload",()=>_.close()),I.client=_}return setupEvents(I),I}e.of=t;async function n(b,w){const A=await fetchJSON(b);return e.of(A,w)}e.ofAsync=n;function o(b,w){b.appendChild(w.container),e.resize(w)}e.append=o;function u(b,w){const{plotsContainer:A,marker:C,plots:z,plotsByType:T}=b;Reactive.listen(w,"activated",()=>{for(const L of z)L!=w&&Reactive.dispatch(L,"deactivate");b.activePlot=w}),Reactive.listen(w,"lock-others",()=>{for(const L of z)L!==w&&Reactive.dispatch(L,"lock")}),Reactive.listen(w,"set-selected",L=>{Marker.update(C,L.cases)}),Reactive.listen(w,"clear-transient",()=>{for(const L of z)exports.Plot.clearUserFrame(L);Marker.clearTransient(C)});const{type:D}=w;T[D]||(T[D]=[]),T[D].push(z.length),z.push(w),exports.Plot.append(A,w),d(b),l(b),e.resize(b)}e.addPlot=u;function r(b,w){const{type:A,variables:C,reducer:z,queries:T}=w??{};if(!A||A==="unknown"||!C)return;for(const $ of C)if(!Object.keys(b.data).includes($))throw new Error(`Variable '${$}' is not present in the data`);const D=keysToSelectors(C),L={};if(z&&(L.reducer=exports.Reducer.parse(z)),T)if(isStringArray(T))L.queries=keysToSelectors(T);else{const $=k=>T.map(([O,P])=>[k[O],exports.Reducer.parse(P)]);L.queries=$}const W=exports.Plot[A](b,D,L);e.addPlot(b,W)}e.addPlotBySpec=r;function d(b){for(let w=0;w<b.plots.length;w++)b.plots[w].container.id=`plot${w+1}`}function s(b){const w=last(b.plots);w&&x(b,w)}e.popPlot=s;function c(b,w){const A=i(b,w);A&&x(b,A)}e.removePlot=c;function x(b,w){const{plots:A,plotsByType:C,plotsContainer:z}=b,T=A.indexOf(w);for(const D of Object.values(C))if(D.indexOf(T)!==-1){remove(D,T);break}remove(A,w),z.removeChild(w.container),Reactive.removeAllListeners(w),d(b),l(b),e.resize(b)}function a(b,w){return w==="scene"?b:i(b,w)}e.getTarget=a;function i(b,w){const{plots:A,plotsByType:C}=b;let[z,T]=splitNumericSuffix(w);const D=parseInt(T,10)-1;if(z==="plot"||z==="p")return A[D];if(z=z.replace("plot","").replace("gram",""),z in Object.keys(plotIdShort)&&(z=plotIdShort[z]),z in C)return A[C[z][D]]}e.getPlot=i;function l(b){const{plots:w}=b;if(w.length===0)return;const A=Math.ceil(Math.sqrt(w.length)),C=Math.ceil(w.length/A);e.setDimensions(b,C,A)}function f(b,w,A){const{plotsContainer:C}=b;b.rows=w,b.cols=A,C.style.gridTemplateRows=Array(w).fill("1fr").join(" "),C.style.gridTemplateColumns=Array(A).fill("1fr").join(" "),e.resize(b)}e.setDimensions=f;function g(b,w){const{plotsContainer:A,plots:C}=b,z=new Set(w.flat()),T=new Set(seq(0,C.length-1));for(const $ of z)T.delete($);T.size>0&&alert("Warning: Some plots are not included in the layout and will be hidden.");for(let $=0;$<C.length;$++)C[$].container.style.gridArea=`plot${$}`;let D="";for(const $ of w)D+=`"${$.map(k=>`plot${k}`).join(" ")}" `;const[L,W]=[w.length,w[0].length];A.style.gridTemplateAreas=D,A.style.gridTemplateRows=Array(L).fill("1fr").join(" "),A.style.gridTemplateColumns=Array(W).fill("1fr").join(" "),e.resize(b)}e.setLayout=g;function p(b){b.plotsContainer.style.gridTemplateAreas="";for(const w of b.plots)w.container.style.gridArea="auto";l(b)}e.clearLayout=p;function h(b,w){if(!b.client)return;const{type:A,target:C,data:z}=w,T=a(b,C);T&&Reactive.dispatch(T,A,z)}e.handleMessage=h;function y(b,w,A){const[C,z]=["scene","server"],T=JSON.stringify({sender:C,target:z,type:w,data:A});b.client.send(T)}e.sendMessage=y;function R(b){for(const w of b.plots)Reactive.dispatch(w,"resize")}e.resize=R;function E(b){for(const w of b.plots)Reactive.dispatch(w,"reset");Marker.clearTransient(b.marker)}e.reset=E;function v(b){for(const w of b.plots)Reactive.dispatch(w,"query-mode")}e.setQueryMode=v;function m(b){Marker.setGroup(b.marker,Group.First)}e.setGroupFirst=m;function S(b){Marker.setGroup(b.marker,Group.Second)}e.setGroupSecond=S;function M(b){Marker.setGroup(b.marker,Group.Third)}e.setGroupThird=M,e.keybindings={r:"reset",q:"query-mode",1:"group-1",2:"group-2",3:"group-3"}})(exports.Scene||(exports.Scene={}));function setupEvents(e){const{marker:t,plots:n,container:o,keybindings:u}=e;o.addEventListener("mousedown",()=>{for(const r of n)Reactive.dispatch(r,"deactivate")}),o.addEventListener("dblclick",()=>{for(const r of n)Reactive.dispatch(r,"deactivate"),Frame.clear(r.frames.user);Marker.clearAll(e.marker),e.activePlot=void 0}),window.addEventListener("keydown",r=>{const d=u[r.key];d&&(e.activePlot&&Reactive.dispatch(e.activePlot,d),Reactive.dispatch(e,d))}),window.addEventListener("keyup",()=>{Marker.setGroup(t,Transient);for(const r of e.plots)r.parameters.mode=exports.Plot.Mode.Select,r.queryTable.style.display="none"}),window.addEventListener("resize",throttle(()=>exports.Scene.resize(e),10)),Reactive.listen(t,"cleared",()=>{for(const r of n)Reactive.dispatch(r,"unlock")}),Reactive.listen(e,"resize",()=>exports.Scene.resize(e)),Reactive.listen(e,"reset",()=>exports.Scene.reset(e)),Reactive.listen(e,"query-mode",()=>exports.Scene.setQueryMode(e)),Reactive.listen(e,"group-1",()=>exports.Scene.setGroupFirst(e)),Reactive.listen(e,"group-2",()=>exports.Scene.setGroupSecond(e)),Reactive.listen(e,"group-3",()=>exports.Scene.setGroupThird(e)),Reactive.listen(e,"connected",()=>{var r;return console.log(`Connected to Websocket server on: ${(r=e.client)==null?void 0:r.url}`)}),Reactive.listen(e,"set-dims",r=>{!r||!r.rows||!r.columns||exports.Scene.setDimensions(e,r.rows,r.cols)}),Reactive.listen(e,"add-plot",r=>{r&&exports.Scene.addPlotBySpec(e,r)}),Reactive.listen(e,"pop-plot",()=>exports.Scene.popPlot(e)),Reactive.listen(e,"remove-plot",r=>{!r||!r.id||exports.Scene.removePlot(e,r.id)}),Reactive.listen(e,"set-selected",r=>{!r||!r.cases||Marker.update(t,r.cases)}),Reactive.listen(e,"set-assigned",r=>{if(!r||!r.group)return;const d=7-Math.min(r.group,3);Marker.update(t,r.cases,{group:d})}),Reactive.listen(e,"get-selected",()=>{const r=filterIndices(Array.from(t.indices),Marker.isTransient);exports.Scene.sendMessage(e,"get-selected",{cases:r})}),Reactive.listen(e,"get-assigned",r=>{if(!r||!r.group)return;const d=c=>(c|4)===7-Math.min(r.group,3),s=filterIndices(Array.from(t.indices),d);exports.Scene.sendMessage(e,"get-assigned",{cases:s,group:r.group})}),Reactive.listen(e,"clear-selection",()=>Marker.clearAll(t)),Reactive.listen(e,"get-scale",r=>{if(!r||!r.id)return;const d=exports.Scene.getPlot(e,r.id);d&&Reactive.dispatch(d,"get-scale",r)}),Reactive.listen(e,"set-scale",r=>{if(!r||!r.id)return;const d=exports.Scene.getPlot(e,r.id);d&&Reactive.dispatch(d,"set-scale",r)}),Reactive.listen(e,"normalize",r=>{if(!r||!r.id)return;const d=exports.Scene.getPlot(e,r.id);d&&Reactive.dispatch(d,"normalize")}),Reactive.listen(e,"zoom",r=>{if(!r||!r.id)return;const d=exports.Scene.getPlot(e,r.id);d&&Reactive.dispatch(d,"zoom",r)}),Reactive.listen(e,"set-layout",r=>{!r||!r.layout||exports.Scene.setLayout(e,r.layout)}),Reactive.listen(e,"set-parameters",r=>{if(!r||!r.id)return;const d=exports.Scene.getPlot(e,r.id);d&&Reactive.dispatch(d,"set-parameters",r)}),Reactive.listen(e,"clear-layout",()=>exports.Scene.clearLayout(e))}const plotIdShort={s:"scatter",b:"bar",h:"histo",f:"fluct",hh:"histo2d",pc:"pcoords"};return exports.METHODS=METHODS,exports.POSITIONS=POSITIONS,exports.addIndexed=addIndexed,exports.addTailwind=addTailwind,exports.applyDirection=applyDirection,exports.applyWith=applyWith,exports.bimap=bimap,exports.binBreaks=binBreaks,exports.call=call,exports.capitalize=capitalize,exports.clearNodeChildren=clearNodeChildren,exports.compareAlphaNumeric=compareAlphaNumeric,exports.convertToSuperscript=convertToSuperscript,exports.copyProps=copyProps,exports.copyValues=copyValues,exports.cumsum=cumsum,exports.dec=dec,exports.diff=diff,exports.exp10=exp10,exports.exponentialToSuperscript=exponentialToSuperscript,exports.fetchJSON=fetchJSON,exports.filterIndices=filterIndices,exports.findLength=findLength,exports.formatAxisLabels=formatAxisLabels,exports.formatLabel=formatLabel,exports.formatText=formatText,exports.identity=identity,exports.inc=inc,exports.invertRange=invertRange,exports.isDefined=isDefined,exports.isEventTarget=isEventTarget,exports.isIntegerString=isIntegerString,exports.isNumber=isNumber,exports.isNumberArray=isNumberArray,exports.isObject=isObject,exports.isPrimitive=isPrimitive,exports.isStringArray=isStringArray,exports.isTypedArray=isTypedArray,exports.just=just,exports.keysToSelectors=keysToSelectors,exports.last=last,exports.log10=log10,exports.max=max,exports.merge=merge,exports.minDecimal=minDecimal,exports.minmax=minmax,exports.one=one,exports.orderBy=orderBy,exports.orderIndices=orderIndices,exports.orderIndicesByTable=orderIndicesByTable,exports.ordered=ordered,exports.pointInRect=pointInRect,exports.prettyBreaks=prettyBreaks,exports.prod=prod,exports.randomInteger=randomInteger,exports.rangeInverse=rangeInverse,exports.rectSegmentIntersect=rectSegmentIntersect,exports.rectsIntersect=rectsIntersect,exports.remove=remove,exports.removeTailwind=removeTailwind,exports.rep=rep,exports.round=round,exports.row=row,exports.segmentsIntersect=segmentsIntersect,exports.selector=selector,exports.seq=seq,exports.seqLength=seqLength,exports.splitNumericSuffix=splitNumericSuffix,exports.sqrt=sqrt,exports.square=square,exports.stringArraysMatch=stringArraysMatch,exports.stripWS=stripWS,exports.subset=subset,exports.sum=sum,exports.throttle=throttle,exports.timeExecution=timeExecution,exports.toLowerCase=toLowerCase,exports.toUpperCase=toUpperCase,exports.trunc=trunc,exports.tw=tw,exports.uniqueIntegers=uniqueIntegers,exports.zero=zero,Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),exports}({});
