<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The algebra of interaction • plotscaper</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The algebra of interaction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plotscaper</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/plotscaper.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/algebra.html">The algebra of interaction</a></li>
    <li><a class="dropdown-item" href="../articles/available-interactions.html">Available interactions</a></li>
    <li><a class="dropdown-item" href="../articles/layout.html">Layout</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Performance</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bartonicek/plotscaper/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="algebra_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="algebra_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="algebra_files/plotscape-0.0.0/main.iife.js"></script><script src="algebra_files/plotscaper-binding-0.2.4/plotscaper.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The algebra of interaction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bartonicek/plotscaper/blob/master/vignettes/algebra.Rmd" class="external-link"><code>vignettes/algebra.Rmd</code></a></small>
      <div class="d-none name"><code>algebra.Rmd</code></div>
    </div>

    
    
<blockquote>
<p>This section delves into deeper properties of
<code>plotscaper</code>. If you are happy using the default figures to
explore your data, feel free to skip it, however, you may still find it
an interesting read.</p>
</blockquote>
<div class="section level2">
<h2 id="preamble">Preamble<a class="anchor" aria-label="anchor" href="#preamble"></a>
</h2>
<p>I really like data visualization. In fact, making plots was one of
the first things that drew me to R. Prior to becoming a statistics
student, I had done some work in applied research, and I can still
deeply feel the pain of trying to reason about the data we had collected
from crude tables of summary statistics. Learning R and packages like
<code>ggplot2</code> <span class="citation">(Wickham 2016)</span>
liberated me in a way that bordered on spiritual. I was finally able to
<em>see</em> the data, with all its intricacies and imperfections, and
eliminate so much of the guesswork I struggled with before.</p>
<p>So, naturally, data visualization became a big part of my day-to-day
data science workflow. I would experiment and write scripts to render
pages upon pages of static plots and then trawl through them, trying to
see if I could glean parts of the overall picture.</p>
<p>Several times, I had thought about using interactive data
visualization. I knew there were packages for making interactive figures
out there. However, each time I tried using one of them, I ended up
going away somewhat disappointed.</p>
<p>It usually boiled down to a kind of Goldilocks problem. The packages
were either too simple, easy to pick up but offering only a few fairly
shallow interactive features, or too complex, highly expressive but
requiring me to learn essentially a whole new programming language, and
spend hours writing dense code just to make one fairly simple
interactive figure. The simple packages just did not provide the
features I wanted, and the complex ones seemed to be designed for data
presentation and not really worth the time investment - things would be
different if I were making dashboards for a large company or
organization, but most of the time, the only audience of my figures was
me, plus or minus few colleagues. In the end, I always ended up going
back to good old static plots.</p>
<p>So, after I had moved to statistics and my supervisor had offered me
the project with the goal to create an interactive data visualization
package geared towards data exploration, I immediately jumped on the
opportunity. I wanted to make a tool for data exploration that would be
simple enough to pick up but offer a decent number of useful interactive
features by default and still be fairly customizable. That is, I wanted
to make the tool I was lacking during my time of applied research
work.</p>
</div>
<div class="section level2">
<h2 id="linked-selection">Linked selection<a class="anchor" aria-label="anchor" href="#linked-selection"></a>
</h2>
<p>One feature that I wanted to support by default in my package was <a href="https://en.wikipedia.org/wiki/Brushing_and_linking" class="external-link">linked
selection</a>. Linked selection (aka “linked brushing” or
“highlighting”) is the ability to click some objects in one plot and
have the corresponding cases highlighted across all other plots. Many
data visualization researchers highlight it as one of the most useful
interactive features <span class="citation">(see e.g. Buja, Cook, and
Swayne 1996; Heer and Shneiderman 2012; Ward, Grinstein, and Keim 2015;
Ware 2019)</span>. To see how linked selection works, click/click and
drag to select some objects (points or bars) in the figure below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bartonicek.github.io/plotscaper/">plotscaper</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ozone"</span>, <span class="st">"solar radiation"</span>, <span class="st">"wind"</span>, </span>
<span>                       <span class="st">"temperature"</span>, <span class="st">"month"</span>, <span class="st">"day"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/create_schema.html">create_schema</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_scatterplot.html">add_scatterplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"solar radiation"</span>, <span class="st">"ozone"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_barplot.html">add_barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"month"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in create_schema(airquality): Removed 42 rows with missing values from</span></span>
<span><span class="co">#&gt; the data</span></span></code></pre></div>
<div class="plotscaper html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"data":{"ozone":[41,36,12,18,23,19,8,16,11,14,18,14,34,6,30,11,1,11,4,32,23,45,115,37,29,71,39,23,21,37,20,12,13,135,49,32,64,40,77,97,97,85,10,27,7,48,35,61,79,63,16,80,108,20,52,82,50,64,59,39,9,16,122,89,110,44,28,65,22,59,23,31,44,21,9,45,168,73,76,118,84,85,96,78,73,91,47,32,20,23,21,24,44,21,28,9,13,46,18,13,24,16,13,23,36,7,14,30,14,18,20],"solar radiation":[190,118,149,313,299,99,19,256,290,274,65,334,307,78,322,44,8,320,25,92,13,252,223,279,127,291,323,148,191,284,37,120,137,269,248,236,175,314,276,267,272,175,264,175,48,260,274,285,187,220,7,294,223,81,82,213,275,253,254,83,24,77,255,229,207,192,273,157,71,51,115,244,190,259,36,212,238,215,203,225,237,188,167,197,183,189,95,92,252,220,230,259,236,259,238,24,112,237,224,27,238,201,238,14,139,49,20,193,191,131,223],"wind":[7.4,8,12.6,11.5,8.6,13.8,20.1,9.699999999999999,9.199999999999999,10.9,13.2,11.5,12,18.4,11.5,9.699999999999999,9.699999999999999,16.6,9.699999999999999,12,12,14.9,5.7,7.4,9.699999999999999,13.8,11.5,8,14.9,20.7,9.199999999999999,11.5,10.3,4.1,9.199999999999999,9.199999999999999,4.6,10.9,5.1,6.3,5.7,7.4,14.3,14.9,14.3,6.9,10.3,6.3,5.1,11.5,6.9,8.6,8,8.6,12,7.4,7.4,7.4,9.199999999999999,6.9,13.8,7.4,4,10.3,8,11.5,11.5,9.699999999999999,10.3,6.3,7.4,10.9,10.3,15.5,14.3,9.699999999999999,3.4,8,9.699999999999999,2.3,6.3,6.3,6.9,5.1,2.8,4.6,7.4,15.5,10.9,10.3,10.9,9.699999999999999,14.9,15.5,6.3,10.9,11.5,6.9,13.8,10.3,10.3,8,12.6,9.199999999999999,10.3,10.3,16.6,6.9,14.3,8,11.5],"temperature":[67,72,74,62,65,59,61,69,66,68,58,64,66,57,68,62,59,73,61,61,67,81,79,76,82,90,87,82,77,72,65,73,76,84,85,81,83,83,88,92,92,89,73,81,80,81,82,84,87,85,74,86,85,82,86,88,86,83,81,81,81,82,89,90,90,86,82,80,77,79,76,78,78,77,72,79,81,86,97,94,96,94,91,92,93,93,87,84,80,78,75,73,81,76,77,71,71,78,67,76,68,82,64,71,81,69,63,70,75,76,68],"month":[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],"day":[1,2,3,4,7,8,9,12,13,14,15,16,17,18,19,20,21,22,23,24,28,29,30,31,7,9,10,13,16,17,18,19,20,1,2,3,5,6,7,8,9,10,12,13,15,16,17,18,19,20,21,24,25,26,27,28,29,30,31,1,2,3,7,8,9,12,13,14,16,17,18,19,20,21,22,24,25,26,28,29,30,31,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,28,29,30]},"queue":[{"sender":"server","target":"scene","type":"add-plot","data":{"type":"scatter","variables":["solar radiation","ozone"],"id":"37e719ec-b911-4256-9603-1185d766acd4"}},{"sender":"server","target":"scene","type":"add-plot","data":{"type":"bar","variables":["month"],"id":"b7f3ce5c-8d9e-403c-98ef-62e94f26d15f"}}],"options":null},"evals":[],"jsHooks":[]}</script><p>However, despite the fact that many data visualization authors praise
the virtues of linked selection, few interactive data visualization
packages actually support the feature out of the box. For example, see
the following quote from <a href="https://rstudio.github.io/crosstalk/" class="external-link">Crosstalk</a> website:</p>
<blockquote>
<p>“Crosstalk currently only works for linked brushing and filtering of
views that show individual data points, not aggregate or summary views
(where “observations” is defined as a single row in a data frame). For
example, histograms are not supported since each bar represents multiple
data points; but scatter plot points each represent a single data point,
so they are supported.”</p>
</blockquote>
<blockquote>
<p><span class="citation">(RStudio Inc. 2023)</span></p>
</blockquote>
<p>And the similar holds in many other current interactive data
visualization libraries - the support for linked selection is usually
quite limited, if the feature is present at all. However, it didn’t
always used to be like this. Linked selection actually used to be the
standard in many of the earlier interactive data visualization packages
available for R, such as GGobi <span class="citation">(Swayne et al.
2003)</span>, Mondrian <span class="citation">(Theus 2002)</span>, or
iplots <span class="citation">(Urbanek and Theus 2003; Urbanek
2011)</span>. So what happened?</p>
<p>I have the following hypothesis to offer. Despite seeming fairly
straightforward, linked selection can be actually surprisingly tricky to
implement generically (for reasons that I will spend the rest of this
article explaining). This wasn’t that much of a problem for the older
generation of interactive data visualization packages, since these
tended to implement interactive plots as one offs - you called one
function to create an interactive plot of type A and another function to
create interactive plot of type B.</p>
<p>However, what happened over the past 20 years or so is that a
declarative, grammar-based style of data visualization became popular.
This style, popularized by packages like <code>ggplot2</code>, made it
possible build up plots combining independent, modular components
(e.g. <code>stats</code> and <code>geoms</code>). The power of this
approach is that it allows you to swap out the different components and
rapidly prototype many different ways of representing your data, which
is likely why it grew in popularity so quickly. As it became the
standard in static visualization, authors of interactive data
visualization libraries wanted to support this style as well.</p>
<p>However, herein lies the problem I think. My claim is that certain
types of interaction such as linked selection are actually very hard to
implement in grammar-based style, because the components
(<code>stats</code>, <code>geoms</code>, and interaction) aren’t
independent. I will explore this claim in more detail in the rest of the
article.</p>
</div>
<div class="section level2">
<h2 id="the-problem">The problem<a class="anchor" aria-label="anchor" href="#the-problem"></a>
</h2>
<p>When I started my work on the interactive data visualization package,
I wanted it to support certain interactive features like linked
selection out of the box, however, I wanted to also retain some of the
flexibility of grammar-based visualization systems. Specifically, I
wanted to be able to use the same plots to show different kinds of
summary statistics, for example counts, sums, means or maximums.</p>
<p>However, I kept running into this one problem, over and over again.
Initially, I found it very hard to even describe what the problem was,
however, I eventually stumble upon the right kind of language to do it.
Anyway, I think the best to begin describing the problem is via an
example.</p>
<p>Try and see if you can spot what’s wrong with the following plot:</p>
<pre><code><span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>            <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  panel.border <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  panel.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"whitesmoke"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, y <span class="op">=</span> <span class="va">mpg</span>, fill <span class="op">=</span> <span class="va">am</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"summary"</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#92c9f6"</span>, <span class="st">"#377eb8"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="algebra_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>If you don’t look too closely, the plot above looks like a perfectly
fine <code>ggplot2</code> figure. It looks like something that might
result from linked selection, with the dark blue bars representing the
selected cases.</p>
<p>However, take a closer look at the following line:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"summary"</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<p>We’re telling <code>ggplot2</code> that we want to draw bars by
summarizing the y-axis variable by its average, within the levels
defined by the Cartesian product of the <code>x</code> and
<code>fill</code> variables (i.e. a table with <code>x</code> as rows
and <code>fill</code> as columns).</p>
<p>That’s fine. However, there’s one important default argument to the
<code>geom_bar</code> that we don’t see unless we specify it
explicitly:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"summary"</span>, fun <span class="op">=</span> <span class="va">mean</span>, position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span></span></code></pre></div>
<p>When we use the <code>fill</code> aesthetic with
<code>geom_bar</code> (as well as other <code>geom</code>s),
<code>ggplot2</code> applies the stack transformation by default. In the
case of bars, this means that the bars get stacked vertically, one on
top of another.</p>
<p>However, what does the height of the stacked bars represent?
Visually, stacking bars is effectively summing up the underlying
statistic. Now, since each single-colored bar represents a group mean,
each whole bar consisting of a light-blue and dark-blue bar represents
the sum of the group averages.</p>
<p>The problem with this is that sum of averages is not meaningful
summary statistic. It’s not a quantity that many people would ask for or
know how to interpret.</p>
<p>This is the kind of problem that can easily trip up a data
visualization rookie, and a good number of data visualization
researchers have actually warned about this:</p>
<blockquote>
<p>“Stacking is useful when the sum of the amounts represented by the
individual stacked bars is in itself a meaningful amount” <span class="citation">(Wilke 2019, 52)</span>.</p>
</blockquote>
<blockquote>
<p>“[…] It is very important that if the element’s size is used to
display a statistic, then that statistic must be summable. Stacking bars
that represent counts, sums, or percentages are fine, but a stacked bar
chart where bars show average values is generally meaningless.” <span class="citation">(Wills 2011, 112)</span>.</p>
</blockquote>
<p>Now we know we can’t stack averages, however, what if we were to
apply the same transformation both within groups and across groups, by
taking the average of averages?</p>
<p>Unfortunately, this is not correct either. The mean of group means is
not guaranteed to be the same as the grand mean:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span></code></pre></div>
<p>other researchers have warned about this too:</p>
<blockquote>
<p>“[…] We do this to ensure that aggregate statistics are always
computed over the input data, and so users do not inadvertantly compute
e.g., averages of averages, which can easily lead to misinterpretation.”
<span class="citation">(Wu 2022)</span></p>
</blockquote>
</div>
<div class="section level2">
<h2 id="stacking-vs--dodging">Stacking vs. dodging<a class="anchor" aria-label="anchor" href="#stacking-vs--dodging"></a>
</h2>
<p>So what should we do if we want to display a barplot of means with
linked selection? If you’re familiar with <code>ggplot2</code>, you may
be thinking of one solution right now: instead of stacking, let’s use
dodging and plot the bars side by side:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, y <span class="op">=</span> <span class="va">mpg</span>, fill <span class="op">=</span> <span class="va">am</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"summary"</span>, fun <span class="op">=</span> <span class="va">mean</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#92c9f6"</span>, <span class="st">"#377eb8"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="algebra_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>And indeed, this technique works rather well for static graphics.
However, for interactive graphics, dodging has several issues. Take a
look at the following figure:</p>
<p><img src="algebra_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>In the top row of plots, we use stacking, and in the bottom row we
use dodging (and the same data is used across all plots, except the
<code>fill</code> variable). We can imagine these barplots being
produced by linked selection, with the dark-blue bars representing
selected cases. Looking at the plots, we can imagine cases being
selected as we move from left to right.</p>
<p>Notice that in the top row, the overall contour of the plots remains
constant even as the numbers of selected cases change: we always have a
tall left bar, short middle bar, and a tall right bar. Only the heights
of the dark-blue sections change.</p>
<p>The same is not true for dodging. With dodging, since we plot the
selected and non-selected cases side-by-side, selection can affect the
overall shape of the plot. Bars may shrink or grow, or even pop and in
out of existence (see left-most plot in the bottom row - there are no
selected cases in category 6 and so there is no dark-blue bar and the
light-blue bar has expanded to fill the available space).</p>
<p>This lack of visual consistency propagates to other parts of the
plot. Notice how in the bottom row, the top y-axis limits change across
the plots. In the context of interactive graphics, this means that we
either might have to make the axes reactive (which means that the user
loses context for what the height of each bar represents each time
selection happens) or risk the bars growing past the edge of the
plotting region.</p>
<p>Finally, this may be a bit of a subjective, but I find interactive
figures which change gradually more visually pleasing and easier to read
than figures which fluctuate rapidly. The dodged barplot has by
definition twice as many moving parts as the stacked barplot, and a lot
of the motion is in opposite directions - as the selected bars grow, the
non-selected bars shrink, and vice versa. I don’t know of any specific
visual perception research that would support this claim, but it seems
to me that this would make the animation induced by the dodged barplot
harder to follow.</p>
</div>
<div class="section level2">
<h2 id="sums-preserve-set-union">Sums preserve set union<a class="anchor" aria-label="anchor" href="#sums-preserve-set-union"></a>
</h2>
<p>So does this mean we can only every do linked selection with sums and
counts? That seems quite limiting. But perhaps there’s another way to
think about this.</p>
<p>In the quotes above, <span class="citation">Wilke (2019)</span> and
<span class="citation">Wills (2011)</span> said that the quantity
represented by the stacked bar should be “meaningful”. But what makes a
quantity meaningful?</p>
<p>I tried thinking of ways to rephrase what Wilke and Wills were
getting at. I eventually arrived at the following. Sums are a
particularly nice kind of summary statistic because they have the
following property:</p>
<blockquote>
<p><em>Sum</em> of grouped <em>sum</em>s is equal to the <em>sum</em> of
everything.</p>
</blockquote>
<p>In other words, we can take subsets of our data, sum each subset up
individually, and then sum up the sums, and we’ll get the same result as
if we had gone through the whole data set and summed everything up in
one go. In other words, sums preserve set union.</p>
<p>This is what makes it possible to draw highlighted parts of bars or
other objects - we know that if we combine any two sums, we’ll get a
valid summary of the union of the underlying data sets.</p>
<p>Are there other statistics that behave this way too? What if we
replace the word <em>“sum”</em> by some placeholder, for example
<em>“foo”</em>:</p>
<blockquote>
<p><em>Foo</em> of grouped <em>foo</em>s is equal to the <em>foo</em> of
everything.</p>
</blockquote>
<p>It actually turns out there are other statistics that behave this
way. For example, the product of products is also a valid product of all
values:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 24</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 24</span></span></code></pre></div>
<p>Likewise, the maximum of maximum is also the valid maximum of all
values:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">999</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 999</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">999</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 999</span></span></code></pre></div>
<p>And even some more exotic operators behave this way, like the
Euclidean norm of a vector that we append a value to:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">euclid_norm_append</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">euclid_norm_append</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.741657</span></span>
<span><span class="fu">euclid_norm_append</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.741657</span></span></code></pre></div>
<p>But some operators just don’t behave the same way. The one example we
already discussed is the mean or average. Another is exponentiation:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">^</span><span class="fl">4</span></span>
<span><span class="co">#&gt; [1] 4096</span></span>
<span><span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="fl">3</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.417852e+24</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="monoids">Monoids<a class="anchor" aria-label="anchor" href="#monoids"></a>
</h2>
<p>So, there are some “nice” statistics that have this property of
preserving set unions, and others which don’t. Can we make this idea
“niceness” precise? It turns out there is a mathematical concept that
describes exactly this.</p>
<p>The word <a href="https://en.wikipedia.org/wiki/Monoid" class="external-link">Monoid</a>
sounds scary but it’s really nothing too complicated. A monoid is really
just three things:</p>
<ul>
<li>Some set of values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
</li>
<li>A binary operation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊗</mo><mo>:</mo><mi>M</mi><mo>×</mo><mi>M</mi><mo>→</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">\otimes: M \times M \to M</annotation></semantics></math>
</li>
<li>A neutral element
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>∈</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">e \in M</annotation></semantics></math>
</li>
</ul>
<p>Subject to two rules:</p>
<ul>
<li>Unitality:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>⊗</mo><mi>e</mi><mo>=</mo><mi>e</mi><mo>⊗</mo><mi>x</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">x \otimes e = e \otimes x = x</annotation></semantics></math>
</li>
<li>Associativity:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>⊗</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>⊗</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>⊗</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⊗</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">x \otimes (y \otimes z) = (x \otimes y) \otimes z</annotation></semantics></math>
</li>
</ul>
<p>In plain words, when we have a monoid, we have a “bunch” of things
called
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
and a way of combining these things
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>⊗</mo><annotation encoding="application/x-tex">\otimes</annotation></semantics></math>,
such that, when we combine, the order in which we do it doesn’t matter.
We also have some neutral element
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>e</mi><annotation encoding="application/x-tex">e</annotation></semantics></math>,
that, when combined with anything else, just yields the other thing
back.</p>
<p>Typical examples of monoids are the above mentioned sums, products,
and maximums (here, the set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
is real numbers and the neutral units are 0, 1, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">-\infty</annotation></semantics></math>
respectively). Counterexamples include the also above-mentioned means
and exponentiation. Neither are associative or include a convenient
default neutral element that any value could be combined with without
being modified.</p>
<p>The idea of monoids comes from abstract algebra and category theory
<span class="citation">(see e.g. Fong and Spivak 2019; Lawvere and
Schanuel 2009)</span>, and is also used in functional programming <span class="citation">(see e.g. Milewski 2018)</span>. For our purposes,
however, monoids are important because they have the exact property we
were looking for - they preserve set union.</p>
<p>Suppose we have some data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
and two disjoint subsets of this data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>B</mi><mo>⊆</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">A, B \subseteq D</annotation></semantics></math>.
Suppose also that we have some monoidal summary statistic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
that we can apply to either subset. For example, applying
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
means just “folding” all of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>’s
elements one by one into a single value, using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>⊗</mo><msub><mi>a</mi><mn>2</mn></msub><mo>⊗</mo><mi>…</mi><mo>⊗</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">F(A) = a_1 \otimes a_2 \otimes \ldots \otimes a_n</annotation></semantics></math></p>
<p>(i.e. like taking the <em>“sum”</em> of all elements of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
where <em>“sum”</em> could actually be some other operator).</p>
<p>Now, if we summarize
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
and combine the summaries, we get the same result as summarizing their
union:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⊗</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>⊗</mo><msub><mi>a</mi><mn>2</mn></msub><mo>⊗</mo><mi>…</mi><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⊗</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>b</mi><mn>1</mn></msub><mo>⊗</mo><msub><mi>b</mi><mn>2</mn></msub><mo>⊗</mo><mi>…</mi><msub><mi>b</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>⊗</mo><msub><mi>a</mi><mn>2</mn></msub><mo>⊗</mo><mi>…</mi><msub><mi>a</mi><mi>n</mi></msub><mo>⊗</mo><msub><mi>b</mi><mn>1</mn></msub><mo>⊗</mo><msub><mi>b</mi><mn>2</mn></msub><mo>⊗</mo><mi>…</mi><msub><mi>b</mi><mi>n</mi></msub><mspace width="2.0em"></mspace><mtext mathvariant="normal">(associativity: brackets don’t matter)</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} 
F(A) \otimes F(B) &amp;= (a_1 \otimes a_2 \otimes \ldots a_n) \otimes (b_1 \otimes b_2 \otimes \ldots b_n) \\
&amp;= a_1 \otimes a_2 \otimes \ldots a_n \otimes b_1 \otimes b_2 \otimes \ldots b_n \qquad \text{(associativity: brackets don't matter)} \\
&amp;= F(A \cup B)
\end{aligned}</annotation></semantics></math></p>
<p>This means that, when we have monoids, we can compare nested subsets
of the data. Which is precisely what we want to do if when highlighting
cases of the data in interactive plots: we want to compare the summary
on the selected cases
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">Selected</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\text{Selected})</annotation></semantics></math>
vs. that on everything
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">Selected</mtext><mo>∪</mo><mtext mathvariant="normal">Not selected</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\text{Selected} \cup \text{Not selected})</annotation></semantics></math>.</p>
<p>There are a few caveats regarding comparison of multiple selected
groups and monotonicity. TODO</p>
</div>
<div class="section level2">
<h2 id="barplot-of-maximums">Barplot of maximums<a class="anchor" aria-label="anchor" href="#barplot-of-maximums"></a>
</h2>
<p>In <code>plotscaper</code>, we can actually take advantage of this.
If you know a little bit of JavaScript, you can use the available plots
to display a new monoidal summary statistic, using something called a
reducer. To create a reducer, we need two things:</p>
<ul>
<li>An <em>initial</em> function: a function that produces the neutral
element
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>e</mi><annotation encoding="application/x-tex">e</annotation></semantics></math>
</li>
<li>A <em>reduce</em> function: a function that takes two values and
combines them together, such that the operation is associative and
unital</li>
</ul>
<p>These currently need to be JavaScript functions.</p>
<p>For example, suppose we want to display the barplot of maximums for
some positive numeric variable. Then we can use the following JavaScript
arrow function as the initial function:</p>
<pre><code>() =&gt; 0</code></pre>
<p>The function takes in no arguments and just produces the value zero.
In computer science lingo, this kind of “dumb” function is called a <a href="https://en.wikipedia.org/wiki/Thunk" class="external-link"><em>thunk</em></a> (in this
case, the function <em>could</em> technically just be a value, with the
way how pointers work in JavaScript, thunks are more general).</p>
<p>The other thing we need is a reduce function:</p>
<pre><code>(x, y) =&gt; Math.max(x, y)</code></pre>
<p>This is just a very simple binary function that takes two numbers and
returns the bigger one (using the JavaScript built-in
<code>Math.max</code> function). That’s it.</p>
<p>You might be asking how does <code>plotscaper</code> know whether the
operation is associative and unital. It doesn’t - you have to figure
that out yourself: try it out on a couple of candidate values &amp; see
if the properties hold. If you give <code>plotscaper</code> a function
that doesn’t have those properties it will still try to make an
interactive plot. The reason why I can’t prevent this is because there
is no way to know which values to try - for example, the operation could
be associative and unital for a handful of numbers but not for others
(sidenote: the functions behind it can actually support values other
than numbers, I haven’t tried to implement a plot with non-numeric
summaries yet but we’ll see in the future).</p>
<p>Anyway, here’s how you can create a barplot of maximums in
<code>plotscaper</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make the reducer - really just an R list() with some serialization metadata</span></span>
<span><span class="va">max_reducer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reducer.html">reducer</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  initialfn <span class="op">=</span> <span class="st">"() =&gt; 0"</span>,</span>
<span>  reducefn <span class="op">=</span> <span class="st">"(x, y) =&gt; Math.max(x, y)"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/create_schema.html">create_schema</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_scatterplot.html">add_scatterplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"solar radiation"</span>, <span class="st">"ozone"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_barplot.html">add_barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"day"</span>, <span class="st">"ozone"</span><span class="op">)</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>reducer <span class="op">=</span> <span class="va">max_reducer</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/render.html">render</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in create_schema(airquality): Removed 42 rows with missing values from</span></span>
<span><span class="co">#&gt; the data</span></span></code></pre></div>
<div class="plotscaper html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"data":{"ozone":[41,36,12,18,23,19,8,16,11,14,18,14,34,6,30,11,1,11,4,32,23,45,115,37,29,71,39,23,21,37,20,12,13,135,49,32,64,40,77,97,97,85,10,27,7,48,35,61,79,63,16,80,108,20,52,82,50,64,59,39,9,16,122,89,110,44,28,65,22,59,23,31,44,21,9,45,168,73,76,118,84,85,96,78,73,91,47,32,20,23,21,24,44,21,28,9,13,46,18,13,24,16,13,23,36,7,14,30,14,18,20],"solar radiation":[190,118,149,313,299,99,19,256,290,274,65,334,307,78,322,44,8,320,25,92,13,252,223,279,127,291,323,148,191,284,37,120,137,269,248,236,175,314,276,267,272,175,264,175,48,260,274,285,187,220,7,294,223,81,82,213,275,253,254,83,24,77,255,229,207,192,273,157,71,51,115,244,190,259,36,212,238,215,203,225,237,188,167,197,183,189,95,92,252,220,230,259,236,259,238,24,112,237,224,27,238,201,238,14,139,49,20,193,191,131,223],"wind":[7.4,8,12.6,11.5,8.6,13.8,20.1,9.699999999999999,9.199999999999999,10.9,13.2,11.5,12,18.4,11.5,9.699999999999999,9.699999999999999,16.6,9.699999999999999,12,12,14.9,5.7,7.4,9.699999999999999,13.8,11.5,8,14.9,20.7,9.199999999999999,11.5,10.3,4.1,9.199999999999999,9.199999999999999,4.6,10.9,5.1,6.3,5.7,7.4,14.3,14.9,14.3,6.9,10.3,6.3,5.1,11.5,6.9,8.6,8,8.6,12,7.4,7.4,7.4,9.199999999999999,6.9,13.8,7.4,4,10.3,8,11.5,11.5,9.699999999999999,10.3,6.3,7.4,10.9,10.3,15.5,14.3,9.699999999999999,3.4,8,9.699999999999999,2.3,6.3,6.3,6.9,5.1,2.8,4.6,7.4,15.5,10.9,10.3,10.9,9.699999999999999,14.9,15.5,6.3,10.9,11.5,6.9,13.8,10.3,10.3,8,12.6,9.199999999999999,10.3,10.3,16.6,6.9,14.3,8,11.5],"temperature":[67,72,74,62,65,59,61,69,66,68,58,64,66,57,68,62,59,73,61,61,67,81,79,76,82,90,87,82,77,72,65,73,76,84,85,81,83,83,88,92,92,89,73,81,80,81,82,84,87,85,74,86,85,82,86,88,86,83,81,81,81,82,89,90,90,86,82,80,77,79,76,78,78,77,72,79,81,86,97,94,96,94,91,92,93,93,87,84,80,78,75,73,81,76,77,71,71,78,67,76,68,82,64,71,81,69,63,70,75,76,68],"month":[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],"day":[1,2,3,4,7,8,9,12,13,14,15,16,17,18,19,20,21,22,23,24,28,29,30,31,7,9,10,13,16,17,18,19,20,1,2,3,5,6,7,8,9,10,12,13,15,16,17,18,19,20,21,24,25,26,27,28,29,30,31,1,2,3,7,8,9,12,13,14,16,17,18,19,20,21,22,24,25,26,28,29,30,31,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,28,29,30]},"queue":[{"sender":"server","target":"scene","type":"add-plot","data":{"type":"scatter","variables":["solar radiation","ozone"],"id":"d865bccf-8d44-47a6-89e9-d58cc5fffb4e"}},{"sender":"server","target":"scene","type":"add-plot","data":{"type":"bar","variables":["day","ozone"],"reducer":{"initialfn":"() => 0","reducefn":"(x, y) => Math.max(x, y)","name":"max"},"id":"91552a68-7b36-4c4f-9dd3-b3d1b6c198bd"}}],"options":null},"evals":[],"jsHooks":[]}</script><p>Since maximum is a monoid, highlighting will work as expected!
However, only for one selected group (transient selection). When
multiple groups are selected, we may not be able to see all of the bars;
the reason for that is a bit more math. TODO</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-buja1996" class="csl-entry">
Buja, Andreas, Dianne Cook, and Deborah F Swayne. 1996.
<span>“Interactive High-Dimensional Data Visualization.”</span>
<em>Journal of Computational and Graphical Statistics</em> 5 (1): 78–99.
</div>
<div id="ref-fong2019" class="csl-entry">
Fong, Brendan, and David I Spivak. 2019. <em>An Invitation to Applied
Category Theory: Seven Sketches in Compositionality</em>. Cambridge
University Press.
</div>
<div id="ref-heer2012" class="csl-entry">
Heer, Jeffrey, and Ben Shneiderman. 2012. <span>“Interactive Dynamics
for Visual Analysis: A Taxonomy of Tools That Support the Fluent and
Flexible Use of Visualizations.”</span> <em>Queue</em> 10 (2): 30–55.
</div>
<div id="ref-lawvere2009" class="csl-entry">
Lawvere, F William, and Stephen H Schanuel. 2009. <em>Conceptual
Mathematics: A First Introduction to Categories</em>. Cambridge
University Press.
</div>
<div id="ref-milewski2018" class="csl-entry">
Milewski, Bartosz. 2018. <em>Category Theory for Programmers</em>.
Blurb.
</div>
<div id="ref-crosstalk2023" class="csl-entry">
RStudio Inc. 2023. <span>“Crosstalk.”</span> <a href="https://rstudio.github.io/crosstalk/" class="external-link">https://rstudio.github.io/crosstalk/</a>.
</div>
<div id="ref-swayne2003" class="csl-entry">
Swayne, Deborah F., Duncan Temple Lang, Andreas Buja, and Dianne Cook.
2003. <span>“<span class="nocase">GGobi: evolving from XGobi into an
extensible framework for interactive data visualization</span>.”</span>
<em>Comput. Statist. Data Anal.</em> 43 (4): 423–44. <a href="https://doi.org/10.1016/S0167-9473(02)00286-4" class="external-link">https://doi.org/10.1016/S0167-9473(02)00286-4</a>.
</div>
<div id="ref-theus2002" class="csl-entry">
Theus, Martin. 2002. <span>“<span class="nocase">Interactive Data
Visualization using Mondrian</span>.”</span> <em>J. Stat. Soft.</em> 7
(November): 1–9. <a href="https://doi.org/10.18637/jss.v007.i11" class="external-link">https://doi.org/10.18637/jss.v007.i11</a>.
</div>
<div id="ref-urbanek2011" class="csl-entry">
Urbanek, Simon. 2011. <span>“iPlots eXtreme: Next-Generation Interactive
Graphics Design and Implementation of Modern Interactive
Graphics.”</span> <em>Computational Statistics</em> 26 (3): 381–93.
</div>
<div id="ref-urbanek2003" class="csl-entry">
Urbanek, Simon, and Martin Theus. 2003. <span>“iPlots: High Interaction
Graphics for r.”</span> In <em>Proceedings of the 3rd International
Workshop on Distributed Statistical Computing</em>. Citeseer.
</div>
<div id="ref-ward2015" class="csl-entry">
Ward, Matthew O, Georges Grinstein, and Daniel Keim. 2015.
<em>Interactive Data Visualization: Foundations, Techniques, and
Applications</em>. CRC Press.
</div>
<div id="ref-ware2019" class="csl-entry">
Ware, Colin. 2019. <em>Information Visualization: Perception for
Design</em>. Morgan Kaufmann.
</div>
<div id="ref-wickham2016" class="csl-entry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data
Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org" class="external-link">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-wilke2019" class="csl-entry">
Wilke, Claus O. 2019. <em>Fundamentals of Data Visualization: A Primer
on Making Informative and Compelling Figures</em>. O’Reilly Media.
</div>
<div id="ref-wills2011" class="csl-entry">
Wills, Graham. 2011. <em>Visualizing Time: Designing Graphical
Representations for Statistical Data</em>. Springer Science &amp;
Business Media.
</div>
<div id="ref-wu2022" class="csl-entry">
Wu, Eugene. 2022. <span>“View Composition Algebra for Ad Hoc
Comparison.”</span> <em>IEEE Transactions on Visualization and Computer
Graphics</em> 28 (6): 2470–85.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adam Bartonicek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
