var plotscape=function(exports){"use strict";var __vite_style__=document.createElement("style");__vite_style__.textContent=`*:where(.tailwind,.tailwind *),:before:where(.tailwind,.tailwind *),:after:where(.tailwind,.tailwind *){box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before:where(.tailwind,.tailwind *),:after:where(.tailwind,.tailwind *){--tw-content: ""}.tailwind{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}.tailwind{margin:0;line-height:inherit}hr:where(.tailwind,.tailwind *){height:0;color:inherit;border-top-width:1px}abbr:where([title]):where(.tailwind,.tailwind *){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1:where(.tailwind,.tailwind *),h2:where(.tailwind,.tailwind *),h3:where(.tailwind,.tailwind *),h4:where(.tailwind,.tailwind *),h5:where(.tailwind,.tailwind *),h6:where(.tailwind,.tailwind *){font-size:inherit;font-weight:inherit}a:where(.tailwind,.tailwind *){color:inherit;text-decoration:inherit}b:where(.tailwind,.tailwind *),strong:where(.tailwind,.tailwind *){font-weight:bolder}code:where(.tailwind,.tailwind *),kbd:where(.tailwind,.tailwind *),samp:where(.tailwind,.tailwind *),pre:where(.tailwind,.tailwind *){font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small:where(.tailwind,.tailwind *){font-size:80%}sub:where(.tailwind,.tailwind *),sup:where(.tailwind,.tailwind *){font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub:where(.tailwind,.tailwind *){bottom:-.25em}sup:where(.tailwind,.tailwind *){top:-.5em}table:where(.tailwind,.tailwind *){text-indent:0;border-color:inherit;border-collapse:collapse}button:where(.tailwind,.tailwind *),input:where(.tailwind,.tailwind *),optgroup:where(.tailwind,.tailwind *),select:where(.tailwind,.tailwind *),textarea:where(.tailwind,.tailwind *){font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button:where(.tailwind,.tailwind *),select:where(.tailwind,.tailwind *){text-transform:none}button:where(.tailwind,.tailwind *),input:where([type=button]):where(.tailwind,.tailwind *),input:where([type=reset]):where(.tailwind,.tailwind *),input:where([type=submit]):where(.tailwind,.tailwind *){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring:where(.tailwind,.tailwind *){outline:auto}:-moz-ui-invalid:where(.tailwind,.tailwind *){box-shadow:none}progress:where(.tailwind,.tailwind *){vertical-align:baseline}::-webkit-inner-spin-button:where(.tailwind,.tailwind *),::-webkit-outer-spin-button:where(.tailwind,.tailwind *){height:auto}[type=search]:where(.tailwind,.tailwind *){-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration:where(.tailwind,.tailwind *){-webkit-appearance:none}::-webkit-file-upload-button:where(.tailwind,.tailwind *){-webkit-appearance:button;font:inherit}summary:where(.tailwind,.tailwind *){display:list-item}blockquote:where(.tailwind,.tailwind *),dl:where(.tailwind,.tailwind *),dd:where(.tailwind,.tailwind *),h1:where(.tailwind,.tailwind *),h2:where(.tailwind,.tailwind *),h3:where(.tailwind,.tailwind *),h4:where(.tailwind,.tailwind *),h5:where(.tailwind,.tailwind *),h6:where(.tailwind,.tailwind *),hr:where(.tailwind,.tailwind *),figure:where(.tailwind,.tailwind *),p:where(.tailwind,.tailwind *),pre:where(.tailwind,.tailwind *){margin:0}fieldset:where(.tailwind,.tailwind *){margin:0;padding:0}legend:where(.tailwind,.tailwind *){padding:0}ol:where(.tailwind,.tailwind *),ul:where(.tailwind,.tailwind *),menu:where(.tailwind,.tailwind *){list-style:none;margin:0;padding:0}dialog:where(.tailwind,.tailwind *){padding:0}textarea:where(.tailwind,.tailwind *){resize:vertical}input::-moz-placeholder:where(.tailwind,.tailwind *),textarea::-moz-placeholder:where(.tailwind,.tailwind *){opacity:1;color:#9ca3af}input::placeholder:where(.tailwind,.tailwind *),textarea::placeholder:where(.tailwind,.tailwind *){opacity:1;color:#9ca3af}button:where(.tailwind,.tailwind *),[role=button]:where(.tailwind,.tailwind *){cursor:pointer}:disabled:where(.tailwind,.tailwind *){cursor:default}img:where(.tailwind,.tailwind *),svg:where(.tailwind,.tailwind *),video:where(.tailwind,.tailwind *),canvas:where(.tailwind,.tailwind *),audio:where(.tailwind,.tailwind *),iframe:where(.tailwind,.tailwind *),embed:where(.tailwind,.tailwind *),object:where(.tailwind,.tailwind *){display:block;vertical-align:middle}img:where(.tailwind,.tailwind *),video:where(.tailwind,.tailwind *){max-width:100%;height:auto}[hidden]:where(.tailwind,.tailwind *){display:none}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.tw-absolute{position:absolute}.tw-relative{position:relative}.tw-left-0{left:0}.tw-right-0{right:0}.tw-top-0{top:0}.tw-z-10{z-index:10}.tw-z-30{z-index:30}.tw-z-50{z-index:50}.tw-m-1{margin:.25rem}.tw-flex{display:flex}.tw-grid{display:grid}.tw-size-full{width:100%;height:100%}.tw-h-5\\/6{height:83.333333%}.tw-h-full{height:100%}.tw-h-screen{height:100vh}.tw-w-5\\/6{width:83.333333%}.tw-w-8{width:2rem}.tw-w-fit{width:-moz-fit-content;width:fit-content}.tw-w-full{width:100%}.tw-select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.tw-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.tw-grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.tw-flex-row{flex-direction:row}.tw-flex-col{flex-direction:column}.tw-flex-wrap{flex-wrap:wrap}.tw-content-center{align-content:center}.tw-items-center{align-items:center}.tw-justify-start{justify-content:flex-start}.tw-justify-center{justify-content:center}.tw-gap-\\[1em\\]{gap:1em}.tw-rounded-md{border-radius:.375rem}.tw-rounded-bl-md{border-bottom-left-radius:.375rem}.tw-border{border-width:1px}.tw-border-black{--tw-border-opacity: 1;border-color:rgb(0 0 0 / var(--tw-border-opacity))}.tw-border-b-black{--tw-border-opacity: 1;border-bottom-color:rgb(0 0 0 / var(--tw-border-opacity))}.tw-border-l-black{--tw-border-opacity: 1;border-left-color:rgb(0 0 0 / var(--tw-border-opacity))}.tw-bg-\\[\\#deded9\\]{--tw-bg-opacity: 1;background-color:rgb(222 222 217 / var(--tw-bg-opacity))}.tw-bg-gray-100{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity))}.tw-bg-gray-300{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity))}.tw-bg-gray-400{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity))}.tw-bg-slate-200{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity))}.tw-bg-slate-800{--tw-bg-opacity: 1;background-color:rgb(30 41 59 / var(--tw-bg-opacity))}.tw-bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.tw-bg-opacity-80{--tw-bg-opacity: .8}.tw-p-1{padding:.25rem}.tw-p-10{padding:2.5rem}.tw-px-2{padding-left:.5rem;padding-right:.5rem}.tw-px-3{padding-left:.75rem;padding-right:.75rem}.tw-py-1{padding-top:.25rem;padding-bottom:.25rem}.tw-py-10{padding-top:2.5rem;padding-bottom:2.5rem}.tw-text-center{text-align:center}.tw-font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.tw-text-sm{font-size:.875rem;line-height:1.25rem}.tw-text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity))}.tw-text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.tw-shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.tw-outline-none{outline:2px solid transparent;outline-offset:2px}.tw-outline{outline-style:solid}.tw-outline-2{outline-width:2px}.tw-outline-slate-600{outline-color:#475569}.tw-drop-shadow-md{--tw-drop-shadow: drop-shadow(0 4px 3px rgb(0 0 0 / .07)) drop-shadow(0 2px 2px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.hover\\:tw-bg-gray-400:hover{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity))}.hover\\:tw-bg-gray-500:hover{--tw-bg-opacity: 1;background-color:rgb(107 114 128 / var(--tw-bg-opacity))}.hover\\:tw-bg-slate-200:hover{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity))}
`,document.head.appendChild(__vite_style__);const METADATA=Symbol("metadata");var Metadata;(e=>{function n(l){return l[METADATA]={},l}e.of=n;function t(l){return!!l[METADATA]}e.hasMetadata=t;function s(l,a){var r;return!!((r=l[METADATA])!=null&&r[a])}e.has=s;function u(l,a){return Array.isArray(a)?a.map(r=>d(l,r)):d(l,a)}e.get=u;function d(l,a){var r;return a==="length"&&Array.isArray(l)?l.length:(r=l[METADATA])==null?void 0:r[a]}function f(l,a){t(l)||(l[METADATA]={});for(const[r,i]of Object.entries(a))l[METADATA][r]=i}e.set=f;function o(l,a,r){if(!t(l))return;t(a)||(a[METADATA]={});const i=r??Object.keys(l[METADATA]);for(const c of i){let p=u(l,c);isSerializable(p)&&(p=structuredClone(p)),a[METADATA][c]=p}}e.copy=o})(Metadata||(Metadata={}));var Getter;(e=>{function n(o){if(typeof o=="function")return o;if(Array.isArray(o)){const l=a=>o[a];return Metadata.set(l,{length:o.length}),l}if(isTypedArray(o)){const l=a=>o[a];return Metadata.set(l,{length:o.length}),l}return()=>o}e.of=n;function t(o){return()=>o}e.constant=t;function s(o,l){const a=e.of(o),r=i=>a(l[i]);return isObject(o)&&Metadata.copy(o,r),Metadata.set(r,{length:l.length}),r}e.proxy=s;function u(o){const l=o.map(e.of),a=r=>l.map(i=>i(r));return Metadata.copy(o[0],a,["length"]),a}e.multi=u;function d(o){const l={};for(const a of Reflect.ownKeys(o))l[a]=e.of(o[a]);return l}e.mapObject=d;function f(o,l){const a=e.of(l),r=Array(o);for(let i=0;i<o;i++)r[i]=a(i);return r}e.array=f})(Getter||(Getter={}));function identity(e){return e}const just=e=>()=>e,zero=just(0),one=just(1);function inc(e){return e+1}function dec(e){return e-1}function call(e){return e()}function bimap(e,n,t){if(e.length!==n.length)throw new Error("Arrays must be of the same length");const s=Array(e.length);for(let u=0;u<e.length;u++)s[u]=t(e[u],n[u]);return s}function square(e){return e**2}const sqrt=Math.sqrt,log10=Math.log10;function exp10(e){return 10**e}const max=Math.max;function diff(e,n){return e-n}function sum(e,n){return e+n}function prod(e,n){return e*n}function trunc(e,n=0,t=1){return Math.min(Math.max(e,n),t)}function rangeInverse(e,n){return 1/(n-e)}function invertRange(e,n){const t=rangeInverse(e,n);return[-e*t,t-e*t]}function round(e,n=0){return Math.round(e*10**n)/10**n}function compareAlphaNumeric(e,n){return e.localeCompare(n,"en",{numeric:!0})}function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}function toLowerCase(e){return e.toLocaleLowerCase()}function toUpperCase(e){return e.toLocaleUpperCase()}function stripWS(e){return e.replace(/\s/g,"")}function last(e){return e[e.length-1]}function rep(e,n){return Array(n).fill(e)}function seq(e,n,t){const s=Math.abs(n-e);t=t??Math.ceil(s)+1;const u=s/(t-1),d=n>=e?1:-1;return Array.from(Array(t),(f,o)=>e+d*u*o)}function seqLength(e,n){return Array.from(Array(n),(t,s)=>e+s)}function subset(e,n){const t=Array(n.length);for(let s=0;s<n.length;s++)t[s]=e[n[s]];return t}function remove(e,n){const t=e.indexOf(n);t!==-1&&e.splice(t,1)}function ordered(e,n){const t=Array(n.length);for(let s=0;s<n.length;s++)t[n[s]]=e[s];return t}function orderIndices(e){const n=e.toSorted(diff),t={},s={};for(let u=0;u<n.length;u++){const d=e[u];s[d]=s[d]+1||0,t[u]=n.indexOf(d)+s[d]}return Object.values(t)}function orderBy(e,n){const t=Array(e.length);for(let s=0;s<e.length;s++)t[s]=e[n[s]];for(let s=0;s<e.length;s++)e[s]=t[s]}function orderIndicesByTable(e,n){const t=Array(e.length);for(let s=0;s<e.length;s++)t[s]=n.indexOf(e[s]);return t}function minmax(e){let[n,t]=[1/0,-1/0];for(let s=0;s<e.length;s++)n=Math.min(n,e[s]),t=Math.max(t,e[s]);return[n,t]}function cumsum(e){const n=Array(e.length);n[0]=e[0];for(let t=1;t<e.length;t++)n[t]=e[t]+n[t-1];return n}function randomInteger(e,n){return Math.floor(e+Math.random()*n)}function uniqueIntegers(e,n,t=n-e){const s=n-e,u=[],d=new Set;for(;u.length<Math.min(t,s);){let f=randomInteger(e,n);for(;d.has(f);)f=randomInteger(e,n);u.push(f),d.add(f)}return u}async function fetchJSON(e){return await(await fetch(e)).json()}function merge(e,n){return{...e,...n}}function copyValues(e,n){if(e!==n){if(isTypedArray(e)&&isTypedArray(n))n.set(e);else if(Array.isArray(e)&&Array.isArray(n)){n.length=e.length;for(let t=0;t<e.length;t++)n[t]=e[t]}}}function copyProps(e,n){for(const[t,s]of Object.entries(e))Array.isArray(s)&&Array.isArray(e[t])?copyValues(s,e[t]):n[t]=s}function applyDirection(e,n){return .5*(1-n)+n*e}function prettyBreaks(e,n,t=4){const s=(n-e)/t,u=Math.floor(Math.log10(s)),d=[1,2,4,5,10];let[f,o]=[1/0,0];for(let p=0;p<d.length;p++){const x=(d[p]*10**u-s)**2;x<f&&([f,o]=[x,d[p]])}const l=10**u*o,a=Math.ceil(e/l)*l,r=Math.floor(n/l)*l,i=Math.round((r-a)/l),c=[];for(let p=0;p<i+1;p++){const x=a+p*l;c.push(x)}return c}function binBreaks(e,n){let{width:t,anchor:s,nBins:u}=n||{};const[d,f]=minmax(e),o=f-d;u=u??(t?Math.ceil(o/t)+1:10),t=t??o/(u-1),s=s??d;const l=d-t+(s-d)%t,a=f+t-(f-s)%t,r=Array(u+2);r[0]=l,r[r.length-1]=a;for(let i=1;i<r.length-1;i++)r[i]=l+i*t;return r}function tw(e){return e.trim().split(/\s+/)}function addTailwind(e,n){for(const t of n.trim().split(/\s+/))e.classList.add(t)}function removeTailwind(e,n){for(const t of n.trim().split(/\s+/))e.classList.remove(t)}function throttle(e,n){let t=0;return function(...s){const u=new Date().getTime();u-t<n||(t=u,e(...s))}}function timeExecution(e){const n=performance.now();return e(),performance.now()-n}function segmentToPointVec(e){const[n,t,s,u]=e;return[n,t,s-n,u-t]}function inRange(e,n,t){return!(e<n)&&!(e>t)}function segmentsIntersect(e,n){let[t,s,u,d]=segmentToPointVec(e),[f,o,l,a]=segmentToPointVec(n);const r=l*d-u*a,i=((t-f)*d-(s-o)*u)/r,c=-(-(t-f)*a+(s-o)*l)/r;return inRange(i,0,1)&&inRange(c,0,1)}function rectSegmentIntersect(e,n){const[t,s,u,d]=e;return segmentsIntersect([t,s,u,s],n)||segmentsIntersect([t,s,t,d],n)||segmentsIntersect([u,s,u,d],n)||segmentsIntersect([t,d,u,d],n)}function pointInRect(e,n){const[t,s]=e;let[u,d,f,o]=n;return[u,f]=[u,f].sort(diff),[d,o]=[d,o].sort(diff),!(t<u||t>f||s<d||s>o)}function rectsIntersect(e,n){const[t,s]=[e[0],e[2]].sort(diff),[u,d]=[e[1],e[3]].sort(diff),[f,o]=[n[0],n[2]].sort(diff),[l,a]=[n[1],n[3]].sort(diff);return!(s<f||t>o||d<l||u>a)}function addIndexed(e,n,t){const u=Object.keys(e).filter(o=>o.replace(/[0-9]*$/,"")===n);if(u.length===0){e[`${n}1`]=t;return}const d=u.map(o=>parseInt(o.match(/[0-9]*$/)[0],10)),f=Math.max(...d);e[`${n}${f+1}`]=t}function minDecimal(e){let n=1/0;for(let t=0;t<e.length;t++)e[t]!==0&&(n=Math.min(n,Math.log10(Math.abs(e[t]))));return n>3?0:Math.floor(Math.abs(n))+2}function formatText(e,n={lowercase:!0,capitalize:!0,split:!0}){return n!=null&&n.split&&(e=e.replace(/_/g," ")),n!=null&&n.lowercase&&(e=e.toLocaleLowerCase()),n!=null&&n.capitalize&&(e=capitalize(e)),e}function formatLabel(e){if(typeof e=="string")return e;if(e===0)return e.toString();const n=Math.floor(Math.log10(Math.abs(e)));return n>=3?round(e).toString():n<=-3?round(e,-n+1).toString():round(e,2).toString()}function formatAxisLabels(e,n){if(!isNumberArray(e))return e;const t=(n==null?void 0:n.tens)??4,s=o=>o!=0&&Math.abs(Math.log10(o))>t,u=(n==null?void 0:n.decimals)??minDecimal(e);e=e.map(o=>round(o,u));const f=minmax(e).some(s)?superscriptFn:noSuperscriptFn;return e.map(f)}function superscriptFn(e){return e===0?"0":exponentialToSuperscript(e.toExponential())}function noSuperscriptFn(e){return e===0?"0":parseFloat(e.toPrecision(12)).toString()}function exponentialToSuperscript(e){let[n,t]=e.split("e");return t=convertToSuperscript(t),n+"×10"+t}const sups={"-":"⁻","+":"",0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹"};function convertToSuperscript(e){return e.split("").map(n=>sups[n]).join("")}function isDefined(e){return e!=null}const primitives=["string","number","boolean","undefined"];function isPrimitive(e){return e===null||primitives.includes(typeof e)}function isFunction(e){return typeof e=="function"}function isSerializable(e){if(isPrimitive(e)||e===null)return!0;if(isFunction(e))return!1;const n=isObject(e)?Object.values(e):e;for(const t of n)if(!isSerializable(t))return!1;return!0}function isObject(e){return typeof e=="object"&&e!==null}function isTypedArray(e){return ArrayBuffer.isView(e)}function isNumber(e){return typeof e=="number"}function isIntegerString(e){return/^[0-9]+/.test(e)}function isNumberArray(e){return Array.isArray(e)&&isNumber(e[0])&&isNumber(last(e))}function isStringArray(e){return typeof e[0]=="string"&&typeof last(e)=="string"}function isEventTarget(e){return"addEventListener"in e}function findLength(e){for(const t of e){if(!t)continue;const s=Metadata.get(t,"length");if(s)return s}const n="At least one variable needs to be of fixed length";throw new Error(n)}function applyWith(...e){return function(n){return n(...e)}}function row(e,n){const t={};for(const[s,u]of Object.entries(e))t[s]=Getter.of(u)(n);return t}function selector(e){return function(n){return n[e]}}function keysToSelectors(e){return function(n){return e.map(t=>n[t])}}function splitNumericSuffix(e){let n=e.length-1;for(;n>0&&/[0-9]/.test(e[n]);)n--;return n+=1,[e.substring(0,n),e.substring(n,e.length)]}function filterIndices(e,n){const t=[];for(let s=0;s<e.length;s++)n(e[s])&&t.push(s);return t}function stringArraysMatch(e,n){if(e.length!==n.length)return!1;const t=e.toSorted(compareAlphaNumeric).join(""),s=n.toSorted(compareAlphaNumeric).join("");return t===s}function stringifyFunction(e){return""+e}function deepModifyProp(e,n,t,s={}){n in e&&(s[n]=t(e[n]));for(const u of Object.values(e))isObject(u)&&deepModifyProp(u,n,t,s)}const LISTENERS=Symbol("listeners");var Reactive;(e=>{function n(){return function(r){return{...r,[LISTENERS]:{}}}}e.of=n;function t(r){return(r==null?void 0:r[LISTENERS])!==void 0}e.isReactive=t;function s(r,i,c,p){if(!e.isReactive(r))return;p!=null&&p.throttle&&(c=throttle(c,p.throttle));const x=(p==null?void 0:p.priority)??1,w=r[LISTENERS],y={priority:x,callback:c};w[i]||(w[i]=[]),w[i].includes(y)||w[i].push(y),w[i].sort((g,v)=>g.priority-v.priority)}e.listen=s;function u(r,i,c){if(!t(r))return;const p=r[LISTENERS][i];if(p)for(const{callback:x}of p)x(c)}e.dispatch=u;function d(r,i,c,p,x){if(!t(r)||!t(i))return;s(r,c,()=>u(i,p??c),x)}e.propagate=d;function f(r,i){t(r)&&(Object.assign(r,i(r)),u(r,"changed"))}e.set=f;function o(r,i,c){if(!t(r))return;const p=r[LISTENERS][i]??[];for(let x=0;x<p.length;x++)p[x].callback===c&&p.splice(x,1)}e.remove=o;function l(r,i){t(r)&&r[LISTENERS][i]&&(r[LISTENERS][i].length=0)}e.removeAll=l;function a(r){if(!t(r))return;const i=r[LISTENERS];if(i)for(const c of Object.values(i))c.length=0}e.removeAllListeners=a})(Reactive||(Reactive={}));const METHODS=Symbol("methods");exports.Polymorphic=void 0,(e=>{function n(u){const d=function(...f){return t(d,u,f[0].type)(...f)};return d[METHODS]={},d}e.of=n;function t(u,d,f){return u[METHODS][f]??d}e.dispatch=t;function s(u,d,f){u[METHODS][d]=f}e.set=s})(exports.Polymorphic||(exports.Polymorphic={})),exports.Expanse=void 0,(e=>{e.normalize=exports.Polymorphic.of(n),e.unnormalize=exports.Polymorphic.of(t),e.train=exports.Polymorphic.of(s),e.breaks=exports.Polymorphic.of(u),e.reorder=exports.Polymorphic.of(f),e.reset=exports.Polymorphic.of(d);function n(g,v){throw new Error(`Method 'normalize' not implemented for expanse of type '${g.type}'`)}function t(g,v){throw new Error(`Method 'unnormalize' not implemented for expanse of type '${g.type}'`)}function s(g,v,b){throw new Error(`Method 'train' not implemented for expanse of type '${g.type}'`)}e.trainDefault=s;function u(g,v,b){throw new Error(`Method 'breaks' not implemented for expanse of type '${g.type}'`)}function d(g,v){const{defaults:b}=g;for(const[S,M]of Object.entries(b))Array.isArray(M)&&Array.isArray(g.props[S])?copyValues(M,g.props[S]):g.props[S]=M;v!=null&&v.silent||Reactive.dispatch(g,"changed")}e.resetDefault=d;function f(g,v){throw new Error(`Method 'reorder' not implemented for expanse of type '${g.type}'`)}function o(){return Reactive.of()({})}e.base=o;function l(g,v,b){const{frozen:S,props:M}=g,I=v({...M});if(!(b!=null&&b.unfreeze))for(const z of S)delete I[z];for(const z of Object.keys(I))I[z]===g.props[z]&&delete I[z];copyProps(I,g.props),b!=null&&b.default&&copyProps(I,g.defaults),b!=null&&b.silent||Reactive.dispatch(g,"changed")}e.set=l;function a(g,v){for(const b of v)g.frozen.includes(b)||g.frozen.push(b)}e.freeze=a;function r(g){return g.type==="continuous"||g.type==="split"}e.isContinuous=r;function i(g){return g.type==="point"}e.isPoint=i;function c(g){return g.type==="point"||g.type==="band"}e.isDiscrete=c;function p(g){return g.type==="band"}e.isBand=p;function x(g){return g.type==="compound"}e.isCompound=x;function w(g){return g.type==="split"}e.isSplit=w;function y(g){return!x(g)&&!w(g)}e.isUnivariate=y})(exports.Expanse||(exports.Expanse={}));var ExpanseBand;(e=>{const n="band";function t(r=[]){const i=exports.Expanse.base(),[c,p]=[!1,seqLength(0,r.length)],x=Array(r.length).fill(1),w=cumsum(x),y={labels:r,ordered:c,order:p,weights:x,cumulativeWeights:w},g=structuredClone(y);return{...i,type:n,props:y,defaults:g,frozen:[]}}e.of=t,exports.Polymorphic.set(exports.Expanse.normalize,n,s),exports.Polymorphic.set(exports.Expanse.unnormalize,n,u),exports.Polymorphic.set(exports.Expanse.train,n,d),exports.Polymorphic.set(exports.Expanse.breaks,n,o),exports.Polymorphic.set(exports.Expanse.reorder,n,f);function s(r,i){const{labels:c}=r.props,p=c.indexOf(i);if(p===-1)throw new Error(`Label ${i} not found in: ${c}`);return a(r,p)}e.normalize=s;function u(r,i){const{labels:c}=r.props,p=Math.round((2*i*c.length-1)/2);return c[p]}e.unnormalize=u;function d(r,i,c){const{props:p}=r,{order:x}=p,w=Array.from(new Set(i)).sort(compareAlphaNumeric);if(!x.length){for(let b=0;b<w.length;b++)x[b]=b;r.defaults.order=[...x],p.ordered=!1}const y=Array(w.length).fill(1),g=cumsum(ordered(y,x)),v={labels:w,weights:y,cumulativeWeights:g};for(const[b,S]of Object.entries(v))copyValues(S,r.props[b]),c!=null&&c.default&&copyValues(S,r.defaults[b]);exports.Expanse.set(r,()=>({}),c)}e.train=d;function f(r,i){const{props:c,defaults:p}=r,{order:x,weights:w,cumulativeWeights:y}=r.props;if(!i){copyValues(p.order,x),copyValues(cumsum(ordered(w,x)),y),c.ordered=!1,Reactive.dispatch(r,"changed");return}copyValues(i,x),copyValues(cumsum(ordered(w,i)),y),c.ordered=!0,Reactive.dispatch(r,"changed")}e.reorder=f;function o(r){const{labels:i,order:c}=r.props;return ordered(i,c)}e.breaks=o;function l(r,i){const{props:c,defaults:p}=r;if(i=i??Array(c.labels.length).fill(1),i.length!=c.labels.length){const y="The length of the weights must match the length of labels";throw new Error(y)}const{order:x}=c,w=cumsum(ordered(i,x));copyValues(i,c.weights),copyValues(i,p.weights),copyValues(w,c.cumulativeWeights),copyValues(w,p.cumulativeWeights),Reactive.dispatch(r,"changed")}e.setWeights=l;function a(r,i){const{order:c,cumulativeWeights:p}=r.props;i=c[i];const x=p[i-1]??0,w=p[i],y=last(p);return(x+w)/2/y}})(ExpanseBand||(ExpanseBand={}));var ExpanseContinuous;(e=>{const n="continuous";function t(l=0,a=1){const r=exports.Expanse.base(),[i,c,p,x]=[identity,identity,0,!1],w={min:l,max:a,offset:p,ratio:x,trans:i,inv:c},y={...w,trans:i,inv:c};return{...r,type:n,props:w,defaults:y,frozen:[]}}e.of=t,exports.Polymorphic.set(exports.Expanse.normalize,n,s),exports.Polymorphic.set(exports.Expanse.unnormalize,n,u),exports.Polymorphic.set(exports.Expanse.train,n,d),exports.Polymorphic.set(exports.Expanse.breaks,n,f);function s(l,a){const{min:r,max:i,offset:c,trans:p}=l.props;return(p(a-c)-p(r))/(p(i)-p(r))}e.normalize=s;function u(l,a){const{min:r,max:i,offset:c,trans:p,inv:x}=l.props;return x(p(r)+a*(p(i)-p(r)))+c}e.unnormalize=u;function d(l,a,r){const{ratio:i}=l.props;let c=Metadata.get(a,"min"),p=Metadata.get(a,"max");(!c||!p)&&([c,p]=minmax(a)),c=i||r!=null&&r.ratio?0:c,exports.Expanse.set(l,()=>({min:c,max:p}),r)}e.train=d;function f(l,a=0,r=1){let[i,c]=[a,r].map(x=>u(l,x));return[i,c]=[i,c].sort(diff),prettyBreaks(i,c,4)}e.breaks=f;function o(l){const{min:a,max:r}=l.props;return r-a}e.range=o})(ExpanseContinuous||(ExpanseContinuous={})),exports.Scale=void 0,(e=>{function n(h,m){const[R,T,C]=[0,1,1],[k,P]=[1,1],G={zero:R,one:T,direction:C,scale:k,mult:P},A={...G},[E,F]=[[],[]],D=Reactive.of()({domain:h,codomain:m,props:G,defaults:A,frozen:F,linked:E});return Reactive.propagate(h,D,"changed"),Reactive.propagate(m,D,"changed"),D}e.of=n;function t(){return e.of(ExpanseContinuous.of(),ExpanseContinuous.of())}e.linear=t;function s(h,m){const{domain:R,codomain:T,props:C}=h;let k=exports.Expanse.normalize(R,m);return Array.isArray(k)?k=k.map(P=>d(P,C)):k=d(k,C),exports.Expanse.unnormalize(T,k)}e.pushforward=s;function u(h,m){const{domain:R,codomain:T,props:C}=h;let k=exports.Expanse.normalize(T,m);return Array.isArray(k)?k=k.map(P=>f(P,C)):k=f(k,C),exports.Expanse.unnormalize(R,k)}e.pullback=u;function d(h,m){const{zero:R,one:T,direction:C,scale:k,mult:P}=m;return h=h*k*P,h=R+h*(T-R),o(h,C)}function f(h,m){const{zero:R,one:T,direction:C,scale:k,mult:P}=m;return h=o(h,C),h=(h-R)/(T-R),h/(k*P)}function o(h,m){return .5*(1-m)+m*h}function l(h,m,R){const{linked:T,frozen:C,props:k}=h,P=m({...k});if(!(R!=null&&R.unfreeze))for(const G of C)delete P[G];Object.assign(k,P),R!=null&&R.default&&Object.assign(h.defaults,P),R!=null&&R.silent||Reactive.dispatch(h,"changed");for(const G of T)e.set(G,m,R)}e.set=l;function a(h,m){Reactive.removeAll(h.domain,"changed"),h.domain=m,Reactive.propagate(h.domain,h,"changed")}e.setDomain=a;function r(h,m){Reactive.removeAll(h.codomain,"changed"),h.codomain=m,Reactive.propagate(h.codomain,h,"changed")}e.setCodomain=r;function i(h,m){for(const R of m)h.frozen.includes(R)||h.frozen.push(R)}e.freeze=i;function c(h){e.set(h,m=>({direction:-1*m.direction}))}e.flip=c;function p(h,m){let{direction:R,zero:T,one:C}=h.props;T+=R*m,C+=R*m,e.set(h,()=>({zero:T,one:C}))}e.move=p;function x(h,m,R,T){const{zero:C,one:k,direction:P}=h.props,G=k-C;P===-1&&([m,R]=[1-m,1-R]),[m,R]=[m,R].map(A=>(A-C)/G),[m,R]=invertRange(m,R),P===-1&&([m,R]=[1-m,1-R]),e.set(h,()=>({zero:m,one:R}),T)}e.expand=x;function w(h,m,R){if(((R==null?void 0:R.name)??!0)&&Metadata.has(m,"name")&&Metadata.copy(m,h,["name"]),typeof m[0]=="string"&&exports.Expanse.isContinuous(h.domain)){const C=Array.from(new Set(m));h.domain=ExpanseBand.of(C)}exports.Expanse.train(h.domain,m,R)}e.train=w;function y(h,m){Object.assign(h.props,h.defaults),m!=null&&m.silent||Reactive.dispatch(h,"changed")}e.reset=y;function g(h){exports.Expanse.reset(h.domain,{silent:!0}),exports.Expanse.reset(h.codomain,{silent:!0}),e.reset(h)}e.restore=g;function v(h){const{domain:m,codomain:R,props:T}=h;let{zero:C,one:k}=T;[C,k]=invertRange(C,k);let P=exports.Expanse.breaks(m,C,k),G=formatAxisLabels(P),A;return exports.Expanse.isCompound(m)?(G=formatAxisLabels(P,{decimals:1}),m.commonScale&&(P=exports.Expanse.normalize(m,P)),P=P.map(E=>d(E,T)),A=exports.Expanse.unnormalize(h.codomain,P)):exports.Expanse.isSplit(R)?A=e.pushforward(h,P):A=P.map(E=>e.pushforward(h,E)),{labels:G,positions:A}}e.breaks=v;function b(h,m){for(const R of m)h.linked.includes(R)||h.linked.push(R)}e.link=b;function S(h,m){for(const R of m)R.codomain=h.codomain}e.shareCodomain=S;function M(h){return h.props.one-h.props.zero}e.unitRange=M;function I(h){const{domain:m}=h;if(exports.Expanse.isContinuous(m))return ExpanseContinuous.range(m)/M(h)}e.domainRange=I;function z(h){const{codomain:m}=h;if(exports.Expanse.isContinuous(m))return ExpanseContinuous.range(m)*M(h)}e.codomainRange=z;function _(h){if(!O(h))throw new Error("Both domain and codomain need to be continuous");const{domain:m,codomain:R}=h,T=ExpanseContinuous.range(m);return ExpanseContinuous.range(R)*M(h)/T}e.unitRatio=_;function O(h){const{domain:m,codomain:R}=h;return exports.Expanse.isContinuous(m)&&exports.Expanse.isContinuous(R)}e.isContinuous=O})(exports.Scale||(exports.Scale={})),exports.Factor=void 0,(e=>{e.POSITIONS=Symbol("positions"),e.CHILD_INDICES=Symbol("child-indices");function n(r,i,c,p){return Reactive.of()({type:r,cardinality:i,indices:c,data:p})}e.of=n;function t(r,i){i.cardinality=r.cardinality,copyValues(r.indices,i.indices);for(const c of Reflect.ownKeys(r.data))Array.isArray(r.data[c])&&Array.isArray(i.data[c])?(copyValues(r.data[c],i.data[c]),Metadata.copy(r.data[c],i.data[c])):i.data[c]=r.data[c]}e.copyFrom=t;function s(r,i){if([r,i].some(c=>c.type==="bijection"))return!0;if(r.indices.length!==i.indices.length)throw new Error("Factors do not have matching length")}function u(r,i){const p=new Uint32Array(seq(0,r)),x=g=>[g];i=i??{};for(const g of Object.values(i))Metadata.set(g,{queryable:!0});const w="bijection",y={...i,[e.POSITIONS]:x};return n(w,1/0,p,y)}e.bijection=u;function d(r){const c=new Uint32Array(r).fill(0),p=()=>Array.from(c),x="constant",w={[e.POSITIONS]:p};return n(x,1,c,w)}e.mono=d;function f(r,i){const c=r.map(v=>v.toString());i=i??Array.from(new Set(c)).sort(compareAlphaNumeric),Metadata.has(r,"name")&&Metadata.copy(r,i,["name"]);const p=new Uint32Array(r.length),x={};for(let v=0;v<c.length;v++){const b=i.indexOf(c[v]);x[b]||(x[b]=[]),p[v]=b,x[b].push(v)}Metadata.set(i,{queryable:!0,isDimension:!0});const w=Object.values(x),y="surjection",g={label:i,[e.POSITIONS]:w};return n(y,i.length,p,g)}e.from=f;function o(r,i){function c(){const x=(i==null?void 0:i.breaks)??binBreaks(r,i),w=new Set,y=new Uint32Array(r.length),g={};for(let T=0;T<r.length;T++){const C=x.findIndex(k=>k>=r[T])-1;g[C]||(g[C]=[]),y[T]=C,g[C].push(T),w.add(C)}const v=Array.from(w).sort(diff);for(let T=0;T<y.length;T++)y[T]=v.indexOf(y[T]);const[b,S]=[[],[]];for(let T=0;T<v.length;T++)b.push(x[v[T]]),S.push(x[v[T]+1]);const[M,I]=[x[v[0]],x[last(v)+1]],z=`min of ${Metadata.get(r,"name")}`,_=`max of ${Metadata.get(r,"name")}`,O={queryable:!0,isDimension:!0};Metadata.set(b,{min:M,max:I,name:z,...O}),Metadata.set(S,{min:M,max:I,name:_,...O}),Metadata.copy(r,x,["name"]);const h=Object.values(g),m="surjection",R={binMin:b,binMax:S,breaks:x,[e.POSITIONS]:h};return n(m,v.length,y,R)}const p=c();return i&&Reactive.isReactive(i)&&Reactive.listen(i,"changed",()=>{const x=c();e.copyFrom(x,p),Reactive.dispatch(p,"changed")}),p}e.bin=o;function l(r,i){s(r,i),r.data[e.CHILD_INDICES]=[];function c(){if(r.type==="bijection"){const k={};for(const D of Reflect.ownKeys(r.data))k[D]=Getter.of(r.data[D]),Metadata.copy(r.data[D],k[D]);for(const D of Reflect.ownKeys(i.data))k[D]=Getter.proxy(i.data[D],i.indices),Metadata.copy(i.data[D],k[D]);const P="bijection",G=i.indices.length,A=new Uint32Array(i.indices.length),E=n(P,G,A,k);E.parent=r;const F=Array.from(Array(A.length),(D,L)=>[L]);return copyValues(F,r.data[e.CHILD_INDICES]),E}if(r.type==="constant"){const{type:k,data:P,cardinality:G,indices:A}=i,E=n(k,G,A,P);return E.parent=r,E}const x=Math.max(r.cardinality,i.cardinality)+1,w=new Set,y=new Uint32Array(r.indices.length),g={},v={},b={},S=Getter.of(r.indices),M=Getter.of(i.indices);for(let k=0;k<r.indices.length;k++){const[P,G]=[S(k),M(k)],A=x*P+G;A in v||(v[A]=P,b[A]=G,g[A]=[]),y[k]=A,g[A].push(k),w.add(A)}const I=Array.from(w).sort(diff),z={};for(const k of Object.keys(v))z[parseInt(k)]=I.indexOf(parseInt(k));for(let k=0;k<y.length;k++)y[k]=z[y[k]];const _={};for(const[k,P]of Object.entries(v))P in _||(_[P]=[]),_[P].push(z[parseInt(k)]);const O=Object.values(v),h=Object.values(b),m={};for(let k of Reflect.ownKeys(r.data)){let P=k;if(typeof k=="string")for(;P in m;)k+="$";const[G,A]=[r.data[k],O],E=Array.isArray(G)?subset(G,A):Getter.proxy(G,A);Metadata.copy(G,E),m[P]=E}for(let k of Reflect.ownKeys(i.data)){let P=k;if(typeof k=="string")for(;P in m;)P+="$";const[G,A]=[i.data[k],h],E=Array.isArray(G)?subset(G,A):Getter.proxy(G,A);Metadata.copy(G,E),m[P]=E}const R="surjection";m[e.POSITIONS]=Object.values(g);const T=n(R,I.length,y,m);T.parent=r;const C=Object.values(_);return copyValues(C,r.data[e.CHILD_INDICES]),T}const p=c();return Reactive.listen(r,"changed",()=>{const x=c();e.copyFrom(x,p),Reactive.dispatch(p,"changed")},{priority:2}),Reactive.listen(i,"changed",()=>{const x=c();e.copyFrom(x,p),Reactive.dispatch(p,"changed")},{priority:2}),p}e.product=l;function a(r,i){const c={};for(let p=0;p<i.indices.length&&(c[i.indices[p]]=r.indices[p],!(Object.keys(c).length>=i.cardinality));p++);return Object.values(c)}e.parentIndices=a})(exports.Factor||(exports.Factor={}));const Transient=255,Group={Base:7,First:6,Second:5,Third:4,BaseTransient:3,FirstTransient:2,SecondTransient:1,ThirdTransient:0},LAYER=Symbol("layer");var Marker;(e=>{function n(r){const i=Transient,c=new Uint32Array(r).fill(Group.Base),p=[],x="surjection",w=[0,1,2,3,4,5,6,7],y=exports.Factor.of(x,8,c,{[LAYER]:w});Metadata.set(w,{queryable:!0});const g=Reactive.of()({group:i,indices:c,transientIndices:p,factor:y});return Reactive.propagate(g,y,"changed"),g}e.of=n;function t(r,i){r.group=i}e.setGroup=t;function s(r,i,c){const p=(c==null?void 0:c.group)??r.group;if(d(r,{silent:!0}),p===Transient){for(let x=0;x<i.length;x++){const w=i[x];r.indices[w]=l(r.indices[w])}r.transientIndices=i}else for(let x=0;x<i.length;x++){const w=i[x];r.indices[w]=p}c!=null&&c.silent||Reactive.dispatch(r,"changed")}e.update=s;function u(r,i){for(let c=0;c<r.indices.length;c++)r.indices[c]=Group.Base;i!=null&&i.silent||(Reactive.dispatch(r,"changed"),Reactive.dispatch(r,"cleared"))}e.clearAll=u;function d(r,i){for(let c=0;c<r.transientIndices.length;c++){const p=r.transientIndices[c];r.indices[p]=a(r.indices[p])}i!=null&&i.silent||(Reactive.dispatch(r,"changed"),Reactive.dispatch(r,"cleared"))}e.clearTransient=d;function f(r){const{factor:i,indices:c}=r;return p=>i.data[LAYER][c[p]]}e.getLayer=f;function o(r){return!(r&4)}e.isTransient=o;function l(r){return r&-5}function a(r){return r|4}})(Marker||(Marker={}));var Reduced;(e=>{e.PARENT=Symbol("parent"),e.VALUES=Symbol("values"),e.INDICES=Symbol("indices"),e.FACTOR=Symbol("factor"),e.REDUCER=Symbol("reducer"),e.ORIGINAL_VALUES=Symbol("original-values");function n(c,p,x,w){const y=c;return y[e.VALUES]=c,y[e.FACTOR]=p,y[e.REDUCER]=x,y[e.ORIGINAL_VALUES]=c,w&&t(y,w),y}e.of=n;function t(c,p){c[e.PARENT]=p}e.setParent=t;function s(c){const[,p,x,w]=i(c);if(!w)throw new Error("Parent missing");const y=exports.Factor.parentIndices(o(w),p),g=subset(w,y),v=n(g,o(w),x,l(w));return a(v,w),r(v,y),v[e.ORIGINAL_VALUES]=c[e.ORIGINAL_VALUES],Metadata.copy(c,v,["name","queryable","reduced"]),v}e.parent=s;function u(c){const[p,x,w,y,g]=i(c);if(!y)throw new Error("Cannot stack a without a parent");const v=exports.Factor.parentIndices(o(y),x),{reducefn:b,initialfn:S}=w,[M,I]=[p.length,[]],z=Array.from(Array(M),()=>S()),_=Getter.of(v);for(let m=0;m<p.length;m++){const R=_(m);I[R]===void 0&&(I[R]=S()),I[R]=b(I[R],p[m]),z[m]=I[R]}const O=g?subset(z,g):z,h=e.of(O,x,w,y);return a(h,z),g&&r(h,g),h[e.ORIGINAL_VALUES]=c[e.ORIGINAL_VALUES],Metadata.copy(c,h,["name","queryable","reduced"]),h}e.stack=u;function d(c,p){const[x,w,y,g,v]=i(c);if(!g)throw new Error("Cannot normalize a without a parent");const b=exports.Factor.parentIndices(o(g),w),S=subset(g,b),M=[...x];for(let _=0;_<c.length;_++)M[_]=p(M[_],S[_]);const I=v?subset(M,v):M,z=e.of(I,w,y,g);return a(z,M),v&&r(z,v),z[e.ORIGINAL_VALUES]=c[e.ORIGINAL_VALUES],Metadata.copy(c,z,["name","queryable","reduced"]),z}e.normalize=d;function f(c){const[p,x,w,y,g]=i(c),v=[];v.push(w.initialfn());for(let M=0;M<p.length-1;M++)v.push(p[M]);const b=g?subset(v,g):v,S=e.of(b,x,w,y);return a(S,v),g&&r(S,g),S[e.ORIGINAL_VALUES]=c[e.ORIGINAL_VALUES],Metadata.copy(c,S,["name","queryable"]),S}e.shiftLeft=f;function o(c){return c[e.FACTOR]}function l(c){return c[e.PARENT]}e.getParent=l;function a(c,p){c[e.VALUES]=p}function r(c,p){c[e.INDICES]=p}function i(c){return[c[e.VALUES],c[e.FACTOR],c[e.REDUCER],c[e.PARENT],c[e.INDICES]]}})(Reduced||(Reduced={}));var Geom;(e=>{function n(c){const p=Reactive.of()(c),x=last(c.coordinates)??Reactive.of()({});return Reactive.listen(x,"changed",()=>Reactive.dispatch(p,"coords-changed")),p}e.of=n,e.render=exports.Polymorphic.of(t),e.check=exports.Polymorphic.of(s),e.query=exports.Polymorphic.of(u);function t(c,p){throw new Error(`Method 'render' not implemented for geom of type '${c.type}'`)}function s(c,p){throw new Error(`Method 'check' not implemented for geom of type '${c.type}'`)}function u(c,p){throw new Error(`Method 'render' not implemented for geom of type '${c.type}'`)}function d(c,p){const x=last(c.coordinates)??Reactive.of()({});Reactive.removeAllListeners(x),c.coordinates=p;const w=last(p)??{};Reactive.listen(w,"changed",()=>Reactive.dispatch(c,"coords-changed")),Reactive.dispatch(c,"coords-swapped")}e.setCoordinates=d;function f(c){return c.coordinates[c.coordinates.length-2]}e.flatData=f;function o(c){return c.coordinates[c.coordinates.length-1]}e.groupedData=o;function l(c,p,x){const[w,y]=[Array(c),Getter.of(p)];for(let g=0;g<c;g++)w[g]=x[y(g)];return w}e.frames=l;function a(c,p){const x=[];for(const[w,y]of p){const g=Array(c),v=Getter.of(w??1);for(let b=0;b<c;b++)g[b]=exports.Scale.pushforward(y,v(b));x.push(g)}return x}e.scaledArrays=a;function r(c,p){const x=p[0],y=[i(c,x,{dimension:"only"})];for(let g=0;g<p.length;g++){const v=p[g],b=i(c,v,{dimension:"exclude"});b[LAYER]=Getter.of(c[LAYER])(v),y.push(b)}return y}e.getQueryInfo=r;function i(c,p,x){const w={},y=x==null?void 0:x.dimension;for(const g of Object.values(c)){if(y==="exclude"&&Metadata.get(g,"isDimension")||y==="only"&&!Metadata.get(g,"isDimension"))continue;const[v,b,S]=Metadata.get(g,["name","queryable","reduced"]);if(!v||!b)continue;const M=S?g[Reduced.ORIGINAL_VALUES]:g,I=Getter.of(M);w[v]=I(p)}return w}})(Geom||(Geom={}));var DOM;(e=>{function n(l,a){const r=document.createElement(l);return a!=null&&a.id&&(r.id=a.id),a!=null&&a.classes&&d(r,a.classes),a!=null&&a.textContent&&(r.textContent=a.textContent),r}e.element=n;function t(l,a){l.appendChild(a)}e.append=t;function s(l,a){return l.querySelector(a)}e.select=s;function u(l,a){for(const[r,i]of Object.entries(a))l.style[r]=i}e.setStyles=u;function d(l,a){for(const r of a)l.classList.add(r)}e.addClasses=d;function f(l,a){for(const r of a)l.classList.remove(r)}e.removeClasses=f;function o(l){l.innerHTML=""}e.clearChildren=o})(DOM||(DOM={}));const VAnchor={Top:1,Middle:1/2,Bottom:0},HAnchor={Left:1,Center:1/2,Right:0},MouseButton={Left:0,Right:2},dataLayers=[0,1,2,3,4,5,6,7],baseLayers=[4,5,6,7];var Frame;(e=>{function n(S){const M=DOM.element("canvas"),I=M.getContext("2d");DOM.addClasses(M,tw(S.classes??""));for(const[P,G]of Object.entries(S.canvasStyles??{}))M.style[P]=G;const{clientWidth:z,clientHeight:_,clientLeft:O,clientTop:h}=M,m=z-O,R=_-h,T=2,{margins:C=[0,0,0,0],contextProps:k={}}=S;return{canvas:M,context:I,width:m,height:R,margins:C,scalingFactor:T,contextProps:k}}e.of=n;function t(S,M){M.appendChild(S.canvas),S.parent=M,e.resize(S)}e.append=t;function s(S,M){for(const[I,z]of Object.entries(M))S.contextProps[I]=z,S.context[I]=z}e.setContext=s;function u(S){const{context:M,canvas:I,scalingFactor:z}=S,{clientWidth:_,clientHeight:O,clientLeft:h,clientTop:m}=I,R=_-h,T=O-m;S.width=R,S.height=T,S.canvas.width=R*z,S.canvas.height=T*z;for(const[C,k]of Object.entries(S.contextProps))S.context[C]=k;M.scale(z,z),e.clip(S)}e.resize=u;function d(S){const{context:M}=S;let{width:I,height:z}=S;const[_,O,h,m]=S.margins;I=Math.max(I-O-m,0),z=Math.max(z-h-_,0),M.beginPath(),M.rect(O,h,I,z),M.clip()}e.clip=d;function f(S){S.context.clearRect(0,0,S.width,S.height)}e.clear=f;function o(S,M){S.context.globalAlpha=M(S.context.globalAlpha)}e.setAlpha=o;function l(S){S.context.globalAlpha=1}e.resetAlpha=l;function a(S,M){return S.context.measureText(M).width}e.textWidth=a;function r(S,M){const I=S.context.measureText(M);return I.actualBoundingBoxAscent+I.actualBoundingBoxDescent}e.textHeight=r;function i(S,M,I,z,_){const{context:O}=S,h=S.canvas.clientHeight,m=(_==null?void 0:_.hAnchor)??HAnchor.Center,R=(_==null?void 0:_.vAnchor)??VAnchor.Middle;M=M+2*(m-.5)*z,I=h-I+2*(.5-R)*z,O.beginPath(),O.arc(M,I,z,0,Math.PI*2),O.fill()}e.point=i;function c(S,M,I,z,_){for(let O=0;O<M.length;O++)i(S[O],M[O],I[O],z[O],_)}e.points=c;function p(S,M,I,z,_,O){const{context:h,height:m}=S,R=z-M,T=_-I;M=M+(1-O)/2*R,z=z-(1-O)/2*R,I=I+(1-O)/2*T,_=_-(1-O)/2*T,h.fillRect(M,m-I,z-M,I-_)}e.rectangleXY=p;function x(S,M,I,z,_,O){for(let h=0;h<M.length;h++)p(S[h],M[h],I[h],z[h],_[h],O[h])}e.rectanglesXY=x;function w(S,M,I,z,_,O){const{context:h,height:m}=S,R=(O==null?void 0:O.hAnchor)??HAnchor.Center,T=(O==null?void 0:O.vAnchor)??VAnchor.Middle;M=M-R*z,I=m-I+T*_,h.fillRect(M,I,z,-_)}e.rectangleWH=w;function y(S,M,I,z,_,O){for(let h=0;h<M.length;h++)w(S[h],M[h],I[h],z[h],_[h],O)}e.rectanglesWH=y;function g(S,M,I){const{context:z,height:_}=S;z.beginPath(),z.moveTo(M[0],_-I[0]);for(let O=0;O<M.length;O++)z.lineTo(M[O],_-I[O]);z.stroke()}e.line=g;function v(S,M,I){for(let z=0;z<M.length;z++)g(S[z],M[z],I[z])}e.lines=v;function b(S,M,I,z,_){const{context:O,height:h}=S;O.save(),O.translate(M,h-I),_!=null&&_.vertical&&O.rotate(-Math.PI/2),O.fillText(z,0,0),O.translate(-M,-(h-I)),O.restore()}e.text=b})(Frame||(Frame={}));var Bars;(e=>{const n="bars";function t(f,o,l){const a=(l==null?void 0:l.vAnchor)??VAnchor.Bottom,r=(l==null?void 0:l.hAnchor)??HAnchor.Center;return Geom.of({type:n,coordinates:f,scales:o,vAnchor:a,hAnchor:r})}e.of=t,exports.Polymorphic.set(Geom.render,n,s),exports.Polymorphic.set(Geom.check,n,u),exports.Polymorphic.set(Geom.query,n,d);function s(f,o){const{scales:l,hAnchor:a,vAnchor:r}=f,i=Geom.groupedData(f),c=findLength(Object.values(i)),[p,x,w,y]=Geom.scaledArrays(c,[[i.x,l.x],[i.y,l.y],[i.width,l.width],[i.height,l.height]]),g=Geom.frames(c,i[LAYER],o);Frame.rectanglesWH(g,p,x,w,y,{hAnchor:a,vAnchor:r})}function u(f,o){const{scales:l,hAnchor:a,vAnchor:r}=f,i=Geom.flatData(f),c=findLength(Object.values(i)),{x:p,y:x,width:w,height:y}=Getter.mapObject(i),g=Getter.of(i[exports.Factor.POSITIONS]),v=[];for(let b=0;b<c;b++){let S=exports.Scale.pushforward(l.x,p(b)),M=exports.Scale.pushforward(l.y,x(b)),I=exports.Scale.pushforward(l.width,w(b)),z=exports.Scale.pushforward(l.height,y(b));const _=[S-I*a,M-z*r,S+I*a,M+z*(1-r)];if(rectsIntersect(o,_)){const O=g(b);for(let h=0;h<O.length;h++)v.push(O[h])}}return v}function d(f,o){var v;const{scales:l,hAnchor:a,vAnchor:r}=f,i=Geom.flatData(f),c=Geom.groupedData(f),p=findLength(Object.values(i)),{x,y:w,width:y,height:g}=Getter.mapObject(i);for(let b=0;b<p;b++){let S=exports.Scale.pushforward(l.x,x(b)),M=exports.Scale.pushforward(l.y,w(b)),I=exports.Scale.pushforward(l.width,y(b)),z=exports.Scale.pushforward(l.height,g(b));const _=[S-I*a,M-z*r,S+I*a,M+z*(1-r)];if(pointInRect(o,_)){const O=(v=i[exports.Factor.CHILD_INDICES])==null?void 0:v[b];return Geom.getQueryInfo(c,O??[])}}}})(Bars||(Bars={}));var ExpanseCompound;(e=>{const n="compound";function t(a){const r=exports.Expanse.base(),i=ExpanseContinuous.of();return{...r,continuous:i,type:n,commonScale:!1,expanses:a}}e.of=t,exports.Polymorphic.set(exports.Expanse.normalize,n,s),exports.Polymorphic.set(exports.Expanse.unnormalize,n,u),exports.Polymorphic.set(exports.Expanse.train,n,d),exports.Polymorphic.set(exports.Expanse.breaks,n,f),exports.Polymorphic.set(exports.Expanse.reset,n,o);function s(a,r){const{expanses:i}=a;return a.commonScale===!0?r.map(c=>exports.Expanse.normalize(a.continuous,c)):r.map((c,p)=>exports.Expanse.normalize(i[p],c))}e.normalize=s;function u(a,r){const{expanses:i}=a;return a.commonScale===!0?r.map(c=>exports.Expanse.normalize(a.continuous,c)):r.map((c,p)=>exports.Expanse.unnormalize(i[p],c))}e.unnormalize=u;function d(a,r){const{expanses:i}=a;if(r.length!=i.length)throw new Error("The number of arrays does not match the number of expanses.");for(let c=0;c<r.length;c++)exports.Expanse.train(i[c],r[c],{default:!0})}e.train=d;function f(a,r,i){return ExpanseContinuous.breaks(a.continuous,r,i)}e.breaks=f;function o(a){for(const r of a.expanses)exports.Expanse.reset(r);exports.Expanse.reset(a.continuous)}e.reset=o;function l(a,r){const{expanses:i,continuous:c}=a;if(!r){a.commonScale=!1,Object.assign(c.props,{min:0,max:1}),Object.assign(c.defaults,{min:0,max:1}),Reactive.dispatch(a,"changed");return}if(i.some(w=>!exports.Expanse.isContinuous(w)))throw new Error("Common scale can only be set if all expanses are continuous.");let[p,x]=[1/0,-1/0];for(const w of i)p=Math.min(p,w.props.min),x=Math.max(x,w.props.max);Object.assign(c.props,{min:p,max:x}),Object.assign(c.defaults,{min:p,max:x}),a.commonScale=!0,Reactive.dispatch(a,"changed")}e.setCommonScale=l})(ExpanseCompound||(ExpanseCompound={}));var ExpansePoint;(e=>{const n="point";function t(l=[]){const a=exports.Expanse.base(),[r,i]=[!1,seqLength(0,l.length)],c={labels:l,ordered:r,order:i},p=structuredClone(c);return{...a,type:n,props:c,defaults:p,frozen:[]}}e.of=t,exports.Polymorphic.set(exports.Expanse.normalize,n,s),exports.Polymorphic.set(exports.Expanse.unnormalize,n,u),exports.Polymorphic.set(exports.Expanse.train,n,d),exports.Polymorphic.set(exports.Expanse.breaks,n,o),exports.Polymorphic.set(exports.Expanse.reorder,n,f);function s(l,a){const{labels:r,order:i}=l.props,c=i[r.indexOf(a)];return c===-1?c:c/(r.length-1)}e.normalize=s;function u(l,a){const{labels:r,order:i}=l.props;return a=Math.round(a*(r.length-1)),r[i[a]]}e.unnormalize=u;function d(l,a,r){const{props:i,defaults:c}=l,{order:p}=i,x=Array.from(new Set(a)).sort(compareAlphaNumeric);if(!p.length){for(let w=0;w<x.length;w++)p[w]=w;c.order=[...p],i.ordered=!1}copyValues(x,i.labels),r!=null&&r.default&&copyValues(x,l.defaults.labels),exports.Expanse.set(l,()=>({}),r)}e.train=d;function f(l,a){const{props:r,defaults:i}=l,{order:c}=r;if(!a){copyValues(i.order,c),r.ordered=!1,Reactive.dispatch(l,"changed");return}copyValues(a,c),r.ordered=!0,Reactive.dispatch(l,"changed")}e.reorder=f;function o(l){const{labels:a,order:r}=l.props;return ordered(a,r)}e.breaks=o})(ExpansePoint||(ExpansePoint={}));var ExpanseSplit;(e=>{const n="split";function t(o){const l=o??ExpanseContinuous.of(),a={...l.props,innerType:l.type};return{...l,type:n,props:a}}e.of=t,exports.Polymorphic.set(exports.Expanse.normalize,n,s),exports.Polymorphic.set(exports.Expanse.unnormalize,n,u),exports.Polymorphic.set(exports.Expanse.train,n,d),exports.Polymorphic.set(exports.Expanse.breaks,n,f);function s(o,l){const{innerType:a}=o.props,r=exports.Polymorphic.dispatch(exports.Expanse.normalize,identity,a);return Array.isArray(l)?l.map(i=>r(o,i)):r(o,l)}e.normalize=s;function u(o,l){const{innerType:a}=o.props,r=exports.Polymorphic.dispatch(exports.Expanse.unnormalize,identity,a);return Array.isArray(l)?l.map(i=>r(o,i)):r(o,l)}e.unnormalize=u;function d(o,l){const{innerType:a}=o.props;exports.Polymorphic.dispatch(exports.Expanse.train,identity,a)(o,l)}e.train=d;function f(o){const{innerType:l}=o.props;return exports.Polymorphic.dispatch(exports.Expanse.breaks,identity,l)(o)}e.breaks=f})(ExpanseSplit||(ExpanseSplit={}));const expanseMap={continuous:ExpanseContinuous,point:ExpansePoint,band:ExpanseBand,split:ExpanseSplit,compound:ExpanseCompound},scaleNames=["x","y","size","area","areaPct","width","height"];exports.Scales=void 0,(e=>{function n(s){const u={};for(const d of scaleNames)u[d]=exports.Scale.linear();for(const[d,[f,o]]of Object.entries(s??{}))u[d]=exports.Scale.of(expanseMap[f].of(),expanseMap[o].of());return u}e.of=n;function t(s,u,d){return{...s,[u]:d}}e.set=t})(exports.Scales||(exports.Scales={})),exports.Reducer=void 0,(Reducer=>{Reducer.sum={name:"sum",fallback:"count",initialfn:()=>0,reducefn:(e,n)=>e+n},Reducer.max={name:"max",initialfn:()=>-1/0,reducefn:(e,n)=>Math.max(e,n)},Reducer.product={name:"product",initialfn:()=>1,reducefn:(e,n)=>e*n},Reducer.table={name:"table",initialfn:()=>({}),reducefn:(e,n)=>(e[n]=e[n]+1||0,e)};function parse(value){if(typeof value=="string")return Reducer[value];if(typeof value.initialfn=="string"&&typeof value.reducefn=="string"){const parsed={name:value.name};return parsed.initialfn=eval(value.initialfn),parsed.reducefn=eval(value.reducefn),parsed}return value}Reducer.parse=parse;function reduce(e,n,t){const{indices:s,cardinality:u}=n,{initialfn:d,reducefn:f}=t,o=Array.from(Array(u),()=>d()),l=Getter.of(s),a=Getter.of(e);for(let c=0;c<s.length;c++){const p=l(c);o[p]=f(o[p],a(c))}const r=Reduced.of(o,n,t);isObject(e)&&Metadata.copy(e,r);const i=getName(o,t)??"[unknown summary]";return Metadata.set(r,{name:i,queryable:!0,reduced:!0}),r}Reducer.reduce=reduce;function getName(e,n){return Metadata.has(e,"name")?`${n.name} of ${Metadata.get(e,"name")}`:n.fallback}Reducer.getName=getName})(exports.Reducer||(exports.Reducer={}));var Summaries;(e=>{function n(d,f){const o=[];for(let l=0;l<f.length;l++){const a=f[l],r=t(d,a),i=Reactive.of()(merge(r,a.data));if(o.push(i),l>0)for(const c of Object.keys(r)){const p=o[l-1][c];Reduced.setParent(r[c],p)}Reactive.listen(a,"changed",()=>{const c=t(d,a);for(const p of Object.keys(c))copyValues(c[p],r[p]);for(const p of Reflect.ownKeys(a.data))copyValues(a.data[p],i[p])}),Reactive.propagate(a,i,"changed")}return o}e.of=n;function t(d,f){const o={};for(const[l,a]of Object.entries(d)){const[r,i]=a;o[l]=exports.Reducer.reduce(r,f,i)}return o}function s(d,f){const o=[];for(let l=0;l<d.length;l++){let a=function(i){const c=f[l](i),p=Reflect.ownKeys(i);for(const x of p)(typeof x=="symbol"||isIntegerString(x))&&(c[x]=i[x]);return c};const r=Reactive.of()(a(d[l]));o.push(r),Reactive.listen(d[l],"changed",()=>{const i=a(d[l]);for(const c of Reflect.ownKeys(i))Array.isArray(i[c])&&Array.isArray(r[c])&&copyValues(i[c],r[c]);Reactive.dispatch(r,"changed")})}return o}e.translate=s;function u(d,f){const o={};let l=0;for(const[a,r]of d)o[`q${l++}`]=[a(f),r];return o}e.formatQueries=u})(Summaries||(Summaries={}));function Barplot(e,n,t){const{data:s,marker:u}=e;let[d,f]=n(s);const o=f&&(t!=null&&t.reducer)?t.reducer:exports.Reducer.sum,l=f||(()=>1),a=exports.Factor.from(d),r=exports.Factor.product(a,u.factor),i=[a,r],c=t!=null&&t.queries?t.queries(s):{},p=[l,o],x=Summaries.of({stat:p,...c},i),w=exports.Scales.of({x:["band","continuous"]}),[y,g]=["bar","absolute"],v={...t,type:y,representation:g},b=Bars.of([],w),S=Object.assign(exports.Plot.of(x,w,v),{bars:b});return barplot(S),exports.Plot.addGeom(S,b),exports.Scale.link(w.y,[w.height]),exports.Scale.freeze(w.y,["zero"]),exports.Scale.freeze(w.height,["zero"]),Reactive.listen(S,"normalize",()=>switchRepresentation$5(S)),S}function sortAxis$1(e,n){if(e.props.ordered)ExpanseBand.reorder(e);else{const t=orderIndices(n);ExpanseBand.reorder(e,t)}}function switchRepresentation$5(e){e.representation==="absolute"?spineplot(e):barplot(e)}function barplot(e){const{data:n,scales:t,bars:s}=e,u=Summaries.translate(n,[a=>({x:a.label,y:zero,height:a.stat,width:one}),a=>({x:a.label,y:zero,height:Reduced.stack(a.stat),width:one})]),[d]=u,f={default:!0,ratio:!0};exports.Scale.train(t.x,d.x,f),exports.Scale.train(t.y,d.height,f),exports.Scale.train(t.width,[0,1],f),exports.Scale.train(t.height,d.height,f),ExpanseBand.setWeights(t.x.domain);const l={scale:1/new Set(d.x).size,mult:.9};return exports.Scale.set(t.width,()=>l,{default:!0}),exports.Expanse.set(t.width.codomain,()=>({offset:0}),{default:!0}),Metadata.copy(d.height,t.y,["name"]),Reactive.removeAll(e,"reorder"),Reactive.listen(e,"reorder",()=>sortAxis$1(t.x.domain,d.height)),Geom.setCoordinates(s,u),e.representation="absolute",exports.Plot.render(e),exports.Plot.renderAxes(e),e}function spineplot(e){const{data:n,scales:t,bars:s}=e,u=Summaries.translate(n,[l=>({x:l.label,y:zero,height:one,width:l.stat}),l=>({x:l.label,y:zero,height:Reduced.normalize(Reduced.stack(l.stat),(a,r)=>a/r),width:Reduced.parent(l.stat)})]),[d]=u,f={default:!0,ratio:!0};exports.Scale.train(t.x,d.x,f),exports.Scale.train(t.y,[0,1],f),exports.Scale.train(t.width,cumsum(d.width),f),exports.Scale.train(t.height,[0,1],f),ExpanseBand.setWeights(t.x.domain,d.width);const o={scale:1,mult:1};exports.Scale.set(t.width,()=>o,{default:!0}),exports.Expanse.set(t.width.codomain,()=>({offset:-1}),{default:!0}),Metadata.set(t.y,{name:"proportion"}),Reactive.removeAll(e,"reorder"),Reactive.listen(e,"reorder",()=>sortAxis$1(t.x.domain,d.width)),Geom.setCoordinates(s,u),e.representation="proportion",exports.Plot.render(e),exports.Plot.renderAxes(e)}function Bibarplot(e,n,t){const{data:s,marker:u}=e;let[d,f,o]=n(s);const l=exports.Reducer.sum,a=exports.Reducer.sum,r=o?f:()=>1,i=o||f,c=exports.Factor.from(d),p=exports.Factor.product(c,u.factor),x=[c,p],w=t!=null&&t.queries?t.queries(s):{},y=[r,l],g=[i,a],v=Summaries.of({stat1:y,stat2:g,...w},x),b=exports.Scales.of({x:["band","continuous"],heightUp:["continuous","continuous"],heightDown:["continuous","continuous"]}),S={type:"bar",representation:"absolute"},M={...b,height:b.heightUp},I={...b,height:b.heightDown},z=Bars.of([],M),_=Bars.of([],I),O={bars1:z,bars2:_},h=Object.assign(exports.Plot.of(v,b,S),O);bibarplot(h),exports.Plot.addGeom(h,z),exports.Plot.addGeom(h,_);const m={default:!0};return exports.Scale.shareCodomain(b.height,[b.heightUp,b.heightDown]),exports.Scale.set(b.heightUp,()=>({one:.4}),m),exports.Scale.set(b.heightDown,()=>({one:-.4}),m),exports.Expanse.set(b.height.codomain,()=>({inv:identity}),m),Reactive.listen(h,"normalize",()=>switchRepresentation$4(h)),h}function sortAxis(e,n){if(e.props.ordered)ExpanseBand.reorder(e);else{const t=orderIndices(n);ExpanseBand.reorder(e,t)}}function switchRepresentation$4(e){e.representation==="absolute"?normalizedbibarplot(e):bibarplot(e)}function bibarplot(e){const{data:n,scales:t,bars1:s,bars2:u}=e,d=Summaries.translate(n,[g=>({x:g.label,y:zero,height:g.stat1,width:one}),g=>({x:g.label,y:zero,height:Reduced.stack(g.stat1),width:one})]),f=Summaries.translate(n,[g=>({x:g.label,y:zero,height:g.stat2,width:one}),g=>({x:g.label,y:zero,height:Reduced.stack(g.stat2),width:one})]),[o]=d,l={default:!0,ratio:!0},{stat1:a,stat2:r}=n[0],i=Math.max(...a),c=Math.max(...r);exports.Scale.train(t.x,o.x,l),exports.Scale.train(t.y,[-1,1],{default:!0,ratio:!1}),exports.Scale.train(t.width,[0,1],l),exports.Scale.train(t.heightUp,[0,i],l),exports.Scale.train(t.heightDown,[0,c],l),ExpanseBand.setWeights(t.x.domain);const[p,x]=[a,r].map(g=>Metadata.get(g,"name"));Metadata.set(t.y,{name:`${x} / ${p}`});const y={scale:1/new Set(o.x).size,mult:.9,offset:0};return exports.Scale.set(t.width,()=>y,{default:!0}),Reactive.removeAll(e,"reorder"),Reactive.listen(e,"reorder",()=>sortAxis(t.x.domain,o.height)),Geom.setCoordinates(s,d),Geom.setCoordinates(u,f),e.representation="absolute",exports.Plot.render(e),exports.Plot.renderAxes(e),e}function normalizedbibarplot(e){const{data:n,scales:t,bars1:s,bars2:u}=e,d=Summaries.translate(n,[i=>({x:i.label,y:zero,height:one,width:one}),i=>({x:i.label,y:zero,height:Reduced.normalize(Reduced.stack(i.stat1),(c,p)=>c/p),width:one})]),f=Summaries.translate(n,[i=>({x:i.label,y:zero,height:one,width:one}),i=>({x:i.label,y:zero,height:Reduced.normalize(Reduced.stack(i.stat2),(c,p)=>c/p),width:one})]),[o]=d,l={default:!0,ratio:!0};exports.Scale.train(t.x,o.x,l),exports.Scale.train(t.y,[-1,1],{default:!0,ratio:!1}),exports.Scale.train(t.width,[0,1],l),exports.Scale.train(t.heightUp,[0,1],l),exports.Scale.train(t.heightDown,[0,1],l),ExpanseBand.setWeights(t.x.domain),Metadata.set(t.y,{name:"proportion"});const r={scale:1/new Set(o.x).size,mult:.9,offset:0};return exports.Scale.set(t.width,()=>r,{default:!0}),Reactive.removeAll(e,"reorder"),Geom.setCoordinates(s,d),Geom.setCoordinates(u,f),e.representation="proportion",exports.Plot.render(e),exports.Plot.renderAxes(e),e}function Fluctuationplot(e,n,t){const{data:s,marker:u}=e;let[d,f,o]=n(s);const l=o&&(t!=null&&t.reducer)?t.reducer:exports.Reducer.sum,a=o?[...o]:()=>1,r=exports.Factor.product(exports.Factor.from(d),exports.Factor.from(f)),i=exports.Factor.product(r,u.factor),c=[r,i],p=t!=null&&t.queries?t.queries(s):{},x=[a,l],w=Summaries.of({stat:x,...p},c),y=exports.Scales.of({x:["band","continuous"],y:["band","continuous"]}),[g,v]=["fluct","absolute"],b={...t,type:g,representation:v},S=Bars.of([],y,{vAnchor:VAnchor.Middle}),M=Object.assign(exports.Plot.of(w,y,b),{bars:S});return exports.Scale.link(y.area,[y.width,y.height]),exports.Scale.shareCodomain(y.area,[y.width,y.height]),fluctplot(M),exports.Plot.addGeom(M,S),Reactive.listen(M,"normalize",()=>switchRepresentation$3(M)),M}function switchRepresentation$3(e){e.representation==="absolute"?pctfluctplot(e):fluctplot(e)}function fluctplot(e){const{data:n,scales:t,bars:s}=e,u=Summaries.translate(n,[a=>({x:a.label,y:a.label$,height:a.stat,width:a.stat}),a=>({x:a.label,y:a.label$,height:Reduced.stack(a.stat),width:Reduced.stack(a.stat)})]),[d]=u,f={default:!0,ratio:!0};exports.Scale.train(t.x,d.x,f),exports.Scale.train(t.y,d.y,f),exports.Scale.train(t.width,d.width,f),exports.Scale.train(t.height,d.height,f);const l={scale:1/max(new Set(d.x).size,new Set(d.y).size)**2,mult:.9};exports.Scale.set(t.area,()=>l,{default:!0}),exports.Expanse.set(t.area.codomain,()=>({offset:0})),Geom.setCoordinates(s,u),e.representation="absolute",exports.Plot.render(e)}function pctfluctplot(e){const{data:n,scales:t,bars:s}=e,u=Summaries.translate(n,[a=>({x:a.label,y:a.label$,height:one,width:one}),a=>({x:a.label,y:a.label$,height:Reduced.normalize(Reduced.stack(a.stat),(r,i)=>r/i),width:Reduced.normalize(Reduced.stack(a.stat),(r,i)=>r/i)})]),[d]=u,f={default:!0,ratio:!0};exports.Scale.train(t.x,d.x,f),exports.Scale.train(t.y,d.y,f),exports.Scale.train(t.width,[0,1],f),exports.Scale.train(t.height,[0,1],f);const l={scale:1/max(new Set(d.x).size,new Set(d.y).size)**2,mult:.9};exports.Scale.set(t.area,()=>l,{default:!0}),exports.Expanse.set(t.area.codomain,()=>({offset:-2})),Geom.setCoordinates(s,u),e.representation="proportion",exports.Plot.render(e)}var Rectangles;(e=>{const n="rectangles";function t(f,o){return Geom.of({type:n,coordinates:f,scales:o})}e.of=t,exports.Polymorphic.set(Geom.render,n,s),exports.Polymorphic.set(Geom.check,n,u),exports.Polymorphic.set(Geom.query,n,d);function s(f,o){const{scales:l}=f,a=Geom.groupedData(f),r=findLength(Object.values(a)),[i,c,p,x,w]=Geom.scaledArrays(r,[[a.x0,l.x],[a.y0,l.y],[a.x1,l.x],[a.y1,l.y],[a.area,l.areaPct]]),y=Geom.frames(r,a[LAYER],o);Frame.rectanglesXY(y,i,c,p,x,w)}e.render=s;function u(f,o){const{scales:l}=f,a=Geom.flatData(f),r=findLength(Object.values(a)),{x0:i,y0:c,x1:p,y1:x,area:w}=Getter.mapObject(a),y=Getter.of(a[exports.Factor.POSITIONS]),g=[];for(let v=0;v<r;v++){let b=exports.Scale.pushforward(l.x,i(v)),S=exports.Scale.pushforward(l.y,c(v)),M=exports.Scale.pushforward(l.x,p(v)),I=exports.Scale.pushforward(l.y,x(v));if(a.area){const z=exports.Scale.pushforward(l.areaPct,w(v)),_=M-b,O=I-S;b=b+(1-z)/2*_,M=M-(1-z)/2*_,S=S+(1-z)/2*O,I=I-(1-z)/2*O}if(rectsIntersect(o,[b,S,M,I])){const z=y(v);for(let _=0;_<z.length;_++)g.push(z[_])}}return g}e.check=u;function d(f,o){var g;const{scales:l}=f,a=Geom.flatData(f),r=Geom.groupedData(f),i=findLength(Object.values(a)),{x0:c,y0:p,x1:x,y1:w,area:y}=Getter.mapObject(a);for(let v=0;v<i;v++){let b=exports.Scale.pushforward(l.x,c(v)),S=exports.Scale.pushforward(l.y,p(v)),M=exports.Scale.pushforward(l.x,x(v)),I=exports.Scale.pushforward(l.y,w(v));if(a.area){const z=exports.Scale.pushforward(l.areaPct,y(v)),_=M-b,O=I-S;b=b+(1-z)/2*_,M=M-(1-z)/2*_,S=S+(1-z)/2*O,I=I-(1-z)/2*O}if(pointInRect(o,[b,S,M,I])){const z=(g=a[exports.Factor.CHILD_INDICES])==null?void 0:g[v];return Geom.getQueryInfo(r,z)}}}e.query=d})(Rectangles||(Rectangles={}));function Histogram(e,n,t){const{data:s,marker:u}=e;let[d,f]=n(s);const o=f&&(t!=null&&t.reducer)?t.reducer:exports.Reducer.sum,l=f||(()=>1),[a,r]=minmax(d),i=r-a,c=Reactive.of()({anchor:a,width:i/15}),p=exports.Factor.mono(d.length),x=exports.Factor.product(p,exports.Factor.bin(d,c)),w=exports.Factor.product(x,u.factor),y=[p,x,w],g=t!=null&&t.queries?t.queries(s):{},v=[l,o],b=Summaries.of({stat:v,...g},y),S=exports.Scales.of(),[M,I]=["histo","absolute"],z={...t,type:M,representation:I},_=Rectangles.of([],S),O=Object.assign(exports.Plot.of(b,S,z),{rectangles:_});histogram(O),exports.Plot.addGeom(O,_),Reactive.listen(O,"normalize",()=>switchRepresentation$2(O));const h=i/10;return Reactive.listen(O,"set-parameters",m=>{m&&(m.width&&Reactive.set(c,()=>({width:m.width})),m.anchor&&Reactive.set(c,()=>({anchor:m.anchor})))}),Reactive.listen(O,"grow",()=>Reactive.set(c,m=>({width:m.width*10/9}))),Reactive.listen(O,"shrink",()=>Reactive.set(c,m=>({width:m.width*9/10}))),Reactive.listen(O,"increment-anchor",()=>Reactive.set(c,m=>({anchor:m.anchor+h}))),Reactive.listen(O,"decrement-anchor",()=>Reactive.set(c,m=>({anchor:m.anchor-h}))),Reactive.listen(O,"reset",()=>{Reactive.set(c,()=>({anchor:a,width:i/15}))}),O}function switchRepresentation$2(e){e.representation==="absolute"?spinogram(e):histogram(e)}function histogram(e){const{data:n,rectangles:t}=e,s=Summaries.translate(n,[f=>f,f=>({x0:f.binMin,y0:zero,x1:f.binMax,y1:f.stat}),f=>({x0:f.binMin,y0:zero,x1:f.binMax,y1:Reduced.stack(f.stat)})]),{scales:u}=e,[,d]=s;exports.Scale.train(u.x,d.x1,{default:!0,name:!1}),exports.Scale.train(u.y,d.y1,{default:!0,ratio:!0}),exports.Scale.freeze(u.y,["zero"]),Reactive.removeAll(t.coordinates[1],"changed"),Reactive.listen(s[1],"changed",()=>{exports.Scale.train(u.x,d.x1,{default:!0,name:!1}),exports.Scale.train(u.y,d.y1,{default:!0,ratio:!0})}),Metadata.copy(n[1].breaks,u.x,["name"]),Metadata.copy(d.y1,u.y,["name"]),Geom.setCoordinates(t,s),e.representation="absolute",exports.Plot.render(e),exports.Plot.renderAxes(e)}function spinogram(e){const{data:n,rectangles:t}=e,s=Summaries.translate(n,[f=>f,f=>({x0:Reduced.shiftLeft(Reduced.stack(f.stat)),y0:zero,x1:Reduced.stack(f.stat),y1:one}),f=>({x0:Reduced.shiftLeft(Reduced.stack(Reduced.parent(f.stat))),y0:zero,x1:Reduced.stack(Reduced.parent(f.stat)),y1:Reduced.normalize(Reduced.stack(f.stat),(o,l)=>o/l),query1:f.binMin,query2:f.binMax})]),{scales:u}=e,[,d]=s;exports.Scale.train(u.x,[0,...d.x1],{default:!0,name:!1}),exports.Scale.train(u.y,[0,1],{default:!0,ratio:!0}),exports.Scale.freeze(u.y,["zero"]),Reactive.removeAll(t.coordinates[1],"changed"),Reactive.listen(s[1],"changed",()=>{exports.Scale.train(u.x,[0,...d.x1],{default:!0,name:!1})}),Metadata.set(u.x,{name:"cumulative count"}),Metadata.set(u.y,{name:"proportion"}),Geom.setCoordinates(t,s),e.representation="proportion",exports.Plot.render(e),exports.Plot.renderAxes(e)}function Histogram2d(e,n,t){const{data:s,marker:u}=e;let[d,f,o]=n(s);const l=o&&(t!=null&&t.reducer)?t.reducer:exports.Reducer.sum,a=o||(()=>1),[r,i]=minmax(d),[c,p]=minmax(f),[x,w]=[i-r,p-c],y=Reactive.of()({anchor:r,width:x/15}),g=Reactive.of()({anchor:c,width:w/15}),v=exports.Factor.bin(d,y),b=exports.Factor.bin(f,g),S=exports.Factor.product(v,b),M=exports.Factor.product(S,u.factor),I=[S,M],z=t!=null&&t.queries?t.queries(s):{},_=[a,l],O=Summaries.of({stat:_,...z},I),h=exports.Scales.of(),[m,R]=["histo2d","absolute"],T={...t,type:m,representation:R},C=Rectangles.of([],h),k=Object.assign(exports.Plot.of(O,h,T),{rectangles:C});return histogram2d(k),exports.Plot.addGeom(k,C),Reactive.listen(k,"normalize",()=>switchRepresentation$1(k)),Reactive.listen(k,"set-parameters",P=>{P&&(P.width1&&Reactive.set(y,()=>({width:P.width1})),P.anchor1&&Reactive.set(y,()=>({anchor:P.anchor1})),P.width2&&Reactive.set(g,()=>({width:P.width2})),P.anchor2&&Reactive.set(g,()=>({anchor:P.anchor2})))}),Reactive.listen(k,"grow",()=>{Reactive.set(y,P=>({width:P.width*10/9})),Reactive.set(g,P=>({width:P.width*10/9}))}),Reactive.listen(k,"shrink",()=>{Reactive.set(y,P=>({width:P.width*9/10})),Reactive.set(g,P=>({width:P.width*9/10}))}),Reactive.listen(k,"reset",()=>{Reactive.set(y,()=>({anchor:r,width:x/15})),Reactive.set(g,()=>({anchor:c,width:w/15}))}),k}function switchRepresentation$1(e){e.representation==="absolute"?spinogram2d(e):histogram2d(e)}function histogram2d(e){const{data:n,rectangles:t}=e,s=Summaries.translate(n,[o=>({x0:o.binMin,y0:o.binMin$,x1:o.binMax,y1:o.binMax$,area:o.stat}),o=>({x0:o.binMin,y0:o.binMin$,x1:o.binMax,y1:o.binMax$,area:Reduced.stack(o.stat)})]),{scales:u}=e,[,d]=s,f={default:!0};exports.Scale.train(u.x,d.x1,f),exports.Scale.train(u.y,d.y1,f),exports.Scale.train(u.areaPct,d.area,f),exports.Expanse.set(u.area.codomain,()=>({min:0,max:1}),f),exports.Expanse.freeze(u.area.codomain,["min","max"]),Reactive.removeAll(t.coordinates[0],"changed"),Reactive.listen(s[0],"changed",()=>{exports.Scale.train(u.x,d.x1,{default:!0,name:!1}),exports.Scale.train(u.y,d.y1,{default:!0,name:!1}),exports.Scale.train(u.areaPct,d.area,f)}),e.representation="absolute",Geom.setCoordinates(t,s),Metadata.copy(n[1].breaks,u.x,["name"]),Metadata.copy(n[1].breaks$,u.y,["name"]),exports.Plot.render(e),exports.Plot.renderAxes(e)}function spinogram2d(e){const{data:n,rectangles:t}=e,s=Summaries.translate(n,[o=>({x0:o.binMin,y0:o.binMin$,x1:o.binMax,y1:o.binMax$,area:one}),o=>({x0:o.binMin,y0:o.binMin$,x1:o.binMax,y1:o.binMax$,area:Reduced.normalize(Reduced.stack(o.stat),(l,a)=>l/a)})]),{scales:u}=e,[,d]=s,f={default:!0};exports.Scale.train(u.x,d.x1,f),exports.Scale.train(u.y,d.y1,f),exports.Scale.train(u.areaPct,[0,1],f),exports.Expanse.set(u.area.codomain,()=>({min:0,max:1}),f),exports.Expanse.freeze(u.area.codomain,["min","max"]),Reactive.removeAll(t.coordinates[0],"changed"),Reactive.listen(s[0],"changed",()=>{exports.Scale.train(u.x,d.x1,{default:!0,name:!1}),exports.Scale.train(u.y,d.y1,{default:!0,name:!1})}),e.representation="proportion",Geom.setCoordinates(t,s),Metadata.copy(n[1].breaks,u.x,["name"]),Metadata.copy(n[1].breaks$,u.y,["name"]),exports.Plot.render(e),exports.Plot.renderAxes(e)}var Lines;(e=>{const n="lines";function t(f,o){return Geom.of({type:n,coordinates:f,scales:o})}e.of=t,exports.Polymorphic.set(Geom.render,n,s),exports.Polymorphic.set(Geom.check,n,u),exports.Polymorphic.set(Geom.query,n,d);function s(f,o){const{scales:l}=f,a=Geom.groupedData(f),r=findLength(Object.values(a)),[i,c]=Geom.scaledArrays(r,[[a.x,l.x],[a.y,l.y]]),p=Geom.frames(r,a[LAYER],o);Frame.lines(p,i,c)}e.render=s;function u(f,o){const{scales:l}=f,a=Geom.flatData(f),r=findLength(Object.values(a)),{x:i,y:c}=Getter.mapObject(a),p=Getter.of(a[exports.Factor.POSITIONS]),x=[];for(let w=0;w<r;w++){const y=exports.Scale.pushforward(l.x,i(w)),g=exports.Scale.pushforward(l.y,c(w));for(let v=1;v<y.length;v++){const b=[y[v-1],g[v-1],y[v],g[v]];if(rectSegmentIntersect(o,b)){const S=p(w);for(let M=0;M<S.length;M++)x.push(S[M])}}}return x}e.check=u;function d(f,o){var w;let{scales:l}=f;const a=Geom.flatData(f),r=Geom.groupedData(f),i=findLength(Object.values(a)),{x:c,y:p}=Getter.mapObject(a),x=bimap([...o,...o],[-1,-1,1,1],sum);for(let y=0;y<i;y++){const g=exports.Scale.pushforward(l.x,c(y)),v=exports.Scale.pushforward(l.y,p(y));for(let b=1;b<g.length;b++){const S=[g[b-1],v[b-1],g[b],v[b]];if(rectSegmentIntersect(x,S)){const M=(w=a[exports.Factor.CHILD_INDICES])==null?void 0:w[y],I=c(y),z=p(y),_={};for(let h=0;h<I.length;h++)_[I[h]]=z[h];const O=M[0];return _[LAYER]=Getter.of(r[LAYER])(O),[_]}}}}e.query=d})(Lines||(Lines={}));function inferExpanse(e,n={train:!0}){const s=isNumberArray(e)?ExpanseContinuous.of():ExpansePoint.of();return n.train&&exports.Expanse.train(s,e,{default:!0}),s}function Pcoordsplot(e,n,t){const{data:s,marker:u}=e,d=n(s),f=d.map(M=>Metadata.get(M,"name")),o=Getter.constant(f),l=Getter.multi(d),a=t!=null&&t.queries?t.queries(s):{},r=exports.Factor.bijection(d[0].length,{x:o,y:l,...a}),i=exports.Factor.product(r,u.factor),c=Summaries.of({},[r,i]),p=exports.Scales.of({x:["split","split"],y:["compound","split"]}),x=Summaries.translate(c,[M=>M,M=>M]),w=Lines.of(x,p),[y,g]=["pcoords","proportion"],v={...t,type:y,representation:g},b=Object.assign(exports.Plot.of(c,p,v),{lines:w});exports.Plot.addGeom(b,w);const S=d.map(M=>inferExpanse(M));return exports.Scale.setDomain(p.x,ExpanseSplit.of(ExpansePoint.of(f))),exports.Scale.setDomain(p.y,ExpanseCompound.of(S)),Metadata.set(p.x,{name:"variable"}),Metadata.set(p.y,{name:"value"}),Reactive.listen(b,"normalize",()=>switchRepresentation(b)),b}function switchRepresentation(e){e.representation==="proportion"?(ExpanseCompound.setCommonScale(e.scales.y.domain,!0),e.representation="absolute"):(ExpanseCompound.setCommonScale(e.scales.y.domain,!1),e.representation="proportion"),exports.Plot.renderAxes(e)}var Points;(e=>{const n="points";function t(f,o){return Geom.of({type:n,coordinates:f,scales:o})}e.of=t,exports.Polymorphic.set(Geom.render,n,s),exports.Polymorphic.set(Geom.check,n,u),exports.Polymorphic.set(Geom.query,n,d);function s(f,o){const{scales:l}=f,a=Geom.groupedData(f),r=findLength(Object.values(a)),[i,c,p]=Geom.scaledArrays(r,[[a.x,l.x],[a.y,l.y],[a.size,l.size]]),x=Geom.frames(r,a[LAYER],o);Frame.points(x,i,c,p)}e.render=s;function u(f,o){const{scales:l}=f,a=Geom.flatData(f),r=findLength(Object.values(a)),{x:i,y:c,size:p}=Getter.mapObject(a),x=Getter.of(a[exports.Factor.POSITIONS]),w=[];for(let y=0;y<r;y++){const g=exports.Scale.pushforward(l.x,i(y)),v=exports.Scale.pushforward(l.y,c(y));let b=exports.Scale.pushforward(l.size,p(y));b=b/Math.sqrt(2);const S=[g-b,v-b,g+b,v+b];if(rectsIntersect(o,S)){const M=x(y);for(let I=0;I<M.length;I++)w.push(M[I])}}return w}e.check=u;function d(f,o){var w;const{scales:l}=f,a=Geom.flatData(f),r=Geom.groupedData(f),i=findLength(Object.values(a)),{x:c,y:p,size:x}=Getter.mapObject(a);for(let y=0;y<i;y++){const g=exports.Scale.pushforward(l.x,c(y)),v=exports.Scale.pushforward(l.y,p(y));let b=exports.Scale.pushforward(l.size,x(y));b=b/Math.sqrt(2);const S=[g-b,v-b,g+b,v+b];if(pointInRect(o,S)){const M=(w=a[exports.Factor.CHILD_INDICES])==null?void 0:w[y];return Geom.getQueryInfo(r,M)}}}e.query=d})(Points||(Points={}));function Scatterplot(e,n,t){const{data:s,marker:u}=e,[d,f,o]=n(s),l=t!=null&&t.queries?t==null?void 0:t.queries(s):{},a={x:d,y:f,size:o??(()=>.5),...l},r=exports.Factor.bijection(d.length,a),i=exports.Factor.product(r,u.factor),c=Summaries.of({},[r,i]),p=Summaries.translate(c,[b=>b,b=>b]),x=exports.Scales.of(),w={...t,type:"scatter"},y=exports.Plot.of(c,x,w);exports.Scale.train(x.x,d,{default:!0}),exports.Scale.train(x.y,f,{default:!0}),o&&exports.Scale.train(x.size,o,{default:!0});const g=30/Math.log(d.length+2);exports.Expanse.set(x.size.codomain,()=>({max:g}),{default:!0});const v=Points.of(p,x);return exports.Plot.addGeom(y,v),y}const defaultOptions={size:10,expandX:.1,expandY:.1,gapPct:.8,gapPx:1,axisLabelSize:1,axisTitleSize:1.25,margins:[0,0,0,0],marginLines:[3.5,3.5,1,1],colors:["#FF7F00","#E31A1C","#33A02C","#1F78B4","#FDBF6F","#FB9A99","#B2DF8A","#A6CEE3"],plotBackground:"#fefffe"};var Axes;(e=>{function n(a){t(a),s(a)}e.renderLabels=n;function t(a){const{frames:r,scales:i,options:c}=a,{margins:p}=c,x=i.x,w=i.y,y=r.xAxis,{context:g,width:v}=y,b=parseInt(g.font.match(/^[0-9]*/)[0],10),S=w.codomain.props.min-b/2,[,M,,I]=p,{labels:z,positions:_}=exports.Scale.breaks(x);Frame.clear(y);let[O,h]=[0,0];for(let m=0;m<z.length;m++){const R=z[m],T=_[m],C=Frame.textWidth(y,R)+1;o(T,M,v-I)||l(O,T,h,C)||([O,h]=[T,C],Frame.text(y,T,S,R))}}function s(a){const{frames:r,scales:i,options:c}=a,{margins:p,marginLines:x}=c,w=i.y,y=i.x,g=r.yAxis,{context:v,height:b}=g,S=parseInt(v.font.match(/^[0-9]*/)[0],10),M=y.codomain.props.min-S/2,[I,,z]=p,{labels:_,positions:O}=exports.Scale.breaks(w);Frame.clear(g);let[h,m]=[0,0];for(let R=0;R<_.length;R++){const T=_[R],C=O[R],k=Frame.textWidth(g,T)+1,P=Frame.textHeight(g,T)+1;if(!o(C,I,b-z)&&!l(h,C,m,P)){for(;p[1]/2<k+P;)x[1]*=1.05,exports.Plot.resize(a);[h,m]=[C,P],Frame.text(g,M,C,T)}}}function u(a){Frame.clear(a.frames.base),d(a),f(a)}e.renderTitles=u;function d(a){const{scales:r,frames:i,options:c}=a,{margins:p}=c,x=r.x,w=r.y,y=i.base,g=Metadata.get(x,"name"),v=p[0],b=exports.Expanse.unnormalize(x.codomain,.5),S=exports.Expanse.unnormalize(w.codomain,0)-v*2/3;Frame.text(y,b,S,g)}function f(a){const{scales:r,frames:i,options:c}=a,{margins:p}=c,x=r.y,w=r.x,y=i.base,g=Metadata.get(x,"name"),v=p[1],b=exports.Expanse.unnormalize(x.codomain,.5),S=exports.Expanse.unnormalize(w.codomain,0)-v*2/3;Frame.text(y,S,b,g,{vertical:!0})}function o(a,r,i){return a<r||a>i}function l(a,r,i,c){const[p,x]=[a-i/2,a+i/2],[w,y]=[r-c/2,r+c/2];return p<y&&x>=w}})(Axes||(Axes={}));function _typeof(e){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof(e)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(e,n){if(e=e||"",n=n||{},e instanceof tinycolor)return e;if(!(this instanceof tinycolor))return new tinycolor(e,n);var t=inputToRGB(e);this._originalInput=e,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=n.format||t.format,this._gradientType=n.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}tinycolor.prototype={isDark:function e(){return this.getBrightness()<128},isLight:function e(){return!this.isDark()},isValid:function e(){return this._ok},getOriginalInput:function e(){return this._originalInput},getFormat:function e(){return this._format},getAlpha:function e(){return this._a},getBrightness:function e(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},getLuminance:function e(){var n=this.toRgb(),t,s,u,d,f,o;return t=n.r/255,s=n.g/255,u=n.b/255,t<=.03928?d=t/12.92:d=Math.pow((t+.055)/1.055,2.4),s<=.03928?f=s/12.92:f=Math.pow((s+.055)/1.055,2.4),u<=.03928?o=u/12.92:o=Math.pow((u+.055)/1.055,2.4),.2126*d+.7152*f+.0722*o},setAlpha:function e(n){return this._a=boundAlpha(n),this._roundA=Math.round(100*this._a)/100,this},toHsv:function e(){var n=rgbToHsv(this._r,this._g,this._b);return{h:n.h*360,s:n.s,v:n.v,a:this._a}},toHsvString:function e(){var n=rgbToHsv(this._r,this._g,this._b),t=Math.round(n.h*360),s=Math.round(n.s*100),u=Math.round(n.v*100);return this._a==1?"hsv("+t+", "+s+"%, "+u+"%)":"hsva("+t+", "+s+"%, "+u+"%, "+this._roundA+")"},toHsl:function e(){var n=rgbToHsl(this._r,this._g,this._b);return{h:n.h*360,s:n.s,l:n.l,a:this._a}},toHslString:function e(){var n=rgbToHsl(this._r,this._g,this._b),t=Math.round(n.h*360),s=Math.round(n.s*100),u=Math.round(n.l*100);return this._a==1?"hsl("+t+", "+s+"%, "+u+"%)":"hsla("+t+", "+s+"%, "+u+"%, "+this._roundA+")"},toHex:function e(n){return rgbToHex(this._r,this._g,this._b,n)},toHexString:function e(n){return"#"+this.toHex(n)},toHex8:function e(n){return rgbaToHex(this._r,this._g,this._b,this._a,n)},toHex8String:function e(n){return"#"+this.toHex8(n)},toRgb:function e(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function e(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function e(){return{r:Math.round(bound01(this._r,255)*100)+"%",g:Math.round(bound01(this._g,255)*100)+"%",b:Math.round(bound01(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function e(){return this._a==1?"rgb("+Math.round(bound01(this._r,255)*100)+"%, "+Math.round(bound01(this._g,255)*100)+"%, "+Math.round(bound01(this._b,255)*100)+"%)":"rgba("+Math.round(bound01(this._r,255)*100)+"%, "+Math.round(bound01(this._g,255)*100)+"%, "+Math.round(bound01(this._b,255)*100)+"%, "+this._roundA+")"},toName:function e(){return this._a===0?"transparent":this._a<1?!1:hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1},toFilter:function e(n){var t="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),s=t,u=this._gradientType?"GradientType = 1, ":"";if(n){var d=tinycolor(n);s="#"+rgbaToArgbHex(d._r,d._g,d._b,d._a)}return"progid:DXImageTransform.Microsoft.gradient("+u+"startColorstr="+t+",endColorstr="+s+")"},toString:function e(n){var t=!!n;n=n||this._format;var s=!1,u=this._a<1&&this._a>=0,d=!t&&u&&(n==="hex"||n==="hex6"||n==="hex3"||n==="hex4"||n==="hex8"||n==="name");return d?n==="name"&&this._a===0?this.toName():this.toRgbString():(n==="rgb"&&(s=this.toRgbString()),n==="prgb"&&(s=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(s=this.toHexString()),n==="hex3"&&(s=this.toHexString(!0)),n==="hex4"&&(s=this.toHex8String(!0)),n==="hex8"&&(s=this.toHex8String()),n==="name"&&(s=this.toName()),n==="hsl"&&(s=this.toHslString()),n==="hsv"&&(s=this.toHsvString()),s||this.toHexString())},clone:function e(){return tinycolor(this.toString())},_applyModification:function e(n,t){var s=n.apply(null,[this].concat([].slice.call(t)));return this._r=s._r,this._g=s._g,this._b=s._b,this.setAlpha(s._a),this},lighten:function e(){return this._applyModification(_lighten,arguments)},brighten:function e(){return this._applyModification(_brighten,arguments)},darken:function e(){return this._applyModification(_darken,arguments)},desaturate:function e(){return this._applyModification(_desaturate,arguments)},saturate:function e(){return this._applyModification(_saturate,arguments)},greyscale:function e(){return this._applyModification(_greyscale,arguments)},spin:function e(){return this._applyModification(_spin,arguments)},_applyCombination:function e(n,t){return n.apply(null,[this].concat([].slice.call(t)))},analogous:function e(){return this._applyCombination(_analogous,arguments)},complement:function e(){return this._applyCombination(_complement,arguments)},monochromatic:function e(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function e(){return this._applyCombination(_splitcomplement,arguments)},triad:function e(){return this._applyCombination(polyad,[3])},tetrad:function e(){return this._applyCombination(polyad,[4])}},tinycolor.fromRatio=function(e,n){if(_typeof(e)=="object"){var t={};for(var s in e)e.hasOwnProperty(s)&&(s==="a"?t[s]=e[s]:t[s]=convertToPercentage(e[s]));e=t}return tinycolor(e,n)};function inputToRGB(e){var n={r:0,g:0,b:0},t=1,s=null,u=null,d=null,f=!1,o=!1;return typeof e=="string"&&(e=stringInputToObject(e)),_typeof(e)=="object"&&(isValidCSSUnit(e.r)&&isValidCSSUnit(e.g)&&isValidCSSUnit(e.b)?(n=rgbToRgb(e.r,e.g,e.b),f=!0,o=String(e.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(e.h)&&isValidCSSUnit(e.s)&&isValidCSSUnit(e.v)?(s=convertToPercentage(e.s),u=convertToPercentage(e.v),n=hsvToRgb(e.h,s,u),f=!0,o="hsv"):isValidCSSUnit(e.h)&&isValidCSSUnit(e.s)&&isValidCSSUnit(e.l)&&(s=convertToPercentage(e.s),d=convertToPercentage(e.l),n=hslToRgb(e.h,s,d),f=!0,o="hsl"),e.hasOwnProperty("a")&&(t=e.a)),t=boundAlpha(t),{ok:f,format:e.format||o,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:t}}function rgbToRgb(e,n,t){return{r:bound01(e,255)*255,g:bound01(n,255)*255,b:bound01(t,255)*255}}function rgbToHsl(e,n,t){e=bound01(e,255),n=bound01(n,255),t=bound01(t,255);var s=Math.max(e,n,t),u=Math.min(e,n,t),d,f,o=(s+u)/2;if(s==u)d=f=0;else{var l=s-u;switch(f=o>.5?l/(2-s-u):l/(s+u),s){case e:d=(n-t)/l+(n<t?6:0);break;case n:d=(t-e)/l+2;break;case t:d=(e-n)/l+4;break}d/=6}return{h:d,s:f,l:o}}function hslToRgb(e,n,t){var s,u,d;e=bound01(e,360),n=bound01(n,100),t=bound01(t,100);function f(a,r,i){return i<0&&(i+=1),i>1&&(i-=1),i<.16666666666666666?a+(r-a)*6*i:i<.5?r:i<.6666666666666666?a+(r-a)*(.6666666666666666-i)*6:a}if(n===0)s=u=d=t;else{var o=t<.5?t*(1+n):t+n-t*n,l=2*t-o;s=f(l,o,e+.3333333333333333),u=f(l,o,e),d=f(l,o,e-.3333333333333333)}return{r:s*255,g:u*255,b:d*255}}function rgbToHsv(e,n,t){e=bound01(e,255),n=bound01(n,255),t=bound01(t,255);var s=Math.max(e,n,t),u=Math.min(e,n,t),d,f,o=s,l=s-u;if(f=s===0?0:l/s,s==u)d=0;else{switch(s){case e:d=(n-t)/l+(n<t?6:0);break;case n:d=(t-e)/l+2;break;case t:d=(e-n)/l+4;break}d/=6}return{h:d,s:f,v:o}}function hsvToRgb(e,n,t){e=bound01(e,360)*6,n=bound01(n,100),t=bound01(t,100);var s=Math.floor(e),u=e-s,d=t*(1-n),f=t*(1-u*n),o=t*(1-(1-u)*n),l=s%6,a=[t,f,d,d,o,t][l],r=[o,t,t,f,d,d][l],i=[d,d,o,t,t,f][l];return{r:a*255,g:r*255,b:i*255}}function rgbToHex(e,n,t,s){var u=[pad2(Math.round(e).toString(16)),pad2(Math.round(n).toString(16)),pad2(Math.round(t).toString(16))];return s&&u[0].charAt(0)==u[0].charAt(1)&&u[1].charAt(0)==u[1].charAt(1)&&u[2].charAt(0)==u[2].charAt(1)?u[0].charAt(0)+u[1].charAt(0)+u[2].charAt(0):u.join("")}function rgbaToHex(e,n,t,s,u){var d=[pad2(Math.round(e).toString(16)),pad2(Math.round(n).toString(16)),pad2(Math.round(t).toString(16)),pad2(convertDecimalToHex(s))];return u&&d[0].charAt(0)==d[0].charAt(1)&&d[1].charAt(0)==d[1].charAt(1)&&d[2].charAt(0)==d[2].charAt(1)&&d[3].charAt(0)==d[3].charAt(1)?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0)+d[3].charAt(0):d.join("")}function rgbaToArgbHex(e,n,t,s){var u=[pad2(convertDecimalToHex(s)),pad2(Math.round(e).toString(16)),pad2(Math.round(n).toString(16)),pad2(Math.round(t).toString(16))];return u.join("")}tinycolor.equals=function(e,n){return!e||!n?!1:tinycolor(e).toRgbString()==tinycolor(n).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function _desaturate(e,n){n=n===0?0:n||10;var t=tinycolor(e).toHsl();return t.s-=n/100,t.s=clamp01(t.s),tinycolor(t)}function _saturate(e,n){n=n===0?0:n||10;var t=tinycolor(e).toHsl();return t.s+=n/100,t.s=clamp01(t.s),tinycolor(t)}function _greyscale(e){return tinycolor(e).desaturate(100)}function _lighten(e,n){n=n===0?0:n||10;var t=tinycolor(e).toHsl();return t.l+=n/100,t.l=clamp01(t.l),tinycolor(t)}function _brighten(e,n){n=n===0?0:n||10;var t=tinycolor(e).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(n/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(n/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(n/100)))),tinycolor(t)}function _darken(e,n){n=n===0?0:n||10;var t=tinycolor(e).toHsl();return t.l-=n/100,t.l=clamp01(t.l),tinycolor(t)}function _spin(e,n){var t=tinycolor(e).toHsl(),s=(t.h+n)%360;return t.h=s<0?360+s:s,tinycolor(t)}function _complement(e){var n=tinycolor(e).toHsl();return n.h=(n.h+180)%360,tinycolor(n)}function polyad(e,n){if(isNaN(n)||n<=0)throw new Error("Argument to polyad must be a positive number");for(var t=tinycolor(e).toHsl(),s=[tinycolor(e)],u=360/n,d=1;d<n;d++)s.push(tinycolor({h:(t.h+d*u)%360,s:t.s,l:t.l}));return s}function _splitcomplement(e){var n=tinycolor(e).toHsl(),t=n.h;return[tinycolor(e),tinycolor({h:(t+72)%360,s:n.s,l:n.l}),tinycolor({h:(t+216)%360,s:n.s,l:n.l})]}function _analogous(e,n,t){n=n||6,t=t||30;var s=tinycolor(e).toHsl(),u=360/t,d=[tinycolor(e)];for(s.h=(s.h-(u*n>>1)+720)%360;--n;)s.h=(s.h+u)%360,d.push(tinycolor(s));return d}function _monochromatic(e,n){n=n||6;for(var t=tinycolor(e).toHsv(),s=t.h,u=t.s,d=t.v,f=[],o=1/n;n--;)f.push(tinycolor({h:s,s:u,v:d})),d=(d+o)%1;return f}tinycolor.mix=function(e,n,t){t=t===0?0:t||50;var s=tinycolor(e).toRgb(),u=tinycolor(n).toRgb(),d=t/100,f={r:(u.r-s.r)*d+s.r,g:(u.g-s.g)*d+s.g,b:(u.b-s.b)*d+s.b,a:(u.a-s.a)*d+s.a};return tinycolor(f)},tinycolor.readability=function(e,n){var t=tinycolor(e),s=tinycolor(n);return(Math.max(t.getLuminance(),s.getLuminance())+.05)/(Math.min(t.getLuminance(),s.getLuminance())+.05)},tinycolor.isReadable=function(e,n,t){var s=tinycolor.readability(e,n),u,d;switch(d=!1,u=validateWCAG2Parms(t),u.level+u.size){case"AAsmall":case"AAAlarge":d=s>=4.5;break;case"AAlarge":d=s>=3;break;case"AAAsmall":d=s>=7;break}return d},tinycolor.mostReadable=function(e,n,t){var s=null,u=0,d,f,o,l;t=t||{},f=t.includeFallbackColors,o=t.level,l=t.size;for(var a=0;a<n.length;a++)d=tinycolor.readability(e,n[a]),d>u&&(u=d,s=tinycolor(n[a]));return tinycolor.isReadable(e,s,{level:o,size:l})||!f?s:(t.includeFallbackColors=!1,tinycolor.mostReadable(e,["#fff","#000"],t))};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names);function flip(e){var n={};for(var t in e)e.hasOwnProperty(t)&&(n[e[t]]=t);return n}function boundAlpha(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function bound01(e,n){isOnePointZero(e)&&(e="100%");var t=isPercentage(e);return e=Math.min(n,Math.max(0,parseFloat(e))),t&&(e=parseInt(e*n,10)/100),Math.abs(e-n)<1e-6?1:e%n/parseFloat(n)}function clamp01(e){return Math.min(1,Math.max(0,e))}function parseIntFromHex(e){return parseInt(e,16)}function isOnePointZero(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function isPercentage(e){return typeof e=="string"&&e.indexOf("%")!=-1}function pad2(e){return e.length==1?"0"+e:""+e}function convertToPercentage(e){return e<=1&&(e=e*100+"%"),e}function convertDecimalToHex(e){return Math.round(parseFloat(e)*255).toString(16)}function convertHexToDecimal(e){return parseIntFromHex(e)/255}var matchers=function(){var e="[-\\+]?\\d+%?",n="[-\\+]?\\d*\\.\\d+%?",t="(?:"+n+")|(?:"+e+")",s="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",u="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+s),rgba:new RegExp("rgba"+u),hsl:new RegExp("hsl"+s),hsla:new RegExp("hsla"+u),hsv:new RegExp("hsv"+s),hsva:new RegExp("hsva"+u),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function isValidCSSUnit(e){return!!matchers.CSS_UNIT.exec(e)}function stringInputToObject(e){e=e.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var n=!1;if(names[e])e=names[e],n=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=matchers.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=matchers.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=matchers.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=matchers.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=matchers.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=matchers.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=matchers.hex8.exec(e))?{r:parseIntFromHex(t[1]),g:parseIntFromHex(t[2]),b:parseIntFromHex(t[3]),a:convertHexToDecimal(t[4]),format:n?"name":"hex8"}:(t=matchers.hex6.exec(e))?{r:parseIntFromHex(t[1]),g:parseIntFromHex(t[2]),b:parseIntFromHex(t[3]),format:n?"name":"hex"}:(t=matchers.hex4.exec(e))?{r:parseIntFromHex(t[1]+""+t[1]),g:parseIntFromHex(t[2]+""+t[2]),b:parseIntFromHex(t[3]+""+t[3]),a:convertHexToDecimal(t[4]+""+t[4]),format:n?"name":"hex8"}:(t=matchers.hex3.exec(e))?{r:parseIntFromHex(t[1]+""+t[1]),g:parseIntFromHex(t[2]+""+t[2]),b:parseIntFromHex(t[3]+""+t[3]),format:n?"name":"hex"}:!1}function validateWCAG2Parms(e){var n,t;return e=e||{level:"AA",size:"small"},n=(e.level||"AA").toUpperCase(),t=(e.size||"small").toLowerCase(),n!=="AA"&&n!=="AAA"&&(n="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:n,size:t}}var QueryTable;(e=>{function n(s,u){if(DOM.clearChildren(s),!Array.isArray(u)){for(const[d,f]of Object.entries(u)){const o=t(d,f);DOM.append(s,o)}return}for(const d of Object.values(u))for(const[f,o]of Object.entries(d)){const l=t(f,o,defaultOptions.colors[d[LAYER]]);DOM.append(s,l)}}e.formatQueryTable=n;function t(s,u,d){const f=DOM.element("tr"),o=DOM.element("td",{classes:tw("tw-border tw-border-black tw-px-3 tw-py-1"),textContent:s}),l=DOM.element("td",{classes:tw("tw-border tw-border-black tw-px-3 tw-py-1 tw-font-mono"),textContent:formatLabel(u)});if(d){const[a,r]=[d,"black"];DOM.setStyles(o,{backgroundColor:a,borderColor:r}),DOM.setStyles(l,{backgroundColor:a,borderColor:r}),tinycolor(d).getBrightness()<127&&(DOM.setStyles(o,{color:"white"}),DOM.setStyles(l,{color:"white"}))}return DOM.append(f,o),DOM.append(f,l),f}})(QueryTable||(QueryTable={})),exports.Plot=void 0,(e=>{function n(A,E,F){const D=DOM.element("div",{id:"plot",classes:tw("tw-relative tw-h-full tw-w-full tw-drop-shadow-md")});A=A??[],E=E??exports.Scales.of();const L={},j=[],H=[],$=[],N={...structuredClone(defaultOptions),...F},{expandX:B,expandY:q}=N,U=[[B,q,1-B,1-q]],W={active:!1,locked:!1,mousedown:!1,mousebutton:MouseButton.Left,mode:"select",mousecoords:[0,0,0,0],lastkey:"",ratio:(F==null?void 0:F.ratio)??void 0},V=F.type??"unknown",K=F.representation??"absolute",Q=Reactive.of()({type:V,representation:K,data:A,container:D,frames:L,scales:E,renderables:j,selectables:H,queryables:$,zoomStack:U,parameters:W,options:N});return setupFrames(Q,N),setupScales(Q),setupEvents$1(Q),Q}e.of=n,e.scatter=Scatterplot,e.bar=Barplot,e.fluct=Fluctuationplot,e.histo=Histogram,e.histo2d=Histogram2d,e.pcoords=Pcoordsplot,e.bibar=Bibarplot;function t(A,E){A.appendChild(E.container),e.resize(E)}e.append=t;function s(A,E){const{renderables:F,selectables:D,queryables:L}=A;for(const j of[F,D,L])j.push(E);Reactive.listen(E,"coords-changed",()=>e.render(A))}e.addGeom=s;function u(A,E){const{renderables:F,selectables:D,queryables:L}=A;for(const j of[F,D,L])remove(j,E);Reactive.removeAllListeners(E)}e.deleteGeom=u;const d=tw("tw-outline tw-outline-2 tw-outline-slate-600");function f(A){DOM.addClasses(A.container,d),A.parameters.active=!0,Reactive.dispatch(A,"activated")}e.activate=f;function o(A){DOM.removeClasses(A.container,d),A.parameters.active=!1,Reactive.dispatch(A,"deactivated")}e.deactivate=o;function l(A){A.parameters.locked=!0}e.lock=l;function a(A){A.parameters.locked=!1}e.unlock=a;function r(A){for(const E of dataLayers)Frame.clear(A.frames[E]);for(const E of A.renderables)Geom.render(E,A.frames)}e.render=r;function i(A){Axes.renderLabels(A),Axes.renderTitles(A)}e.renderAxes=i;function c(A){Frame.clear(A.frames.user)}e.clearUserFrame=c;function p(A){const{container:E,scales:F,frames:D,parameters:L,options:j}=A,{clientWidth:H,clientHeight:$}=E,{x:N,y:B,width:q,height:U,area:W}=F,{margins:V,marginLines:K}=j,Q=getComputedStyle(A.container),ee=parseFloat(Q.fontSize);for(let Z=0;Z<V.length;Z++)V[Z]=K[Z]*ee;for(const Z of Object.values(A.frames))Frame.resize(Z);const[J,Y]=[V[0],V[1]],[ne,X]=[$-V[2],H-V[3]];DOM.setStyles(D.under.canvas,{width:`calc(100% - ${Y}px - ${V[3]}px)`,height:`calc(100% - ${J}px - ${V[2]}px)`,top:`${V[2]}px`,right:`${V[3]}px`}),DOM.setStyles(D.over.canvas,{width:`calc(100% - ${Y}px - ${V[3]}px)`,height:`calc(100% - ${J}px - ${V[2]}px)`,top:`${V[2]}px`,right:`${V[3]}px`});const te={default:!0,silent:!0};exports.Expanse.set(N.codomain,()=>({min:Y,max:X}),te),exports.Expanse.set(B.codomain,()=>({min:J,max:ne}),te);const[re,oe]=[X-Y,ne-J];if(exports.Expanse.set(q.codomain,()=>({max:re}),te),exports.Expanse.set(U.codomain,()=>({max:oe}),te),exports.Expanse.set(W.codomain,()=>({max:Math.min(re,oe)}),te),L.ratio){const{expandX:Z,expandY:se}=defaultOptions;exports.Scale.set(N,()=>({zero:Z,one:1-Z}),te),exports.Scale.set(B,()=>({zero:se,one:1-se}),te),e.applyRatio(A,L.ratio)}e.render(A),e.renderAxes(A)}e.resize=p;function x(A,E){const{selectables:F,parameters:D}=A;E=E??D.mousecoords;const L=new Set;for(const H of F){const $=Geom.check(H,E);for(let N=0;N<$.length;N++)L.add($[N])}const j=Array.from(L);Reactive.dispatch(A,"set-selected",{cases:j})}e.checkSelection=x;function w(A,E,F){const{frames:D,scales:L,options:j}=A,{margins:H}=j,$=(F==null?void 0:F.units)??"pct";$==="screen"?(E[0]+=H[1],E[1]+=H[0],E[2]+=H[1],E[3]+=H[0]):$==="pct"?(E[0]=exports.Expanse.unnormalize(L.x.codomain,E[0]),E[1]=exports.Expanse.unnormalize(L.y.codomain,E[1]),E[2]=exports.Expanse.unnormalize(L.x.codomain,E[2]),E[3]=exports.Expanse.unnormalize(L.y.codomain,E[3])):$==="data"&&(E[0]=exports.Scale.pushforward(L.x,E[0]),E[1]=exports.Scale.pushforward(L.y,E[1]),E[2]=exports.Scale.pushforward(L.x,E[2]),E[3]=exports.Scale.pushforward(L.y,E[3])),x(A,E),e.clearUserFrame(A),Frame.rectangleXY(D.user,...E,1)}e.selectRegion=w;function y(A,E){A.parameters.mode=E}e.setMode=y;function g(A,E){A.parameters.mousedown=E}e.setMousedown=g;function v(A,E){A.parameters.mousebutton=E}e.setMouseButton=v,e.mousemoveHandlers={select:b,pan:S,query:M};function b(A,E){const{container:F,parameters:D,frames:L}=A;if(!D.active||!D.mousedown)return;const{mousecoords:j}=D,{clientHeight:H}=F,$=E.offsetX,N=H-E.offsetY;j[2]=$,j[3]=N,e.checkSelection(A),Reactive.dispatch(A,"lock-others"),e.clearUserFrame(A),Frame.rectangleXY(L.user,...D.mousecoords,1)}function S(A,E){const{container:F,scales:D,parameters:L}=A;if(!L.active||!L.mousedown)return;const{mousecoords:j}=L,{clientWidth:H,clientHeight:$}=F,[N,B]=j,q=E.offsetX,U=$-E.offsetY,W=(q-N)/H,V=(U-B)/$;exports.Scale.move(D.x,W),exports.Scale.move(D.y,V),j[0]=q,j[1]=U,e.clearUserFrame(A)}function M(A,E){const{offsetX:F,offsetY:D}=E,{queryTable:L,queryables:j,container:H}=A,{clientHeight:$}=H;if(!L)return;DOM.setStyles(L,{display:"none"});const[N,B]=[F,$-D];let q;for(const U of j)if(q=Geom.query(U,[N,B]),q)break;q&&(QueryTable.formatQueryTable(L,q),L.style.display="inline-block")}e.keybindings={"=":"grow","-":"shrink","]":"unfade","[":"fade",z:"zoom",x:"pop-zoom",o:"reorder",";":"decrement-anchor","'":"increment-anchor",n:"normalize"};function I(A){const{area:E,size:F,width:D}=A.scales,L=10/9,j={silent:!0};exports.Expanse.set(E.codomain,H=>({min:H.min*L,max:H.max*L}),j),exports.Expanse.set(F.codomain,H=>({min:H.min*L,max:H.max*L}),j),exports.Expanse.set(D.codomain,H=>H.mult<1?{mult:H.mult*L}:{},j),e.render(A)}e.grow=I;function z(A){const{area:E,size:F,width:D}=A.scales,L=9/10,j={silent:!0};exports.Expanse.set(E.codomain,H=>({min:H.min*L,max:H.max*L}),j),exports.Expanse.set(F.codomain,H=>({min:H.min*L,max:H.max*L}),j),exports.Expanse.set(D.codomain,H=>({mult:H.mult*9/10}),j),e.render(A)}e.shrink=z;function _(A){const{frames:E}=A;for(const F of baseLayers)Frame.setAlpha(E[F],D=>D*9/10);e.render(A)}e.fade=_;function O(A){const{frames:E}=A;for(const F of baseLayers)Frame.setAlpha(E[F],D=>D*10/9);e.render(A)}e.unfade=O;function h(A){const{frames:E,scales:F}=A;for(const D of baseLayers)Frame.resetAlpha(E[D]);for(const D of Object.values(F))exports.Scale.restore(D);A.zoomStack.length=1,e.clearUserFrame(A)}e.reset=h;function m(A){e.setMode(A,"query")}e.setQueryMode=m;function R(A,E){const{scales:F,parameters:D,zoomStack:L}=A;let{coords:j,units:H}=E??{};H=H??"screen";let[$,N,B,q]=j??D.mousecoords;const{x:U,y:W}=F;if(H==="data"){const X={silent:!0};exports.Scale.set(U,()=>({zero:0,one:1}),X),exports.Scale.set(W,()=>({zero:0,one:1}),X),$=exports.Expanse.normalize(U.domain,$),B=exports.Expanse.normalize(U.domain,B),N=exports.Expanse.normalize(W.domain,N),q=exports.Expanse.normalize(W.domain,q)}if(H==="screen"){if(Math.abs(B-$)<10||Math.abs(q-N)<10)return;$=trunc(exports.Expanse.normalize(U.codomain,$)),B=trunc(exports.Expanse.normalize(U.codomain,B)),N=trunc(exports.Expanse.normalize(W.codomain,N)),q=trunc(exports.Expanse.normalize(W.codomain,q))}[$,B]=[$,B].sort(diff),[N,q]=[N,q].sort(diff),exports.Scale.expand(F.x,$,B),exports.Scale.expand(F.y,N,q);const V=rangeInverse($,B),K=rangeInverse(N,q),Q=sqrt(max(V,K)),{width:ee,height:J,area:Y,size:ne}=F;ee.codomain!==Y.codomain&&exports.Expanse.set(ee.codomain,X=>({max:X.max*V})),J.codomain!==Y.codomain&&exports.Expanse.set(J.codomain,X=>({max:X.max*K})),exports.Expanse.set(Y.codomain,X=>({max:X.max*Q})),exports.Expanse.set(ne.codomain,X=>({max:X.max*Q})),L.push([$,N,B,q]),Reactive.dispatch(A,"clear-transient"),e.render(A)}e.zoom=R;function T(A){const{scales:E,zoomStack:F}=A;if(F.length===1)return;const[D,L,j,H]=F[F.length-1],[$,N]=invertRange(D,j),[B,q]=invertRange(L,H);exports.Scale.expand(E.x,$,N),exports.Scale.expand(E.y,B,q);const U=rangeInverse($,N),W=rangeInverse(B,q),V=1/sqrt(max(1/U,1/W)),{width:K,height:Q,area:ee,size:J}=E;K.codomain!==ee.codomain&&exports.Expanse.set(K.codomain,Y=>({max:Y.max*U})),Q.codomain!==ee.codomain&&exports.Expanse.set(Q.codomain,Y=>({max:Y.max*W})),exports.Expanse.set(ee.codomain,Y=>({max:Y.max*V})),exports.Expanse.set(J.codomain,Y=>({max:Y.max*V})),F.pop(),e.clearUserFrame(A),e.render(A)}e.popZoom=T;function C(A,E){const{x:F,y:D}=A.scales;if(!exports.Expanse.isContinuous(F.domain)||!exports.Expanse.isContinuous(D.domain))throw new Error("Both axes need to be continuous to set a ratio");A.parameters.ratio=E,e.resize(A)}e.setRatio=C;function k(A,E){const{scales:F}=A,{x:D,y:L}=F,j=exports.Scale.unitRatio(D),H=exports.Scale.unitRatio(L)*E,$={default:!0,silent:!0};if(j>H){const N=H/j*exports.Scale.unitRange(L),[B,q]=[(1-N)/2,(1+N)/2];exports.Scale.set(D,()=>({zero:B,one:q}),$)}else{const N=j/H*exports.Scale.unitRange(D),[B,q]=[(1-N)/2,(1+N)/2];exports.Scale.set(L,()=>({zero:B,one:q}),$)}}e.applyRatio=k;function P(A,E){return A.scales[E]}e.getScale=P;function G(A,E,F){let{min:D,max:L,zero:j,one:H,mult:$,labels:N,direction:B}=F;const q=A.scales[E],U=q.domain;if(!Object.keys(A.scales).includes(E))throw new Error(`Unrecognized scale '${E}'`);const W={default:F.default??!1,unfreeze:F.unfreeze??!1};if([j,H].some(isDefined)&&(j=j??q.props.zero,H=H??q.props.one,exports.Scale.set(q,()=>({zero:j,one:H}),W),A.parameters.ratio=void 0),[D,L].some(isDefined)){if(!exports.Expanse.isContinuous(U))throw new Error("Limits can only be set with a continuous domain");j=isDefined(D)?j??0:q.props.zero,H=isDefined(L)?H??1:q.props.one,D=D??U.props.min,L=L??U.props.max,exports.Expanse.set(U,()=>({min:D,max:L}),W),exports.Scale.set(q,()=>({zero:j,one:H}),W),A.parameters.ratio=void 0}if(N){if(!exports.Expanse.isDiscrete(U))throw new Error("Labels can be ordered with a discrete domain only");if(!stringArraysMatch(U.props.labels,N))throw new Error("Labels must match the scale's labels");const V=orderIndicesByTable(U.props.labels,N);exports.Expanse.reorder(U,V)}B&&exports.Scale.set(q,()=>({direction:B}),W),$&&exports.Scale.set(q,()=>({mult:$}),W)}e.setScale=G})(exports.Plot||(exports.Plot={}));function setupFrames(e,n){const{container:t,frames:s}=e,{margins:u,colors:d,axisLabelSize:f,axisTitleSize:o}=n,[l,a,r,i]=u,c=[7,6,5,4,3,2,1,0],p="tw-absolute tw-top-0 tw-right-0 tw-w-full tw-h-full ";for(const O of c){const h={zIndex:`${7-O+2}`},m=d[O],R={fillStyle:m,strokeStyle:m},T=Frame.of({classes:p,contextProps:R,canvasStyles:h,margins:u});s[O]=T}const x=Frame.of({classes:p+"tw-bg-gray-100"});Frame.setContext(x,{font:`${o}em sans-serif`,textBaseline:"middle",textAlign:"center"});const w=`calc(100% - ${a}px - ${i}px)`,y=`calc(100% - ${l}px - ${r}px)`,g={width:w,height:y,top:r+"px",right:i+"px"},v=Frame.of({classes:p+"tw-z-1 tw-bg-white",canvasStyles:g}),S=Frame.of({classes:p+"tw-z-10 tw-border tw-border-b-black tw-border-l-black",canvasStyles:g}),M=Frame.of({classes:p+"tw-z-10",margins:u});Frame.setContext(M,{globalAlpha:.06666666666666667});const I="#3B4854",z=Frame.of({classes:p});Frame.setContext(z,{fillStyle:I,textBaseline:"top",textAlign:"center",font:`${f}em serif`});const _=Frame.of({classes:p});Frame.setContext(_,{fillStyle:"#3B4854",textBaseline:"middle",textAlign:"right",font:`${f}em serif`}),Object.assign(s,{base:x,under:v,over:S,user:M,xAxis:z,yAxis:_});for(let[O,h]of Object.entries(s))isNaN(parseFloat(O))||(O="data-"+O),h.canvas.id=`frame-${O}`,Frame.append(h,t)}function setupEvents$1(e){const{container:n,parameters:t}=e,{mousecoords:s}=t;for(const[u,d]of Object.entries(exports.Plot.keybindings))Reactive.listen(e,u,()=>Reactive.dispatch(e,d));n.addEventListener("mousedown",u=>{const{locked:d}=t;exports.Plot.activate(e),exports.Plot.setMousedown(e,!0),exports.Plot.setMouseButton(e,u.button),u.button===MouseButton.Left?exports.Plot.setMode(e,"select"):u.button===MouseButton.Right&&exports.Plot.setMode(e,"pan");const f=u.offsetX,o=n.clientHeight-u.offsetY;copyValues([f,o,f,o],s),!d&&t.mode==="select"&&(Reactive.dispatch(e,"clear-transient"),exports.Plot.checkSelection(e)),exports.Plot.unlock(e)}),n.addEventListener("contextmenu",u=>{u.preventDefault(),exports.Plot.setMousedown(e,!0),exports.Plot.setMouseButton(e,MouseButton.Right),exports.Plot.setMode(e,"pan"),s[0]=u.offsetX,s[1]=n.clientHeight-u.offsetY,exports.Plot.clearUserFrame(e)}),n.addEventListener("mouseup",()=>exports.Plot.setMousedown(e,!1)),n.addEventListener("mousemove",throttle(u=>{exports.Plot.mousemoveHandlers[t.mode](e,u)},20)),Reactive.listen(e,"reset",()=>exports.Plot.reset(e)),Reactive.listen(e,"resize",()=>exports.Plot.resize(e)),Reactive.listen(e,"activate",()=>exports.Plot.activate(e)),Reactive.listen(e,"deactivate",()=>exports.Plot.deactivate(e)),Reactive.listen(e,"render",()=>exports.Plot.render(e)),Reactive.listen(e,"lock",()=>exports.Plot.lock(e)),Reactive.listen(e,"unlock",()=>exports.Plot.unlock(e)),Reactive.listen(e,"query-mode",()=>exports.Plot.setMode(e,"query")),Reactive.listen(e,"render-axes",()=>exports.Plot.renderAxes(e)),Reactive.listen(e,"clear-transient",()=>exports.Plot.clearUserFrame(e)),Reactive.listen(e,"get-scale",u=>{if(!(!u||!u.scale))return exports.Plot.getScale(e,u.scale)}),Reactive.listen(e,"set-scale",u=>{!u||!u.scale||exports.Plot.setScale(e,u.scale,u)}),Reactive.listen(e,"grow",()=>exports.Plot.grow(e),{throttle:10}),Reactive.listen(e,"shrink",()=>exports.Plot.shrink(e),{throttle:10}),Reactive.listen(e,"fade",()=>exports.Plot.fade(e),{throttle:10}),Reactive.listen(e,"unfade",()=>exports.Plot.unfade(e),{throttle:10}),Reactive.listen(e,"zoom",u=>exports.Plot.zoom(e,u)),Reactive.listen(e,"pop-zoom",()=>exports.Plot.popZoom(e));for(const u of Object.values(e.scales))Reactive.listen(u,"changed",()=>{exports.Plot.render(e),exports.Plot.renderAxes(e)})}function setupScales(e){const{scales:n}=e,{x:t,y:s,width:u,height:d,size:f,area:o,areaPct:l}=n,a={default:!0,silent:!0},{expandX:r,expandY:i}=defaultOptions;exports.Expanse.set(o.domain,()=>({ratio:!0}),a),exports.Expanse.set(l.domain,()=>({ratio:!0}),a),exports.Expanse.set(f.domain,()=>({ratio:!0}),a),exports.Expanse.set(f.codomain,()=>({trans:square,inv:sqrt}),a),exports.Expanse.set(o.codomain,()=>({trans:square,inv:sqrt}),a),exports.Expanse.set(l.codomain,()=>({trans:square,inv:sqrt}),a),exports.Scale.set(t,()=>({zero:r,one:1-r}),a),exports.Scale.set(s,()=>({zero:i,one:1-i}),a),exports.Scale.set(u,()=>({one:1-2*r}),a),exports.Scale.set(d,()=>({one:1-2*i}),a),exports.Scale.set(o,()=>({one:1-2*Math.max(r,i)}),a);const c=p=>Math.max(p,0);exports.Expanse.set(u.codomain,()=>({inv:c}),a),exports.Expanse.set(d.codomain,()=>({inv:c}),a)}var KeybindingsMenu;(e=>{function n(s){const u=DOM.element("div"),d=DOM.element("div",{id:"modal"}),f=DOM.element("div",{id:"bindings"}),o=DOM.element("button",{textContent:"key bindings"});DOM.addClasses(d,tw("tw-absolute tw-left-0 tw-top-0 tw-z-50 tw-flex tw-size-full tw-flex-col tw-items-center tw-bg-slate-800 tw-bg-opacity-80 tw-p-10")),DOM.addClasses(f,tw("tw-relative tw-flex tw-h-full tw-w-fit tw-flex-col tw-flex-wrap tw-justify-start tw-py-10")),DOM.addClasses(o,tw("tw-absolute tw-right-0 tw-top-0 tw-z-30 tw-select-none tw-rounded-bl-md tw-bg-gray-300 tw-p-1 tw-px-2 tw-text-sm tw-text-white hover:tw-bg-gray-400")),DOM.append(u,d),DOM.append(u,o),DOM.append(d,f),f.style.columnFill="auto",d.style.display="none";let l=!1;function a(){d.style.display="flex"}function r(){l||(d.style.display="none")}o.addEventListener("click",a),d.addEventListener("click",r);for(const[i,c]of Object.entries(s)){const p=DOM.element("span",{classes:tw("tw-m-1 tw-flex tw-flex-row")}),x=DOM.element("button",{textContent:i}),w=DOM.element("div",{classes:tw("tw-m-1 tw-p-1 tw-px-2 tw-text-white"),textContent:capitalize(c.replaceAll("-"," "))});DOM.addClasses(x,tw("tw-m-1 tw-w-8 tw-rounded-md tw-bg-gray-400 tw-p-1 tw-px-2 tw-text-center tw-text-white tw-outline-none hover:tw-bg-gray-500")),DOM.append(p,x),DOM.append(p,w),w.addEventListener("click",g=>g.stopPropagation()),x.addEventListener("click",g=>{l||(g.stopPropagation(),DOM.addClasses(x,tw("text-black bg-slate-200 hover:bg-slate-200")),window.addEventListener("keydown",y),l=!0)});const y=g=>{const{key:v}=g,b=x.innerText;v in s&&v!==b||(t(s,v,c),x.innerText=g.key,DOM.removeClasses(x,tw("tw-text-black tw-bg-slate-200 hover:tw-bg-slate-200")),window.removeEventListener("keydown",y),l=!1)};f.appendChild(p)}return u}e.of=n;function t(s,u,d){let f;for(const[o,l]of Object.entries(s))if(l===d){f=o;break}f&&delete s[f],s[u]=d}})(KeybindingsMenu||(KeybindingsMenu={})),exports.Scene=void 0,(e=>{function n(h,m){const R=DOM.element("div",{id:"scene-container"}),T=DOM.element("div",{id:"plots-container"});DOM.addClasses(R,tw("tailwind tw-pr-15 tw-relative tw-flex tw-h-full tw-w-full tw-content-center tw-items-center tw-justify-center tw-bg-[#deded9] tw-p-10")),DOM.addClasses(T,tw("tw-grid tw-h-full tw-w-full tw-grid-cols-1 tw-grid-rows-1 tw-gap-[1em]"));const C=DOM.element("table",{classes:tw("tw-absolute tw-z-30 tw-bg-gray-100 tw-shadow-md")});DOM.setStyles(C,{pointerEvents:"none"});const k={...e.keybindings,...exports.Plot.keybindings},P=KeybindingsMenu.of(k);DOM.append(R,T),DOM.append(R,P),DOM.append(R,C);const[G,A,E]=[1,1,!1],F=Marker.of(Object.values(h)[0].length),D=[],L={},j=void 0,H=(m==null?void 0:m.echo)??!1,$=Object.assign(defaultOptions,m);for(const[B,q]of Object.entries(h))Metadata.hasMetadata(q)||(h[B]=Metadata.of(q)),Metadata.has(q,"name")||Metadata.set(q,{name:B});const N=Reactive.of()({data:h,container:R,plotsContainer:T,queryTable:C,rows:G,cols:A,active:E,echo:H,marker:F,client:j,plots:D,plotIndicesByType:L,options:$,keybindings:k});if(m!=null&&m.websocketURL){const B=new WebSocket(m.websocketURL),q={sender:"scene",target:"server",type:"connected"};B.addEventListener("open",()=>B.send(JSON.stringify(q))),B.addEventListener("message",U=>{g(N,JSON.parse(U.data))}),window.addEventListener("beforeunload",()=>B.close()),N.client=B}return setupEvents(N),N}e.of=n;async function t(h,m){const R=await fetchJSON(h);return e.of(R,m)}e.ofAsync=t;function s(h,m){h.appendChild(m.container),e.resize(m)}e.append=s;function u(h,m){const{plotsContainer:R,marker:T,plots:C,plotIndicesByType:k}=h;Reactive.listen(m,"activated",()=>{for(const A of C)A!=m&&Reactive.dispatch(A,"deactivate");const G=C.indexOf(m);h.activePlotIndex=G}),Reactive.listen(m,"lock-others",()=>{for(const G of C)G!==m&&(exports.Plot.clearUserFrame(G),Reactive.dispatch(G,"lock"))}),Reactive.listen(m,"set-selected",G=>{Marker.update(T,G.cases)}),Reactive.listen(m,"clear-transient",()=>{for(const G of C)exports.Plot.clearUserFrame(G);Marker.clearTransient(T)}),Reactive.listen(m,"render-all",()=>{for(const G of C)Reactive.dispatch(G,"render")});const{type:P}=m;k[P]||(k[P]=[]),k[P].push(C.length),C.push(m),exports.Plot.append(R,m),m.queryTable=h.queryTable,f(h),p(h),e.resize(h)}e.addPlot=u;function d(h,m){const{type:R,variables:T,reducer:C,queries:k}=m??{};if(!R||R==="unknown"||!T)return;for(const E of T)if(!Object.keys(h.data).includes(E))throw new Error(`Variable '${E}' is not present in the data`);const P=keysToSelectors(T),G={};if(G.ratio=m==null?void 0:m.ratio,C&&(G.reducer=exports.Reducer.parse(C)),k)if(isStringArray(k))G.queries=keysToSelectors(k);else{const E=F=>k.map(([D,L])=>[F[D],exports.Reducer.parse(L)]);G.queries=E}const A=exports.Plot[R](h,P,G);e.addPlot(h,A)}e.addPlotBySpec=d;function f(h){for(let m=0;m<h.plots.length;m++)h.plots[m].container.id=`plot${m+1}`}function o(h){const m=last(h.plots);m&&a(h,m)}e.popPlot=o;function l(h,m){const R=c(h,m);R&&a(h,R)}e.removePlot=l;function a(h,m){const{plots:R,plotIndicesByType:T,plotsContainer:C}=h,k=R.indexOf(m);for(const P of Object.values(T))if(P.indexOf(k)!==-1){remove(P,k);break}remove(R,m),C.removeChild(m.container),Reactive.removeAllListeners(m),f(h),p(h),e.resize(h)}function r(h,m){return m==="scene"?h:c(h,m)}e.getTarget=r;function i(h){const m={},R=[];for(const T of h.plots){const{type:C}=T;m[C]===void 0&&(m[C]=0),R.push(`${C}${m[C]}`),m[C]++}return R}e.getPlotIds=i;function c(h,m){const{plots:R,plotIndicesByType:T}=h;let[C,k]=splitNumericSuffix(m);const P=parseInt(k,10)-1;if(C==="plot"||C==="p")return R[P];if(C=C.replace("plot","").replace("gram",""),C in Object.keys(plotIdShort)&&(C=plotIdShort[C]),C in T)return R[T[C][P]]}e.getPlot=c;function p(h){const{plots:m}=h;if(m.length===0)return;const R=Math.ceil(Math.sqrt(m.length)),T=Math.ceil(m.length/R);e.setDimensions(h,T,R)}function x(h,m,R){const{plotsContainer:T}=h;h.rows=m,h.cols=R;const C=Array(m).fill("1fr").join(" "),k=Array(R).fill("1fr").join(" ");DOM.setStyles(T,{gridTemplateRows:C,gridTemplateColumns:k}),e.resize(h)}e.setDimensions=x;function w(h,m){const{plotsContainer:R,plots:T}=h,C=new Set(m.flat()),k=new Set(seq(0,T.length-1));for(const L of C)k.delete(L);k.size>0&&alert("Warning: Some plots are not included in the layout and will be hidden.");for(let L=0;L<T.length;L++)DOM.setStyles(T[L].container,{gridArea:`plot${L}`});let G="";for(const L of m)G+=`"${L.map(j=>`plot${j}`).join(" ")}" `;const[A,E]=[m.length,m[0].length],F=Array(A).fill("1fr").join(" "),D=Array(E).fill("1fr").join(" ");DOM.setStyles(R,{gridTemplateAreas:G,gridTemplateRows:F,gridTemplateColumns:D}),e.resize(h)}e.setLayout=w;function y(h){const{plotsContainer:m,plots:R}=h;DOM.setStyles(m,{gridTemplateAreas:""});for(const T of R)DOM.setStyles(T.container,{gridArea:"auto"});p(h)}e.clearLayout=y;function g(h,m){const{echo:R}=h;R&&console.log(`Scene recieved message: "${JSON.stringify(m)}"`);const{target:T,data:C}=m,k=m.type,P=r(h,T);P&&k&&Reactive.dispatch(P,k,C)}e.handleMessage=g;function v(h,m,R){const[T,C]=["scene","server"],k=JSON.stringify({sender:T,target:C,type:m,data:R}),{client:P,echo:G}=h;P&&(G&&console.log(`Scene sent message: "${k}"`),P.send(k))}e.sendMessage=v;function b(h,m){const{container:R}=h;let{fontSize:T}=m??{};if(!T){const{clientWidth:C,clientHeight:k}=R,P=Math.min(C,k)/100;T=Math.min(Math.max(8,3*P),16)}DOM.setStyles(R,{fontSize:T+"px"});for(const C of h.plots)Reactive.dispatch(C,"resize")}e.resize=b;function S(h){for(const m of h.plots)exports.Plot.render(m)}e.render=S;function M(h){for(const m of h.plots)Reactive.dispatch(m,"reset");Marker.clearTransient(h.marker)}e.reset=M;function I(h){for(const m of h.plots)Reactive.dispatch(m,"query-mode")}e.setQueryMode=I;function z(h){Marker.setGroup(h.marker,Group.First)}e.setGroupFirst=z;function _(h){Marker.setGroup(h.marker,Group.Second)}e.setGroupSecond=_;function O(h){Marker.setGroup(h.marker,Group.Third)}e.setGroupThird=O,e.keybindings={r:"reset",q:"query-mode",1:"group-1",2:"group-2",3:"group-3"}})(exports.Scene||(exports.Scene={}));function setupEvents(e){const{marker:n,plots:t,container:s,plotsContainer:u,keybindings:d,queryTable:f}=e;document.addEventListener("load",()=>{exports.Scene.resize(e),exports.Scene.render(e)}),document.addEventListener("visibilitychange",()=>{document.hidden||(exports.Scene.resize(e),exports.Scene.render(e))}),window.addEventListener("mousedown",o=>{s.contains(o.target)?e.active=!0:e.active=!1}),s.addEventListener("mousedown",o=>{if(o.target===s)for(const l of t)Reactive.dispatch(l,"deactivate")}),s.addEventListener("dblclick",()=>{for(const o of t)Reactive.dispatch(o,"deactivate"),Frame.clear(o.frames.user);Marker.clearAll(e.marker),e.activePlotIndex=void 0}),u.addEventListener("mousemove",throttle(o=>{const{clientWidth:l,clientHeight:a}=u,{clientWidth:r,clientHeight:i}=f;let{offsetX:c,offsetY:p}=o,x=o.target;for(;x!==u;){if(x===null)return;c+=x.offsetLeft,p+=x.offsetTop,x=x.parentElement}let[w,y]=[c+2,p+2];c+r>l&&(w=w-r-4),p+i>a&&(y=y-i-4),DOM.setStyles(f,{left:w+"px",top:y+"px"})},20)),window.addEventListener("keydown",o=>{const l=d[o.key],{active:a,activePlotIndex:r}=e;if(!(!l||!a)){if(r!==void 0){const i=t[r];Reactive.dispatch(i,l)}Reactive.dispatch(e,l)}}),window.addEventListener("keyup",()=>{Marker.setGroup(n,Transient);for(const o of e.plots)o.parameters.mode="select",DOM.setStyles(f,{display:"none"})}),window.addEventListener("resize",throttle(()=>exports.Scene.resize(e),10)),Reactive.listen(n,"cleared",()=>{for(const o of t)Reactive.dispatch(o,"unlock")}),Reactive.listen(e,"resize",()=>exports.Scene.resize(e)),Reactive.listen(e,"reset",()=>exports.Scene.reset(e)),Reactive.listen(e,"query-mode",()=>exports.Scene.setQueryMode(e)),Reactive.listen(e,"group-1",()=>exports.Scene.setGroupFirst(e)),Reactive.listen(e,"group-2",()=>exports.Scene.setGroupSecond(e)),Reactive.listen(e,"group-3",()=>exports.Scene.setGroupThird(e)),Reactive.listen(e,"connected",()=>{var o;return console.log(`Connected to Websocket server on: ${(o=e.client)==null?void 0:o.url}`)}),Reactive.listen(e,"set-dims",o=>{!o||!o.rows||!o.columns||exports.Scene.setDimensions(e,o.rows,o.cols)}),Reactive.listen(e,"get-plot-ids",()=>{const o=exports.Scene.getPlotIds(e);exports.Scene.sendMessage(e,"get-plot-ids",{ids:o})}),Reactive.listen(e,"add-plot",o=>{o&&exports.Scene.addPlotBySpec(e,o)}),Reactive.listen(e,"get-plot",o=>{!o||o.id}),Reactive.listen(e,"pop-plot",()=>exports.Scene.popPlot(e)),Reactive.listen(e,"remove-plot",o=>{!o||!o.id||exports.Scene.removePlot(e,o.id)}),Reactive.listen(e,"set-selected",o=>{!o||!o.cases||Marker.update(n,o.cases)}),Reactive.listen(e,"set-assigned",o=>{if(!o||!o.group)return;const l=7-Math.min(o.group,3);Marker.update(n,o.cases,{group:l})}),Reactive.listen(e,"get-selected",()=>{const o=filterIndices(Array.from(n.indices),Marker.isTransient);exports.Scene.sendMessage(e,"get-selected",{cases:o})}),Reactive.listen(e,"get-assigned",o=>{if(!o||!o.group)return;const l=r=>(r|4)===7-Math.min(o.group,3),a=filterIndices(Array.from(n.indices),l);exports.Scene.sendMessage(e,"get-assigned",{cases:a,group:o.group})}),Reactive.listen(e,"clear-selection",()=>Marker.clearAll(n)),Reactive.listen(e,"get-scale",o=>{if(!o||!o.id||!o.scale)return;const l=exports.Scene.getPlot(e,o.id);if(!l)return;const a={...exports.Plot.getScale(l,o.scale)};deepModifyProp(a,"trans",stringifyFunction),deepModifyProp(a,"inv",stringifyFunction),exports.Scene.sendMessage(e,"get-scale",{scale:a})}),Reactive.listen(e,"set-scale",o=>{if(!o||!o.id)return;const l=exports.Scene.getPlot(e,o.id);l&&Reactive.dispatch(l,"set-scale",o)}),Reactive.listen(e,"normalize",o=>{if(!o||!o.id)return;const l=exports.Scene.getPlot(e,o.id);l&&Reactive.dispatch(l,"normalize")}),Reactive.listen(e,"zoom",o=>{if(!o||!o.id)return;const l=exports.Scene.getPlot(e,o.id);l&&Reactive.dispatch(l,"zoom",o)}),Reactive.listen(e,"set-layout",o=>{!o||!o.layout||exports.Scene.setLayout(e,o.layout)}),Reactive.listen(e,"set-parameters",o=>{if(!o||!o.id)return;const l=exports.Scene.getPlot(e,o.id);l&&Reactive.dispatch(l,"set-parameters",o)}),Reactive.listen(e,"clear-layout",()=>exports.Scene.clearLayout(e))}const plotIdShort={s:"scatter",b:"bar",bb:"bibar",h:"histo",f:"fluct",hh:"histo2d",pc:"pcoords"};var Indexable;return(e=>{function n(t){return isSerializable(t)?structuredClone(t):t}e.clone=n})(Indexable||(Indexable={})),exports.Reduce=void 0,(e=>{function n(t){const s=Indexable.clone(t);return Metadata.copy(t,s),Metadata.set(s,{reducer:exports.Reducer.sum}),s}e.sum=n})(exports.Reduce||(exports.Reduce={})),exports.METHODS=METHODS,exports.addIndexed=addIndexed,exports.addTailwind=addTailwind,exports.applyDirection=applyDirection,exports.applyWith=applyWith,exports.bimap=bimap,exports.binBreaks=binBreaks,exports.call=call,exports.capitalize=capitalize,exports.compareAlphaNumeric=compareAlphaNumeric,exports.convertToSuperscript=convertToSuperscript,exports.copyProps=copyProps,exports.copyValues=copyValues,exports.cumsum=cumsum,exports.dec=dec,exports.deepModifyProp=deepModifyProp,exports.diff=diff,exports.exp10=exp10,exports.exponentialToSuperscript=exponentialToSuperscript,exports.fetchJSON=fetchJSON,exports.filterIndices=filterIndices,exports.findLength=findLength,exports.formatAxisLabels=formatAxisLabels,exports.formatLabel=formatLabel,exports.formatText=formatText,exports.identity=identity,exports.inc=inc,exports.invertRange=invertRange,exports.isDefined=isDefined,exports.isEventTarget=isEventTarget,exports.isFunction=isFunction,exports.isIntegerString=isIntegerString,exports.isNumber=isNumber,exports.isNumberArray=isNumberArray,exports.isObject=isObject,exports.isPrimitive=isPrimitive,exports.isSerializable=isSerializable,exports.isStringArray=isStringArray,exports.isTypedArray=isTypedArray,exports.just=just,exports.keysToSelectors=keysToSelectors,exports.last=last,exports.log10=log10,exports.max=max,exports.merge=merge,exports.minDecimal=minDecimal,exports.minmax=minmax,exports.one=one,exports.orderBy=orderBy,exports.orderIndices=orderIndices,exports.orderIndicesByTable=orderIndicesByTable,exports.ordered=ordered,exports.pointInRect=pointInRect,exports.prettyBreaks=prettyBreaks,exports.prod=prod,exports.randomInteger=randomInteger,exports.rangeInverse=rangeInverse,exports.rectSegmentIntersect=rectSegmentIntersect,exports.rectsIntersect=rectsIntersect,exports.remove=remove,exports.removeTailwind=removeTailwind,exports.rep=rep,exports.round=round,exports.row=row,exports.segmentsIntersect=segmentsIntersect,exports.selector=selector,exports.seq=seq,exports.seqLength=seqLength,exports.splitNumericSuffix=splitNumericSuffix,exports.sqrt=sqrt,exports.square=square,exports.stringArraysMatch=stringArraysMatch,exports.stringifyFunction=stringifyFunction,exports.stripWS=stripWS,exports.subset=subset,exports.sum=sum,exports.throttle=throttle,exports.timeExecution=timeExecution,exports.toLowerCase=toLowerCase,exports.toUpperCase=toUpperCase,exports.trunc=trunc,exports.tw=tw,exports.uniqueIntegers=uniqueIntegers,exports.zero=zero,Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),exports}({});
